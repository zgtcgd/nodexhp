const _0x5b0936=_0x67e5;(function(_0x222b22,_0x16f8ab){const _0x48f54c=_0x67e5,_0x208c60=_0x222b22();while(!![]){try{const _0x1d0b24=parseInt(_0x48f54c(0x29f))/0x1*(parseInt(_0x48f54c(0x25b))/0x2)+parseInt(_0x48f54c(0x247))/0x3*(parseInt(_0x48f54c(0x27a))/0x4)+-parseInt(_0x48f54c(0x2ae))/0x5+parseInt(_0x48f54c(0x1e9))/0x6*(-parseInt(_0x48f54c(0x239))/0x7)+parseInt(_0x48f54c(0x229))/0x8+parseInt(_0x48f54c(0x24b))/0x9*(parseInt(_0x48f54c(0x264))/0xa)+-parseInt(_0x48f54c(0x2be))/0xb*(parseInt(_0x48f54c(0x1d8))/0xc);if(_0x1d0b24===_0x16f8ab)break;else _0x208c60['push'](_0x208c60['shift']());}catch(_0x916f5e){_0x208c60['push'](_0x208c60['shift']());}}}(_0x228f,0x65967));const os=require('os'),fs=require('fs'),net=require('net'),path=require(_0x5b0936(0x245)),http=require(_0x5b0936(0x21f)),https=require('https'),axios=require(_0x5b0936(0x2ab)),{Buffer}=require(_0x5b0936(0x205)),{exec,execSync}=require('child_process'),FILE_PATH=process[_0x5b0936(0x289)]['FILE_PATH']||'/tmp',SUB_PATH=process['env'][_0x5b0936(0x2bc)]||_0x5b0936(0x24e),PORT=process[_0x5b0936(0x289)][_0x5b0936(0x296)]||0xbb8,CFPORT=process[_0x5b0936(0x289)][_0x5b0936(0x250)]||0x1bb,delay=_0x52e826=>new Promise(_0x3aa26b=>setTimeout(_0x3aa26b,_0x52e826)),SUB_URL=process[_0x5b0936(0x289)]['SUB_URL']||'',UUID=process[_0x5b0936(0x289)]['UUID']||'',XPATH=process['env'][_0x5b0936(0x23e)]||UUID[_0x5b0936(0x293)](0x0,0x8),HTTPSTLS=process[_0x5b0936(0x289)]['HTTPSTLS']||_0x5b0936(0x1ff),NEZHA_VERSION=process[_0x5b0936(0x289)][_0x5b0936(0x238)]||'V0',NEZHA_SERVER=process[_0x5b0936(0x289)][_0x5b0936(0x20d)]||'',NEZHA_PORT=process['env'][_0x5b0936(0x266)]||'443',NEZHA_KEY=process[_0x5b0936(0x289)][_0x5b0936(0x231)]||'',SUB_NAME=process[_0x5b0936(0x289)][_0x5b0936(0x23f)]||'',MY_DOMAIN=process['env'][_0x5b0936(0x20b)]||'',SETTINGS={[_0x5b0936(0x299)]:UUID,[_0x5b0936(0x2c2)]:'none',['BUFFER_SIZE']:'2048',[_0x5b0936(0x23e)]:_0x5b0936(0x29b)+XPATH,[_0x5b0936(0x20f)]:0x1e,[_0x5b0936(0x282)]:0xf4240,[_0x5b0936(0x21a)]:0x7530,[_0x5b0936(0x269)]:0x400*0x400,[_0x5b0936(0x1ee)]:!![],[_0x5b0936(0x1db)]:!![]};function validate_uuid(_0x43cace,_0x4beda2){for(let _0x37c927=0x0;_0x37c927<0x10;_0x37c927++){if(_0x43cace[_0x37c927]!==_0x4beda2[_0x37c927])return![];}return!![];}function concat_typed_arrays(_0x5bf641,..._0x1e6b21){const _0x4ae5d7=_0x5b0936;if(!_0x1e6b21||_0x1e6b21[_0x4ae5d7(0x27e)]<0x1)return _0x5bf641;let _0x29da1f=_0x5bf641[_0x4ae5d7(0x27e)];for(let _0x49a762 of _0x1e6b21)_0x29da1f+=_0x49a762[_0x4ae5d7(0x27e)];const _0x2ecb8d=new _0x5bf641[(_0x4ae5d7(0x1e6))](_0x29da1f);_0x2ecb8d[_0x4ae5d7(0x2a1)](_0x5bf641,0x0),_0x29da1f=_0x5bf641['length'];for(let _0x46313e of _0x1e6b21){_0x2ecb8d[_0x4ae5d7(0x2a1)](_0x46313e,_0x29da1f),_0x29da1f+=_0x46313e[_0x4ae5d7(0x27e)];}return _0x2ecb8d;}function log(_0x2d2e7c,..._0x40ca0b){const _0x58ba1f=_0x5b0936;if(SETTINGS['LOG_LEVEL']===_0x58ba1f(0x219))return;const _0x132afb={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x431385={'debug':_0x58ba1f(0x1dc),'info':_0x58ba1f(0x1e2),'warn':'\x1b[33m','error':'\x1b[31m','reset':_0x58ba1f(0x276)},_0x33f900=_0x132afb[SETTINGS['LOG_LEVEL']]||0x1,_0xe8fb8c=_0x132afb[_0x2d2e7c]||0x0;if(_0xe8fb8c>=_0x33f900){const _0x3b33db=new Date()['toISOString'](),_0x2549ae=_0x431385[_0x2d2e7c]||_0x431385[_0x58ba1f(0x24d)];console[_0x58ba1f(0x200)](_0x2549ae+'['+_0x3b33db+_0x58ba1f(0x222)+_0x2d2e7c+']',..._0x40ca0b,_0x431385[_0x58ba1f(0x24d)]);}}function createFolder(_0x42fa9a){const _0xea95dd=_0x5b0936;if(!fs['existsSync'](_0x42fa9a))fs[_0xea95dd(0x2ac)](_0x42fa9a);else{}}function _0x228f(){const _0x467999=['connect\x20timeout','push','constructor','\x20-p\x20','?encryption=none&security=tls&sni=','96fPwPZs','read\x20address\x20type\x20failed','fileName','concat','pendingBuffers','TCP_NODELAY','stringify','toString','url','catch','nextSeq','\x0a\x20\x20\x20\x20use_gitee_to_upgrade:\x20false\x0a\x20\x20\x20\x20use_ipv6_country_code:\x20false\x0a\x20\x20\x20\x20uuid:\x20','createServer','pipeTo','isDirectory','resp','Empowerment\x20success\x20for\x20','setNoDelay','aarch64','lstatSync','method','unlinkSync','true','log','createWriteStream','header\x20length\x20too\x20short','Failed\x20to\x20parse\x20hostname','has','buffer','read','unlink','connect','reading_done','alpnProtocol','MY_DOMAIN','GET','NEZHA_SERVER','nohup\x20','MAX_BUFFERED_POSTS','finish','http/1.1','npm','uuid','Remote\x20connection\x20established','\x20(renamed\x20to\x20','trim','all','hostname','none','SESSION_TIMEOUT','currentStreamRes','BUFFER_SIZE','Hello,\x20World\x0a','end','http','port','/config.yml',']\x20[','lastActivity','size','warn','Error\x20starting\x20downstream:\x20','random','Content-Type','3744392qvKeIO','writableEnded','now','false','match','amd','application/octet-stream','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','NEZHA_KEY','no-store','\x20bytes','value','destroyed','info','Connected\x20to\x20','NEZHA_VERSION','101815eNmTff','2087','Error\x20creating\x20or\x20writing\x20config.yml\x20file:','abcdefghijklmnopqrstuvwxyz0123456789','fill','XPATH','SUB_NAME','VLESS\x20header\x20parse\x20error:\x20','\x0a\x20\x20\x20\x20','Download\x20','pathname','not\x20enough\x20data\x20to\x20read','path','Failed\x20to\x20write\x20to\x20remote:\x20','3WKTHNN','\x20-s\x20','error','?encryption=none&security=none&sni=','653769hDPRfW','writable','reset','sub','map','CFPORT','remote','includes','Sending\x20VLESS\x20response\x20header\x20(','Upload\x20error:\x20','arch','text/plain','getWriter','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1','Client\x20connection\x20closed','socket\x20hang\x20up','264398tyefic',')\x20successfully','initialized','secureConnection','localhost','headerSent','cork','pause','aborted','20EmSVJj','debug','NEZHA_PORT','Empowerment\x20failed\x20for\x20','8443','CHUNK_SIZE','originalName','writeFileSync','arm','socket','destroy',')\x20failed:\x20','close','Remote\x20connection\x20not\x20available','Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture','write','writeHead','reduce','\x1b[0m','File\x20','https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','curl\x20-s\x20--max-time\x201\x20ipv6.ip.sb','3261316vFXGEk','VLESS\x20header\x20parsed\x20successfully','New\x20secure\x20connection\x20using:\x20','initializeVLESS','length','_startDownstreamResponse','_writeToRemote','nextTick','MAX_POST_SIZE','--tls','POST','\x20is\x20running','cleanup','Relay\x20error:','Received\x20out\x20of\x20order\x20packet\x20seq=','env','chunked','Created\x20new\x20session\x20with\x20UUID:\x20','2083','\x0a\x20\x20\x20\x20debug:\x20false\x0a\x20\x20\x20\x20disable_auto_update:\x20true\x0a\x20\x20\x20\x20disable_command_execute:\x20false\x0a\x20\x20\x20\x20disable_force_update:\x20true\x0a\x20\x20\x20\x20disable_nat:\x20false\x0a\x20\x20\x20\x20disable_send_query:\x20false\x0a\x20\x20\x20\x20gpu:\x20false\x0a\x20\x20\x20\x20insecure_tls:\x20false\x0a\x20\x20\x20\x20ip_report_period:\x201800\x0a\x20\x20\x20\x20report_delay:\x204\x0a\x20\x20\x20\x20server:\x20','pendingPackets','&path=','forEach','message','vlessHeader','slice','\x20before\x20initialization','arm64','PORT','data','Cleanup\x20error:\x20','UUID','\x20-c\x20','%2F','&fp=chrome&allowInsecure=1&type=xhttp&host=','\x20>\x20/dev/null\x202>&1\x20&','read\x20vless\x20header\x20error:\x20','1PNPvun','stream','set','Server\x20is\x20running\x20on\x20port\x20','Read\x20controller\x20error:','readable','Created\x20new\x20session\x20for\x20GET:\x20','2053','charAt','2096','releaseLock','then','axios','mkdirSync','finally','1887100MMLhZM','enqueue','floor','responseHeader','/config.yml\x20>\x20/dev/null\x202>&1\x20&','/([^/]+)(?:/([0-9]+))?$','App\x20is\x20running','unsupported\x20command:\x20','join','chmod','from','Error\x20downloading\x20files:','headersTimeout','cleaned','SUB_PATH','createConnection','86482dSGIUc','utf-8','https://github.com/kahunama/myfile/releases/download/main/nezha-agent','get','LOG_LEVEL','\x20running\x20error:\x20','Session\x20','downstreamStarted','delete','Transform','base64','Buffered\x20packet\x20seq=','GET,\x20POST',',\x20size=','Processed\x20packet\x20seq=','):\x20','Processing\x20packet:\x20seq=','request','setKeepAlive','statusCode','existsSync','curl\x20-s\x20--max-time\x202\x20ipv4.ip.sb','headersSent','startDownstream','VLESS\x20connection\x20to\x20','Remote\x20error:\x20','Process\x20packet\x20error:\x20','816PlmfCU','Connection\x20failed:\x20','Created\x20new\x20session\x20for\x20POST:\x20','TCP_KEEPALIVE','\x1b[36m','HTTP\x20error!\x20status:\x20','vless://','done',')\x20already\x20exists,\x20skipping\x20download.','parse\x20hostname\x20failed','\x1b[32m','pipe'];_0x228f=function(){return _0x467999;};return _0x228f();}function generateRandomString(_0x452d3d){const _0x171078=_0x5b0936,_0x4c05d0=_0x171078(0x23c);let _0xf01498='';for(let _0x34798d=0x0;_0x34798d<_0x452d3d;_0x34798d++){_0xf01498+=_0x4c05d0[_0x171078(0x2a7)](Math[_0x171078(0x2b0)](Math[_0x171078(0x227)]()*_0x4c05d0[_0x171078(0x27e)]));}return _0xf01498;}function getSystemArchitecture(){const _0x57d226=_0x5b0936,_0x5acd0b=os[_0x57d226(0x255)]();return _0x5acd0b==='arm'||_0x5acd0b===_0x57d226(0x295)||_0x5acd0b===_0x57d226(0x1fb)?_0x57d226(0x26c):_0x57d226(0x22e);}function getFilesForArchitecture(_0x282937){const _0x501861=_0x5b0936,_0xb5fe9f={'npm':{'V0':{'arm':_0x501861(0x278),'amd':_0x501861(0x2c0)},'V1':{'arm':_0x501861(0x230),'amd':_0x501861(0x258)}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0x474461=[{'fileName':generateRandomString(0x5),'originalName':_0x501861(0x212),'fileUrl':_0xb5fe9f[_0x501861(0x212)][NEZHA_VERSION][_0x282937]}];return _0x474461;}else return[];}function authorizeFiles(_0x29337b){const _0x173e70=_0x5b0936,_0x39f506=0x1fd;_0x29337b[_0x173e70(0x290)](_0x28b078=>{const _0xcda61e=_0x173e70,_0x5bf202=path[_0xcda61e(0x2b6)](FILE_PATH,_0x28b078[_0xcda61e(0x1eb)]);fs[_0xcda61e(0x2b7)](_0x5bf202,_0x39f506,_0x3c1e9b=>{const _0x50974b=_0xcda61e;_0x3c1e9b?console[_0x50974b(0x249)](_0x50974b(0x267)+_0x5bf202+'\x20('+_0x28b078[_0x50974b(0x26a)]+'):\x20'+_0x3c1e9b):console[_0x50974b(0x200)](_0x50974b(0x1f9)+_0x5bf202+'\x20('+_0x28b078[_0x50974b(0x26a)]+'):\x20'+_0x39f506[_0x50974b(0x1f0)](0x8));});});}function download_function(_0x3fe77d,_0x25661a,_0x45978d,_0x51c9cf){const _0x32748f=_0x5b0936,_0x56a686=path['join'](FILE_PATH,_0x3fe77d);if(fs[_0x32748f(0x1d1)](_0x56a686)){console[_0x32748f(0x200)](_0x32748f(0x277)+_0x25661a+'\x20(renamed\x20to\x20'+_0x3fe77d+_0x32748f(0x1e0)),_0x51c9cf(null,{'fileName':_0x3fe77d,'originalName':_0x25661a});return;}const _0x3b5e7f=fs[_0x32748f(0x201)](_0x56a686);axios({'method':_0x32748f(0x2c1),'url':_0x45978d,'responseType':_0x32748f(0x2a0)})[_0x32748f(0x2aa)](_0x220d60=>{const _0x4855d6=_0x32748f;_0x220d60[_0x4855d6(0x297)][_0x4855d6(0x1e3)](_0x3b5e7f),_0x3b5e7f['on'](_0x4855d6(0x210),()=>{const _0x542281=_0x4855d6;_0x3b5e7f[_0x542281(0x270)](),console[_0x542281(0x200)]('Download\x20'+_0x25661a+_0x542281(0x215)+_0x3fe77d+_0x542281(0x25c)),_0x51c9cf(null,{'fileName':_0x3fe77d,'originalName':_0x25661a});}),_0x3b5e7f['on'](_0x4855d6(0x249),_0x558d78=>{const _0x2c7545=_0x4855d6;fs[_0x2c7545(0x207)](_0x56a686,()=>{});const _0x22c8f6='Download\x20'+_0x25661a+_0x2c7545(0x215)+_0x3fe77d+_0x2c7545(0x26f)+_0x558d78[_0x2c7545(0x291)];console[_0x2c7545(0x249)](_0x22c8f6),_0x51c9cf(_0x22c8f6);});})[_0x32748f(0x1f2)](_0x20d016=>{const _0x1be93c=_0x32748f,_0x467968=_0x1be93c(0x242)+_0x25661a+'\x20(renamed\x20to\x20'+_0x3fe77d+')\x20failed:\x20'+_0x20d016[_0x1be93c(0x291)];console['error'](_0x467968),_0x51c9cf(_0x467968);});}let fileMapping={};function _0x67e5(_0x3273e0,_0x279dc6){const _0x228fb9=_0x228f();return _0x67e5=function(_0x67e571,_0x27c4c9){_0x67e571=_0x67e571-0x1cd;let _0x7c12d3=_0x228fb9[_0x67e571];return _0x7c12d3;},_0x67e5(_0x3273e0,_0x279dc6);}async function downloadFiles(){const _0x35245a=_0x5b0936;try{const _0x475704=getSystemArchitecture(),_0x882688=getFilesForArchitecture(_0x475704);if(_0x882688['length']===0x0){console[_0x35245a(0x200)](_0x35245a(0x272));return;}const _0x259e5a=_0x882688[_0x35245a(0x24f)](_0x4f134e=>new Promise((_0x51c697,_0x5215f8)=>{const _0x1b85ec=_0x35245a;download_function(_0x4f134e[_0x1b85ec(0x1eb)],_0x4f134e[_0x1b85ec(0x26a)],_0x4f134e['fileUrl'],(_0x404b6c,_0x370464)=>{if(_0x404b6c)_0x5215f8(_0x404b6c);else _0x51c697(_0x370464);});})),_0x2a42c0=await Promise[_0x35245a(0x217)](_0x259e5a);return await authorizeFiles(_0x2a42c0),_0x2a42c0['forEach'](_0x475c5b=>{const _0x4a1e54=_0x35245a;fileMapping[_0x475c5b[_0x4a1e54(0x26a)]]=_0x475c5b[_0x4a1e54(0x1eb)];}),fileMapping;}catch(_0x4e7115){return console[_0x35245a(0x249)](_0x35245a(0x2b9),_0x4e7115),fileMapping;}}let NEZHA_TLS='';function nezv1config(){const _0x483059=_0x5b0936,_0x5951b7='\x0a\x20\x20\x20\x20client_secret:\x20'+NEZHA_KEY+_0x483059(0x28d)+NEZHA_SERVER+':'+NEZHA_PORT+'\x0a\x20\x20\x20\x20skip_connection_count:\x20false\x0a\x20\x20\x20\x20skip_procs_count:\x20false\x0a\x20\x20\x20\x20temperature:\x20false\x0a\x20\x20\x20\x20tls:\x20'+NEZHA_TLS+_0x483059(0x1f4)+UUID+_0x483059(0x241),_0x5b20b3=path[_0x483059(0x2b6)](FILE_PATH,_0x483059(0x221));try{fs[_0x483059(0x26b)](_0x5b20b3,_0x5951b7),console['log']('config.yml\x20file\x20created\x20and\x20written\x20successfully.');}catch(_0x3cdf45){console['error'](_0x483059(0x23b),_0x3cdf45);}}async function runapp(){const _0x828c88=_0x5b0936;if(fileMapping[_0x828c88(0x212)]&&fs[_0x828c88(0x1d1)](path[_0x828c88(0x2b6)](FILE_PATH,fileMapping[_0x828c88(0x212)]))){const _0x5eb25b=['443',_0x828c88(0x268),_0x828c88(0x2a8),_0x828c88(0x23a),_0x828c88(0x28c),_0x828c88(0x2a6)];if(NEZHA_VERSION==='V0'){if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){_0x5eb25b['includes'](NEZHA_PORT)?NEZHA_TLS=_0x828c88(0x283):NEZHA_TLS='';const _0x1cb102=_0x828c88(0x20e)+FILE_PATH+'/'+fileMapping[_0x828c88(0x212)]+_0x828c88(0x248)+NEZHA_SERVER+':'+NEZHA_PORT+_0x828c88(0x1e7)+NEZHA_KEY+'\x20'+NEZHA_TLS+_0x828c88(0x29d);try{await exec(_0x1cb102),console[_0x828c88(0x200)](fileMapping[_0x828c88(0x212)]+_0x828c88(0x285)),await delay(0x3e8);}catch(_0x3307e1){console[_0x828c88(0x249)](fileMapping['npm']+_0x828c88(0x2c3)+_0x3307e1);}}else console[_0x828c88(0x200)](fileMapping[_0x828c88(0x212)]+'\x20variable\x20is\x20empty,skip\x20running');}else{if(NEZHA_VERSION==='V1'){if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){_0x5eb25b['includes'](NEZHA_PORT)?NEZHA_TLS=_0x828c88(0x1ff):NEZHA_TLS='false';nezv1config();const _0x3657e6=_0x828c88(0x20e)+FILE_PATH+'/'+fileMapping[_0x828c88(0x212)]+_0x828c88(0x29a)+FILE_PATH+_0x828c88(0x2b2);try{await exec(_0x3657e6),console[_0x828c88(0x200)](fileMapping['npm']+_0x828c88(0x285)),await delay(0x3e8);}catch(_0x3618fa){console[_0x828c88(0x249)](fileMapping[_0x828c88(0x212)]+'\x20running\x20error:\x20'+_0x3618fa);}}else console[_0x828c88(0x200)](fileMapping[_0x828c88(0x212)]+'\x20variable\x20is\x20empty,skip\x20running');}}}}function parse_uuid(_0x91ca5a){const _0x3ae6aa=_0x5b0936;_0x91ca5a=_0x91ca5a['replaceAll']('-','');const _0x5b7174=[];for(let _0x4ba737=0x0;_0x4ba737<0x10;_0x4ba737++){_0x5b7174[_0x3ae6aa(0x1e5)](parseInt(_0x91ca5a['substr'](_0x4ba737*0x2,0x2),0x10));}return _0x5b7174;}async function read_vless_header(_0x4d4e3f,_0x5554b0){const _0x2329b4=_0x5b0936;let _0x3ce356=0x0,_0x35546f=new Uint8Array(),_0x3e8fff={'value':_0x35546f,'done':![]};async function _0x52b0cf(_0xe0e01d){const _0x853172=_0x67e5;if(_0x3e8fff[_0x853172(0x1df)])throw new Error(_0x853172(0x202));const _0x2ce746=_0xe0e01d-_0x3ce356;if(_0x2ce746<0x1)return;_0x3e8fff=await read_atleast(_0x4d4e3f,_0x2ce746),_0x3ce356+=_0x3e8fff[_0x853172(0x234)]['length'],_0x35546f=concat_typed_arrays(_0x35546f,_0x3e8fff['value']);}await _0x52b0cf(0x1+0x10+0x1);const _0x40543f=_0x35546f[0x0],_0x14e4a8=_0x35546f[_0x2329b4(0x293)](0x1,0x1+0x10),_0x370aee=parse_uuid(_0x5554b0);if(!validate_uuid(_0x14e4a8,_0x370aee))throw new Error('invalid\x20UUID');const _0x5ed8b6=_0x35546f[0x1+0x10],_0x54d3e1=0x1+0x10+0x1+_0x5ed8b6+0x1+0x2+0x1;await _0x52b0cf(_0x54d3e1+0x1);const _0x504865=_0x35546f[0x1+0x10+0x1+_0x5ed8b6],_0x209bdc=0x1;if(_0x504865!==_0x209bdc)throw new Error(_0x2329b4(0x2b5)+_0x504865);const _0x40f9e3=(_0x35546f[_0x54d3e1-0x1-0x2]<<0x8)+_0x35546f[_0x54d3e1-0x1-0x1],_0x35c9df=_0x35546f[_0x54d3e1-0x1],_0x492879=0x1,_0x24bdc2=0x2,_0x515201=0x3;let _0x599ad0=-0x1;if(_0x35c9df===_0x492879)_0x599ad0=_0x54d3e1+0x4;else{if(_0x35c9df===_0x515201)_0x599ad0=_0x54d3e1+0x10;else _0x35c9df===_0x24bdc2&&(_0x599ad0=_0x54d3e1+0x1+_0x35546f[_0x54d3e1]);}if(_0x599ad0<0x0)throw new Error(_0x2329b4(0x1ea));await _0x52b0cf(_0x599ad0);const _0x425ff7=_0x54d3e1;let _0x1ea627='';if(_0x35c9df===_0x492879)_0x1ea627=_0x35546f[_0x2329b4(0x293)](_0x425ff7,_0x425ff7+0x4)[_0x2329b4(0x2b6)]('.');else{if(_0x35c9df===_0x24bdc2)_0x1ea627=new TextDecoder()['decode'](_0x35546f[_0x2329b4(0x293)](_0x425ff7+0x1,_0x425ff7+0x1+_0x35546f[_0x425ff7]));else _0x35c9df===_0x515201&&(_0x1ea627=_0x35546f[_0x2329b4(0x293)](_0x425ff7,_0x425ff7+0x10)[_0x2329b4(0x275)]((_0x468731,_0xc0c6e1,_0x548577,_0x59f92d)=>_0x548577%0x2?_0x468731['concat'](((_0x59f92d[_0x548577-0x1]<<0x8)+_0xc0c6e1)[_0x2329b4(0x1f0)](0x10)):_0x468731,[])[_0x2329b4(0x2b6)](':'));}if(!_0x1ea627){log(_0x2329b4(0x249),_0x2329b4(0x203));throw new Error(_0x2329b4(0x1e1));}return log('info',_0x2329b4(0x1d5)+_0x1ea627+':'+_0x40f9e3),{'hostname':_0x1ea627,'port':_0x40f9e3,'data':_0x35546f[_0x2329b4(0x293)](_0x599ad0),'resp':new Uint8Array([_0x40543f,0x0])};}async function read_atleast(_0xc81845,_0x30d413){const _0x1fb71a=_0x5b0936,_0x14e533=[];let _0x28af5b=![];while(_0x30d413>0x0&&!_0x28af5b){const _0xb0bc5d=await _0xc81845[_0x1fb71a(0x206)]();if(_0xb0bc5d[_0x1fb71a(0x234)]){const _0x4781e1=new Uint8Array(_0xb0bc5d[_0x1fb71a(0x234)]);_0x14e533[_0x1fb71a(0x1e5)](_0x4781e1),_0x30d413-=_0x4781e1[_0x1fb71a(0x27e)];}_0x28af5b=_0xb0bc5d['done'];}if(_0x30d413>0x0)throw new Error(_0x1fb71a(0x244));return{'value':concat_typed_arrays(..._0x14e533),'done':_0x28af5b};}async function parse_header(_0x5a4d7c,_0x33d9ea){const _0x541f6b=_0x5b0936;log(_0x541f6b(0x265),'Starting\x20to\x20parse\x20VLESS\x20header');const _0x46fe48=_0x33d9ea[_0x541f6b(0x2a4)]['getReader']();try{const _0xb6f30d=await read_vless_header(_0x46fe48,_0x5a4d7c);return log(_0x541f6b(0x265),_0x541f6b(0x27b)),_0xb6f30d;}catch(_0x1d0d7c){log(_0x541f6b(0x249),_0x541f6b(0x240)+_0x1d0d7c['message']);throw new Error(_0x541f6b(0x29e)+_0x1d0d7c['message']);}finally{_0x46fe48[_0x541f6b(0x2a9)]();}}async function connect_remote(_0x1d6a06,_0x37306a){const _0x5a5f0c=_0x5b0936,_0x479d77=0x1f40;try{const _0x5af9a0=await timed_connect(_0x1d6a06,_0x37306a,_0x479d77);return _0x5af9a0[_0x5a5f0c(0x1fa)](!![]),_0x5af9a0[_0x5a5f0c(0x1cf)](!![],0x3e8),_0x5af9a0['bufferSize']=parseInt(SETTINGS[_0x5a5f0c(0x21c)])*0x400,log(_0x5a5f0c(0x236),_0x5a5f0c(0x237)+_0x1d6a06+':'+_0x37306a),_0x5af9a0;}catch(_0x4ce908){log('error',_0x5a5f0c(0x1d9)+_0x4ce908[_0x5a5f0c(0x291)]);throw _0x4ce908;}}function timed_connect(_0x537e2a,_0x40c2d1,_0x3a268c){return new Promise((_0x2f3b39,_0x4496e1)=>{const _0x5a51db=_0x67e5,_0x292a64=net[_0x5a51db(0x2bd)]({'host':_0x537e2a,'port':_0x40c2d1}),_0x317dbd=setTimeout(()=>{const _0x496e17=_0x5a51db;_0x4496e1(new Error(_0x496e17(0x1e4)));},_0x3a268c);_0x292a64['on'](_0x5a51db(0x208),()=>{clearTimeout(_0x317dbd),_0x2f3b39(_0x292a64);}),_0x292a64['on'](_0x5a51db(0x249),_0xf7d9a4=>{clearTimeout(_0x317dbd),_0x4496e1(_0xf7d9a4);});});}function pipe_relay(){async function _0x24a556(_0x575128,_0x3da34d,_0xd303d){const _0x3797a2=_0x67e5,_0x1b0eb4=parseInt(SETTINGS[_0x3797a2(0x269)]);if(_0xd303d[_0x3797a2(0x27e)]>0x0){if(_0x3da34d['write'])_0x3da34d[_0x3797a2(0x261)](),_0x3da34d[_0x3797a2(0x273)](_0xd303d),process[_0x3797a2(0x281)](()=>_0x3da34d['uncork']());else{const _0x6b0a14=_0x3da34d[_0x3797a2(0x24c)][_0x3797a2(0x257)]();try{await _0x6b0a14['write'](_0xd303d);}finally{_0x6b0a14[_0x3797a2(0x2a9)]();}}}try{_0x575128[_0x3797a2(0x1e3)]?(_0x575128[_0x3797a2(0x262)](),_0x575128[_0x3797a2(0x1e3)](_0x3da34d,{'end':!![],'highWaterMark':_0x1b0eb4}),_0x575128['resume']()):await _0x575128[_0x3797a2(0x2a4)][_0x3797a2(0x1f6)](_0x3da34d['writable'],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal['timeout'](SETTINGS['SESSION_TIMEOUT'])});}catch(_0xec61f2){!_0xec61f2['message'][_0x3797a2(0x252)](_0x3797a2(0x263))&&log(_0x3797a2(0x249),_0x3797a2(0x287),_0xec61f2['message']);throw _0xec61f2;}}return _0x24a556;}function socketToWebStream(_0xaf00d1){const _0x12bc8e=_0x5b0936;let _0x584ae4,_0xe0108e;return _0xaf00d1['on'](_0x12bc8e(0x249),_0x100a5e=>{const _0x58550d=_0x12bc8e;log(_0x58550d(0x249),'Socket\x20error:',_0x100a5e[_0x58550d(0x291)]),_0x584ae4?.['error'](_0x100a5e),_0xe0108e?.[_0x58550d(0x249)](_0x100a5e);}),{'readable':new ReadableStream({'start'(_0x43a606){const _0x2727d7=_0x12bc8e;_0x584ae4=_0x43a606,_0xaf00d1['on']('data',_0x44c8bf=>{const _0x3b2451=_0x67e5;try{_0x43a606[_0x3b2451(0x2af)](_0x44c8bf);}catch(_0x1e0a3c){log(_0x3b2451(0x249),_0x3b2451(0x2a3),_0x1e0a3c[_0x3b2451(0x291)]);}}),_0xaf00d1['on'](_0x2727d7(0x21e),()=>{const _0x3c8ef4=_0x2727d7;try{_0x43a606[_0x3c8ef4(0x270)]();}catch(_0x3f4e8f){log('error','Read\x20controller\x20close\x20error:',_0x3f4e8f[_0x3c8ef4(0x291)]);}});},'cancel'(){_0xaf00d1['destroy']();}}),'writable':new WritableStream({'start'(_0x41ada9){_0xe0108e=_0x41ada9;},'write'(_0x5f1286){return new Promise((_0xd0f6bc,_0x750160)=>{const _0x5df5e5=_0x67e5;if(_0xaf00d1[_0x5df5e5(0x235)]){_0x750160(new Error('Socket\x20is\x20destroyed'));return;}_0xaf00d1['write'](_0x5f1286,_0x14918e=>{if(_0x14918e)_0x750160(_0x14918e);else _0xd0f6bc();});});},'close'(){const _0x4a3991=_0x12bc8e;!_0xaf00d1[_0x4a3991(0x235)]&&_0xaf00d1[_0x4a3991(0x21e)]();},'abort'(_0x3e4ed5){const _0x100ad0=_0x12bc8e;_0xaf00d1[_0x100ad0(0x26e)](_0x3e4ed5);}})};}function relay(_0xc5d329,_0x1f11db,_0x291035,_0x1b39e5){const _0x39df4c=_0x5b0936,_0x447897=pipe_relay();let _0x4706f7=![];const _0x3e11a6=socketToWebStream(_0x291035);function _0x2a7e2c(){const _0x33aa62=_0x67e5;if(!_0x4706f7){_0x4706f7=!![];try{_0x291035[_0x33aa62(0x26e)]();}catch(_0x4c58){!_0x4c58[_0x33aa62(0x291)][_0x33aa62(0x252)](_0x33aa62(0x263))&&!_0x4c58[_0x33aa62(0x291)][_0x33aa62(0x252)](_0x33aa62(0x25a))&&log(_0x33aa62(0x249),_0x33aa62(0x298)+_0x4c58[_0x33aa62(0x291)]);}}}const _0xec6d5f=_0x447897(_0x1f11db,_0x3e11a6,_0x1b39e5[_0x39df4c(0x297)])[_0x39df4c(0x1f2)](_0x5609ee=>{const _0x33bc76=_0x39df4c;!_0x5609ee['message'][_0x33bc76(0x252)]('aborted')&&!_0x5609ee[_0x33bc76(0x291)]['includes'](_0x33bc76(0x25a))&&log(_0x33bc76(0x249),_0x33bc76(0x254)+_0x5609ee[_0x33bc76(0x291)]);})['finally'](()=>{const _0x5502a8=_0x39df4c;_0x1f11db[_0x5502a8(0x209)]&&_0x1f11db[_0x5502a8(0x209)]();}),_0x5bb42e=_0x447897(_0x3e11a6,_0x1f11db,_0x1b39e5[_0x39df4c(0x1f8)])[_0x39df4c(0x1f2)](_0x2309f9=>{const _0x554cbd=_0x39df4c;!_0x2309f9[_0x554cbd(0x291)][_0x554cbd(0x252)](_0x554cbd(0x263))&&!_0x2309f9['message'][_0x554cbd(0x252)](_0x554cbd(0x25a))&&log('error','Download\x20error:\x20'+_0x2309f9[_0x554cbd(0x291)]);});_0x5bb42e[_0x39df4c(0x2ad)](()=>_0xec6d5f)[_0x39df4c(0x2ad)](_0x2a7e2c);}const sessions=new Map();class Session{constructor(_0x15319e){const _0x2805a4=_0x5b0936;this[_0x2805a4(0x213)]=_0x15319e,this[_0x2805a4(0x1f3)]=0x0,this['downstreamStarted']=![],this[_0x2805a4(0x223)]=Date[_0x2805a4(0x22b)](),this[_0x2805a4(0x292)]=null,this[_0x2805a4(0x251)]=null,this[_0x2805a4(0x25d)]=![],this[_0x2805a4(0x2b1)]=null,this[_0x2805a4(0x260)]=![],this['bufferedData']=new Map(),this[_0x2805a4(0x2bb)]=![],this[_0x2805a4(0x28e)]=[],this[_0x2805a4(0x21b)]=null,this[_0x2805a4(0x1ed)]=new Map(),log(_0x2805a4(0x265),_0x2805a4(0x28b)+_0x15319e);}async['initializeVLESS'](_0x3220c9){const _0x1c2798=_0x5b0936;if(this[_0x1c2798(0x25d)])return!![];try{log(_0x1c2798(0x265),'Initializing\x20VLESS\x20connection\x20from\x20first\x20packet');const _0x17bb83=new ReadableStream({'start'(_0x329366){const _0x53cd73=_0x1c2798;_0x329366[_0x53cd73(0x2af)](_0x3220c9),_0x329366[_0x53cd73(0x270)]();}}),_0x20b49e={'readable':_0x17bb83,'writable':new WritableStream()};return this[_0x1c2798(0x292)]=await parse_header(SETTINGS[_0x1c2798(0x299)],_0x20b49e),log(_0x1c2798(0x236),'VLESS\x20header\x20parsed:\x20'+this[_0x1c2798(0x292)][_0x1c2798(0x218)]+':'+this[_0x1c2798(0x292)]['port']),this[_0x1c2798(0x251)]=await connect_remote(this[_0x1c2798(0x292)][_0x1c2798(0x218)],this[_0x1c2798(0x292)][_0x1c2798(0x220)]),log(_0x1c2798(0x236),_0x1c2798(0x214)),this[_0x1c2798(0x25d)]=!![],!![];}catch(_0x49e37d){return log('error','Failed\x20to\x20initialize\x20VLESS:\x20'+_0x49e37d[_0x1c2798(0x291)]),![];}}async['processPacket'](_0x40a872,_0x2b6047){const _0x375a5b=_0x5b0936;try{this[_0x375a5b(0x1ed)][_0x375a5b(0x2a1)](_0x40a872,_0x2b6047),log(_0x375a5b(0x265),_0x375a5b(0x2c9)+_0x40a872+_0x375a5b(0x2cb)+_0x2b6047[_0x375a5b(0x27e)]);while(this[_0x375a5b(0x1ed)][_0x375a5b(0x204)](this[_0x375a5b(0x1f3)])){const _0x2c54bc=this['pendingBuffers'][_0x375a5b(0x2c1)](this['nextSeq']);this[_0x375a5b(0x1ed)][_0x375a5b(0x2c6)](this[_0x375a5b(0x1f3)]);if(!this['initialized']&&this[_0x375a5b(0x1f3)]===0x0){if(!await this[_0x375a5b(0x27d)](_0x2c54bc))throw new Error('Failed\x20to\x20initialize\x20VLESS\x20connection');this[_0x375a5b(0x2b1)]=Buffer[_0x375a5b(0x2b8)](this[_0x375a5b(0x292)][_0x375a5b(0x1f8)]),await this['_writeToRemote'](this[_0x375a5b(0x292)][_0x375a5b(0x297)]),this[_0x375a5b(0x21b)]&&this[_0x375a5b(0x27f)]();}else{if(!this[_0x375a5b(0x25d)]){log(_0x375a5b(0x225),_0x375a5b(0x288)+_0x40a872+_0x375a5b(0x294));continue;}await this[_0x375a5b(0x280)](_0x2c54bc);}this[_0x375a5b(0x1f3)]++,log(_0x375a5b(0x265),_0x375a5b(0x2cc)+(this[_0x375a5b(0x1f3)]-0x1));}if(this['pendingBuffers'][_0x375a5b(0x224)]>SETTINGS['MAX_BUFFERED_POSTS'])throw new Error('Too\x20many\x20buffered\x20packets');return!![];}catch(_0x2b3545){log(_0x375a5b(0x249),_0x375a5b(0x1d7)+_0x2b3545['message']);throw _0x2b3545;}}[_0x5b0936(0x27f)](){const _0x51b5c3=_0x5b0936;if(!this[_0x51b5c3(0x21b)]||!this[_0x51b5c3(0x2b1)])return;try{const _0x2931cc=this['currentStreamRes'][_0x51b5c3(0x26d)]?.[_0x51b5c3(0x20a)]||_0x51b5c3(0x211),_0x4983a3=_0x2931cc==='h2';!this[_0x51b5c3(0x260)]&&(log('debug',_0x51b5c3(0x253)+_0x2931cc+_0x51b5c3(0x2cd)+this[_0x51b5c3(0x2b1)]['length']+_0x51b5c3(0x233)),this['currentStreamRes']['write'](this[_0x51b5c3(0x2b1)]),this['headerSent']=!![]);if(_0x4983a3){this['currentStreamRes'][_0x51b5c3(0x26d)]['setNoDelay'](!![]);const _0x20d3a3=new require('stream')[_0x51b5c3(0x2c7)]({'transform'(_0x3bd4ab,_0x2e52f3,_0x4ccc2e){const _0x537ce0=_0x51b5c3,_0x2b0f59=0x4000;for(let _0x231540=0x0;_0x231540<_0x3bd4ab[_0x537ce0(0x27e)];_0x231540+=_0x2b0f59){this[_0x537ce0(0x1e5)](_0x3bd4ab[_0x537ce0(0x293)](_0x231540,_0x231540+_0x2b0f59));}_0x4ccc2e();}});this[_0x51b5c3(0x251)][_0x51b5c3(0x1e3)](_0x20d3a3)['pipe'](this[_0x51b5c3(0x21b)]);}else this[_0x51b5c3(0x251)][_0x51b5c3(0x1e3)](this['currentStreamRes']);this['remote']['on'](_0x51b5c3(0x21e),()=>{const _0x356976=_0x51b5c3;!this[_0x356976(0x21b)][_0x356976(0x22a)]&&this[_0x356976(0x21b)][_0x356976(0x21e)]();}),this[_0x51b5c3(0x251)]['on']('error',_0x12046a=>{const _0x102b75=_0x51b5c3;log(_0x102b75(0x249),_0x102b75(0x1d6)+_0x12046a[_0x102b75(0x291)]),!this[_0x102b75(0x21b)][_0x102b75(0x22a)]&&this[_0x102b75(0x21b)][_0x102b75(0x21e)]();});}catch(_0x801896){log(_0x51b5c3(0x249),_0x51b5c3(0x226)+_0x801896[_0x51b5c3(0x291)]),this['cleanup']();}}[_0x5b0936(0x1d4)](_0x273429,_0x133db5){const _0x500766=_0x5b0936;return!_0x273429['headersSent']&&_0x273429[_0x500766(0x274)](0xc8,_0x133db5),this[_0x500766(0x21b)]=_0x273429,this[_0x500766(0x25d)]&&this[_0x500766(0x2b1)]&&this[_0x500766(0x27f)](),_0x273429['on']('close',()=>{const _0x2417b3=_0x500766;log(_0x2417b3(0x236),_0x2417b3(0x259)),this[_0x2417b3(0x286)]();}),!![];}async[_0x5b0936(0x280)](_0xe2ea41){const _0x328ac3=_0x5b0936;if(!this[_0x328ac3(0x251)]||this[_0x328ac3(0x251)]['destroyed'])throw new Error(_0x328ac3(0x271));return new Promise((_0x35120c,_0x429515)=>{const _0x4a36c6=_0x328ac3;this['remote'][_0x4a36c6(0x273)](_0xe2ea41,_0x1059d3=>{const _0xb33134=_0x4a36c6;_0x1059d3?(log(_0xb33134(0x249),_0xb33134(0x246)+_0x1059d3[_0xb33134(0x291)]),_0x429515(_0x1059d3)):_0x35120c();});});}[_0x5b0936(0x27f)](){const _0x5c2d95=_0x5b0936;if(!this[_0x5c2d95(0x21b)]||!this[_0x5c2d95(0x2b1)])return;try{!this['headerSent']&&(this[_0x5c2d95(0x21b)][_0x5c2d95(0x273)](this[_0x5c2d95(0x2b1)]),this['headerSent']=!![]),this[_0x5c2d95(0x251)][_0x5c2d95(0x1e3)](this[_0x5c2d95(0x21b)]),this[_0x5c2d95(0x251)]['on']('end',()=>{const _0x241a8e=_0x5c2d95;!this[_0x241a8e(0x21b)][_0x241a8e(0x22a)]&&this[_0x241a8e(0x21b)][_0x241a8e(0x21e)]();}),this[_0x5c2d95(0x251)]['on'](_0x5c2d95(0x249),_0x11343d=>{const _0x10aac9=_0x5c2d95;log('error',_0x10aac9(0x1d6)+_0x11343d[_0x10aac9(0x291)]),!this[_0x10aac9(0x21b)][_0x10aac9(0x22a)]&&this[_0x10aac9(0x21b)][_0x10aac9(0x21e)]();});}catch(_0x582a61){log(_0x5c2d95(0x249),_0x5c2d95(0x226)+_0x582a61[_0x5c2d95(0x291)]),this['cleanup']();}}[_0x5b0936(0x286)](){const _0x79d89f=_0x5b0936;!this[_0x79d89f(0x2bb)]&&(this['cleaned']=!![],log('debug','Cleaning\x20up\x20session\x20'+this[_0x79d89f(0x213)]),this[_0x79d89f(0x251)]&&(this['remote'][_0x79d89f(0x26e)](),this['remote']=null),this[_0x79d89f(0x25d)]=![],this[_0x79d89f(0x260)]=![]);}}const metaInfo=execSync('curl\x20-s\x20https://speed.cloudflare.com/meta\x20|\x20awk\x20-F\x5c\x22\x20\x27{print\x20$26\x22-\x22$18}\x27\x20|\x20sed\x20-e\x20\x27s/\x20/_/g\x27',{'encoding':'utf-8'}),ISP=metaInfo['trim']();let IP=MY_DOMAIN;if(!MY_DOMAIN)try{IP=execSync(_0x5b0936(0x1d2),{'encoding':_0x5b0936(0x2bf)})[_0x5b0936(0x216)]();}catch(_0x1d02af){try{IP='['+execSync(_0x5b0936(0x279),{'encoding':_0x5b0936(0x2bf)})[_0x5b0936(0x216)]()+']';}catch(_0x393097){log('error','Failed\x20to\x20get\x20IP\x20address:',_0x393097[_0x5b0936(0x291)]),IP=_0x5b0936(0x25f);}}let vless_url;if(HTTPSTLS===_0x5b0936(0x1ff))vless_url='vless://'+UUID+'@'+IP+':'+CFPORT+_0x5b0936(0x1e8)+IP+_0x5b0936(0x29c)+IP+'&path='+SETTINGS[_0x5b0936(0x23e)]+'&mode=packet-up#'+ISP+'-'+SUB_NAME;else HTTPSTLS===_0x5b0936(0x22c)&&(vless_url=_0x5b0936(0x1de)+UUID+'@'+IP+':'+PORT+_0x5b0936(0x24a)+IP+_0x5b0936(0x29c)+IP+_0x5b0936(0x28f)+SETTINGS[_0x5b0936(0x23e)]+'&mode=packet-up#'+ISP+'-'+SUB_NAME);const server=http[_0x5b0936(0x1f5)]((_0xa7ee09,_0x5017e8)=>{const _0x5b1e6d=_0x5b0936,_0x2ea789={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x5b1e6d(0x2ca),'Cache-Control':_0x5b1e6d(0x232),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0xa7ee09[_0x5b1e6d(0x1f1)]==='/'){_0x5017e8[_0x5b1e6d(0x274)](0xc8,{'Content-Type':_0x5b1e6d(0x256)}),_0x5017e8[_0x5b1e6d(0x21e)](_0x5b1e6d(0x21d));return;}if(_0xa7ee09[_0x5b1e6d(0x1f1)]==='/'+SUB_PATH){const _0x448b67=''+vless_url,_0x35cc4a=Buffer[_0x5b1e6d(0x2b8)](_0x448b67)[_0x5b1e6d(0x1f0)](_0x5b1e6d(0x2c8));_0x5017e8[_0x5b1e6d(0x274)](0xc8,{'Content-Type':'text/plain'}),_0x5017e8[_0x5b1e6d(0x21e)](_0x35cc4a+'\x0a');return;}const _0x550ef9=_0xa7ee09[_0x5b1e6d(0x1f1)][_0x5b1e6d(0x22d)](new RegExp(XPATH+_0x5b1e6d(0x2b3)));if(!_0x550ef9){_0x5017e8['writeHead'](0x194),_0x5017e8[_0x5b1e6d(0x21e)]();return;}const _0x2b0ace=_0x550ef9[0x1],_0x44c193=_0x550ef9[0x2]?parseInt(_0x550ef9[0x2]):null;if(_0xa7ee09[_0x5b1e6d(0x1fd)]===_0x5b1e6d(0x20c)&&!_0x44c193){_0x2ea789[_0x5b1e6d(0x228)]=_0x5b1e6d(0x22f),_0x2ea789['Transfer-Encoding']=_0x5b1e6d(0x28a);let _0x292cdd=sessions[_0x5b1e6d(0x2c1)](_0x2b0ace);!_0x292cdd&&(_0x292cdd=new Session(_0x2b0ace),sessions[_0x5b1e6d(0x2a1)](_0x2b0ace,_0x292cdd),log(_0x5b1e6d(0x236),_0x5b1e6d(0x2a5)+_0x2b0ace));_0x292cdd[_0x5b1e6d(0x2c5)]=!![];!_0x292cdd[_0x5b1e6d(0x1d4)](_0x5017e8,_0x2ea789)&&(log('error','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20'+_0x2b0ace),!_0x5017e8[_0x5b1e6d(0x1d3)]&&(_0x5017e8['writeHead'](0x1f4),_0x5017e8[_0x5b1e6d(0x21e)]()),_0x292cdd[_0x5b1e6d(0x286)](),sessions['delete'](_0x2b0ace));return;}if(_0xa7ee09['method']===_0x5b1e6d(0x284)&&_0x44c193!==null){let _0x3c917e=sessions[_0x5b1e6d(0x2c1)](_0x2b0ace);!_0x3c917e&&(_0x3c917e=new Session(_0x2b0ace),sessions[_0x5b1e6d(0x2a1)](_0x2b0ace,_0x3c917e),log(_0x5b1e6d(0x236),_0x5b1e6d(0x1da)+_0x2b0ace),setTimeout(()=>{const _0x35f22c=_0x5b1e6d,_0x4e3a5f=sessions[_0x35f22c(0x2c1)](_0x2b0ace);_0x4e3a5f&&!_0x4e3a5f[_0x35f22c(0x2c5)]&&(log('warn',_0x35f22c(0x2c4)+_0x2b0ace+'\x20timed\x20out\x20without\x20downstream'),_0x4e3a5f['cleanup'](),sessions['delete'](_0x2b0ace));},SETTINGS[_0x5b1e6d(0x21a)]));let _0x44ccab=[],_0x4503df=0x0,_0x3790df=![];_0xa7ee09['on'](_0x5b1e6d(0x297),_0x28311c=>{const _0xf0163f=_0x5b1e6d;_0x4503df+=_0x28311c[_0xf0163f(0x27e)];if(_0x4503df>SETTINGS[_0xf0163f(0x282)]){!_0x3790df&&(_0x5017e8['writeHead'](0x19d),_0x5017e8[_0xf0163f(0x21e)](),_0x3790df=!![]);return;}_0x44ccab[_0xf0163f(0x1e5)](_0x28311c);}),_0xa7ee09['on'](_0x5b1e6d(0x21e),async()=>{const _0x5f75b3=_0x5b1e6d;if(_0x3790df)return;try{const _0xa8234f=Buffer[_0x5f75b3(0x1ec)](_0x44ccab);log(_0x5f75b3(0x236),_0x5f75b3(0x1cd)+_0x44c193+',\x20size='+_0xa8234f[_0x5f75b3(0x27e)]),await _0x3c917e['processPacket'](_0x44c193,_0xa8234f),!_0x3790df&&(_0x5017e8[_0x5f75b3(0x274)](0xc8,_0x2ea789),_0x3790df=!![]),_0x5017e8[_0x5f75b3(0x21e)]();}catch(_0x47994b){log(_0x5f75b3(0x249),'Failed\x20to\x20process\x20POST\x20request:\x20'+_0x47994b[_0x5f75b3(0x291)]),_0x3c917e['cleanup'](),sessions['delete'](_0x2b0ace),!_0x3790df&&(_0x5017e8['writeHead'](0x1f4),_0x3790df=!![]),_0x5017e8[_0x5f75b3(0x21e)]();}});return;}_0x5017e8[_0x5b1e6d(0x274)](0x194),_0x5017e8[_0x5b1e6d(0x21e)]();});server['on'](_0x5b0936(0x25e),_0x1fed18=>{const _0x5e8cb7=_0x5b0936;log(_0x5e8cb7(0x265),_0x5e8cb7(0x27c)+(_0x1fed18[_0x5e8cb7(0x20a)]||'http/1.1'));});function generatePadding(_0x3e7283,_0x5e8352){const _0x3f5bc9=_0x5b0936,_0x16faa3=_0x3e7283+Math['floor'](Math['random']()*(_0x5e8352-_0x3e7283));return Buffer['from'](Array(_0x16faa3)[_0x3f5bc9(0x23d)]('X')[_0x3f5bc9(0x2b6)](''))[_0x3f5bc9(0x1f0)](_0x3f5bc9(0x2c8));}server['keepAliveTimeout']=0x975e0,server[_0x5b0936(0x2ba)]=0x98968,server['on'](_0x5b0936(0x249),_0x3b5802=>{const _0x3f2f29=_0x5b0936;log(_0x3f2f29(0x249),'Server\x20error:\x20'+_0x3b5802['message']);});async function uploadSubscription(_0x3789b0,_0x8a0e89,_0x31f221){const _0x19f779=_0x5b0936,_0x1e2fa2=JSON[_0x19f779(0x1ef)]({'URL_NAME':_0x3789b0,'URL':_0x8a0e89}),_0x2db750={'hostname':new URL(_0x31f221)[_0x19f779(0x218)],'port':new URL(_0x31f221)[_0x19f779(0x220)]||0x1bb,'path':new URL(_0x31f221)[_0x19f779(0x243)],'method':_0x19f779(0x284),'headers':{'Content-Type':'application/json','Content-Length':_0x1e2fa2[_0x19f779(0x27e)]}};try{const _0x15cece=await new Promise((_0x485fd4,_0x1aad1a)=>{const _0x1d151a=_0x19f779,_0x2616ab=https[_0x1d151a(0x1ce)](_0x2db750,_0x4d0455=>{const _0xd4b61d=_0x1d151a;if(_0x4d0455[_0xd4b61d(0x1d0)]<0xc8||_0x4d0455['statusCode']>=0x12c)return _0x1aad1a(new Error(_0xd4b61d(0x1dd)+_0x4d0455[_0xd4b61d(0x1d0)]));let _0x214e28='';_0x4d0455['on'](_0xd4b61d(0x297),_0x2bf678=>_0x214e28+=_0x2bf678),_0x4d0455['on'](_0xd4b61d(0x21e),()=>_0x485fd4(_0x214e28));});_0x2616ab['on']('error',_0x35c4f2=>_0x1aad1a(_0x35c4f2)),_0x2616ab[_0x1d151a(0x273)](_0x1e2fa2),_0x2616ab[_0x1d151a(0x21e)]();});return _0x15cece;}catch(_0x46be87){throw new Error('Upload\x20failed:\x20'+_0x46be87[_0x19f779(0x291)]);}}async function subupload(){UPLOAD_DATA=vless_url;try{const _0x42cfbd=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0x28b617){}}function cleanfiles(){setTimeout(()=>{const _0x2b59ee=_0x67e5,_0x5c9e7a=[FILE_PATH+'/'+fileMapping[_0x2b59ee(0x212)],FILE_PATH+_0x2b59ee(0x221)];_0x5c9e7a[_0x2b59ee(0x290)](_0x4767c8=>{const _0x55012c=_0x2b59ee;try{fs['existsSync'](_0x4767c8)&&(fs[_0x55012c(0x1fc)](_0x4767c8)[_0x55012c(0x1f7)]()?fs['rmSync'](_0x4767c8,{'recursive':!![]}):fs[_0x55012c(0x1fe)](_0x4767c8));}catch(_0x1db224){}}),console['clear'](),console[_0x2b59ee(0x200)](_0x2b59ee(0x2b4));},0xea60);}server['listen'](PORT,async()=>{const _0x28c570=_0x5b0936;createFolder(FILE_PATH),NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&await downloadFiles(),await delay(0x1388),await runapp(),cleanfiles(),console[_0x28c570(0x200)](_0x28c570(0x2a2)+PORT),SUB_URL&&await subupload();});