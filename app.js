const _0x14de37=_0x6a6d;(function(_0x11236b,_0x3c3f9e){const _0x16c851=_0x6a6d,_0x274bba=_0x11236b();while(!![]){try{const _0x363878=-parseInt(_0x16c851(0x2b9))/0x1+parseInt(_0x16c851(0x272))/0x2+parseInt(_0x16c851(0x1d6))/0x3*(parseInt(_0x16c851(0x25d))/0x4)+parseInt(_0x16c851(0x1ba))/0x5+-parseInt(_0x16c851(0x2c2))/0x6*(parseInt(_0x16c851(0x276))/0x7)+parseInt(_0x16c851(0x2ab))/0x8+-parseInt(_0x16c851(0x2c9))/0x9*(parseInt(_0x16c851(0x1e0))/0xa);if(_0x363878===_0x3c3f9e)break;else _0x274bba['push'](_0x274bba['shift']());}catch(_0x222b03){_0x274bba['push'](_0x274bba['shift']());}}}(_0x587c,0xb236e));const FILE_PATH=process['env'][_0x14de37(0x2cb)]||_0x14de37(0x215),intervalInseconds=process['env'][_0x14de37(0x209)]||0x64,SUB_PATH=process[_0x14de37(0x1d9)][_0x14de37(0x289)]||_0x14de37(0x23c),PORT=process[_0x14de37(0x1d9)][_0x14de37(0x242)]||0xbb8,CFPORT=process[_0x14de37(0x1d9)][_0x14de37(0x2a9)]||0x1bb,CFIP=process[_0x14de37(0x1d9)][_0x14de37(0x21a)]||_0x14de37(0x1c6),KEEPALIVE=process[_0x14de37(0x1d9)][_0x14de37(0x265)]||![],SUB_URL=process[_0x14de37(0x1d9)][_0x14de37(0x20b)]||'',UUID=process['env'][_0x14de37(0x1e7)]||_0x14de37(0x1e9),XPATH=process[_0x14de37(0x1d9)][_0x14de37(0x263)]||UUID[_0x14de37(0x257)](0x0,0x8),HTTPSTLS=process[_0x14de37(0x1d9)][_0x14de37(0x1e5)]||!![],NEZHA_VERSION=process[_0x14de37(0x1d9)][_0x14de37(0x1e4)]||'V0',NEZHA_SERVER=process[_0x14de37(0x1d9)][_0x14de37(0x1f8)]||'',NEZHA_PORT=process[_0x14de37(0x1d9)][_0x14de37(0x1ee)]||_0x14de37(0x208),NEZHA_KEY=process[_0x14de37(0x1d9)]['NEZHA_KEY']||'',SUB_NAME=process['env'][_0x14de37(0x267)]||'',MY_DOMAIN=process[_0x14de37(0x1d9)]['MY_DOMAIN']||'',os=require('os'),fs=require('fs'),net=require('net'),path=require(_0x14de37(0x1d4)),http=require(_0x14de37(0x230)),https=require(_0x14de37(0x28c)),axios=require(_0x14de37(0x264)),{pipeline}=require(_0x14de37(0x1bb)),{Buffer}=require('buffer'),exec=require(_0x14de37(0x246))[_0x14de37(0x266)],delay=_0x5ca3dc=>new Promise(_0xb98457=>setTimeout(_0xb98457,_0x5ca3dc)),SETTINGS={['UUID']:UUID,[_0x14de37(0x23f)]:_0x14de37(0x22c),[_0x14de37(0x207)]:'2048',[_0x14de37(0x263)]:'%2F'+XPATH,[_0x14de37(0x1ea)]:0x1e,[_0x14de37(0x238)]:0xf4240,[_0x14de37(0x1ec)]:0x7530,[_0x14de37(0x259)]:0x400*0x400,[_0x14de37(0x274)]:!![],[_0x14de37(0x1d5)]:!![]};function validate_uuid(_0x475bac,_0x4f2383){for(let _0x22c3e7=0x0;_0x22c3e7<0x10;_0x22c3e7++){if(_0x475bac[_0x22c3e7]!==_0x4f2383[_0x22c3e7])return![];}return!![];}function concat_typed_arrays(_0x371fcb,..._0x6891f2){const _0x21185d=_0x14de37;if(!_0x6891f2||_0x6891f2[_0x21185d(0x28d)]<0x1)return _0x371fcb;let _0x1c443b=_0x371fcb[_0x21185d(0x28d)];for(let _0x1755a2 of _0x6891f2)_0x1c443b+=_0x1755a2[_0x21185d(0x28d)];const _0x34bb4b=new _0x371fcb['constructor'](_0x1c443b);_0x34bb4b['set'](_0x371fcb,0x0),_0x1c443b=_0x371fcb[_0x21185d(0x28d)];for(let _0x8c12ec of _0x6891f2){_0x34bb4b['set'](_0x8c12ec,_0x1c443b),_0x1c443b+=_0x8c12ec[_0x21185d(0x28d)];}return _0x34bb4b;}function log(_0x1f9c1c,..._0x333eb5){const _0x59d9ac=_0x14de37;if(SETTINGS[_0x59d9ac(0x23f)]===_0x59d9ac(0x22c))return;const _0xf8fe28={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x2b2ecc={'debug':_0x59d9ac(0x273),'info':_0x59d9ac(0x204),'warn':_0x59d9ac(0x1f0),'error':_0x59d9ac(0x2a3),'reset':_0x59d9ac(0x260)},_0x56f531=_0xf8fe28[SETTINGS['LOG_LEVEL']]||0x1,_0x440626=_0xf8fe28[_0x1f9c1c]||0x0;if(_0x440626>=_0x56f531){const _0x34c3d4=new Date()[_0x59d9ac(0x222)](),_0x90c7be=_0x2b2ecc[_0x1f9c1c]||_0x2b2ecc['reset'];console[_0x59d9ac(0x1d7)](_0x90c7be+'['+_0x34c3d4+']\x20['+_0x1f9c1c+']',..._0x333eb5,_0x2b2ecc['reset']);}}function cleanupOldFiles(){const _0x5344e6=_0x14de37;try{fs[_0x5344e6(0x241)](path[_0x5344e6(0x1f7)](FILE_PATH))?(fs[_0x5344e6(0x29a)](path[_0x5344e6(0x1f7)](FILE_PATH),{'recursive':!![]}),console[_0x5344e6(0x1d7)](FILE_PATH+'\x20deleted')):console[_0x5344e6(0x1d7)](FILE_PATH+_0x5344e6(0x203));}catch(_0x1e90e4){console[_0x5344e6(0x1d7)]('unable\x20to\x20rm\x20'+FILE_PATH);}}function createFolder(_0x3cafff){const _0x2168ef=_0x14de37;!fs['existsSync'](_0x3cafff)?(fs[_0x2168ef(0x202)](_0x3cafff),console['log'](_0x3cafff+_0x2168ef(0x2c5))):console[_0x2168ef(0x1d7)](_0x3cafff+_0x2168ef(0x2bf));}function execPromise(_0x4a3701,_0x2168c3={}){return new Promise((_0x33a0fb,_0x3dc303)=>{const _0x1e2ce9=exec(_0x4a3701,_0x2168c3,(_0x292d39,_0x472ad2,_0x5f3d6a)=>{const _0x44bcf5=_0x6a6d;if(_0x292d39){const _0x599411=new Error(_0x44bcf5(0x229)+_0x292d39['message']);_0x599411[_0x44bcf5(0x1f3)]=_0x292d39[_0x44bcf5(0x1f3)],_0x599411[_0x44bcf5(0x22e)]=_0x5f3d6a[_0x44bcf5(0x1ed)](),_0x3dc303(_0x599411);}else _0x33a0fb(_0x472ad2[_0x44bcf5(0x1ed)]());});});}async function detectProcess(_0x13605b){const _0x425018=_0x14de37,_0x469268=[{'cmd':_0x425018(0x2c3)+_0x13605b+'\x22','name':'pidof'},{'cmd':_0x425018(0x26b)+_0x13605b+'\x22','name':'pgrep'},{'cmd':_0x425018(0x261)+_0x13605b+'\x22\x20\x27$2\x20==\x20name\x20{print\x20$1}\x27','name':'ps+awk'}];for(const _0x30d359 of _0x469268){try{const _0x16c00e=await execPromise(_0x30d359[_0x425018(0x2a2)]);if(_0x16c00e)return _0x16c00e[_0x425018(0x205)](/\n/g,'\x20')[_0x425018(0x1ed)]();}catch(_0x3d2caa){_0x3d2caa['code']!==0x7f&&_0x3d2caa[_0x425018(0x1f3)]!==0x1&&console['debug']('[detectProcess]\x20'+_0x30d359[_0x425018(0x277)]+_0x425018(0x1ca),_0x3d2caa[_0x425018(0x269)]);}}return'';}async function killProcess(_0x25501c){const _0x20b4e2=_0x14de37;console[_0x20b4e2(0x1d7)](_0x20b4e2(0x231)+_0x25501c);try{const _0x3b62bf=await detectProcess(_0x25501c);if(!_0x3b62bf)return console['warn'](_0x20b4e2(0x232)+_0x25501c+_0x20b4e2(0x283)),{'success':!![],'message':'Process\x20not\x20found'};await execPromise(_0x20b4e2(0x293)+_0x3b62bf);const _0x371860=_0x20b4e2(0x28f)+_0x3b62bf+')';return console[_0x20b4e2(0x1d7)](_0x371860),{'success':!![],'message':_0x371860};}catch(_0x29ad93){const _0x2c54eb='Kill\x20failed:\x20'+_0x29ad93[_0x20b4e2(0x269)];return console[_0x20b4e2(0x247)](_0x2c54eb),{'success':![],'message':_0x2c54eb};}}function generateRandomString(_0x399c87){const _0x236173=_0x14de37,_0x56a0fb='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';let _0x246911='';for(let _0x5386f7=0x0;_0x5386f7<_0x399c87;_0x5386f7++){_0x246911+=_0x56a0fb['charAt'](Math[_0x236173(0x282)](Math['random']()*_0x56a0fb[_0x236173(0x28d)]));}return _0x246911;}function getSystemArchitecture(){const _0x190c86=_0x14de37,_0xeb3b57=os[_0x190c86(0x1dd)]();return _0xeb3b57==='arm'||_0xeb3b57==='arm64'||_0xeb3b57===_0x190c86(0x22d)?_0x190c86(0x217):'amd';}function getFilesForArchitecture(_0x52f779){const _0x7d1f25=_0x14de37,_0x5e928c={'app':{'V0':{'arm':'https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','amd':_0x7d1f25(0x233)},'V1':{'arm':_0x7d1f25(0x2a4),'amd':_0x7d1f25(0x220)}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0x32a626=[{'fileName':_0x7d1f25(0x22a)+generateRandomString(0x5),'originalName':_0x7d1f25(0x29b),'fileUrl':_0x5e928c['app'][NEZHA_VERSION][_0x52f779]}];return _0x32a626;}else return[];}async function download_function(_0x58e7d7,_0x1878a5,_0x2a99c8){const _0x51ba1e=_0x14de37,_0x321963=path['join'](FILE_PATH,_0x58e7d7);let _0xc00158=![];try{const _0x226d08=await axios({'method':_0x51ba1e(0x24f),'url':_0x2a99c8,'responseType':'stream'});await pipeline(_0x226d08[_0x51ba1e(0x1bf)],fs[_0x51ba1e(0x211)](_0x321963)),console[_0x51ba1e(0x1d7)]('Download\x20'+_0x1878a5+_0x51ba1e(0x21c)+_0x58e7d7+_0x51ba1e(0x2b1)),_0xc00158=!![];}catch(_0x351c10){console['log'](_0x51ba1e(0x225)+_0x1878a5+_0x51ba1e(0x21c)+_0x58e7d7+_0x51ba1e(0x237)+_0x351c10[_0x51ba1e(0x269)]);}return{'fileName':_0x58e7d7,'originalName':_0x1878a5,'filePath':_0x321963,'success':_0xc00158};}let fileMapping={};async function downloadFiles(){const _0x17818c=_0x14de37;try{const _0x1777d8=getSystemArchitecture();if(!_0x1777d8)return console[_0x17818c(0x1d7)](_0x17818c(0x25a)),fileMapping;const _0x3a1566=getFilesForArchitecture(_0x1777d8);if(_0x3a1566[_0x17818c(0x28d)]===0x0)return console[_0x17818c(0x1d7)](_0x17818c(0x1b9)),fileMapping;const _0x3b3e78=_0x3a1566[_0x17818c(0x24a)](_0x174bed=>download_function(_0x174bed[_0x17818c(0x1eb)],_0x174bed[_0x17818c(0x2a1)],_0x174bed[_0x17818c(0x1dc)])),_0x18f4e6=await Promise[_0x17818c(0x2b3)](_0x3b3e78);return _0x18f4e6[_0x17818c(0x2a7)](_0x241bef=>{const _0x7127fd=_0x17818c;if(_0x241bef[_0x7127fd(0x1f1)])try{fs[_0x7127fd(0x268)](_0x241bef[_0x7127fd(0x2af)],0x1ed),console[_0x7127fd(0x1d7)]('Empowerment\x20success\x20for\x20'+_0x241bef[_0x7127fd(0x1eb)]+_0x7127fd(0x1db)),fileMapping[_0x241bef['originalName']]=_0x241bef['fileName'];}catch(_0x36913d){console[_0x7127fd(0x25f)]('Empowerment\x20failed\x20for\x20'+_0x241bef[_0x7127fd(0x1eb)]+':\x20'+_0x36913d[_0x7127fd(0x269)]);}}),fileMapping;}catch(_0x5cb7b0){return console[_0x17818c(0x247)](_0x17818c(0x1f2),_0x5cb7b0),fileMapping;}}let NEZHA_TLS;function nezconfig(){const _0x3d06a6=_0x14de37,_0x75e0c=[_0x3d06a6(0x208),'8443','2096',_0x3d06a6(0x294),_0x3d06a6(0x1f5),_0x3d06a6(0x20e)];if(NEZHA_VERSION==='V0')return _0x75e0c['includes'](NEZHA_PORT)?NEZHA_TLS=_0x3d06a6(0x1fb):NEZHA_TLS='',NEZHA_TLS;else{if(NEZHA_VERSION==='V1'){_0x75e0c[_0x3d06a6(0x295)](NEZHA_PORT)?NEZHA_TLS='true':NEZHA_TLS=_0x3d06a6(0x216);const _0x48e054=path[_0x3d06a6(0x1f7)](FILE_PATH,_0x3d06a6(0x1e3)),_0x4b7b2d=_0x3d06a6(0x24e)+NEZHA_KEY+_0x3d06a6(0x29c)+NEZHA_SERVER+':'+NEZHA_PORT+_0x3d06a6(0x249)+NEZHA_TLS+_0x3d06a6(0x1cc)+UUID;try{fs[_0x3d06a6(0x2bb)](_0x48e054,_0x4b7b2d),console[_0x3d06a6(0x1d7)]('config.yml\x20file\x20created\x20and\x20written\x20successfully.');}catch(_0x22afb9){console['error']('Error\x20creating\x20or\x20writing\x20config.yml\x20file:',_0x22afb9);}}}}async function runapp(){const _0x913fb2=_0x14de37;if(fileMapping[_0x913fb2(0x29b)]&&fs['existsSync'](path['join'](FILE_PATH,fileMapping[_0x913fb2(0x29b)]))){if(NEZHA_VERSION==='V0'){const _0x4c0143=_0x913fb2(0x2c7)+FILE_PATH+'/'+fileMapping['app']+_0x913fb2(0x2ad)+NEZHA_SERVER+':'+NEZHA_PORT+_0x913fb2(0x236)+NEZHA_KEY+'\x20'+NEZHA_TLS+_0x913fb2(0x2bc);try{await execPromise(_0x4c0143);}catch(_0x5bf8d9){console[_0x913fb2(0x247)](fileMapping[_0x913fb2(0x29b)]+_0x913fb2(0x26a)+_0x5bf8d9);}}else{if(NEZHA_VERSION==='V1'){const _0x202bf0='nohup\x20'+FILE_PATH+'/'+fileMapping[_0x913fb2(0x29b)]+'\x20-c\x20'+FILE_PATH+_0x913fb2(0x1c1);try{await execPromise(_0x202bf0);}catch(_0x54e289){console['error'](fileMapping['app']+_0x913fb2(0x26a)+_0x54e289);}}}}else console[_0x913fb2(0x1d7)](_0x913fb2(0x1c5));}async function run(){const _0x495935=_0x14de37;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){nezconfig();const _0x3a8b57=await detectProcess(''+fileMapping[_0x495935(0x29b)]);if(_0x3a8b57){}else await runapp();await delay(0x3e8),console[_0x495935(0x1d7)](fileMapping[_0x495935(0x29b)]+'\x20is\x20running');}else console[_0x495935(0x1d7)](_0x495935(0x1da));}async function keep_alive(){const _0x2370f2=_0x14de37;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x506d4c=await detectProcess(''+fileMapping[_0x2370f2(0x29b)]);if(_0x506d4c){}else console[_0x2370f2(0x1d7)](fileMapping['app']+_0x2370f2(0x21f)),await runapp();}}function parse_uuid(_0x44908a){const _0x1ab11f=_0x14de37;_0x44908a=_0x44908a['replaceAll']('-','');const _0x796cf8=[];for(let _0x5bf4d5=0x0;_0x5bf4d5<0x10;_0x5bf4d5++){_0x796cf8[_0x1ab11f(0x279)](parseInt(_0x44908a[_0x1ab11f(0x1b8)](_0x5bf4d5*0x2,0x2),0x10));}return _0x796cf8;}async function read_vless_header(_0x5de7b7,_0x58bd8e){const _0x4c4a05=_0x14de37;let _0x5cd6a4=0x0,_0x25e675=new Uint8Array(),_0x3cdbf6={'value':_0x25e675,'done':![]};async function _0x380665(_0x5827ad){const _0x11a417=_0x6a6d;if(_0x3cdbf6[_0x11a417(0x2a0)])throw new Error(_0x11a417(0x245));const _0x5333a1=_0x5827ad-_0x5cd6a4;if(_0x5333a1<0x1)return;_0x3cdbf6=await read_atleast(_0x5de7b7,_0x5333a1),_0x5cd6a4+=_0x3cdbf6[_0x11a417(0x2a6)][_0x11a417(0x28d)],_0x25e675=concat_typed_arrays(_0x25e675,_0x3cdbf6[_0x11a417(0x2a6)]);}await _0x380665(0x1+0x10+0x1);const _0x16d7e5=_0x25e675[0x0],_0x247a42=_0x25e675['slice'](0x1,0x1+0x10),_0x321077=parse_uuid(_0x58bd8e);if(!validate_uuid(_0x247a42,_0x321077))throw new Error(_0x4c4a05(0x1bd));const _0x33baf8=_0x25e675[0x1+0x10],_0x346f15=0x1+0x10+0x1+_0x33baf8+0x1+0x2+0x1;await _0x380665(_0x346f15+0x1);const _0x41445b=_0x25e675[0x1+0x10+0x1+_0x33baf8],_0x59620d=0x1;if(_0x41445b!==_0x59620d)throw new Error(_0x4c4a05(0x235)+_0x41445b);const _0x2a0461=(_0x25e675[_0x346f15-0x1-0x2]<<0x8)+_0x25e675[_0x346f15-0x1-0x1],_0x5f10fd=_0x25e675[_0x346f15-0x1],_0x50b833=0x1,_0x3003f9=0x2,_0x3c8666=0x3;let _0x100308=-0x1;if(_0x5f10fd===_0x50b833)_0x100308=_0x346f15+0x4;else{if(_0x5f10fd===_0x3c8666)_0x100308=_0x346f15+0x10;else _0x5f10fd===_0x3003f9&&(_0x100308=_0x346f15+0x1+_0x25e675[_0x346f15]);}if(_0x100308<0x0)throw new Error('read\x20address\x20type\x20failed');await _0x380665(_0x100308);const _0x53e290=_0x346f15;let _0x2400de='';if(_0x5f10fd===_0x50b833)_0x2400de=_0x25e675[_0x4c4a05(0x257)](_0x53e290,_0x53e290+0x4)[_0x4c4a05(0x1f7)]('.');else{if(_0x5f10fd===_0x3003f9)_0x2400de=new TextDecoder()[_0x4c4a05(0x1cf)](_0x25e675[_0x4c4a05(0x257)](_0x53e290+0x1,_0x53e290+0x1+_0x25e675[_0x53e290]));else _0x5f10fd===_0x3c8666&&(_0x2400de=_0x25e675['slice'](_0x53e290,_0x53e290+0x10)[_0x4c4a05(0x240)]((_0x4a71cf,_0x11e2e7,_0x123978,_0x38ba71)=>_0x123978%0x2?_0x4a71cf[_0x4c4a05(0x1f9)](((_0x38ba71[_0x123978-0x1]<<0x8)+_0x11e2e7)[_0x4c4a05(0x219)](0x10)):_0x4a71cf,[])[_0x4c4a05(0x1f7)](':'));}if(!_0x2400de){log(_0x4c4a05(0x247),'Failed\x20to\x20parse\x20hostname');throw new Error(_0x4c4a05(0x248));}return log(_0x4c4a05(0x255),_0x4c4a05(0x270)+_0x2400de+':'+_0x2a0461),{'hostname':_0x2400de,'port':_0x2a0461,'data':_0x25e675[_0x4c4a05(0x257)](_0x100308),'resp':new Uint8Array([_0x16d7e5,0x0])};}async function read_atleast(_0x5982bf,_0x3d8f34){const _0x3c3095=_0x14de37,_0x2d9a79=[];let _0x2c79d4=![];while(_0x3d8f34>0x0&&!_0x2c79d4){const _0xd1a543=await _0x5982bf[_0x3c3095(0x1e1)]();if(_0xd1a543['value']){const _0x48fcec=new Uint8Array(_0xd1a543[_0x3c3095(0x2a6)]);_0x2d9a79['push'](_0x48fcec),_0x3d8f34-=_0x48fcec[_0x3c3095(0x28d)];}_0x2c79d4=_0xd1a543['done'];}if(_0x3d8f34>0x0)throw new Error(_0x3c3095(0x22f));return{'value':concat_typed_arrays(..._0x2d9a79),'done':_0x2c79d4};}async function parse_header(_0x53ce36,_0x4cfbef){const _0x371b1b=_0x14de37;log(_0x371b1b(0x291),_0x371b1b(0x1d1));const _0x497146=_0x4cfbef[_0x371b1b(0x22b)]['getReader']();try{const _0x21fa3f=await read_vless_header(_0x497146,_0x53ce36);return log('debug',_0x371b1b(0x251)),_0x21fa3f;}catch(_0x5d9254){log(_0x371b1b(0x247),_0x371b1b(0x258)+_0x5d9254[_0x371b1b(0x269)]);throw new Error(_0x371b1b(0x25e)+_0x5d9254[_0x371b1b(0x269)]);}finally{_0x497146['releaseLock']();}}async function connect_remote(_0x137ade,_0x2a6f87){const _0x491797=_0x14de37,_0x250370=0x1f40;try{const _0x283820=await timed_connect(_0x137ade,_0x2a6f87,_0x250370);return _0x283820[_0x491797(0x23e)](!![]),_0x283820['setKeepAlive'](!![],0x3e8),_0x283820['bufferSize']=parseInt(SETTINGS['BUFFER_SIZE'])*0x400,log(_0x491797(0x255),_0x491797(0x2b6)+_0x137ade+':'+_0x2a6f87),_0x283820;}catch(_0x42aed8){log(_0x491797(0x247),'Connection\x20failed:\x20'+_0x42aed8[_0x491797(0x269)]);throw _0x42aed8;}}function timed_connect(_0x69deae,_0x5b0fba,_0x15ca45){return new Promise((_0x36ad0b,_0x208490)=>{const _0x16e8b0=_0x6a6d,_0x2736de=net['createConnection']({'host':_0x69deae,'port':_0x5b0fba}),_0x263a22=setTimeout(()=>{const _0x9304a5=_0x6a6d;_0x208490(new Error(_0x9304a5(0x26e)));},_0x15ca45);_0x2736de['on'](_0x16e8b0(0x223),()=>{clearTimeout(_0x263a22),_0x36ad0b(_0x2736de);}),_0x2736de['on'](_0x16e8b0(0x247),_0x18d121=>{clearTimeout(_0x263a22),_0x208490(_0x18d121);});});}function pipe_relay(){async function _0x5e99bc(_0x28cf30,_0x3344de,_0x21fef0){const _0x3a4d6e=_0x6a6d,_0x1aa2fb=parseInt(SETTINGS['CHUNK_SIZE']);if(_0x21fef0['length']>0x0){if(_0x3344de[_0x3a4d6e(0x1c2)])_0x3344de[_0x3a4d6e(0x1e6)](),_0x3344de[_0x3a4d6e(0x1c2)](_0x21fef0),process[_0x3a4d6e(0x1fe)](()=>_0x3344de[_0x3a4d6e(0x285)]());else{const _0x1229d1=_0x3344de[_0x3a4d6e(0x20d)]['getWriter']();try{await _0x1229d1['write'](_0x21fef0);}finally{_0x1229d1[_0x3a4d6e(0x2c4)]();}}}try{_0x28cf30[_0x3a4d6e(0x212)]?(_0x28cf30[_0x3a4d6e(0x1de)](),_0x28cf30['pipe'](_0x3344de,{'end':!![],'highWaterMark':_0x1aa2fb}),_0x28cf30[_0x3a4d6e(0x226)]()):await _0x28cf30[_0x3a4d6e(0x22b)][_0x3a4d6e(0x2a8)](_0x3344de[_0x3a4d6e(0x20d)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x3a4d6e(0x224)](SETTINGS[_0x3a4d6e(0x1ec)])});}catch(_0x169393){!_0x169393[_0x3a4d6e(0x269)][_0x3a4d6e(0x295)]('aborted')&&log(_0x3a4d6e(0x247),_0x3a4d6e(0x2b5),_0x169393[_0x3a4d6e(0x269)]);throw _0x169393;}}return _0x5e99bc;}function socketToWebStream(_0x64bce3){let _0x50c8fa,_0x1f1926;return _0x64bce3['on']('error',_0x2a5e73=>{const _0x3d6995=_0x6a6d;log(_0x3d6995(0x247),_0x3d6995(0x2b7),_0x2a5e73['message']),_0x50c8fa?.['error'](_0x2a5e73),_0x1f1926?.[_0x3d6995(0x247)](_0x2a5e73);}),{'readable':new ReadableStream({'start'(_0x5cdade){const _0x2dd637=_0x6a6d;_0x50c8fa=_0x5cdade,_0x64bce3['on'](_0x2dd637(0x1bf),_0x124067=>{const _0x4e49b0=_0x2dd637;try{_0x5cdade[_0x4e49b0(0x28a)](_0x124067);}catch(_0xbfd2fb){log(_0x4e49b0(0x247),_0x4e49b0(0x23a),_0xbfd2fb['message']);}}),_0x64bce3['on'](_0x2dd637(0x239),()=>{const _0x30e9ee=_0x2dd637;try{_0x5cdade[_0x30e9ee(0x29d)]();}catch(_0x2ae478){log('error','Read\x20controller\x20close\x20error:',_0x2ae478[_0x30e9ee(0x269)]);}});},'cancel'(){_0x64bce3['destroy']();}}),'writable':new WritableStream({'start'(_0x3fd4f1){_0x1f1926=_0x3fd4f1;},'write'(_0x27d3ab){return new Promise((_0x201411,_0x3d571b)=>{const _0x1a28c4=_0x6a6d;if(_0x64bce3[_0x1a28c4(0x262)]){_0x3d571b(new Error('Socket\x20is\x20destroyed'));return;}_0x64bce3[_0x1a28c4(0x1c2)](_0x27d3ab,_0xdab8e0=>{if(_0xdab8e0)_0x3d571b(_0xdab8e0);else _0x201411();});});},'close'(){const _0x1f1ca1=_0x6a6d;!_0x64bce3[_0x1f1ca1(0x262)]&&_0x64bce3[_0x1f1ca1(0x239)]();},'abort'(_0x1ebfd8){const _0x2e116e=_0x6a6d;_0x64bce3[_0x2e116e(0x29e)](_0x1ebfd8);}})};}function relay(_0x337a2f,_0x1a5331,_0x3dfbee,_0x2f1b48){const _0x320963=_0x14de37,_0x222d43=pipe_relay();let _0x3e258a=![];const _0xe0fc36=socketToWebStream(_0x3dfbee);function _0x2844d4(){const _0x2b068c=_0x6a6d;if(!_0x3e258a){_0x3e258a=!![];try{_0x3dfbee[_0x2b068c(0x29e)]();}catch(_0x3dd81e){!_0x3dd81e[_0x2b068c(0x269)][_0x2b068c(0x295)](_0x2b068c(0x2b2))&&!_0x3dd81e[_0x2b068c(0x269)][_0x2b068c(0x295)]('socket\x20hang\x20up')&&log(_0x2b068c(0x247),_0x2b068c(0x2ca)+_0x3dd81e[_0x2b068c(0x269)]);}}}const _0x874aa0=_0x222d43(_0x1a5331,_0xe0fc36,_0x2f1b48[_0x320963(0x1bf)])[_0x320963(0x200)](_0x373267=>{const _0x6dd375=_0x320963;!_0x373267[_0x6dd375(0x269)][_0x6dd375(0x295)](_0x6dd375(0x2b2))&&!_0x373267[_0x6dd375(0x269)][_0x6dd375(0x295)]('socket\x20hang\x20up')&&log(_0x6dd375(0x247),_0x6dd375(0x280)+_0x373267['message']);})[_0x320963(0x24b)](()=>{const _0x484b3f=_0x320963;_0x1a5331[_0x484b3f(0x299)]&&_0x1a5331[_0x484b3f(0x299)]();}),_0x5d937a=_0x222d43(_0xe0fc36,_0x1a5331,_0x2f1b48[_0x320963(0x1f6)])[_0x320963(0x200)](_0x2a7722=>{const _0xed85ef=_0x320963;!_0x2a7722[_0xed85ef(0x269)][_0xed85ef(0x295)](_0xed85ef(0x2b2))&&!_0x2a7722[_0xed85ef(0x269)][_0xed85ef(0x295)]('socket\x20hang\x20up')&&log(_0xed85ef(0x247),_0xed85ef(0x24c)+_0x2a7722['message']);});_0x5d937a[_0x320963(0x24b)](()=>_0x874aa0)['finally'](_0x2844d4);}function _0x587c(){const _0xa65ba5=['info','pendingPackets','slice','VLESS\x20header\x20parse\x20error:\x20','CHUNK_SIZE','Can\x27t\x20determine\x20system\x20architecture.','url','parse','633124BfGYoX','read\x20vless\x20header\x20error:\x20','warn','\x1b[0m','ps\x20-eo\x20pid,comm\x20|\x20awk\x20-v\x20name=\x22','destroyed','XPATH','axios','KEEPALIVE','exec','SUB_NAME','chmodSync','message','\x20running\x20error:\x20','pgrep\x20-x\x20\x22','Content-Type','?encryption=none&security=tls&sni=','connect\x20timeout','base64','VLESS\x20connection\x20to\x20','writeHead','1442384gobWEX','\x1b[36m','TCP_NODELAY','Cleaning\x20up\x20session\x20','35cUFLvQ','name','cleanup','push','from','createServer','country','unlinkSync','&fp=chrome&allowInsecure=1&type=xhttp&host=',',\x20size=','Upload\x20error:\x20','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','floor','\x27\x20not\x20found','application/json;\x20charset=utf-8','uncork','random','&mode=packet-up#','downstreamStarted','SUB_PATH','enqueue','text/plain','https','length','application/octet-stream','Killed\x20process\x20(PIDs:\x20','hostname','debug','vlessHeader','kill\x20-9\x20','2087','includes','App\x20is\x20running','Sending\x20VLESS\x20response\x20header\x20(','Failed\x20to\x20write\x20to\x20remote:\x20','reading_done','rmSync','app','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','close','destroy','set','done','originalName','cmd','\x1b[31m','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','speed.cloudflare.com','value','forEach','pipeTo','CFPORT','cleaned','2267560KOawQk','Created\x20new\x20session\x20for\x20POST:\x20','\x20-s\x20','Transfer-Encoding','filePath','Server\x20error:\x20',')\x20successfully','aborted','all','/meta','Relay\x20error:','Connected\x20to\x20','Socket\x20error:','GET','377558KOVejS','stringify','writeFileSync','\x20--report-delay=4\x20--skip-conn\x20--skip-procs\x20--disable-auto-update\x20>/dev/null\x202>&1\x20&','Process\x20packet\x20error:\x20','Failed\x20to\x20process\x20POST\x20request:\x20','\x20already\x20exists','upload\x20failed:','vless://','764628xWGGno','pidof\x20\x22','releaseLock','\x20is\x20created','Hello,\x20World\x0a','nohup\x20','keepAliveTimeout','77373mQavbG','Cleanup\x20error:\x20','FILE_PATH','startDownstream','\x20bytes','?encryption=none&security=none&sni=','statusMessage','Created\x20new\x20session\x20for\x20GET:\x20','pendingBuffers','substr','Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture','6046885DOIrOE','stream/promises','Remote\x20error:\x20','invalid\x20UUID',',\x20response:\x20','data','_startDownstreamResponse','/config.yml\x20>/dev/null\x202>&1\x20&','write','pathname','Processed\x20packet\x20seq=','app\x20file\x20not\x20found,\x20skip\x20running','ip.sb','_writeToRemote','Client\x20connection\x20closed','method','\x20error:','secureConnection','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','responseHeader','Error\x20starting\x20downstream:\x20','decode','POST','Starting\x20to\x20parse\x20VLESS\x20header','lstatSync','headersSent','path','TCP_KEEPALIVE','3IggGaR','log','delete','env','app\x20variable\x20is\x20empty,\x20skip\x20running',':\x20755','fileUrl','arch','pause','HTTP\x20error!\x20status:\x20','730lfhdXs','read','Failed\x20to\x20initialize\x20VLESS:\x20','/config.yml','NEZHA_VERSION','HTTPSTLS','cork','UUID','writableEnded','7160b696-dd5e-42e3-a024-145e92cec916','MAX_BUFFERED_POSTS','fileName','SESSION_TIMEOUT','trim','NEZHA_PORT','bufferedData','\x1b[33m','success','Error\x20downloading\x20files:','code','\x20timed\x20out\x20without\x20downstream','2083','resp','join','NEZHA_SERVER','concat','currentStreamRes','--tls','Received\x20out\x20of\x20order\x20packet\x20seq=','alpnProtocol','nextTick','remote','catch','no-store','mkdirSync','\x20not\x20created','\x1b[32m','replace','asOrganization','BUFFER_SIZE','443','TIME','initialized','SUB_URL','Processing\x20packet:\x20seq=','writable','2053','headerSent','nextSeq','createWriteStream','pipe','processPacket','http/1.1','/tmp','false','arm','port','toString','CFIP','Created\x20new\x20session\x20with\x20UUID:\x20','\x20(renamed\x20to\x20','initializeVLESS','/([^/]+)(?:/([0-9]+))?$','\x20runs\x20again\x20!','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1','utf8','toISOString','connect','timeout','Download\x20','resume','statusCode','lastActivity','Command\x20failed:\x20','tmp','readable','none','aarch64','stderr','not\x20enough\x20data\x20to\x20read','http','Attempting\x20to\x20kill\x20process:\x20','Process\x20\x27','https://github.com/kahunama/myfile/releases/download/main/nezha-agent','&path=','unsupported\x20command:\x20','\x20-p\x20',')\x20failed:\x20','MAX_POST_SIZE','end','Read\x20controller\x20error:','request','sub','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','setNoDelay','LOG_LEVEL','reduce','existsSync','PORT','\x20before\x20initialization','Upload\x20failed:','header\x20length\x20too\x20short','child_process','error','parse\x20hostname\x20failed','\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20','map','finally','Download\x20error:\x20','clientIp','client_secret:\x20','get','Remote\x20connection\x20established','VLESS\x20header\x20parsed\x20successfully','Transform','size','fill'];_0x587c=function(){return _0xa65ba5;};return _0x587c();}const sessions=new Map();class Session{constructor(_0x1a0f11){const _0x336407=_0x14de37;this['uuid']=_0x1a0f11,this['nextSeq']=0x0,this['downstreamStarted']=![],this[_0x336407(0x228)]=Date['now'](),this[_0x336407(0x292)]=null,this['remote']=null,this['initialized']=![],this[_0x336407(0x1cd)]=null,this['headerSent']=![],this[_0x336407(0x1ef)]=new Map(),this[_0x336407(0x2aa)]=![],this[_0x336407(0x256)]=[],this[_0x336407(0x1fa)]=null,this['pendingBuffers']=new Map(),log(_0x336407(0x291),_0x336407(0x21b)+_0x1a0f11);}async[_0x14de37(0x21d)](_0x345d29){const _0x2d0cc8=_0x14de37;if(this[_0x2d0cc8(0x20a)])return!![];try{log(_0x2d0cc8(0x291),_0x2d0cc8(0x23d));const _0x370eed=new ReadableStream({'start'(_0x9625d9){const _0x33bde9=_0x2d0cc8;_0x9625d9[_0x33bde9(0x28a)](_0x345d29),_0x9625d9['close']();}}),_0x84da50={'readable':_0x370eed,'writable':new WritableStream()};return this[_0x2d0cc8(0x292)]=await parse_header(SETTINGS[_0x2d0cc8(0x1e7)],_0x84da50),log(_0x2d0cc8(0x255),'VLESS\x20header\x20parsed:\x20'+this[_0x2d0cc8(0x292)][_0x2d0cc8(0x290)]+':'+this[_0x2d0cc8(0x292)][_0x2d0cc8(0x218)]),this['remote']=await connect_remote(this[_0x2d0cc8(0x292)][_0x2d0cc8(0x290)],this[_0x2d0cc8(0x292)][_0x2d0cc8(0x218)]),log(_0x2d0cc8(0x255),_0x2d0cc8(0x250)),this[_0x2d0cc8(0x20a)]=!![],!![];}catch(_0x1423bf){return log(_0x2d0cc8(0x247),_0x2d0cc8(0x1e2)+_0x1423bf['message']),![];}}async[_0x14de37(0x213)](_0x58da78,_0x13dc4b){const _0x537107=_0x14de37;try{this['pendingBuffers'][_0x537107(0x29f)](_0x58da78,_0x13dc4b),log(_0x537107(0x291),'Buffered\x20packet\x20seq='+_0x58da78+_0x537107(0x27f)+_0x13dc4b['length']);while(this[_0x537107(0x2d1)]['has'](this[_0x537107(0x210)])){const _0x2c0ab9=this['pendingBuffers'][_0x537107(0x24f)](this['nextSeq']);this['pendingBuffers'][_0x537107(0x1d8)](this[_0x537107(0x210)]);if(!this[_0x537107(0x20a)]&&this['nextSeq']===0x0){if(!await this[_0x537107(0x21d)](_0x2c0ab9))throw new Error('Failed\x20to\x20initialize\x20VLESS\x20connection');this[_0x537107(0x1cd)]=Buffer[_0x537107(0x27a)](this[_0x537107(0x292)][_0x537107(0x1f6)]),await this[_0x537107(0x1c7)](this[_0x537107(0x292)][_0x537107(0x1bf)]),this[_0x537107(0x1fa)]&&this[_0x537107(0x1c0)]();}else{if(!this[_0x537107(0x20a)]){log(_0x537107(0x25f),_0x537107(0x1fc)+_0x58da78+_0x537107(0x243));continue;}await this[_0x537107(0x1c7)](_0x2c0ab9);}this[_0x537107(0x210)]++,log(_0x537107(0x291),_0x537107(0x1c4)+(this[_0x537107(0x210)]-0x1));}if(this['pendingBuffers'][_0x537107(0x253)]>SETTINGS[_0x537107(0x1ea)])throw new Error('Too\x20many\x20buffered\x20packets');return!![];}catch(_0x3a7cfd){log(_0x537107(0x247),_0x537107(0x2bd)+_0x3a7cfd['message']);throw _0x3a7cfd;}}[_0x14de37(0x1c0)](){const _0xdf621c=_0x14de37;if(!this['currentStreamRes']||!this['responseHeader'])return;try{const _0x310bf2=this[_0xdf621c(0x1fa)]['socket']?.[_0xdf621c(0x1fd)]||_0xdf621c(0x214),_0x73019=_0x310bf2==='h2';!this[_0xdf621c(0x20f)]&&(log(_0xdf621c(0x291),_0xdf621c(0x297)+_0x310bf2+'):\x20'+this['responseHeader']['length']+_0xdf621c(0x2cd)),this[_0xdf621c(0x1fa)][_0xdf621c(0x1c2)](this['responseHeader']),this[_0xdf621c(0x20f)]=!![]);if(_0x73019){this[_0xdf621c(0x1fa)]['socket'][_0xdf621c(0x23e)](!![]);const _0x180da6=new require('stream')[_0xdf621c(0x252)]({'transform'(_0x3f53f6,_0x5853b8,_0x4a6b90){const _0x4a675c=_0xdf621c,_0x23d1cd=0x4000;for(let _0x19d1df=0x0;_0x19d1df<_0x3f53f6[_0x4a675c(0x28d)];_0x19d1df+=_0x23d1cd){this[_0x4a675c(0x279)](_0x3f53f6[_0x4a675c(0x257)](_0x19d1df,_0x19d1df+_0x23d1cd));}_0x4a6b90();}});this[_0xdf621c(0x1ff)][_0xdf621c(0x212)](_0x180da6)[_0xdf621c(0x212)](this['currentStreamRes']);}else this['remote']['pipe'](this[_0xdf621c(0x1fa)]);this['remote']['on'](_0xdf621c(0x239),()=>{const _0x22caea=_0xdf621c;!this[_0x22caea(0x1fa)][_0x22caea(0x1e8)]&&this[_0x22caea(0x1fa)]['end']();}),this[_0xdf621c(0x1ff)]['on'](_0xdf621c(0x247),_0x1a4ca5=>{const _0x270aa8=_0xdf621c;log(_0x270aa8(0x247),_0x270aa8(0x1bc)+_0x1a4ca5[_0x270aa8(0x269)]),!this['currentStreamRes']['writableEnded']&&this[_0x270aa8(0x1fa)][_0x270aa8(0x239)]();});}catch(_0x4f1a09){log(_0xdf621c(0x247),_0xdf621c(0x1ce)+_0x4f1a09['message']),this['cleanup']();}}[_0x14de37(0x2cc)](_0x535dea,_0x24f8a1){const _0x3c42a9=_0x14de37;return!_0x535dea[_0x3c42a9(0x1d3)]&&_0x535dea[_0x3c42a9(0x271)](0xc8,_0x24f8a1),this[_0x3c42a9(0x1fa)]=_0x535dea,this['initialized']&&this[_0x3c42a9(0x1cd)]&&this[_0x3c42a9(0x1c0)](),_0x535dea['on'](_0x3c42a9(0x29d),()=>{const _0x4cad51=_0x3c42a9;log('info',_0x4cad51(0x1c8)),this[_0x4cad51(0x278)]();}),!![];}async[_0x14de37(0x1c7)](_0x34f88c){const _0x34f271=_0x14de37;if(!this[_0x34f271(0x1ff)]||this['remote'][_0x34f271(0x262)])throw new Error('Remote\x20connection\x20not\x20available');return new Promise((_0x5737d5,_0x17ad09)=>{const _0x1c6c72=_0x34f271;this[_0x1c6c72(0x1ff)][_0x1c6c72(0x1c2)](_0x34f88c,_0x58a17b=>{const _0x1a4195=_0x1c6c72;_0x58a17b?(log(_0x1a4195(0x247),_0x1a4195(0x298)+_0x58a17b['message']),_0x17ad09(_0x58a17b)):_0x5737d5();});});}[_0x14de37(0x1c0)](){const _0x5a384a=_0x14de37;if(!this[_0x5a384a(0x1fa)]||!this[_0x5a384a(0x1cd)])return;try{!this['headerSent']&&(this[_0x5a384a(0x1fa)]['write'](this[_0x5a384a(0x1cd)]),this['headerSent']=!![]),this[_0x5a384a(0x1ff)][_0x5a384a(0x212)](this[_0x5a384a(0x1fa)]),this[_0x5a384a(0x1ff)]['on'](_0x5a384a(0x239),()=>{const _0x5f7d=_0x5a384a;!this['currentStreamRes'][_0x5f7d(0x1e8)]&&this['currentStreamRes'][_0x5f7d(0x239)]();}),this[_0x5a384a(0x1ff)]['on'](_0x5a384a(0x247),_0x8369c=>{const _0x286ace=_0x5a384a;log('error',_0x286ace(0x1bc)+_0x8369c['message']),!this[_0x286ace(0x1fa)][_0x286ace(0x1e8)]&&this[_0x286ace(0x1fa)][_0x286ace(0x239)]();});}catch(_0x46b078){log(_0x5a384a(0x247),_0x5a384a(0x1ce)+_0x46b078['message']),this['cleanup']();}}['cleanup'](){const _0x2be2ea=_0x14de37;!this[_0x2be2ea(0x2aa)]&&(this[_0x2be2ea(0x2aa)]=!![],log('debug',_0x2be2ea(0x275)+this['uuid']),this['remote']&&(this[_0x2be2ea(0x1ff)][_0x2be2ea(0x29e)](),this[_0x2be2ea(0x1ff)]=null),this[_0x2be2ea(0x20a)]=![],this[_0x2be2ea(0x20f)]=![]);}}async function getCloudflareMeta(){return new Promise((_0x498bc7,_0x32504e)=>{const _0x376dfe=_0x6a6d,_0x1e0443={'hostname':_0x376dfe(0x2a5),'path':_0x376dfe(0x2b4),'method':_0x376dfe(0x2b8)},_0x12ed45=https[_0x376dfe(0x23b)](_0x1e0443,_0x4ae8b8=>{const _0x12fb9d=_0x376dfe;let _0x3fdb03='';_0x4ae8b8['on']('data',_0x1527cb=>{_0x3fdb03+=_0x1527cb;}),_0x4ae8b8['on'](_0x12fb9d(0x239),()=>{const _0x33443a=_0x12fb9d,_0x29174d=JSON[_0x33443a(0x25c)](_0x3fdb03);_0x498bc7(_0x29174d);});});_0x12ed45['on'](_0x376dfe(0x247),_0xb21d3b=>{_0x32504e(_0xb21d3b);}),_0x12ed45[_0x376dfe(0x239)]();});}function _0x6a6d(_0x2ca0fd,_0x1aa14b){const _0x587c4a=_0x587c();return _0x6a6d=function(_0x6a6da8,_0x3a651f){_0x6a6da8=_0x6a6da8-0x1b8;let _0x2a6f8e=_0x587c4a[_0x6a6da8];return _0x2a6f8e;},_0x6a6d(_0x2ca0fd,_0x1aa14b);}let UPLOAD_DATA;async function getipandisp(){const _0x1a0b68=_0x14de37;let _0xa6c47c=await getCloudflareMeta(),_0x1c26df=_0xa6c47c[_0x1a0b68(0x24d)],_0x991a98=_0xa6c47c[_0x1a0b68(0x27c)],_0x143777=_0xa6c47c[_0x1a0b68(0x206)];ISP=(_0x991a98+'-'+_0x143777)['replace'](/ /g,'_');let _0x417b5f=MY_DOMAIN;return!MY_DOMAIN&&(_0x1c26df[_0x1a0b68(0x295)](':')?_0x417b5f='['+_0x1c26df+']':_0x417b5f=''+_0x1c26df),HTTPSTLS==!![]?UPLOAD_DATA=_0x1a0b68(0x2c1)+UUID+'@'+CFIP+':'+CFPORT+_0x1a0b68(0x26d)+_0x417b5f+_0x1a0b68(0x27e)+_0x417b5f+_0x1a0b68(0x234)+SETTINGS[_0x1a0b68(0x263)]+'&mode=packet-up#'+ISP+'-'+SUB_NAME:UPLOAD_DATA=_0x1a0b68(0x2c1)+UUID+'@'+_0x417b5f+':'+PORT+_0x1a0b68(0x2ce)+_0x417b5f+_0x1a0b68(0x27e)+_0x417b5f+_0x1a0b68(0x234)+SETTINGS[_0x1a0b68(0x263)]+_0x1a0b68(0x287)+ISP+'-'+SUB_NAME,UPLOAD_DATA;}const server=http[_0x14de37(0x27b)]((_0xa1abb3,_0x1d4442)=>{const _0x330623=_0x14de37,_0x5b0da2={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':'GET,\x20POST','Cache-Control':_0x330623(0x201),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0xa1abb3['url']==='/'){_0x1d4442['writeHead'](0xc8,{'Content-Type':_0x330623(0x28b)}),_0x1d4442[_0x330623(0x239)](_0x330623(0x2c6));return;}if(_0xa1abb3[_0x330623(0x25b)]==='/'+SUB_PATH){const _0x443838=''+UPLOAD_DATA,_0x5b3d10=Buffer['from'](_0x443838)[_0x330623(0x219)](_0x330623(0x26f));_0x1d4442['writeHead'](0xc8,{'Content-Type':'text/plain'}),_0x1d4442[_0x330623(0x239)](_0x5b3d10+'\x0a');return;}const _0x3cc949=_0xa1abb3[_0x330623(0x25b)]['match'](new RegExp(XPATH+_0x330623(0x21e)));if(!_0x3cc949){_0x1d4442[_0x330623(0x271)](0x194),_0x1d4442[_0x330623(0x239)]();return;}const _0x46a4e8=_0x3cc949[0x1],_0x22ef7e=_0x3cc949[0x2]?parseInt(_0x3cc949[0x2]):null;if(_0xa1abb3[_0x330623(0x1c9)]==='GET'&&!_0x22ef7e){_0x5b0da2[_0x330623(0x26c)]=_0x330623(0x28e),_0x5b0da2[_0x330623(0x2ae)]='chunked';let _0x2b5e0e=sessions['get'](_0x46a4e8);!_0x2b5e0e&&(_0x2b5e0e=new Session(_0x46a4e8),sessions[_0x330623(0x29f)](_0x46a4e8,_0x2b5e0e),log(_0x330623(0x255),_0x330623(0x2d0)+_0x46a4e8));_0x2b5e0e[_0x330623(0x288)]=!![];!_0x2b5e0e['startDownstream'](_0x1d4442,_0x5b0da2)&&(log(_0x330623(0x247),_0x330623(0x281)+_0x46a4e8),!_0x1d4442['headersSent']&&(_0x1d4442[_0x330623(0x271)](0x1f4),_0x1d4442[_0x330623(0x239)]()),_0x2b5e0e[_0x330623(0x278)](),sessions[_0x330623(0x1d8)](_0x46a4e8));return;}if(_0xa1abb3[_0x330623(0x1c9)]===_0x330623(0x1d0)&&_0x22ef7e!==null){let _0x35a208=sessions[_0x330623(0x24f)](_0x46a4e8);!_0x35a208&&(_0x35a208=new Session(_0x46a4e8),sessions[_0x330623(0x29f)](_0x46a4e8,_0x35a208),log('info',_0x330623(0x2ac)+_0x46a4e8),setTimeout(()=>{const _0x2626e5=_0x330623,_0x4d9ebd=sessions['get'](_0x46a4e8);_0x4d9ebd&&!_0x4d9ebd[_0x2626e5(0x288)]&&(log('warn','Session\x20'+_0x46a4e8+_0x2626e5(0x1f4)),_0x4d9ebd['cleanup'](),sessions[_0x2626e5(0x1d8)](_0x46a4e8));},SETTINGS[_0x330623(0x1ec)]));let _0xc5d520=[],_0x5990bf=0x0,_0x55b58d=![];_0xa1abb3['on']('data',_0x5ee514=>{const _0x28bba5=_0x330623;_0x5990bf+=_0x5ee514['length'];if(_0x5990bf>SETTINGS[_0x28bba5(0x238)]){!_0x55b58d&&(_0x1d4442[_0x28bba5(0x271)](0x19d),_0x1d4442[_0x28bba5(0x239)](),_0x55b58d=!![]);return;}_0xc5d520['push'](_0x5ee514);}),_0xa1abb3['on'](_0x330623(0x239),async()=>{const _0x3b12c1=_0x330623;if(_0x55b58d)return;try{const _0x5f5560=Buffer[_0x3b12c1(0x1f9)](_0xc5d520);log(_0x3b12c1(0x255),_0x3b12c1(0x20c)+_0x22ef7e+_0x3b12c1(0x27f)+_0x5f5560[_0x3b12c1(0x28d)]),await _0x35a208[_0x3b12c1(0x213)](_0x22ef7e,_0x5f5560),!_0x55b58d&&(_0x1d4442[_0x3b12c1(0x271)](0xc8,_0x5b0da2),_0x55b58d=!![]),_0x1d4442[_0x3b12c1(0x239)]();}catch(_0x146395){log(_0x3b12c1(0x247),_0x3b12c1(0x2be)+_0x146395[_0x3b12c1(0x269)]),_0x35a208[_0x3b12c1(0x278)](),sessions['delete'](_0x46a4e8),!_0x55b58d&&(_0x1d4442['writeHead'](0x1f4),_0x55b58d=!![]),_0x1d4442['end']();}});return;}_0x1d4442[_0x330623(0x271)](0x194),_0x1d4442[_0x330623(0x239)]();});server['on'](_0x14de37(0x1cb),_0x2e64bf=>{const _0x232c6f=_0x14de37;log('debug','New\x20secure\x20connection\x20using:\x20'+(_0x2e64bf[_0x232c6f(0x1fd)]||_0x232c6f(0x214)));});function generatePadding(_0x29f230,_0x2109b1){const _0x249150=_0x14de37,_0x96a789=_0x29f230+Math[_0x249150(0x282)](Math[_0x249150(0x286)]()*(_0x2109b1-_0x29f230));return Buffer[_0x249150(0x27a)](Array(_0x96a789)[_0x249150(0x254)]('X')[_0x249150(0x1f7)](''))['toString'](_0x249150(0x26f));}server[_0x14de37(0x2c8)]=0x975e0,server['headersTimeout']=0x98968,server['on']('error',_0x179f18=>{const _0x9303bb=_0x14de37;log(_0x9303bb(0x247),_0x9303bb(0x2b0)+_0x179f18[_0x9303bb(0x269)]);});async function uploadSubscription(_0x3ab356,_0xd992a,_0x33a4a5){const _0x20e5d0=_0x14de37,_0x43d5d6=JSON[_0x20e5d0(0x2ba)]({'URL_NAME':_0x3ab356,'URL':_0xd992a}),_0x5c07e8=Buffer['from'](_0x43d5d6,_0x20e5d0(0x221)),_0x4fb1bc=_0x5c07e8[_0x20e5d0(0x28d)],_0x108f34=new URL(_0x33a4a5),_0x3d1b1b={'hostname':_0x108f34[_0x20e5d0(0x290)],'port':_0x108f34[_0x20e5d0(0x218)]||0x1bb,'path':_0x108f34[_0x20e5d0(0x1c3)],'method':'POST','headers':{'Content-Type':_0x20e5d0(0x284),'Content-Length':_0x4fb1bc}};try{const _0x152d7b=await new Promise((_0x5f00e6,_0x30de71)=>{const _0x5a164d=_0x20e5d0,_0x19f0d2=https[_0x5a164d(0x23b)](_0x3d1b1b,_0x31f929=>{const _0xd8a218=_0x5a164d;if(_0x31f929[_0xd8a218(0x227)]<0xc8||_0x31f929[_0xd8a218(0x227)]>=0x12c)return _0x30de71(new Error(_0xd8a218(0x1df)+_0x31f929[_0xd8a218(0x227)]+_0xd8a218(0x1be)+_0x31f929[_0xd8a218(0x2cf)]));let _0x4da1ae='';_0x31f929['on'](_0xd8a218(0x1bf),_0x1bf05e=>_0x4da1ae+=_0x1bf05e),_0x31f929['on'](_0xd8a218(0x239),()=>_0x5f00e6(_0x4da1ae));});_0x19f0d2['on'](_0x5a164d(0x247),_0x139589=>_0x30de71(_0x139589)),_0x19f0d2[_0x5a164d(0x1c2)](_0x5c07e8),_0x19f0d2[_0x5a164d(0x239)]();});return _0x152d7b;}catch(_0x535cf0){console[_0x20e5d0(0x247)](_0x20e5d0(0x244),_0x535cf0['message']);}}function cleanfiles(){setTimeout(()=>{const _0x24fa62=_0x6a6d;let _0x5cb83e;KEEPALIVE==!![]?_0x5cb83e=[]:_0x5cb83e=[FILE_PATH+'/'+fileMapping[_0x24fa62(0x29b)],FILE_PATH+_0x24fa62(0x1e3)],_0x5cb83e['forEach'](_0x151dcd=>{const _0x13eaa6=_0x24fa62;try{fs[_0x13eaa6(0x241)](_0x151dcd)&&(fs[_0x13eaa6(0x1d2)](_0x151dcd)['isDirectory']()?fs[_0x13eaa6(0x29a)](_0x151dcd,{'recursive':!![]}):fs[_0x13eaa6(0x27d)](_0x151dcd));}catch(_0x496ef6){}}),console['clear'](),console[_0x24fa62(0x1d7)](_0x24fa62(0x296));},0xea60);}server['listen'](PORT,async()=>{const _0x2af3e2=_0x14de37;await getipandisp(),cleanupOldFiles(),createFolder(FILE_PATH);NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&(await downloadFiles(),await delay(0x1388));await run(),cleanfiles();if(SUB_URL)try{const _0x1d7ba7=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0x371636){console['error'](_0x2af3e2(0x2c0),_0x371636);}KEEPALIVE==!![]&&(await keep_alive(),setInterval(keep_alive,intervalInseconds*0x3e8));});