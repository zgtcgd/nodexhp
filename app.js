const _0x332f99=_0x4dde;(function(_0x1103f6,_0x2170dc){const _0x2108b4=_0x4dde,_0xc37e38=_0x1103f6();while(!![]){try{const _0x4eefc6=-parseInt(_0x2108b4(0x24b))/0x1+-parseInt(_0x2108b4(0x1c3))/0x2+-parseInt(_0x2108b4(0x1ea))/0x3+-parseInt(_0x2108b4(0x1c9))/0x4+-parseInt(_0x2108b4(0x22f))/0x5*(parseInt(_0x2108b4(0x13f))/0x6)+-parseInt(_0x2108b4(0x19d))/0x7*(parseInt(_0x2108b4(0x23b))/0x8)+parseInt(_0x2108b4(0x1e7))/0x9;if(_0x4eefc6===_0x2170dc)break;else _0xc37e38['push'](_0xc37e38['shift']());}catch(_0x38daca){_0xc37e38['push'](_0xc37e38['shift']());}}}(_0x4c66,0x43dc4));function _0x4c66(){const _0x1b92e6=['Killed\x20process\x20(PIDs:\x20','pgrep','charAt','length','/config.yml','join','done','curl\x20-s\x20https://speed.cloudflare.com/meta\x20|\x20awk\x20-F\x27\x22\x27\x20\x27{print\x20$26\x22-\x22$18}\x27\x20|\x20sed\x20-e\x20\x27s/\x20/_/g\x27','15507117gHVDME','resume','fileName','170607qAYjSy','log','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1','VLESS\x20header\x20parsed:\x20','Error\x20downloading\x20files:','App\x20is\x20running','debug','POST','CHUNK_SIZE','Too\x20many\x20buffered\x20packets','socket\x20hang\x20up','connect','rmSync','nohup\x20','statusCode','Socket\x20is\x20destroyed','secureConnection','originalName','SUB_URL','Remote\x20error:\x20','NEZHA_KEY','stderr','NEZHA_VERSION','\x20bytes','Node\x20variable\x20is\x20empty,\x20skip\x20running','Process\x20packet\x20error:\x20','write','Upload\x20error:\x20','listen','aborted','\x20error:','\x20-s\x20','writable','HTTPSTLS','Server\x20error:\x20','get','bufferSize','reading_done','\x20running\x20error:\x20','LOCAL_DOMAIN','GET,\x20POST','Starting\x20to\x20parse\x20VLESS\x20header','resp','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','utf-8','Error\x20starting\x20downstream:\x20','port','\x1b[31m','pause','Transform','trim','Kill\x20failed:\x20','vlessHeader','headersSent','Failed\x20to\x20write\x20to\x20remote:\x20','finally','timeout','startDownstream','443','chmodSync','stream','from','Connected\x20to\x20','_writeToRemote','setKeepAlive','createConnection','arm64','&path=','releaseLock','1162155KUnIqV','Sending\x20VLESS\x20response\x20header\x20(','Download\x20error:\x20','UUID','now','request','UNKNOWN_ISP','Socket\x20error:','value','pgrep\x20-x\x20\x22','Remote\x20connection\x20not\x20available','stream/promises','808BYEiIR','createWriteStream','delete','getWriter','match','Can\x27t\x20determine\x20system\x20architecture.','--tls','header\x20length\x20too\x20short','not\x20enough\x20data\x20to\x20read','pendingBuffers','substr','Server\x20is\x20running\x20on\x20port\x20','none','client_secret:\x20','https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','&fp=chrome&allowInsecure=1&type=xhttp&host=','16961REuXWk','Remote\x20connection\x20established','2083','Cleanup\x20error:\x20','GET','\x20timed\x20out\x20without\x20downstream','application/json;\x20charset=utf-8','MAX_BUFFERED_POSTS','TCP_KEEPALIVE','12fOdQdH','cork','Session\x20','message',',\x20response:\x20','destroy','Transfer-Encoding','https','slice','):\x20','remote','random','MAX_POST_SIZE','Error\x20fetching\x20ISP\x20info:','VLESS\x20header\x20parsed\x20successfully','set','curl\x20-s\x20https://speed.cloudflare.com/meta','close','NEZHA_SERVER','\x20--report-delay=4\x20--skip-conn\x20--skip-procs\x20--disable-auto-update\x20>/dev/null\x202>&1\x20&','/tmp','env','cleaned','net','Relay\x20error:','http/1.1','headerSent','PORT','\x20before\x20initialization','aarch64','VLESS\x20header\x20parse\x20error:\x20','uuid','warn','processPacket','no-store','text/plain','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20',',\x20size=','Processed\x20packet\x20seq=','mkdirSync','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','VLESS\x20connection\x20to\x20','nextSeq','lastActivity','push','pathname','existsSync','7160b696-dd5e-42e3-a024-145e92cec916','reduce','parse\x20hostname\x20failed','info','includes','arch','initializeVLESS','concat','CFPORT','CFIP','\x27\x20not\x20found','/([^/]+)(?:/([0-9]+))?$','MY_DOMAIN','vless://','\x1b[0m','_startDownstreamResponse','statusMessage','TIME','LOG_LEVEL','constructor','ip.sb','method','kill\x20-9\x20','filePath','responseHeader','application/octet-stream','isDirectory','currentStreamRes','Created\x20new\x20session\x20for\x20POST:\x20','Connection\x20failed:\x20','KEEPALIVE','Buffered\x20packet\x20seq=','XPATH','HTTP\x20error!\x20status:\x20','decode','code','app','fileUrl','8443','socket','bufferedData','Client\x20connection\x20closed','catch','amd','SESSION_TIMEOUT','setNoDelay','pipeTo','16009abNjxp','NEZHA_PORT','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','clear','Failed\x20to\x20parse\x20hostname','\x22\x20\x27$2\x20==\x20name\x20{print\x20$1}\x27','Upload\x20failed:','?encryption=none&security=none&sni=','Processing\x20packet:\x20seq=','Failed\x20to\x20initialize\x20VLESS\x20connection','FILE_PATH','\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20','error','Failed\x20to\x20initialize\x20VLESS:\x20','has','writeFileSync','cleanup','Failed\x20to\x20process\x20POST\x20request:\x20','writableEnded','true','initialized','toString','name','end','keepAliveTimeout','base64','all','&mode=packet-up#','Cleaning\x20up\x20session\x20','upload\x20failed:','ps\x20-eo\x20pid,comm\x20|\x20awk\x20-v\x20name=\x22','destroyed','toISOString','read','/config.yml\x20>/dev/null\x202>&1\x20&','Created\x20new\x20session\x20for\x20GET:\x20','Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture','pendingPackets','609156OpGbhm','axios','2096','Hello,\x20World\x0a','pipe','Read\x20controller\x20close\x20error:','1483200aeZCsE','uncork','replace','utf8','New\x20secure\x20connection\x20using:\x20','readable','data','read\x20address\x20type\x20failed','hostname','downstreamStarted','\x1b[36m','\x20-c\x20','invalid\x20UUID','reset',']\x20[','floor','Process\x20\x27','?encryption=none&security=tls&sni=','url','stringify','127.0.0.1','writeHead'];_0x4c66=function(){return _0x1b92e6;};return _0x4c66();}const FILE_PATH=process[_0x332f99(0x154)][_0x332f99(0x1a7)]||_0x332f99(0x153),intervalInseconds=process['env'][_0x332f99(0x17f)]||0x64,PORT=process[_0x332f99(0x154)][_0x332f99(0x15a)]||0xbb8,CFPORT=process[_0x332f99(0x154)][_0x332f99(0x176)]||0x1bb,CFIP=process[_0x332f99(0x154)][_0x332f99(0x177)]||_0x332f99(0x182),KEEPALIVE=process['env'][_0x332f99(0x18c)]||![],SUB_URL=process[_0x332f99(0x154)][_0x332f99(0x1fc)]||'',UUID=process[_0x332f99(0x154)]['UUID']||_0x332f99(0x16e),XPATH=process[_0x332f99(0x154)][_0x332f99(0x18e)]||UUID[_0x332f99(0x147)](0x0,0x8),HTTPSTLS=process[_0x332f99(0x154)][_0x332f99(0x20b)]||!![],NEZHA_VERSION=process['env'][_0x332f99(0x200)]||'V0',NEZHA_SERVER=process[_0x332f99(0x154)][_0x332f99(0x151)]||'',NEZHA_PORT=process['env'][_0x332f99(0x19e)]||'443',NEZHA_KEY=process['env'][_0x332f99(0x1fe)]||'',SUB_NAME=process[_0x332f99(0x154)]['SUB_NAME']||'',MY_DOMAIN=process[_0x332f99(0x154)][_0x332f99(0x17a)]||'',LOCAL_DOMAIN=process[_0x332f99(0x154)][_0x332f99(0x211)]||'',os=require('os'),fs=require('fs'),net=require(_0x332f99(0x156)),path=require('path'),http=require('http'),https=require(_0x332f99(0x146)),axios=require(_0x332f99(0x1c4)),{pipeline}=require(_0x332f99(0x23a)),{Buffer}=require('buffer'),{exec,execSync}=require('child_process'),delay=_0x186f83=>new Promise(_0x50592d=>setTimeout(_0x50592d,_0x186f83)),SETTINGS={[_0x332f99(0x232)]:UUID,[_0x332f99(0x180)]:'none',['BUFFER_SIZE']:'2048',[_0x332f99(0x18e)]:'%2F'+XPATH,[_0x332f99(0x252)]:0x1e,['MAX_POST_SIZE']:0xf4240,[_0x332f99(0x19a)]:0x7530,['CHUNK_SIZE']:0x400*0x400,['TCP_NODELAY']:!![],[_0x332f99(0x13e)]:!![]};function validate_uuid(_0xfbaf48,_0x349d7b){for(let _0x3abb54=0x0;_0x3abb54<0x10;_0x3abb54++){if(_0xfbaf48[_0x3abb54]!==_0x349d7b[_0x3abb54])return![];}return!![];}function concat_typed_arrays(_0x4bfda3,..._0x9c49e6){const _0x26f232=_0x332f99;if(!_0x9c49e6||_0x9c49e6[_0x26f232(0x1e2)]<0x1)return _0x4bfda3;let _0x351463=_0x4bfda3[_0x26f232(0x1e2)];for(let _0x259ca0 of _0x9c49e6)_0x351463+=_0x259ca0[_0x26f232(0x1e2)];const _0x20d008=new _0x4bfda3[(_0x26f232(0x181))](_0x351463);_0x20d008[_0x26f232(0x14e)](_0x4bfda3,0x0),_0x351463=_0x4bfda3[_0x26f232(0x1e2)];for(let _0x327d22 of _0x9c49e6){_0x20d008['set'](_0x327d22,_0x351463),_0x351463+=_0x327d22[_0x26f232(0x1e2)];}return _0x20d008;}function log(_0x4238ce,..._0x2e398e){const _0x532d7b=_0x332f99;if(SETTINGS[_0x532d7b(0x180)]===_0x532d7b(0x247))return;const _0x1fd356={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x42aa5={'debug':_0x532d7b(0x1d3),'info':'\x1b[32m','warn':'\x1b[33m','error':_0x532d7b(0x219),'reset':_0x532d7b(0x17c)},_0x38a5c4=_0x1fd356[SETTINGS['LOG_LEVEL']]||0x1,_0x142b78=_0x1fd356[_0x4238ce]||0x0;if(_0x142b78>=_0x38a5c4){const _0x45eab8=new Date()[_0x532d7b(0x1bd)](),_0xd6c4fe=_0x42aa5[_0x4238ce]||_0x42aa5['reset'];console[_0x532d7b(0x1eb)](_0xd6c4fe+'['+_0x45eab8+_0x532d7b(0x1d7)+_0x4238ce+']',..._0x2e398e,_0x42aa5[_0x532d7b(0x1d6)]);}}function cleanupOldFiles(){const _0x275dfa=_0x332f99;try{if(fs[_0x275dfa(0x16d)](path[_0x275dfa(0x1e4)](FILE_PATH)))fs[_0x275dfa(0x1f6)](path['join'](FILE_PATH),{'recursive':!![]});else{}}catch(_0x20738b){}}function createFolder(_0x1b6f0d){const _0x34b933=_0x332f99;if(!fs['existsSync'](_0x1b6f0d))fs[_0x34b933(0x166)](_0x1b6f0d);else{}}function execPromise(_0x401ce0,_0x5db3ca={}){return new Promise((_0x526f78,_0x38394a)=>{const _0x1d86b0=exec(_0x401ce0,_0x5db3ca,(_0x1ea79a,_0x290780,_0x465a33)=>{const _0x20b628=_0x4dde;if(_0x1ea79a){const _0x3d678e=new Error('Command\x20failed:\x20'+_0x1ea79a['message']);_0x3d678e[_0x20b628(0x191)]=_0x1ea79a[_0x20b628(0x191)],_0x3d678e[_0x20b628(0x1ff)]=_0x465a33[_0x20b628(0x21c)](),_0x38394a(_0x3d678e);}else _0x526f78(_0x290780[_0x20b628(0x21c)]());});});}async function detectProcess(_0x54cf73){const _0x5d594d=_0x332f99,_0x462fb6=[{'cmd':'pidof\x20\x22'+_0x54cf73+'\x22','name':'pidof'},{'cmd':_0x5d594d(0x238)+_0x54cf73+'\x22','name':_0x5d594d(0x1e0)},{'cmd':_0x5d594d(0x1bb)+_0x54cf73+_0x5d594d(0x1a2),'name':'ps+awk'}];for(const _0x4d02aa of _0x462fb6){try{const _0xb20766=await execPromise(_0x4d02aa['cmd']);if(_0xb20766)return _0xb20766[_0x5d594d(0x1cb)](/\n/g,'\x20')[_0x5d594d(0x21c)]();}catch(_0xee0a92){_0xee0a92[_0x5d594d(0x191)]!==0x7f&&_0xee0a92[_0x5d594d(0x191)]!==0x1&&console[_0x5d594d(0x1f0)]('[detectProcess]\x20'+_0x4d02aa[_0x5d594d(0x1b3)]+_0x5d594d(0x208),_0xee0a92[_0x5d594d(0x142)]);}}return'';}async function killProcess(_0x49126f){const _0x4f2e86=_0x332f99;console[_0x4f2e86(0x1eb)]('Attempting\x20to\x20kill\x20process:\x20'+_0x49126f);try{const _0x23897c=await detectProcess(_0x49126f);if(!_0x23897c)return console[_0x4f2e86(0x15f)](_0x4f2e86(0x1d9)+_0x49126f+_0x4f2e86(0x178)),{'success':!![],'message':'Process\x20not\x20found'};await execPromise(_0x4f2e86(0x184)+_0x23897c);const _0x8b6080=_0x4f2e86(0x1df)+_0x23897c+')';return console[_0x4f2e86(0x1eb)](_0x8b6080),{'success':!![],'message':_0x8b6080};}catch(_0xa27152){const _0x38d628=_0x4f2e86(0x21d)+_0xa27152['message'];return console[_0x4f2e86(0x1a9)](_0x38d628),{'success':![],'message':_0x38d628};}}function generateRandomString(_0x2ed2b8){const _0x23aa7d=_0x332f99,_0x59c0dd=_0x23aa7d(0x19f);let _0x1c08b='';for(let _0x470fce=0x0;_0x470fce<_0x2ed2b8;_0x470fce++){_0x1c08b+=_0x59c0dd[_0x23aa7d(0x1e1)](Math['floor'](Math['random']()*_0x59c0dd['length']));}return _0x1c08b;}function getSystemArchitecture(){const _0xca5088=_0x332f99,_0x11ac54=os[_0xca5088(0x173)]();return _0x11ac54==='arm'||_0x11ac54===_0xca5088(0x22c)||_0x11ac54===_0xca5088(0x15c)?'arm':_0xca5088(0x199);}function getFilesForArchitecture(_0x4e6d4a){const _0x4480ec=_0x332f99,_0x43570e={'app':{'V0':{'arm':_0x4480ec(0x249),'amd':'https://github.com/kahunama/myfile/releases/download/main/nezha-agent'},'V1':{'arm':'https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','amd':_0x4480ec(0x1ec)}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0xf52ee2=[{'fileName':'tmp'+generateRandomString(0x5),'originalName':'app','fileUrl':_0x43570e[_0x4480ec(0x192)][NEZHA_VERSION][_0x4e6d4a]}];return _0xf52ee2;}else return[];}async function download_function(_0x4510ec,_0x2617d8,_0x16b46f){const _0x2ce779=_0x332f99,_0x3e8454=path[_0x2ce779(0x1e4)](FILE_PATH,_0x4510ec);let _0x28c5cc=![];try{const _0x49eb37=await axios({'method':_0x2ce779(0x20d),'url':_0x16b46f,'responseType':'stream'});await pipeline(_0x49eb37[_0x2ce779(0x1cf)],fs[_0x2ce779(0x23c)](_0x3e8454)),_0x28c5cc=!![];}catch(_0x3ce532){}return{'fileName':_0x4510ec,'originalName':_0x2617d8,'filePath':_0x3e8454,'success':_0x28c5cc};}let fileMapping={};function _0x4dde(_0x2cc3e6,_0x5c3bd4){const _0x4c669c=_0x4c66();return _0x4dde=function(_0x4ddef0,_0x575e5c){_0x4ddef0=_0x4ddef0-0x13e;let _0x283ec4=_0x4c669c[_0x4ddef0];return _0x283ec4;},_0x4dde(_0x2cc3e6,_0x5c3bd4);}async function downloadFiles(){const _0xf3992b=_0x332f99;try{const _0x30086c=getSystemArchitecture();if(!_0x30086c)return console['log'](_0xf3992b(0x240)),fileMapping;const _0x558fe5=getFilesForArchitecture(_0x30086c);if(_0x558fe5['length']===0x0)return console[_0xf3992b(0x1eb)](_0xf3992b(0x1c1)),fileMapping;const _0x279414=_0x558fe5['map'](_0x4c7e0f=>download_function(_0x4c7e0f[_0xf3992b(0x1e9)],_0x4c7e0f[_0xf3992b(0x1fb)],_0x4c7e0f[_0xf3992b(0x193)])),_0x451ede=await Promise[_0xf3992b(0x1b7)](_0x279414);return _0x451ede['forEach'](_0x58a24c=>{const _0x11cb2f=_0xf3992b;if(_0x58a24c['success'])try{fs[_0x11cb2f(0x225)](_0x58a24c[_0x11cb2f(0x185)],0x1ed),fileMapping[_0x58a24c[_0x11cb2f(0x1fb)]]=_0x58a24c[_0x11cb2f(0x1e9)];}catch(_0x1ce2fd){}}),fileMapping;}catch(_0x5921f3){return console['error'](_0xf3992b(0x1ee),_0x5921f3),fileMapping;}}let NEZHA_TLS;function nezconfig(){const _0x4e263d=_0x332f99,_0x2c3e17=[_0x4e263d(0x224),_0x4e263d(0x194),_0x4e263d(0x1c5),'2087',_0x4e263d(0x24d),'2053'];if(NEZHA_VERSION==='V0')return _0x2c3e17[_0x4e263d(0x172)](NEZHA_PORT)?NEZHA_TLS=_0x4e263d(0x241):NEZHA_TLS='',NEZHA_TLS;else{if(NEZHA_VERSION==='V1'){_0x2c3e17[_0x4e263d(0x172)](NEZHA_PORT)?NEZHA_TLS=_0x4e263d(0x1b0):NEZHA_TLS='false';const _0x1c5666=path[_0x4e263d(0x1e4)](FILE_PATH,_0x4e263d(0x1e3)),_0x1fa371=_0x4e263d(0x248)+NEZHA_KEY+_0x4e263d(0x215)+NEZHA_SERVER+':'+NEZHA_PORT+_0x4e263d(0x1a8)+NEZHA_TLS+_0x4e263d(0x163)+UUID;try{fs[_0x4e263d(0x1ac)](_0x1c5666,_0x1fa371);}catch(_0x3b1d3b){}}}}async function runapp(){const _0x4bbe47=_0x332f99;if(fileMapping['app']&&fs['existsSync'](path[_0x4bbe47(0x1e4)](FILE_PATH,fileMapping[_0x4bbe47(0x192)]))){if(NEZHA_VERSION==='V0'){const _0x441cc5=_0x4bbe47(0x1f7)+FILE_PATH+'/'+fileMapping[_0x4bbe47(0x192)]+_0x4bbe47(0x209)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+NEZHA_TLS+_0x4bbe47(0x152);try{await execPromise(_0x441cc5);}catch(_0x67373c){console[_0x4bbe47(0x1a9)](fileMapping[_0x4bbe47(0x192)]+'\x20running\x20error:\x20'+_0x67373c);}}else{if(NEZHA_VERSION==='V1'){const _0x37558f=_0x4bbe47(0x1f7)+FILE_PATH+'/'+fileMapping[_0x4bbe47(0x192)]+_0x4bbe47(0x1d4)+FILE_PATH+_0x4bbe47(0x1bf);try{await execPromise(_0x37558f);}catch(_0x182c70){console[_0x4bbe47(0x1a9)](fileMapping['app']+_0x4bbe47(0x210)+_0x182c70);}}}}else console[_0x4bbe47(0x1eb)]('app\x20file\x20not\x20found,\x20skip\x20running');}async function run(){const _0x1c94c=_0x332f99;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){nezconfig();const _0x229712=await detectProcess(''+fileMapping['app']);if(_0x229712){}else await runapp();await delay(0x3e8);}else console[_0x1c94c(0x1eb)](_0x1c94c(0x202));}async function keep_alive(){const _0x2c8631=_0x332f99;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x3593b1=await detectProcess(''+fileMapping[_0x2c8631(0x192)]);if(_0x3593b1){}else await runapp();}}function parse_uuid(_0x568232){const _0x43b300=_0x332f99;_0x568232=_0x568232['replaceAll']('-','');const _0x29e20c=[];for(let _0x5493ef=0x0;_0x5493ef<0x10;_0x5493ef++){_0x29e20c[_0x43b300(0x16b)](parseInt(_0x568232[_0x43b300(0x245)](_0x5493ef*0x2,0x2),0x10));}return _0x29e20c;}async function read_vless_header(_0x4f431a,_0x2dc9f1){const _0x177441=_0x332f99;let _0x295d6e=0x0,_0x23b714=new Uint8Array(),_0x4fdd18={'value':_0x23b714,'done':![]};async function _0x5d5b15(_0x5263e5){const _0x5cc239=_0x4dde;if(_0x4fdd18[_0x5cc239(0x1e5)])throw new Error(_0x5cc239(0x242));const _0x13ae48=_0x5263e5-_0x295d6e;if(_0x13ae48<0x1)return;_0x4fdd18=await read_atleast(_0x4f431a,_0x13ae48),_0x295d6e+=_0x4fdd18[_0x5cc239(0x237)]['length'],_0x23b714=concat_typed_arrays(_0x23b714,_0x4fdd18['value']);}await _0x5d5b15(0x1+0x10+0x1);const _0x1e88fd=_0x23b714[0x0],_0x4ae23c=_0x23b714[_0x177441(0x147)](0x1,0x1+0x10),_0x4923de=parse_uuid(_0x2dc9f1);if(!validate_uuid(_0x4ae23c,_0x4923de))throw new Error(_0x177441(0x1d5));const _0x15c3a1=_0x23b714[0x1+0x10],_0x40aeb4=0x1+0x10+0x1+_0x15c3a1+0x1+0x2+0x1;await _0x5d5b15(_0x40aeb4+0x1);const _0xc6de76=_0x23b714[0x1+0x10+0x1+_0x15c3a1],_0x4ac7c0=0x1;if(_0xc6de76!==_0x4ac7c0)throw new Error('unsupported\x20command:\x20'+_0xc6de76);const _0x404019=(_0x23b714[_0x40aeb4-0x1-0x2]<<0x8)+_0x23b714[_0x40aeb4-0x1-0x1],_0x4251dc=_0x23b714[_0x40aeb4-0x1],_0x533c84=0x1,_0xf785f4=0x2,_0x463b17=0x3;let _0xc027ac=-0x1;if(_0x4251dc===_0x533c84)_0xc027ac=_0x40aeb4+0x4;else{if(_0x4251dc===_0x463b17)_0xc027ac=_0x40aeb4+0x10;else _0x4251dc===_0xf785f4&&(_0xc027ac=_0x40aeb4+0x1+_0x23b714[_0x40aeb4]);}if(_0xc027ac<0x0)throw new Error(_0x177441(0x1d0));await _0x5d5b15(_0xc027ac);const _0x4fcdd6=_0x40aeb4;let _0x134791='';if(_0x4251dc===_0x533c84)_0x134791=_0x23b714[_0x177441(0x147)](_0x4fcdd6,_0x4fcdd6+0x4)[_0x177441(0x1e4)]('.');else{if(_0x4251dc===_0xf785f4)_0x134791=new TextDecoder()[_0x177441(0x190)](_0x23b714[_0x177441(0x147)](_0x4fcdd6+0x1,_0x4fcdd6+0x1+_0x23b714[_0x4fcdd6]));else _0x4251dc===_0x463b17&&(_0x134791=_0x23b714[_0x177441(0x147)](_0x4fcdd6,_0x4fcdd6+0x10)[_0x177441(0x16f)]((_0x486b34,_0x23e8b3,_0x3798f0,_0x4d947d)=>_0x3798f0%0x2?_0x486b34[_0x177441(0x175)](((_0x4d947d[_0x3798f0-0x1]<<0x8)+_0x23e8b3)[_0x177441(0x1b2)](0x10)):_0x486b34,[])[_0x177441(0x1e4)](':'));}if(!_0x134791){log(_0x177441(0x1a9),_0x177441(0x1a1));throw new Error(_0x177441(0x170));}return log(_0x177441(0x171),_0x177441(0x168)+_0x134791+':'+_0x404019),{'hostname':_0x134791,'port':_0x404019,'data':_0x23b714[_0x177441(0x147)](_0xc027ac),'resp':new Uint8Array([_0x1e88fd,0x0])};}async function read_atleast(_0x27f031,_0x160b77){const _0x4d4143=_0x332f99,_0x3dd26d=[];let _0x5ba64e=![];while(_0x160b77>0x0&&!_0x5ba64e){const _0x1efd57=await _0x27f031[_0x4d4143(0x1be)]();if(_0x1efd57[_0x4d4143(0x237)]){const _0x32fbbc=new Uint8Array(_0x1efd57[_0x4d4143(0x237)]);_0x3dd26d['push'](_0x32fbbc),_0x160b77-=_0x32fbbc[_0x4d4143(0x1e2)];}_0x5ba64e=_0x1efd57[_0x4d4143(0x1e5)];}if(_0x160b77>0x0)throw new Error(_0x4d4143(0x243));return{'value':concat_typed_arrays(..._0x3dd26d),'done':_0x5ba64e};}async function parse_header(_0x3a59b2,_0x5ac085){const _0x37bfe6=_0x332f99;log(_0x37bfe6(0x1f0),_0x37bfe6(0x213));const _0x21b04c=_0x5ac085[_0x37bfe6(0x1ce)]['getReader']();try{const _0x618d21=await read_vless_header(_0x21b04c,_0x3a59b2);return log('debug',_0x37bfe6(0x14d)),_0x618d21;}catch(_0x32db73){log(_0x37bfe6(0x1a9),_0x37bfe6(0x15d)+_0x32db73['message']);throw new Error('read\x20vless\x20header\x20error:\x20'+_0x32db73[_0x37bfe6(0x142)]);}finally{_0x21b04c['releaseLock']();}}async function connect_remote(_0x26984f,_0x4332b9){const _0x6fca1c=_0x332f99,_0x584eb2=0x1f40;try{const _0x501db7=await timed_connect(_0x26984f,_0x4332b9,_0x584eb2);return _0x501db7['setNoDelay'](!![]),_0x501db7[_0x6fca1c(0x22a)](!![],0x3e8),_0x501db7[_0x6fca1c(0x20e)]=parseInt(SETTINGS['BUFFER_SIZE'])*0x400,log(_0x6fca1c(0x171),_0x6fca1c(0x228)+_0x26984f+':'+_0x4332b9),_0x501db7;}catch(_0x5ed5bd){log(_0x6fca1c(0x1a9),_0x6fca1c(0x18b)+_0x5ed5bd[_0x6fca1c(0x142)]);throw _0x5ed5bd;}}function timed_connect(_0x36fa44,_0xd0d313,_0x303bc4){return new Promise((_0x6d2b,_0x4a5fdd)=>{const _0x200125=_0x4dde,_0x473b80=net[_0x200125(0x22b)]({'host':_0x36fa44,'port':_0xd0d313}),_0x3835cb=setTimeout(()=>{_0x4a5fdd(new Error('connect\x20timeout'));},_0x303bc4);_0x473b80['on'](_0x200125(0x1f5),()=>{clearTimeout(_0x3835cb),_0x6d2b(_0x473b80);}),_0x473b80['on'](_0x200125(0x1a9),_0x371e78=>{clearTimeout(_0x3835cb),_0x4a5fdd(_0x371e78);});});}function pipe_relay(){async function _0x34cca1(_0xff8d10,_0x5388f2,_0x2264fe){const _0x453d13=_0x4dde,_0x280f6f=parseInt(SETTINGS[_0x453d13(0x1f2)]);if(_0x2264fe[_0x453d13(0x1e2)]>0x0){if(_0x5388f2['write'])_0x5388f2[_0x453d13(0x140)](),_0x5388f2['write'](_0x2264fe),process['nextTick'](()=>_0x5388f2[_0x453d13(0x1ca)]());else{const _0x2510ce=_0x5388f2[_0x453d13(0x20a)][_0x453d13(0x23e)]();try{await _0x2510ce[_0x453d13(0x204)](_0x2264fe);}finally{_0x2510ce[_0x453d13(0x22e)]();}}}try{_0xff8d10['pipe']?(_0xff8d10[_0x453d13(0x21a)](),_0xff8d10[_0x453d13(0x1c7)](_0x5388f2,{'end':!![],'highWaterMark':_0x280f6f}),_0xff8d10[_0x453d13(0x1e8)]()):await _0xff8d10[_0x453d13(0x1ce)][_0x453d13(0x19c)](_0x5388f2[_0x453d13(0x20a)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x453d13(0x222)](SETTINGS[_0x453d13(0x19a)])});}catch(_0x2915d5){!_0x2915d5[_0x453d13(0x142)][_0x453d13(0x172)](_0x453d13(0x207))&&log(_0x453d13(0x1a9),_0x453d13(0x157),_0x2915d5[_0x453d13(0x142)]);throw _0x2915d5;}}return _0x34cca1;}function socketToWebStream(_0x5759cf){const _0x2dddc4=_0x332f99;let _0x4dc34f,_0x11778d;return _0x5759cf['on'](_0x2dddc4(0x1a9),_0x2157d9=>{const _0x35146a=_0x2dddc4;log(_0x35146a(0x1a9),_0x35146a(0x236),_0x2157d9[_0x35146a(0x142)]),_0x4dc34f?.[_0x35146a(0x1a9)](_0x2157d9),_0x11778d?.['error'](_0x2157d9);}),{'readable':new ReadableStream({'start'(_0x144d40){_0x4dc34f=_0x144d40,_0x5759cf['on']('data',_0x527143=>{const _0x10b228=_0x4dde;try{_0x144d40['enqueue'](_0x527143);}catch(_0x1526a9){log('error','Read\x20controller\x20error:',_0x1526a9[_0x10b228(0x142)]);}}),_0x5759cf['on']('end',()=>{const _0x529584=_0x4dde;try{_0x144d40[_0x529584(0x150)]();}catch(_0x28a38b){log('error',_0x529584(0x1c8),_0x28a38b[_0x529584(0x142)]);}});},'cancel'(){const _0x8ec55c=_0x2dddc4;_0x5759cf[_0x8ec55c(0x144)]();}}),'writable':new WritableStream({'start'(_0x26cf03){_0x11778d=_0x26cf03;},'write'(_0x308cfd){return new Promise((_0x2eb835,_0x2c7eb9)=>{const _0x137a19=_0x4dde;if(_0x5759cf[_0x137a19(0x1bc)]){_0x2c7eb9(new Error(_0x137a19(0x1f9)));return;}_0x5759cf[_0x137a19(0x204)](_0x308cfd,_0x568cbc=>{if(_0x568cbc)_0x2c7eb9(_0x568cbc);else _0x2eb835();});});},'close'(){const _0x5c96ed=_0x2dddc4;!_0x5759cf[_0x5c96ed(0x1bc)]&&_0x5759cf['end']();},'abort'(_0x55e0ae){_0x5759cf['destroy'](_0x55e0ae);}})};}function relay(_0x49f568,_0x25fd0d,_0x51ea70,_0x4b810a){const _0x44ae32=_0x332f99,_0xedc5f7=pipe_relay();let _0x49333f=![];const _0x14fb0e=socketToWebStream(_0x51ea70);function _0xd9aeaa(){const _0x212931=_0x4dde;if(!_0x49333f){_0x49333f=!![];try{_0x51ea70[_0x212931(0x144)]();}catch(_0x56efcb){!_0x56efcb[_0x212931(0x142)][_0x212931(0x172)](_0x212931(0x207))&&!_0x56efcb[_0x212931(0x142)]['includes'](_0x212931(0x1f4))&&log('error',_0x212931(0x24e)+_0x56efcb[_0x212931(0x142)]);}}}const _0x566762=_0xedc5f7(_0x25fd0d,_0x14fb0e,_0x4b810a[_0x44ae32(0x1cf)])[_0x44ae32(0x198)](_0x3543af=>{const _0x5a35dc=_0x44ae32;!_0x3543af[_0x5a35dc(0x142)]['includes'](_0x5a35dc(0x207))&&!_0x3543af[_0x5a35dc(0x142)][_0x5a35dc(0x172)](_0x5a35dc(0x1f4))&&log(_0x5a35dc(0x1a9),_0x5a35dc(0x205)+_0x3543af['message']);})[_0x44ae32(0x221)](()=>{const _0x4b8a3e=_0x44ae32;_0x25fd0d['reading_done']&&_0x25fd0d[_0x4b8a3e(0x20f)]();}),_0x2caaf0=_0xedc5f7(_0x14fb0e,_0x25fd0d,_0x4b810a[_0x44ae32(0x214)])['catch'](_0x53c039=>{const _0x587914=_0x44ae32;!_0x53c039[_0x587914(0x142)][_0x587914(0x172)](_0x587914(0x207))&&!_0x53c039['message'][_0x587914(0x172)]('socket\x20hang\x20up')&&log(_0x587914(0x1a9),_0x587914(0x231)+_0x53c039[_0x587914(0x142)]);});_0x2caaf0[_0x44ae32(0x221)](()=>_0x566762)['finally'](_0xd9aeaa);}const sessions=new Map();class Session{constructor(_0x14c057){const _0x19d345=_0x332f99;this[_0x19d345(0x15e)]=_0x14c057,this[_0x19d345(0x169)]=0x0,this[_0x19d345(0x1d2)]=![],this[_0x19d345(0x16a)]=Date[_0x19d345(0x233)](),this[_0x19d345(0x21e)]=null,this['remote']=null,this['initialized']=![],this[_0x19d345(0x186)]=null,this[_0x19d345(0x159)]=![],this[_0x19d345(0x196)]=new Map(),this[_0x19d345(0x155)]=![],this[_0x19d345(0x1c2)]=[],this[_0x19d345(0x189)]=null,this[_0x19d345(0x244)]=new Map(),log(_0x19d345(0x1f0),'Created\x20new\x20session\x20with\x20UUID:\x20'+_0x14c057);}async[_0x332f99(0x174)](_0x12f48f){const _0x4afcbb=_0x332f99;if(this['initialized'])return!![];try{log(_0x4afcbb(0x1f0),'Initializing\x20VLESS\x20connection\x20from\x20first\x20packet');const _0x118067=new ReadableStream({'start'(_0x4bce72){_0x4bce72['enqueue'](_0x12f48f),_0x4bce72['close']();}}),_0xadc5fd={'readable':_0x118067,'writable':new WritableStream()};return this['vlessHeader']=await parse_header(SETTINGS[_0x4afcbb(0x232)],_0xadc5fd),log('info',_0x4afcbb(0x1ed)+this[_0x4afcbb(0x21e)][_0x4afcbb(0x1d1)]+':'+this['vlessHeader'][_0x4afcbb(0x218)]),this[_0x4afcbb(0x149)]=await connect_remote(this[_0x4afcbb(0x21e)][_0x4afcbb(0x1d1)],this[_0x4afcbb(0x21e)]['port']),log(_0x4afcbb(0x171),_0x4afcbb(0x24c)),this['initialized']=!![],!![];}catch(_0x16f60c){return log(_0x4afcbb(0x1a9),_0x4afcbb(0x1aa)+_0x16f60c[_0x4afcbb(0x142)]),![];}}async[_0x332f99(0x160)](_0x2e2891,_0x56d6ff){const _0x4b0fca=_0x332f99;try{this[_0x4b0fca(0x244)][_0x4b0fca(0x14e)](_0x2e2891,_0x56d6ff),log(_0x4b0fca(0x1f0),_0x4b0fca(0x18d)+_0x2e2891+_0x4b0fca(0x164)+_0x56d6ff[_0x4b0fca(0x1e2)]);while(this['pendingBuffers'][_0x4b0fca(0x1ab)](this[_0x4b0fca(0x169)])){const _0x2a9f76=this['pendingBuffers'][_0x4b0fca(0x20d)](this[_0x4b0fca(0x169)]);this[_0x4b0fca(0x244)][_0x4b0fca(0x23d)](this[_0x4b0fca(0x169)]);if(!this[_0x4b0fca(0x1b1)]&&this['nextSeq']===0x0){if(!await this[_0x4b0fca(0x174)](_0x2a9f76))throw new Error(_0x4b0fca(0x1a6));this[_0x4b0fca(0x186)]=Buffer[_0x4b0fca(0x227)](this[_0x4b0fca(0x21e)][_0x4b0fca(0x214)]),await this['_writeToRemote'](this[_0x4b0fca(0x21e)][_0x4b0fca(0x1cf)]),this['currentStreamRes']&&this['_startDownstreamResponse']();}else{if(!this['initialized']){log(_0x4b0fca(0x15f),'Received\x20out\x20of\x20order\x20packet\x20seq='+_0x2e2891+_0x4b0fca(0x15b));continue;}await this[_0x4b0fca(0x229)](_0x2a9f76);}this['nextSeq']++,log(_0x4b0fca(0x1f0),_0x4b0fca(0x165)+(this[_0x4b0fca(0x169)]-0x1));}if(this['pendingBuffers']['size']>SETTINGS[_0x4b0fca(0x252)])throw new Error(_0x4b0fca(0x1f3));return!![];}catch(_0x102da2){log(_0x4b0fca(0x1a9),_0x4b0fca(0x203)+_0x102da2[_0x4b0fca(0x142)]);throw _0x102da2;}}[_0x332f99(0x17d)](){const _0x54c2e6=_0x332f99;if(!this[_0x54c2e6(0x189)]||!this[_0x54c2e6(0x186)])return;try{const _0xed60ac=this[_0x54c2e6(0x189)][_0x54c2e6(0x195)]?.['alpnProtocol']||'http/1.1',_0x4101c3=_0xed60ac==='h2';!this[_0x54c2e6(0x159)]&&(log(_0x54c2e6(0x1f0),_0x54c2e6(0x230)+_0xed60ac+_0x54c2e6(0x148)+this[_0x54c2e6(0x186)][_0x54c2e6(0x1e2)]+_0x54c2e6(0x201)),this[_0x54c2e6(0x189)][_0x54c2e6(0x204)](this[_0x54c2e6(0x186)]),this['headerSent']=!![]);if(_0x4101c3){this[_0x54c2e6(0x189)][_0x54c2e6(0x195)][_0x54c2e6(0x19b)](!![]);const _0x4325ae=new require(_0x54c2e6(0x226))[_0x54c2e6(0x21b)]({'transform'(_0x3b29ce,_0x14b724,_0x56181c){const _0x5ddfff=_0x54c2e6,_0x161b29=0x4000;for(let _0x273c6f=0x0;_0x273c6f<_0x3b29ce[_0x5ddfff(0x1e2)];_0x273c6f+=_0x161b29){this['push'](_0x3b29ce[_0x5ddfff(0x147)](_0x273c6f,_0x273c6f+_0x161b29));}_0x56181c();}});this[_0x54c2e6(0x149)][_0x54c2e6(0x1c7)](_0x4325ae)['pipe'](this[_0x54c2e6(0x189)]);}else this[_0x54c2e6(0x149)][_0x54c2e6(0x1c7)](this['currentStreamRes']);this['remote']['on'](_0x54c2e6(0x1b4),()=>{const _0x403335=_0x54c2e6;!this[_0x403335(0x189)]['writableEnded']&&this[_0x403335(0x189)]['end']();}),this[_0x54c2e6(0x149)]['on'](_0x54c2e6(0x1a9),_0x490a17=>{const _0x1af7b5=_0x54c2e6;log(_0x1af7b5(0x1a9),_0x1af7b5(0x1fd)+_0x490a17['message']),!this[_0x1af7b5(0x189)][_0x1af7b5(0x1af)]&&this[_0x1af7b5(0x189)][_0x1af7b5(0x1b4)]();});}catch(_0x2b70e0){log('error','Error\x20starting\x20downstream:\x20'+_0x2b70e0[_0x54c2e6(0x142)]),this[_0x54c2e6(0x1ad)]();}}['startDownstream'](_0xa40a53,_0x3c1db8){const _0x114377=_0x332f99;return!_0xa40a53[_0x114377(0x21f)]&&_0xa40a53[_0x114377(0x1de)](0xc8,_0x3c1db8),this[_0x114377(0x189)]=_0xa40a53,this[_0x114377(0x1b1)]&&this[_0x114377(0x186)]&&this[_0x114377(0x17d)](),_0xa40a53['on']('close',()=>{const _0x53dfd8=_0x114377;log(_0x53dfd8(0x171),_0x53dfd8(0x197)),this[_0x53dfd8(0x1ad)]();}),!![];}async[_0x332f99(0x229)](_0x5815db){const _0x50f900=_0x332f99;if(!this[_0x50f900(0x149)]||this[_0x50f900(0x149)][_0x50f900(0x1bc)])throw new Error(_0x50f900(0x239));return new Promise((_0x37372c,_0x55bb1c)=>{const _0x10cb7c=_0x50f900;this[_0x10cb7c(0x149)][_0x10cb7c(0x204)](_0x5815db,_0x2de042=>{const _0x1d1c08=_0x10cb7c;_0x2de042?(log(_0x1d1c08(0x1a9),_0x1d1c08(0x220)+_0x2de042[_0x1d1c08(0x142)]),_0x55bb1c(_0x2de042)):_0x37372c();});});}[_0x332f99(0x17d)](){const _0x5640e9=_0x332f99;if(!this['currentStreamRes']||!this[_0x5640e9(0x186)])return;try{!this[_0x5640e9(0x159)]&&(this[_0x5640e9(0x189)][_0x5640e9(0x204)](this[_0x5640e9(0x186)]),this['headerSent']=!![]),this[_0x5640e9(0x149)]['pipe'](this[_0x5640e9(0x189)]),this['remote']['on'](_0x5640e9(0x1b4),()=>{const _0x569710=_0x5640e9;!this[_0x569710(0x189)][_0x569710(0x1af)]&&this[_0x569710(0x189)][_0x569710(0x1b4)]();}),this['remote']['on']('error',_0x3e69f6=>{const _0x13eacc=_0x5640e9;log(_0x13eacc(0x1a9),_0x13eacc(0x1fd)+_0x3e69f6[_0x13eacc(0x142)]),!this[_0x13eacc(0x189)][_0x13eacc(0x1af)]&&this[_0x13eacc(0x189)][_0x13eacc(0x1b4)]();});}catch(_0x3c7d21){log(_0x5640e9(0x1a9),_0x5640e9(0x217)+_0x3c7d21[_0x5640e9(0x142)]),this[_0x5640e9(0x1ad)]();}}[_0x332f99(0x1ad)](){const _0x54371d=_0x332f99;!this['cleaned']&&(this[_0x54371d(0x155)]=!![],log(_0x54371d(0x1f0),_0x54371d(0x1b9)+this[_0x54371d(0x15e)]),this[_0x54371d(0x149)]&&(this[_0x54371d(0x149)][_0x54371d(0x144)](),this[_0x54371d(0x149)]=null),this['initialized']=![],this[_0x54371d(0x159)]=![]);}}let ISP=_0x332f99(0x235);try{const metaInfo=execSync(_0x332f99(0x1e6),{'encoding':_0x332f99(0x216)});ISP=metaInfo['trim']();}catch(_0xd7e2eb){console[_0x332f99(0x1a9)](_0x332f99(0x14c),_0xd7e2eb[_0x332f99(0x142)]);}let IP;if(MY_DOMAIN&&!LOCAL_DOMAIN)IP=MY_DOMAIN;else{if(LOCAL_DOMAIN&&!MY_DOMAIN)IP=LOCAL_DOMAIN;else{if(!MY_DOMAIN&&!LOCAL_DOMAIN){let SERVER_IP=_0x332f99(0x1dd);try{const rawIpInfo=execSync(_0x332f99(0x14f),{'encoding':_0x332f99(0x216)}),metaJson=JSON['parse'](rawIpInfo);SERVER_IP=metaJson['clientIp'];}catch(_0x34e653){console[_0x332f99(0x1a9)]('Error\x20fetching\x20IP\x20info:',_0x34e653[_0x332f99(0x142)]);}SERVER_IP[_0x332f99(0x172)](':')?IP='['+SERVER_IP+']':IP=''+SERVER_IP;}}}let UPLOAD_DATA;if(HTTPSTLS===!![])UPLOAD_DATA=_0x332f99(0x17b)+UUID+'@'+CFIP+':'+CFPORT+_0x332f99(0x1da)+IP+'&fp=chrome&allowInsecure=1&type=xhttp&host='+IP+_0x332f99(0x22d)+SETTINGS[_0x332f99(0x18e)]+_0x332f99(0x1b8)+ISP+'-'+SUB_NAME;else HTTPSTLS===![]&&(UPLOAD_DATA=_0x332f99(0x17b)+UUID+'@'+IP+':'+PORT+_0x332f99(0x1a4)+IP+_0x332f99(0x24a)+IP+'&path='+SETTINGS['XPATH']+_0x332f99(0x1b8)+ISP+'-'+SUB_NAME);const server=http['createServer']((_0x472d64,_0x428256)=>{const _0x2a47bb=_0x332f99,_0x5445d6={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x2a47bb(0x212),'Cache-Control':_0x2a47bb(0x161),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x472d64[_0x2a47bb(0x1db)]==='/'){_0x428256[_0x2a47bb(0x1de)](0xc8,{'Content-Type':_0x2a47bb(0x162)}),_0x428256[_0x2a47bb(0x1b4)](_0x2a47bb(0x1c6));return;}if(_0x472d64['url']==='/'+UUID){const _0x4afa44=''+UPLOAD_DATA,_0x145dcc=Buffer[_0x2a47bb(0x227)](_0x4afa44)[_0x2a47bb(0x1b2)]('base64');_0x428256[_0x2a47bb(0x1de)](0xc8,{'Content-Type':_0x2a47bb(0x162)}),_0x428256[_0x2a47bb(0x1b4)](_0x145dcc+'\x0a');return;}const _0x5926dd=_0x472d64[_0x2a47bb(0x1db)][_0x2a47bb(0x23f)](new RegExp(XPATH+_0x2a47bb(0x179)));if(!_0x5926dd){_0x428256[_0x2a47bb(0x1de)](0x194),_0x428256['end']();return;}const _0x9d4792=_0x5926dd[0x1],_0x3c5952=_0x5926dd[0x2]?parseInt(_0x5926dd[0x2]):null;if(_0x472d64[_0x2a47bb(0x183)]===_0x2a47bb(0x24f)&&!_0x3c5952){_0x5445d6['Content-Type']=_0x2a47bb(0x187),_0x5445d6[_0x2a47bb(0x145)]='chunked';let _0x2c179c=sessions[_0x2a47bb(0x20d)](_0x9d4792);!_0x2c179c&&(_0x2c179c=new Session(_0x9d4792),sessions[_0x2a47bb(0x14e)](_0x9d4792,_0x2c179c),log(_0x2a47bb(0x171),_0x2a47bb(0x1c0)+_0x9d4792));_0x2c179c[_0x2a47bb(0x1d2)]=!![];!_0x2c179c[_0x2a47bb(0x223)](_0x428256,_0x5445d6)&&(log(_0x2a47bb(0x1a9),_0x2a47bb(0x167)+_0x9d4792),!_0x428256['headersSent']&&(_0x428256['writeHead'](0x1f4),_0x428256[_0x2a47bb(0x1b4)]()),_0x2c179c['cleanup'](),sessions[_0x2a47bb(0x23d)](_0x9d4792));return;}if(_0x472d64[_0x2a47bb(0x183)]==='POST'&&_0x3c5952!==null){let _0x317471=sessions[_0x2a47bb(0x20d)](_0x9d4792);!_0x317471&&(_0x317471=new Session(_0x9d4792),sessions[_0x2a47bb(0x14e)](_0x9d4792,_0x317471),log(_0x2a47bb(0x171),_0x2a47bb(0x18a)+_0x9d4792),setTimeout(()=>{const _0xe40dcc=_0x2a47bb,_0x7eccdb=sessions[_0xe40dcc(0x20d)](_0x9d4792);_0x7eccdb&&!_0x7eccdb[_0xe40dcc(0x1d2)]&&(log('warn',_0xe40dcc(0x141)+_0x9d4792+_0xe40dcc(0x250)),_0x7eccdb[_0xe40dcc(0x1ad)](),sessions[_0xe40dcc(0x23d)](_0x9d4792));},SETTINGS['SESSION_TIMEOUT']));let _0xf19ce7=[],_0x4f9848=0x0,_0x5536ce=![];_0x472d64['on']('data',_0x3f671d=>{const _0x26aff2=_0x2a47bb;_0x4f9848+=_0x3f671d[_0x26aff2(0x1e2)];if(_0x4f9848>SETTINGS[_0x26aff2(0x14b)]){!_0x5536ce&&(_0x428256[_0x26aff2(0x1de)](0x19d),_0x428256[_0x26aff2(0x1b4)](),_0x5536ce=!![]);return;}_0xf19ce7[_0x26aff2(0x16b)](_0x3f671d);}),_0x472d64['on']('end',async()=>{const _0x435d28=_0x2a47bb;if(_0x5536ce)return;try{const _0xc7447d=Buffer[_0x435d28(0x175)](_0xf19ce7);log('info',_0x435d28(0x1a5)+_0x3c5952+_0x435d28(0x164)+_0xc7447d[_0x435d28(0x1e2)]),await _0x317471[_0x435d28(0x160)](_0x3c5952,_0xc7447d),!_0x5536ce&&(_0x428256['writeHead'](0xc8,_0x5445d6),_0x5536ce=!![]),_0x428256[_0x435d28(0x1b4)]();}catch(_0x56795a){log(_0x435d28(0x1a9),_0x435d28(0x1ae)+_0x56795a[_0x435d28(0x142)]),_0x317471[_0x435d28(0x1ad)](),sessions[_0x435d28(0x23d)](_0x9d4792),!_0x5536ce&&(_0x428256[_0x435d28(0x1de)](0x1f4),_0x5536ce=!![]),_0x428256[_0x435d28(0x1b4)]();}});return;}_0x428256[_0x2a47bb(0x1de)](0x194),_0x428256['end']();});server['on'](_0x332f99(0x1fa),_0x10ac5c=>{const _0x484159=_0x332f99;log(_0x484159(0x1f0),_0x484159(0x1cd)+(_0x10ac5c['alpnProtocol']||_0x484159(0x158)));});function generatePadding(_0x1cdce6,_0xc3b40e){const _0x82e02b=_0x332f99,_0x3a7d87=_0x1cdce6+Math[_0x82e02b(0x1d8)](Math[_0x82e02b(0x14a)]()*(_0xc3b40e-_0x1cdce6));return Buffer[_0x82e02b(0x227)](Array(_0x3a7d87)['fill']('X')[_0x82e02b(0x1e4)](''))['toString'](_0x82e02b(0x1b6));}server[_0x332f99(0x1b5)]=0x975e0,server['headersTimeout']=0x98968,server['on'](_0x332f99(0x1a9),_0x54bdc8=>{const _0x5aca39=_0x332f99;log(_0x5aca39(0x1a9),_0x5aca39(0x20c)+_0x54bdc8['message']);});async function uploadSubscription(_0x23b974,_0x395e8f,_0x373736){const _0x18cf49=_0x332f99,_0x44a957=JSON[_0x18cf49(0x1dc)]({'URL_NAME':_0x23b974,'URL':_0x395e8f}),_0x4c2705=Buffer[_0x18cf49(0x227)](_0x44a957,_0x18cf49(0x1cc)),_0x421f1b=_0x4c2705[_0x18cf49(0x1e2)],_0xf4a113=new URL(_0x373736),_0xbb7f90={'hostname':_0xf4a113[_0x18cf49(0x1d1)],'port':_0xf4a113[_0x18cf49(0x218)]||0x1bb,'path':_0xf4a113[_0x18cf49(0x16c)],'method':_0x18cf49(0x1f1),'headers':{'Content-Type':_0x18cf49(0x251),'Content-Length':_0x421f1b}};try{const _0x2c4be5=await new Promise((_0x4dd923,_0x21f1fd)=>{const _0x2e0579=_0x18cf49,_0x4cf87e=https[_0x2e0579(0x234)](_0xbb7f90,_0x5a19d3=>{const _0x278e5f=_0x2e0579;if(_0x5a19d3[_0x278e5f(0x1f8)]<0xc8||_0x5a19d3[_0x278e5f(0x1f8)]>=0x12c)return _0x21f1fd(new Error(_0x278e5f(0x18f)+_0x5a19d3[_0x278e5f(0x1f8)]+_0x278e5f(0x143)+_0x5a19d3[_0x278e5f(0x17e)]));let _0x10b5a7='';_0x5a19d3['on'](_0x278e5f(0x1cf),_0x4d8851=>_0x10b5a7+=_0x4d8851),_0x5a19d3['on'](_0x278e5f(0x1b4),()=>_0x4dd923(_0x10b5a7));});_0x4cf87e['on'](_0x2e0579(0x1a9),_0x538387=>_0x21f1fd(_0x538387)),_0x4cf87e[_0x2e0579(0x204)](_0x4c2705),_0x4cf87e[_0x2e0579(0x1b4)]();});return _0x2c4be5;}catch(_0x150ef6){console[_0x18cf49(0x1a9)](_0x18cf49(0x1a3),_0x150ef6[_0x18cf49(0x142)]);}}function cleanfiles(){setTimeout(()=>{const _0x49fd43=_0x4dde;let _0x182578;KEEPALIVE==!![]?_0x182578=[]:_0x182578=[FILE_PATH+'/'+fileMapping[_0x49fd43(0x192)],FILE_PATH+_0x49fd43(0x1e3)],_0x182578['forEach'](_0x5361f9=>{const _0x1eeb26=_0x49fd43;try{fs['existsSync'](_0x5361f9)&&(fs['lstatSync'](_0x5361f9)[_0x1eeb26(0x188)]()?fs[_0x1eeb26(0x1f6)](_0x5361f9,{'recursive':!![]}):fs['unlinkSync'](_0x5361f9));}catch(_0x32aa87){}}),console[_0x49fd43(0x1a0)](),console['log'](_0x49fd43(0x1ef));},0xea60);}server[_0x332f99(0x206)](PORT,async()=>{const _0x14b88b=_0x332f99;cleanupOldFiles(),createFolder(FILE_PATH);NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&(await downloadFiles(),await delay(0x1388));await run(),cleanfiles(),console[_0x14b88b(0x1eb)](_0x14b88b(0x246)+PORT);if(SUB_URL)try{const _0x1542f9=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0x5b753b){console[_0x14b88b(0x1a9)](_0x14b88b(0x1ba),_0x5b753b);}KEEPALIVE==!![]&&(await keep_alive(),setInterval(keep_alive,intervalInseconds*0x3e8));});