const _0x2f7695=_0x9fc3;(function(_0x390660,_0x39c207){const _0x1d9cd9=_0x9fc3,_0x1cb1b2=_0x390660();while(!![]){try{const _0x2c3ebb=parseInt(_0x1d9cd9(0x2c7))/0x1*(-parseInt(_0x1d9cd9(0x279))/0x2)+parseInt(_0x1d9cd9(0x242))/0x3+parseInt(_0x1d9cd9(0x24b))/0x4*(-parseInt(_0x1d9cd9(0x2ed))/0x5)+parseInt(_0x1d9cd9(0x2ad))/0x6+parseInt(_0x1d9cd9(0x238))/0x7*(-parseInt(_0x1d9cd9(0x2d9))/0x8)+parseInt(_0x1d9cd9(0x289))/0x9+parseInt(_0x1d9cd9(0x2cd))/0xa;if(_0x2c3ebb===_0x39c207)break;else _0x1cb1b2['push'](_0x1cb1b2['shift']());}catch(_0x2bb7b4){_0x1cb1b2['push'](_0x1cb1b2['shift']());}}}(_0x579e,0xec2dc));const FILE_PATH=process[_0x2f7695(0x249)]['FILE_PATH']||_0x2f7695(0x247),intervalInseconds=process[_0x2f7695(0x249)][_0x2f7695(0x2c0)]||0x64,PORT=process['env']['PORT']||0xbb8,CFPORT=process['env']['CFPORT']||0x1bb,CFIP=process[_0x2f7695(0x249)][_0x2f7695(0x288)]||_0x2f7695(0x29a),KEEPALIVE=(process[_0x2f7695(0x249)][_0x2f7695(0x2d0)]||_0x2f7695(0x1f9))===_0x2f7695(0x2b2),SUB_URL=process[_0x2f7695(0x249)]['SUB_URL']||'',UUID=process['env'][_0x2f7695(0x1fb)]||'7160b696-dd5e-42e3-a024-145e92cec916',XPATH=process['env'][_0x2f7695(0x260)]||UUID[_0x2f7695(0x2ef)](0x0,0x8),NEZHA_VERSION=process['env'][_0x2f7695(0x1ec)]||'V0',NEZHA_SERVER=process[_0x2f7695(0x249)][_0x2f7695(0x2d1)]||'',NEZHA_PORT=process[_0x2f7695(0x249)][_0x2f7695(0x225)]||'443',NEZHA_KEY=process['env'][_0x2f7695(0x2e1)]||'',SUB_NAME=process[_0x2f7695(0x249)][_0x2f7695(0x273)]||'',MY_DOMAIN=process['env'][_0x2f7695(0x26f)]||'',LOCAL_DOMAIN=process[_0x2f7695(0x249)][_0x2f7695(0x235)]||'',os=require('os'),fs=require('fs'),net=require(_0x2f7695(0x2a1)),path=require(_0x2f7695(0x255)),http=require('http'),https=require('https'),axios=require(_0x2f7695(0x2ec)),{pipeline}=require(_0x2f7695(0x27c)),{Buffer}=require(_0x2f7695(0x21b)),exec=require(_0x2f7695(0x270))[_0x2f7695(0x215)],delay=_0x425e07=>new Promise(_0x7e7b53=>setTimeout(_0x7e7b53,_0x425e07)),SETTINGS={[_0x2f7695(0x1fb)]:UUID,[_0x2f7695(0x2cf)]:_0x2f7695(0x28a),['BUFFER_SIZE']:_0x2f7695(0x1ef),[_0x2f7695(0x260)]:'%2F'+XPATH,[_0x2f7695(0x295)]:0x1e,[_0x2f7695(0x262)]:0xf4240,[_0x2f7695(0x201)]:0x7530,[_0x2f7695(0x2a2)]:0x400*0x400,[_0x2f7695(0x1f3)]:!![],[_0x2f7695(0x227)]:!![]};function validate_uuid(_0x4ddf43,_0x2564f2){for(let _0x32b340=0x0;_0x32b340<0x10;_0x32b340++){if(_0x4ddf43[_0x32b340]!==_0x2564f2[_0x32b340])return![];}return!![];}function concat_typed_arrays(_0xf335f5,..._0x401735){const _0x26a5a1=_0x2f7695;if(!_0x401735||_0x401735[_0x26a5a1(0x206)]<0x1)return _0xf335f5;let _0x156e15=_0xf335f5[_0x26a5a1(0x206)];for(let _0x410cfd of _0x401735)_0x156e15+=_0x410cfd[_0x26a5a1(0x206)];const _0x238dd3=new _0xf335f5['constructor'](_0x156e15);_0x238dd3[_0x26a5a1(0x229)](_0xf335f5,0x0),_0x156e15=_0xf335f5['length'];for(let _0xfbbb39 of _0x401735){_0x238dd3['set'](_0xfbbb39,_0x156e15),_0x156e15+=_0xfbbb39[_0x26a5a1(0x206)];}return _0x238dd3;}function log(_0x2060d0,..._0x79a4aa){const _0x22296a=_0x2f7695;if(SETTINGS[_0x22296a(0x2cf)]===_0x22296a(0x28a))return;const _0x2d1f6f={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x761f2c={'debug':'\x1b[36m','info':_0x22296a(0x223),'warn':_0x22296a(0x2db),'error':_0x22296a(0x1ed),'reset':_0x22296a(0x2c2)},_0x24b01d=_0x2d1f6f[SETTINGS[_0x22296a(0x2cf)]]||0x1,_0x34172d=_0x2d1f6f[_0x2060d0]||0x0;if(_0x34172d>=_0x24b01d){const _0x1c6e67=new Date()[_0x22296a(0x2c4)](),_0x29e697=_0x761f2c[_0x2060d0]||_0x761f2c[_0x22296a(0x240)];console[_0x22296a(0x2b9)](_0x29e697+'['+_0x1c6e67+_0x22296a(0x292)+_0x2060d0+']',..._0x79a4aa,_0x761f2c[_0x22296a(0x240)]);}}function createFolder(_0x446b4b){const _0x417858=_0x2f7695;try{fs[_0x417858(0x2d5)](_0x446b4b);}catch(_0x9c3a05){if(_0x9c3a05[_0x417858(0x26d)]===_0x417858(0x263))fs[_0x417858(0x22b)](_0x446b4b);else{}}}function execPromise(_0x25746d,_0x386fed={}){return new Promise((_0x4b6d88,_0x41ffd1)=>{const _0x498dde=exec(_0x25746d,_0x386fed,(_0x341ed6,_0x3b4a8e,_0xbe8302)=>{const _0x14cb76=_0x9fc3;if(_0x341ed6){const _0x403c5b=new Error(_0x14cb76(0x267)+_0x341ed6[_0x14cb76(0x256)]);_0x403c5b[_0x14cb76(0x26d)]=_0x341ed6[_0x14cb76(0x26d)],_0x403c5b[_0x14cb76(0x24d)]=_0xbe8302['trim'](),_0x41ffd1(_0x403c5b);}else _0x4b6d88(_0x3b4a8e[_0x14cb76(0x29d)]());});});}async function detectProcess(_0xd93446){const _0xb7c9c1=_0x2f7695,_0x324d5b=[{'cmd':_0xb7c9c1(0x246)+_0xd93446+'\x22','name':_0xb7c9c1(0x2cb)},{'cmd':'pgrep\x20-x\x20\x22'+_0xd93446+'\x22','name':_0xb7c9c1(0x2a5)},{'cmd':'ps\x20-eo\x20pid,comm\x20|\x20awk\x20-v\x20name=\x22'+_0xd93446+_0xb7c9c1(0x211),'name':_0xb7c9c1(0x29c)}];for(const _0x588d78 of _0x324d5b){try{const _0x2892da=await execPromise(_0x588d78[_0xb7c9c1(0x23e)]);if(_0x2892da)return _0x2892da[_0xb7c9c1(0x297)](/\n/g,'\x20')[_0xb7c9c1(0x29d)]();}catch(_0x3f4ebf){_0x3f4ebf[_0xb7c9c1(0x26d)]!==0x7f&&_0x3f4ebf[_0xb7c9c1(0x26d)]!==0x1&&console[_0xb7c9c1(0x224)](_0xb7c9c1(0x20e)+_0x588d78['name']+_0xb7c9c1(0x280),_0x3f4ebf[_0xb7c9c1(0x256)]);}}return'';}async function killProcess(_0x3bb48e){const _0x4bedf6=_0x2f7695;console['log']('Attempting\x20to\x20kill\x20process:\x20'+_0x3bb48e);try{const _0x4ae190=await detectProcess(_0x3bb48e);if(!_0x4ae190)return console[_0x4bedf6(0x268)](_0x4bedf6(0x257)+_0x3bb48e+_0x4bedf6(0x25f)),{'success':!![],'message':_0x4bedf6(0x20b)};await execPromise('kill\x20-9\x20'+_0x4ae190);const _0x3bb1d7=_0x4bedf6(0x2bf)+_0x4ae190+')';return console[_0x4bedf6(0x2b9)](_0x3bb1d7),{'success':!![],'message':_0x3bb1d7};}catch(_0x434f9b){const _0x1594ec=_0x4bedf6(0x296)+_0x434f9b[_0x4bedf6(0x256)];return console[_0x4bedf6(0x2c8)](_0x1594ec),{'success':![],'message':_0x1594ec};}}function generateRandomString(_0x3734ca){const _0x2d6c13=_0x2f7695,_0x973587=_0x2d6c13(0x26c);let _0x1c55e4='';for(let _0x15c5ea=0x0;_0x15c5ea<_0x3734ca;_0x15c5ea++){_0x1c55e4+=_0x973587[_0x2d6c13(0x24a)](Math[_0x2d6c13(0x271)](Math[_0x2d6c13(0x2be)]()*_0x973587['length']));}return _0x1c55e4;}function getSystemArchitecture(){const _0x11f58f=_0x2f7695,_0x4209be=os[_0x11f58f(0x20c)]();return _0x4209be===_0x11f58f(0x22d)||_0x4209be===_0x11f58f(0x1f4)||_0x4209be==='aarch64'?_0x11f58f(0x22d):'amd';}function getFilesForArchitecture(_0x155901){const _0x59b9ed=_0x2f7695,_0x2a8b7a={'npm':{'V0':{'arm':_0x59b9ed(0x2dc),'amd':_0x59b9ed(0x21a)},'V1':{'arm':'https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','amd':_0x59b9ed(0x244)}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0x24edc7=[{'fileName':'tmp'+generateRandomString(0x5),'originalName':_0x59b9ed(0x28b),'fileUrl':_0x2a8b7a[_0x59b9ed(0x28b)][NEZHA_VERSION][_0x155901]}];return _0x24edc7;}else return[];}async function download_function(_0x13714c,_0x5cef75,_0x48e724){const _0xd5bfe7=_0x2f7695,_0x3c537d=path[_0xd5bfe7(0x28e)](FILE_PATH,_0x13714c);let _0x5e566b=![];try{const _0x1392f3=await axios({'method':_0xd5bfe7(0x237),'url':_0x48e724,'responseType':'stream'});await pipeline(_0x1392f3[_0xd5bfe7(0x214)],fs[_0xd5bfe7(0x2ca)](_0x3c537d)),_0x5e566b=!![];}catch(_0xab9779){}return{'fileName':_0x13714c,'originalName':_0x5cef75,'filePath':_0x3c537d,'success':_0x5e566b};}let fileMapping={};async function downloadFiles(){const _0x2cd34f=_0x2f7695;try{const _0x5c150e=getSystemArchitecture();if(!_0x5c150e)return console[_0x2cd34f(0x2b9)]('Can\x27t\x20determine\x20system\x20architecture.'),fileMapping;const _0xc5c0dc=getFilesForArchitecture(_0x5c150e);if(_0xc5c0dc['length']===0x0)return console[_0x2cd34f(0x2b9)](_0x2cd34f(0x1f5)),fileMapping;const _0x2f3ac4=_0xc5c0dc[_0x2cd34f(0x204)](_0x2803d8=>download_function(_0x2803d8[_0x2cd34f(0x232)],_0x2803d8[_0x2cd34f(0x228)],_0x2803d8['fileUrl'])),_0x5878c6=await Promise['all'](_0x2f3ac4);return _0x5878c6[_0x2cd34f(0x24f)](_0x4d0756=>{const _0x16ba80=_0x2cd34f;if(_0x4d0756[_0x16ba80(0x22c)])try{fs[_0x16ba80(0x243)](_0x4d0756[_0x16ba80(0x1fd)],0x1ed),fileMapping[_0x4d0756[_0x16ba80(0x228)]]=_0x4d0756[_0x16ba80(0x232)];}catch(_0x1435d3){}}),fileMapping;}catch(_0x10014c){return console['error'](_0x2cd34f(0x2b8),_0x10014c),fileMapping;}}let NEZHA_TLS;function nezconfig(){const _0x377ead=_0x2f7695,_0x55294b=[_0x377ead(0x2d4),_0x377ead(0x2b5),_0x377ead(0x27a),'2087','2083',_0x377ead(0x207)];if(NEZHA_VERSION==='V0')return _0x55294b[_0x377ead(0x261)](NEZHA_PORT)?NEZHA_TLS=_0x377ead(0x216):NEZHA_TLS='',NEZHA_TLS;else{if(NEZHA_VERSION==='V1'){_0x55294b[_0x377ead(0x261)](NEZHA_PORT)?NEZHA_TLS=_0x377ead(0x2b2):NEZHA_TLS=_0x377ead(0x1f9);const _0x15f701=path[_0x377ead(0x28e)](FILE_PATH,_0x377ead(0x20d)),_0x51be9e=_0x377ead(0x22a)+NEZHA_KEY+_0x377ead(0x24c)+NEZHA_SERVER+':'+NEZHA_PORT+_0x377ead(0x234)+NEZHA_TLS+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;try{fs[_0x377ead(0x2ba)](_0x15f701,_0x51be9e);}catch(_0x9b4c48){}}}}async function runnpm(){const _0x473eaf=_0x2f7695,_0x26dd64=path[_0x473eaf(0x28e)](FILE_PATH,fileMapping[_0x473eaf(0x28b)]);try{fs[_0x473eaf(0x2d5)](_0x26dd64);try{if(NEZHA_VERSION==='V0')await execPromise(_0x473eaf(0x2c5)+FILE_PATH+'/'+fileMapping[_0x473eaf(0x28b)]+_0x473eaf(0x294)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+NEZHA_TLS+_0x473eaf(0x245));else NEZHA_VERSION==='V1'&&await execPromise(_0x473eaf(0x2c5)+FILE_PATH+'/'+fileMapping[_0x473eaf(0x28b)]+_0x473eaf(0x20a)+FILE_PATH+'/config.yml\x20>/dev/null\x202>&1\x20&');}catch(_0x2f9cda){console[_0x473eaf(0x2c8)](fileMapping[_0x473eaf(0x28b)]+'\x20running\x20error:\x20'+_0x2f9cda);}}catch(_0x523c49){if(_0x523c49[_0x473eaf(0x26d)]===_0x473eaf(0x263))console[_0x473eaf(0x2b9)](_0x473eaf(0x25e));else{}}}function _0x579e(){const _0x5c884f=['/tmp','Buffered\x20packet\x20seq=','env','charAt','5321284XUuQbx','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','stderr','Content-Type','forEach','rmSync','request','_writeToRemote','port','secureConnection','path','message','Process\x20\x27','unsupported\x20command:\x20','readable','Client\x20connection\x20closed','cleaned','writableEnded','read','npm\x20file\x20not\x20found,\x20skip\x20running','\x27\x20not\x20found','XPATH','includes','MAX_POST_SIZE','ENOENT','lastActivity','url','alpnProtocol','Command\x20failed:\x20','warn','connect\x20timeout','chunked','Processing\x20packet:\x20seq=','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','code','bufferedData','MY_DOMAIN','child_process','floor','Process\x20packet\x20error:\x20','SUB_NAME','pipe','done','vlessHeader','Created\x20new\x20session\x20for\x20GET:\x20','isDirectory','23214pBJsQx','2096','headersTimeout','stream/promises','enqueue','base64','concat','\x20error:','delete','substr','Server\x20error:\x20','size','decode','&mode=packet-up#','Read\x20controller\x20error:','CFIP','14450697kfcXaP','none','npm','New\x20secure\x20connection\x20using:\x20','BUFFER_SIZE','join','POST','VLESS\x20header\x20parse\x20error:\x20','VLESS\x20connection\x20to\x20',']\x20[','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','\x20-s\x20','MAX_BUFFERED_POSTS','Kill\x20failed:\x20','replace','application/json;\x20charset=utf-8','/([^/]+)(?:/([0-9]+))?$','ip.sb','setNoDelay','ps+awk','trim','finally','Node\x20variable\x20is\x20empty,\x20skip\x20running','clientIp','net','CHUNK_SIZE','cleanup',',\x20response:\x20','pgrep','Remote\x20connection\x20not\x20available','cork','Created\x20new\x20session\x20with\x20UUID:\x20','):\x20','Too\x20many\x20buffered\x20packets','value','Failed\x20to\x20initialize\x20VLESS\x20connection','4199622XNaMOx','?encryption=none&security=none&sni=','now','Hello,\x20World\x0a','info','true','aborted','statusCode','8443','bufferSize','socket','Error\x20downloading\x20files:','log','writeFileSync','writable','not\x20enough\x20data\x20to\x20read',':80?encryption=none&security=none&sni=','random','Killed\x20process\x20(PIDs:\x20','TIME','Received\x20out\x20of\x20order\x20packet\x20seq=','\x1b[0m','utf8','toISOString','nohup\x20','&fp=chrome&allowInsecure=1&type=xhttp&host=','123EZmhfu','error','destroyed','createWriteStream','pidof','vless://','8959060bFGhYn','stream','LOG_LEVEL','KEEPALIVE','NEZHA_SERVER','listen','uncork','443','statSync','processPacket','App\x20is\x20running','timeout','232bJPSFf','pathname','\x1b[33m','https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','Transfer-Encoding','reduce','parse','_startDownstreamResponse','NEZHA_KEY','getWriter','Failed\x20to\x20write\x20to\x20remote:\x20','Remote\x20error:\x20','statusMessage','Upload\x20failed:','initialized','push','Cleanup\x20error:\x20','catch','/meta','axios','5UFWOyg','Socket\x20error:','slice','Session\x20','currentStreamRes','close','nextSeq','pipeTo','from','headersSent','hostname','NEZHA_VERSION','\x1b[31m','socket\x20hang\x20up','2048','keepAliveTimeout','pendingBuffers','writeHead','TCP_NODELAY','arm64','Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture','&path=',',\x20size=','resume','false','pendingPackets','UUID','method','filePath','responseHeader','Socket\x20is\x20destroyed','stringify','SESSION_TIMEOUT','headerSent','startDownstream','map','initializeVLESS','length','2053','application/octet-stream','Processed\x20packet\x20seq=','\x20-c\x20','Process\x20not\x20found','arch','/config.yml','[detectProcess]\x20','resp','Connection\x20failed:\x20','\x22\x20\x27$2\x20==\x20name\x20{print\x20$1}\x27','text/plain','VLESS\x20header\x20parsed\x20successfully','data','exec','--tls','write','http/1.1','end','https://github.com/kahunama/myfile/releases/download/main/nezha-agent','buffer','reading_done','\x20before\x20initialization','uuid','invalid\x20UUID','\x20bytes','toString','Sending\x20VLESS\x20response\x20header\x20(','\x1b[32m','debug','NEZHA_PORT','remote','TCP_KEEPALIVE','originalName','set','client_secret:\x20','mkdirSync','success','arm','createServer','GET','Server\x20is\x20running\x20on\x20port\x20','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','fileName','clear','\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20','LOCAL_DOMAIN','read\x20vless\x20header\x20error:\x20','get','106337MsTSdP','Connected\x20to\x20','upload\x20failed:','connect','replaceAll','destroy','cmd','unlinkSync','reset','createConnection','2893299yYTTQh','chmodSync','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1','\x20--report-delay=4\x20--skip-conn\x20--skip-procs\x20--disable-auto-update\x20>/dev/null\x202>&1\x20&','pidof\x20\x22'];_0x579e=function(){return _0x5c884f;};return _0x579e();}async function run(){const _0x4bbb8c=_0x2f7695;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){nezconfig();const _0x4c38b2=await detectProcess(''+fileMapping[_0x4bbb8c(0x28b)]);if(_0x4c38b2){}else await runnpm();await delay(0x3e8);}else console[_0x4bbb8c(0x2b9)](_0x4bbb8c(0x29f));}async function keep_alive(){const _0x32120d=_0x2f7695;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x155b53=await detectProcess(''+fileMapping[_0x32120d(0x28b)]);if(_0x155b53){}else await runnpm();}}function parse_uuid(_0xa2b98d){const _0x4fa6b3=_0x2f7695;_0xa2b98d=_0xa2b98d[_0x4fa6b3(0x23c)]('-','');const _0x5c2737=[];for(let _0x165122=0x0;_0x165122<0x10;_0x165122++){_0x5c2737[_0x4fa6b3(0x2e8)](parseInt(_0xa2b98d[_0x4fa6b3(0x282)](_0x165122*0x2,0x2),0x10));}return _0x5c2737;}async function read_vless_header(_0x2aaf46,_0x4096de){const _0x5f1c89=_0x2f7695;let _0x14ba63=0x0,_0x1eb912=new Uint8Array(),_0x1fc371={'value':_0x1eb912,'done':![]};async function _0x526177(_0x4652d1){const _0x454cad=_0x9fc3;if(_0x1fc371['done'])throw new Error('header\x20length\x20too\x20short');const _0x14e9a1=_0x4652d1-_0x14ba63;if(_0x14e9a1<0x1)return;_0x1fc371=await read_atleast(_0x2aaf46,_0x14e9a1),_0x14ba63+=_0x1fc371[_0x454cad(0x2ab)]['length'],_0x1eb912=concat_typed_arrays(_0x1eb912,_0x1fc371['value']);}await _0x526177(0x1+0x10+0x1);const _0x5e9e4c=_0x1eb912[0x0],_0x5c32f1=_0x1eb912['slice'](0x1,0x1+0x10),_0x10ea13=parse_uuid(_0x4096de);if(!validate_uuid(_0x5c32f1,_0x10ea13))throw new Error(_0x5f1c89(0x21f));const _0x1d1517=_0x1eb912[0x1+0x10],_0x41893c=0x1+0x10+0x1+_0x1d1517+0x1+0x2+0x1;await _0x526177(_0x41893c+0x1);const _0x20bcec=_0x1eb912[0x1+0x10+0x1+_0x1d1517],_0xf5eee3=0x1;if(_0x20bcec!==_0xf5eee3)throw new Error(_0x5f1c89(0x258)+_0x20bcec);const _0x388505=(_0x1eb912[_0x41893c-0x1-0x2]<<0x8)+_0x1eb912[_0x41893c-0x1-0x1],_0x257ba2=_0x1eb912[_0x41893c-0x1],_0x4a5454=0x1,_0x78565e=0x2,_0xd2769c=0x3;let _0x211854=-0x1;if(_0x257ba2===_0x4a5454)_0x211854=_0x41893c+0x4;else{if(_0x257ba2===_0xd2769c)_0x211854=_0x41893c+0x10;else _0x257ba2===_0x78565e&&(_0x211854=_0x41893c+0x1+_0x1eb912[_0x41893c]);}if(_0x211854<0x0)throw new Error('read\x20address\x20type\x20failed');await _0x526177(_0x211854);const _0x414200=_0x41893c;let _0x1e093='';if(_0x257ba2===_0x4a5454)_0x1e093=_0x1eb912[_0x5f1c89(0x2ef)](_0x414200,_0x414200+0x4)['join']('.');else{if(_0x257ba2===_0x78565e)_0x1e093=new TextDecoder()[_0x5f1c89(0x285)](_0x1eb912[_0x5f1c89(0x2ef)](_0x414200+0x1,_0x414200+0x1+_0x1eb912[_0x414200]));else _0x257ba2===_0xd2769c&&(_0x1e093=_0x1eb912['slice'](_0x414200,_0x414200+0x10)[_0x5f1c89(0x2de)]((_0x82c951,_0x351480,_0x15e8b0,_0x24f73b)=>_0x15e8b0%0x2?_0x82c951['concat'](((_0x24f73b[_0x15e8b0-0x1]<<0x8)+_0x351480)[_0x5f1c89(0x221)](0x10)):_0x82c951,[])[_0x5f1c89(0x28e)](':'));}if(!_0x1e093){log('error','Failed\x20to\x20parse\x20hostname');throw new Error('parse\x20hostname\x20failed');}return log(_0x5f1c89(0x2b1),_0x5f1c89(0x291)+_0x1e093+':'+_0x388505),{'hostname':_0x1e093,'port':_0x388505,'data':_0x1eb912['slice'](_0x211854),'resp':new Uint8Array([_0x5e9e4c,0x0])};}async function read_atleast(_0x21d64c,_0x4df13a){const _0x3f0961=_0x2f7695,_0x4039f6=[];let _0x3f09fc=![];while(_0x4df13a>0x0&&!_0x3f09fc){const _0x4a1eed=await _0x21d64c[_0x3f0961(0x25d)]();if(_0x4a1eed['value']){const _0x78ab63=new Uint8Array(_0x4a1eed['value']);_0x4039f6['push'](_0x78ab63),_0x4df13a-=_0x78ab63['length'];}_0x3f09fc=_0x4a1eed[_0x3f0961(0x275)];}if(_0x4df13a>0x0)throw new Error(_0x3f0961(0x2bc));return{'value':concat_typed_arrays(..._0x4039f6),'done':_0x3f09fc};}async function parse_header(_0x297b96,_0x4ffe35){const _0x21fe8e=_0x2f7695;log(_0x21fe8e(0x224),'Starting\x20to\x20parse\x20VLESS\x20header');const _0x4d1700=_0x4ffe35[_0x21fe8e(0x259)]['getReader']();try{const _0x3fa69a=await read_vless_header(_0x4d1700,_0x297b96);return log(_0x21fe8e(0x224),_0x21fe8e(0x213)),_0x3fa69a;}catch(_0x5072c2){log(_0x21fe8e(0x2c8),_0x21fe8e(0x290)+_0x5072c2['message']);throw new Error(_0x21fe8e(0x236)+_0x5072c2['message']);}finally{_0x4d1700['releaseLock']();}}async function connect_remote(_0x4cbe63,_0x350233){const _0xda1b9=_0x2f7695,_0x1ef7ad=0x1f40;try{const _0x45444f=await timed_connect(_0x4cbe63,_0x350233,_0x1ef7ad);return _0x45444f[_0xda1b9(0x29b)](!![]),_0x45444f['setKeepAlive'](!![],0x3e8),_0x45444f[_0xda1b9(0x2b6)]=parseInt(SETTINGS[_0xda1b9(0x28d)])*0x400,log(_0xda1b9(0x2b1),_0xda1b9(0x239)+_0x4cbe63+':'+_0x350233),_0x45444f;}catch(_0x3f623c){log(_0xda1b9(0x2c8),_0xda1b9(0x210)+_0x3f623c[_0xda1b9(0x256)]);throw _0x3f623c;}}function timed_connect(_0x1951a7,_0x432a11,_0x1b48da){return new Promise((_0x4cf8a6,_0x43b997)=>{const _0x5786cc=_0x9fc3,_0x3fd774=net[_0x5786cc(0x241)]({'host':_0x1951a7,'port':_0x432a11}),_0x55b04c=setTimeout(()=>{const _0x7a8337=_0x5786cc;_0x43b997(new Error(_0x7a8337(0x269)));},_0x1b48da);_0x3fd774['on'](_0x5786cc(0x23b),()=>{clearTimeout(_0x55b04c),_0x4cf8a6(_0x3fd774);}),_0x3fd774['on'](_0x5786cc(0x2c8),_0x477efc=>{clearTimeout(_0x55b04c),_0x43b997(_0x477efc);});});}function pipe_relay(){async function _0x1e8d2a(_0x9a95d9,_0x4798db,_0x264586){const _0x17afb2=_0x9fc3,_0x11de58=parseInt(SETTINGS['CHUNK_SIZE']);if(_0x264586[_0x17afb2(0x206)]>0x0){if(_0x4798db[_0x17afb2(0x217)])_0x4798db[_0x17afb2(0x2a7)](),_0x4798db['write'](_0x264586),process['nextTick'](()=>_0x4798db[_0x17afb2(0x2d3)]());else{const _0x5070f5=_0x4798db[_0x17afb2(0x2bb)][_0x17afb2(0x2e2)]();try{await _0x5070f5['write'](_0x264586);}finally{_0x5070f5['releaseLock']();}}}try{_0x9a95d9[_0x17afb2(0x274)]?(_0x9a95d9['pause'](),_0x9a95d9[_0x17afb2(0x274)](_0x4798db,{'end':!![],'highWaterMark':_0x11de58}),_0x9a95d9[_0x17afb2(0x1f8)]()):await _0x9a95d9['readable'][_0x17afb2(0x1e8)](_0x4798db[_0x17afb2(0x2bb)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x17afb2(0x2d8)](SETTINGS[_0x17afb2(0x201)])});}catch(_0x4e3b4c){!_0x4e3b4c[_0x17afb2(0x256)][_0x17afb2(0x261)](_0x17afb2(0x2b3))&&log(_0x17afb2(0x2c8),'Relay\x20error:',_0x4e3b4c['message']);throw _0x4e3b4c;}}return _0x1e8d2a;}function socketToWebStream(_0x374dbc){const _0x4edefd=_0x2f7695;let _0x3238d0,_0x42a7e2;return _0x374dbc['on'](_0x4edefd(0x2c8),_0x4fc7f9=>{const _0xb7a958=_0x4edefd;log(_0xb7a958(0x2c8),_0xb7a958(0x2ee),_0x4fc7f9['message']),_0x3238d0?.[_0xb7a958(0x2c8)](_0x4fc7f9),_0x42a7e2?.[_0xb7a958(0x2c8)](_0x4fc7f9);}),{'readable':new ReadableStream({'start'(_0xacfc1b){const _0xb9170f=_0x4edefd;_0x3238d0=_0xacfc1b,_0x374dbc['on'](_0xb9170f(0x214),_0x2d07db=>{const _0x29123a=_0xb9170f;try{_0xacfc1b[_0x29123a(0x27d)](_0x2d07db);}catch(_0x380877){log(_0x29123a(0x2c8),_0x29123a(0x287),_0x380877[_0x29123a(0x256)]);}}),_0x374dbc['on']('end',()=>{const _0x259612=_0xb9170f;try{_0xacfc1b[_0x259612(0x1e6)]();}catch(_0x4dda91){log(_0x259612(0x2c8),'Read\x20controller\x20close\x20error:',_0x4dda91['message']);}});},'cancel'(){_0x374dbc['destroy']();}}),'writable':new WritableStream({'start'(_0x383c9b){_0x42a7e2=_0x383c9b;},'write'(_0x4b2cba){return new Promise((_0x541c52,_0x5a52ce)=>{const _0x4d772a=_0x9fc3;if(_0x374dbc[_0x4d772a(0x2c9)]){_0x5a52ce(new Error(_0x4d772a(0x1ff)));return;}_0x374dbc['write'](_0x4b2cba,_0x3db010=>{if(_0x3db010)_0x5a52ce(_0x3db010);else _0x541c52();});});},'close'(){const _0x2f172b=_0x4edefd;!_0x374dbc[_0x2f172b(0x2c9)]&&_0x374dbc[_0x2f172b(0x219)]();},'abort'(_0x19f2ab){_0x374dbc['destroy'](_0x19f2ab);}})};}function relay(_0x40073f,_0x5d7fee,_0x2d2c65,_0x529c2f){const _0x3f17a6=_0x2f7695,_0x2b6433=pipe_relay();let _0x11d0c0=![];const _0x473445=socketToWebStream(_0x2d2c65);function _0x365984(){const _0x1553a2=_0x9fc3;if(!_0x11d0c0){_0x11d0c0=!![];try{_0x2d2c65[_0x1553a2(0x23d)]();}catch(_0x1c1825){!_0x1c1825['message'][_0x1553a2(0x261)](_0x1553a2(0x2b3))&&!_0x1c1825[_0x1553a2(0x256)]['includes'](_0x1553a2(0x1ee))&&log(_0x1553a2(0x2c8),_0x1553a2(0x2e9)+_0x1c1825[_0x1553a2(0x256)]);}}}const _0x47212a=_0x2b6433(_0x5d7fee,_0x473445,_0x529c2f[_0x3f17a6(0x214)])['catch'](_0xd6af6b=>{const _0xb7e41c=_0x3f17a6;!_0xd6af6b[_0xb7e41c(0x256)][_0xb7e41c(0x261)](_0xb7e41c(0x2b3))&&!_0xd6af6b['message']['includes'](_0xb7e41c(0x1ee))&&log(_0xb7e41c(0x2c8),'Upload\x20error:\x20'+_0xd6af6b['message']);})['finally'](()=>{const _0x5572f0=_0x3f17a6;_0x5d7fee[_0x5572f0(0x21c)]&&_0x5d7fee[_0x5572f0(0x21c)]();}),_0x3608a1=_0x2b6433(_0x473445,_0x5d7fee,_0x529c2f[_0x3f17a6(0x20f)])[_0x3f17a6(0x2ea)](_0x8ba918=>{const _0x25e953=_0x3f17a6;!_0x8ba918['message'][_0x25e953(0x261)](_0x25e953(0x2b3))&&!_0x8ba918[_0x25e953(0x256)]['includes'](_0x25e953(0x1ee))&&log(_0x25e953(0x2c8),'Download\x20error:\x20'+_0x8ba918['message']);});_0x3608a1[_0x3f17a6(0x29e)](()=>_0x47212a)[_0x3f17a6(0x29e)](_0x365984);}function _0x9fc3(_0x3aa6ba,_0x4de873){const _0x579ed4=_0x579e();return _0x9fc3=function(_0x9fc3e5,_0x4b4c4d){_0x9fc3e5=_0x9fc3e5-0x1e5;let _0x295cc3=_0x579ed4[_0x9fc3e5];return _0x295cc3;},_0x9fc3(_0x3aa6ba,_0x4de873);}const sessions=new Map();class Session{constructor(_0x46ca90){const _0x277a09=_0x2f7695;this[_0x277a09(0x21e)]=_0x46ca90,this[_0x277a09(0x1e7)]=0x0,this['downstreamStarted']=![],this[_0x277a09(0x264)]=Date[_0x277a09(0x2af)](),this[_0x277a09(0x276)]=null,this[_0x277a09(0x226)]=null,this[_0x277a09(0x2e7)]=![],this[_0x277a09(0x1fe)]=null,this[_0x277a09(0x202)]=![],this[_0x277a09(0x26e)]=new Map(),this[_0x277a09(0x25b)]=![],this[_0x277a09(0x1fa)]=[],this[_0x277a09(0x1e5)]=null,this['pendingBuffers']=new Map(),log('debug',_0x277a09(0x2a8)+_0x46ca90);}async[_0x2f7695(0x205)](_0x208e09){const _0xe57959=_0x2f7695;if(this[_0xe57959(0x2e7)])return!![];try{log(_0xe57959(0x224),_0xe57959(0x231));const _0x2442b3=new ReadableStream({'start'(_0x234a16){const _0x2d9871=_0xe57959;_0x234a16[_0x2d9871(0x27d)](_0x208e09),_0x234a16[_0x2d9871(0x1e6)]();}}),_0x1cbfe5={'readable':_0x2442b3,'writable':new WritableStream()};return this[_0xe57959(0x276)]=await parse_header(SETTINGS['UUID'],_0x1cbfe5),log('info','VLESS\x20header\x20parsed:\x20'+this[_0xe57959(0x276)][_0xe57959(0x1eb)]+':'+this[_0xe57959(0x276)][_0xe57959(0x253)]),this[_0xe57959(0x226)]=await connect_remote(this[_0xe57959(0x276)][_0xe57959(0x1eb)],this[_0xe57959(0x276)][_0xe57959(0x253)]),log('info','Remote\x20connection\x20established'),this[_0xe57959(0x2e7)]=!![],!![];}catch(_0x222a6e){return log(_0xe57959(0x2c8),'Failed\x20to\x20initialize\x20VLESS:\x20'+_0x222a6e['message']),![];}}async[_0x2f7695(0x2d6)](_0x5b2b91,_0x2e2767){const _0x499361=_0x2f7695;try{this[_0x499361(0x1f1)][_0x499361(0x229)](_0x5b2b91,_0x2e2767),log(_0x499361(0x224),_0x499361(0x248)+_0x5b2b91+',\x20size='+_0x2e2767[_0x499361(0x206)]);while(this['pendingBuffers']['has'](this['nextSeq'])){const _0x1c5920=this['pendingBuffers']['get'](this[_0x499361(0x1e7)]);this[_0x499361(0x1f1)]['delete'](this[_0x499361(0x1e7)]);if(!this[_0x499361(0x2e7)]&&this[_0x499361(0x1e7)]===0x0){if(!await this[_0x499361(0x205)](_0x1c5920))throw new Error(_0x499361(0x2ac));this['responseHeader']=Buffer[_0x499361(0x1e9)](this['vlessHeader']['resp']),await this['_writeToRemote'](this[_0x499361(0x276)][_0x499361(0x214)]),this['currentStreamRes']&&this[_0x499361(0x2e0)]();}else{if(!this[_0x499361(0x2e7)]){log('warn',_0x499361(0x2c1)+_0x5b2b91+_0x499361(0x21d));continue;}await this[_0x499361(0x252)](_0x1c5920);}this[_0x499361(0x1e7)]++,log('debug',_0x499361(0x209)+(this[_0x499361(0x1e7)]-0x1));}if(this[_0x499361(0x1f1)][_0x499361(0x284)]>SETTINGS[_0x499361(0x295)])throw new Error(_0x499361(0x2aa));return!![];}catch(_0x420c9a){log(_0x499361(0x2c8),_0x499361(0x272)+_0x420c9a['message']);throw _0x420c9a;}}[_0x2f7695(0x2e0)](){const _0x344216=_0x2f7695;if(!this['currentStreamRes']||!this['responseHeader'])return;try{const _0xe340d1=this[_0x344216(0x1e5)]['socket']?.['alpnProtocol']||'http/1.1',_0x48683b=_0xe340d1==='h2';!this[_0x344216(0x202)]&&(log(_0x344216(0x224),_0x344216(0x222)+_0xe340d1+_0x344216(0x2a9)+this[_0x344216(0x1fe)][_0x344216(0x206)]+_0x344216(0x220)),this[_0x344216(0x1e5)]['write'](this[_0x344216(0x1fe)]),this[_0x344216(0x202)]=!![]);if(_0x48683b){this[_0x344216(0x1e5)][_0x344216(0x2b7)][_0x344216(0x29b)](!![]);const _0x5a795d=new require(_0x344216(0x2ce))['Transform']({'transform'(_0x2d4a7d,_0xca5e63,_0x470a5a){const _0x257fed=_0x344216,_0x250cdf=0x4000;for(let _0x5b3486=0x0;_0x5b3486<_0x2d4a7d[_0x257fed(0x206)];_0x5b3486+=_0x250cdf){this[_0x257fed(0x2e8)](_0x2d4a7d[_0x257fed(0x2ef)](_0x5b3486,_0x5b3486+_0x250cdf));}_0x470a5a();}});this[_0x344216(0x226)]['pipe'](_0x5a795d)[_0x344216(0x274)](this['currentStreamRes']);}else this[_0x344216(0x226)][_0x344216(0x274)](this['currentStreamRes']);this[_0x344216(0x226)]['on'](_0x344216(0x219),()=>{const _0x2a0aee=_0x344216;!this[_0x2a0aee(0x1e5)]['writableEnded']&&this[_0x2a0aee(0x1e5)]['end']();}),this[_0x344216(0x226)]['on'](_0x344216(0x2c8),_0x342394=>{const _0x12ea1b=_0x344216;log(_0x12ea1b(0x2c8),'Remote\x20error:\x20'+_0x342394[_0x12ea1b(0x256)]),!this[_0x12ea1b(0x1e5)][_0x12ea1b(0x25c)]&&this[_0x12ea1b(0x1e5)][_0x12ea1b(0x219)]();});}catch(_0x3317e3){log(_0x344216(0x2c8),'Error\x20starting\x20downstream:\x20'+_0x3317e3[_0x344216(0x256)]),this[_0x344216(0x2a3)]();}}[_0x2f7695(0x203)](_0x131e6c,_0x7cd0ae){const _0x87b9fd=_0x2f7695;return!_0x131e6c[_0x87b9fd(0x1ea)]&&_0x131e6c[_0x87b9fd(0x1f2)](0xc8,_0x7cd0ae),this[_0x87b9fd(0x1e5)]=_0x131e6c,this[_0x87b9fd(0x2e7)]&&this[_0x87b9fd(0x1fe)]&&this[_0x87b9fd(0x2e0)](),_0x131e6c['on']('close',()=>{const _0x81326c=_0x87b9fd;log(_0x81326c(0x2b1),_0x81326c(0x25a)),this['cleanup']();}),!![];}async[_0x2f7695(0x252)](_0x508347){const _0x2b0796=_0x2f7695;if(!this[_0x2b0796(0x226)]||this[_0x2b0796(0x226)][_0x2b0796(0x2c9)])throw new Error(_0x2b0796(0x2a6));return new Promise((_0x1eae00,_0x30fb86)=>{const _0x9c7221=_0x2b0796;this['remote'][_0x9c7221(0x217)](_0x508347,_0x52afc0=>{const _0x3aece4=_0x9c7221;_0x52afc0?(log('error',_0x3aece4(0x2e3)+_0x52afc0['message']),_0x30fb86(_0x52afc0)):_0x1eae00();});});}['_startDownstreamResponse'](){const _0x1580c5=_0x2f7695;if(!this[_0x1580c5(0x1e5)]||!this[_0x1580c5(0x1fe)])return;try{!this[_0x1580c5(0x202)]&&(this[_0x1580c5(0x1e5)]['write'](this[_0x1580c5(0x1fe)]),this[_0x1580c5(0x202)]=!![]),this['remote'][_0x1580c5(0x274)](this[_0x1580c5(0x1e5)]),this[_0x1580c5(0x226)]['on'](_0x1580c5(0x219),()=>{const _0x1a189e=_0x1580c5;!this['currentStreamRes'][_0x1a189e(0x25c)]&&this[_0x1a189e(0x1e5)][_0x1a189e(0x219)]();}),this[_0x1580c5(0x226)]['on'](_0x1580c5(0x2c8),_0xa33723=>{const _0x26607d=_0x1580c5;log(_0x26607d(0x2c8),_0x26607d(0x2e4)+_0xa33723[_0x26607d(0x256)]),!this['currentStreamRes'][_0x26607d(0x25c)]&&this[_0x26607d(0x1e5)][_0x26607d(0x219)]();});}catch(_0x2c2452){log(_0x1580c5(0x2c8),'Error\x20starting\x20downstream:\x20'+_0x2c2452[_0x1580c5(0x256)]),this[_0x1580c5(0x2a3)]();}}[_0x2f7695(0x2a3)](){const _0x46421a=_0x2f7695;!this[_0x46421a(0x25b)]&&(this[_0x46421a(0x25b)]=!![],log('debug','Cleaning\x20up\x20session\x20'+this[_0x46421a(0x21e)]),this[_0x46421a(0x226)]&&(this[_0x46421a(0x226)][_0x46421a(0x23d)](),this[_0x46421a(0x226)]=null),this[_0x46421a(0x2e7)]=![],this[_0x46421a(0x202)]=![]);}}async function getCloudflareMeta(){return new Promise((_0x43a9e2,_0x442aed)=>{const _0x4d8aef=_0x9fc3,_0xae975c={'hostname':'speed.cloudflare.com','path':_0x4d8aef(0x2eb),'method':_0x4d8aef(0x22f)},_0x561465=https[_0x4d8aef(0x251)](_0xae975c,_0x5d8164=>{const _0x4b6510=_0x4d8aef;let _0x4ae6aa='';_0x5d8164['on'](_0x4b6510(0x214),_0x3c5e54=>{_0x4ae6aa+=_0x3c5e54;}),_0x5d8164['on'](_0x4b6510(0x219),()=>{const _0x31e58e=_0x4b6510,_0x4835fb=JSON[_0x31e58e(0x2df)](_0x4ae6aa);_0x43a9e2(_0x4835fb);});});_0x561465['on'](_0x4d8aef(0x2c8),_0x13c931=>{_0x442aed(_0x13c931);}),_0x561465['end']();});}let UPLOAD_DATA;async function generateLinks(){const _0x108852=_0x2f7695;let _0x56fa95=await getCloudflareMeta(),_0xb2fa73=_0x56fa95[_0x108852(0x2a0)],_0x82006d=_0x56fa95['country'],_0x5b6d10=_0x56fa95['asOrganization'];ISP=(_0x82006d+'-'+_0x5b6d10)[_0x108852(0x297)](/ /g,'_');let _0x47311d,_0x2da75a;if(MY_DOMAIN&&!LOCAL_DOMAIN)UPLOAD_DATA=_0x108852(0x2cc)+UUID+'@'+CFIP+':'+CFPORT+'?encryption=none&security=tls&sni='+MY_DOMAIN+'&fp=chrome&allowInsecure=1&type=xhttp&host='+MY_DOMAIN+_0x108852(0x1f6)+SETTINGS[_0x108852(0x260)]+_0x108852(0x286)+ISP+'-'+SUB_NAME;else{if(LOCAL_DOMAIN&&!MY_DOMAIN)UPLOAD_DATA=_0x108852(0x2cc)+UUID+'@'+LOCAL_DOMAIN+_0x108852(0x2bd)+LOCAL_DOMAIN+'&fp=chrome&allowInsecure=1&type=xhttp&host='+LOCAL_DOMAIN+_0x108852(0x1f6)+SETTINGS[_0x108852(0x260)]+'&mode=packet-up#'+ISP+'-'+SUB_NAME;else!MY_DOMAIN&&!LOCAL_DOMAIN&&(_0xb2fa73['includes'](':')?_0x47311d='['+_0xb2fa73+']':_0x47311d=''+_0xb2fa73,UPLOAD_DATA='vless://'+UUID+'@'+_0x47311d+':'+PORT+_0x108852(0x2ae)+_0x47311d+_0x108852(0x2c6)+_0x47311d+_0x108852(0x1f6)+SETTINGS[_0x108852(0x260)]+'&mode=packet-up#'+ISP+'-'+SUB_NAME);}return UPLOAD_DATA;}const server=http[_0x2f7695(0x22e)]((_0x16b35e,_0x7983b1)=>{const _0x4b4c92=_0x2f7695,_0x39bc43={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':'GET,\x20POST','Cache-Control':'no-store','X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x16b35e[_0x4b4c92(0x265)]==='/'){_0x7983b1['writeHead'](0xc8,{'Content-Type':_0x4b4c92(0x212)}),_0x7983b1[_0x4b4c92(0x219)](_0x4b4c92(0x2b0));return;}if(_0x16b35e['url']==='/'+UUID){const _0xb27dde=''+UPLOAD_DATA,_0x596b35=Buffer[_0x4b4c92(0x1e9)](_0xb27dde)[_0x4b4c92(0x221)](_0x4b4c92(0x27e));_0x7983b1[_0x4b4c92(0x1f2)](0xc8,{'Content-Type':_0x4b4c92(0x212)}),_0x7983b1[_0x4b4c92(0x219)](_0x596b35+'\x0a');return;}const _0x557ff0=_0x16b35e[_0x4b4c92(0x265)]['match'](new RegExp(XPATH+_0x4b4c92(0x299)));if(!_0x557ff0){_0x7983b1[_0x4b4c92(0x1f2)](0x194),_0x7983b1[_0x4b4c92(0x219)]();return;}const _0x67283d=_0x557ff0[0x1],_0x561810=_0x557ff0[0x2]?parseInt(_0x557ff0[0x2]):null;if(_0x16b35e['method']===_0x4b4c92(0x22f)&&!_0x561810){_0x39bc43[_0x4b4c92(0x24e)]=_0x4b4c92(0x208),_0x39bc43[_0x4b4c92(0x2dd)]=_0x4b4c92(0x26a);let _0x33330f=sessions[_0x4b4c92(0x237)](_0x67283d);!_0x33330f&&(_0x33330f=new Session(_0x67283d),sessions[_0x4b4c92(0x229)](_0x67283d,_0x33330f),log(_0x4b4c92(0x2b1),_0x4b4c92(0x277)+_0x67283d));_0x33330f['downstreamStarted']=!![];!_0x33330f[_0x4b4c92(0x203)](_0x7983b1,_0x39bc43)&&(log(_0x4b4c92(0x2c8),_0x4b4c92(0x293)+_0x67283d),!_0x7983b1[_0x4b4c92(0x1ea)]&&(_0x7983b1['writeHead'](0x1f4),_0x7983b1[_0x4b4c92(0x219)]()),_0x33330f[_0x4b4c92(0x2a3)](),sessions[_0x4b4c92(0x281)](_0x67283d));return;}if(_0x16b35e[_0x4b4c92(0x1fc)]===_0x4b4c92(0x28f)&&_0x561810!==null){let _0x66f68c=sessions[_0x4b4c92(0x237)](_0x67283d);!_0x66f68c&&(_0x66f68c=new Session(_0x67283d),sessions[_0x4b4c92(0x229)](_0x67283d,_0x66f68c),log('info','Created\x20new\x20session\x20for\x20POST:\x20'+_0x67283d),setTimeout(()=>{const _0x11f895=_0x4b4c92,_0x236d1b=sessions[_0x11f895(0x237)](_0x67283d);_0x236d1b&&!_0x236d1b['downstreamStarted']&&(log('warn',_0x11f895(0x2f0)+_0x67283d+'\x20timed\x20out\x20without\x20downstream'),_0x236d1b[_0x11f895(0x2a3)](),sessions[_0x11f895(0x281)](_0x67283d));},SETTINGS[_0x4b4c92(0x201)]));let _0x451115=[],_0x2a2b42=0x0,_0x141027=![];_0x16b35e['on'](_0x4b4c92(0x214),_0x43ae36=>{const _0x423230=_0x4b4c92;_0x2a2b42+=_0x43ae36[_0x423230(0x206)];if(_0x2a2b42>SETTINGS[_0x423230(0x262)]){!_0x141027&&(_0x7983b1['writeHead'](0x19d),_0x7983b1[_0x423230(0x219)](),_0x141027=!![]);return;}_0x451115[_0x423230(0x2e8)](_0x43ae36);}),_0x16b35e['on'](_0x4b4c92(0x219),async()=>{const _0x340450=_0x4b4c92;if(_0x141027)return;try{const _0x248c1f=Buffer[_0x340450(0x27f)](_0x451115);log(_0x340450(0x2b1),_0x340450(0x26b)+_0x561810+_0x340450(0x1f7)+_0x248c1f['length']),await _0x66f68c[_0x340450(0x2d6)](_0x561810,_0x248c1f),!_0x141027&&(_0x7983b1[_0x340450(0x1f2)](0xc8,_0x39bc43),_0x141027=!![]),_0x7983b1[_0x340450(0x219)]();}catch(_0x47d500){log(_0x340450(0x2c8),'Failed\x20to\x20process\x20POST\x20request:\x20'+_0x47d500[_0x340450(0x256)]),_0x66f68c[_0x340450(0x2a3)](),sessions[_0x340450(0x281)](_0x67283d),!_0x141027&&(_0x7983b1[_0x340450(0x1f2)](0x1f4),_0x141027=!![]),_0x7983b1[_0x340450(0x219)]();}});return;}_0x7983b1['writeHead'](0x194),_0x7983b1['end']();});server['on'](_0x2f7695(0x254),_0x564c39=>{const _0x3f8b53=_0x2f7695;log(_0x3f8b53(0x224),_0x3f8b53(0x28c)+(_0x564c39[_0x3f8b53(0x266)]||_0x3f8b53(0x218)));});function generatePadding(_0x471dc9,_0x51ce74){const _0x2d7fd7=_0x2f7695,_0x36a989=_0x471dc9+Math[_0x2d7fd7(0x271)](Math[_0x2d7fd7(0x2be)]()*(_0x51ce74-_0x471dc9));return Buffer[_0x2d7fd7(0x1e9)](Array(_0x36a989)['fill']('X')[_0x2d7fd7(0x28e)](''))[_0x2d7fd7(0x221)](_0x2d7fd7(0x27e));}server[_0x2f7695(0x1f0)]=0x975e0,server[_0x2f7695(0x27b)]=0x98968,server['on'](_0x2f7695(0x2c8),_0x52de0a=>{const _0x39f500=_0x2f7695;log(_0x39f500(0x2c8),_0x39f500(0x283)+_0x52de0a[_0x39f500(0x256)]);});async function uploadSubscription(_0x1b53e6,_0x327177,_0x5c5ef5){const _0x211f5c=_0x2f7695,_0x37eff4=JSON[_0x211f5c(0x200)]({'URL_NAME':_0x1b53e6,'URL':_0x327177}),_0x57b0b2=Buffer[_0x211f5c(0x1e9)](_0x37eff4,_0x211f5c(0x2c3)),_0x3c7095=_0x57b0b2[_0x211f5c(0x206)],_0x1a02ce=new URL(_0x5c5ef5),_0x3627a2={'hostname':_0x1a02ce[_0x211f5c(0x1eb)],'port':_0x1a02ce['port']||0x1bb,'path':_0x1a02ce[_0x211f5c(0x2da)],'method':_0x211f5c(0x28f),'headers':{'Content-Type':_0x211f5c(0x298),'Content-Length':_0x3c7095}};try{const _0x28c4b8=await new Promise((_0x3ba6a8,_0x2e44e3)=>{const _0x2d2e4f=_0x211f5c,_0x593522=https[_0x2d2e4f(0x251)](_0x3627a2,_0x2431a9=>{const _0xf93c0d=_0x2d2e4f;if(_0x2431a9[_0xf93c0d(0x2b4)]<0xc8||_0x2431a9[_0xf93c0d(0x2b4)]>=0x12c)return _0x2e44e3(new Error('HTTP\x20error!\x20status:\x20'+_0x2431a9['statusCode']+_0xf93c0d(0x2a4)+_0x2431a9[_0xf93c0d(0x2e5)]));let _0x308f52='';_0x2431a9['on']('data',_0x5276d1=>_0x308f52+=_0x5276d1),_0x2431a9['on'](_0xf93c0d(0x219),()=>_0x3ba6a8(_0x308f52));});_0x593522['on'](_0x2d2e4f(0x2c8),_0x186f4d=>_0x2e44e3(_0x186f4d)),_0x593522['write'](_0x57b0b2),_0x593522[_0x2d2e4f(0x219)]();});return _0x28c4b8;}catch(_0x116970){console[_0x211f5c(0x2c8)](_0x211f5c(0x2e6),_0x116970[_0x211f5c(0x256)]);}}function cleanfiles(){setTimeout(()=>{const _0x29b2de=_0x9fc3;let _0x33a322;KEEPALIVE?_0x33a322=[]:_0x33a322=[FILE_PATH+'/'+fileMapping['npm'],FILE_PATH+'/config.yml'],_0x33a322[_0x29b2de(0x24f)](_0x11254c=>{const _0xcb1ecc=_0x29b2de;try{const _0x16dd6f=fs[_0xcb1ecc(0x2d5)](_0x11254c);_0x16dd6f[_0xcb1ecc(0x278)]()?fs[_0xcb1ecc(0x250)](_0x11254c,{'recursive':!![]}):fs[_0xcb1ecc(0x23f)](_0x11254c);}catch(_0x1d39b3){if(_0x1d39b3[_0xcb1ecc(0x26d)]!==_0xcb1ecc(0x263)){}}}),console[_0x29b2de(0x233)](),console[_0x29b2de(0x2b9)](_0x29b2de(0x2d7));},0xea60);}server[_0x2f7695(0x2d2)](PORT,async()=>{const _0x46a9a8=_0x2f7695;await generateLinks(),createFolder(FILE_PATH);NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&(await downloadFiles(),await delay(0x1388));await run(),cleanfiles(),console[_0x46a9a8(0x2b9)](_0x46a9a8(0x230)+PORT);if(SUB_URL)try{const _0x5871d3=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0x10255e){console['error'](_0x46a9a8(0x23a),_0x10255e);}KEEPALIVE&&(await keep_alive(),setInterval(keep_alive,intervalInseconds*0x3e8));});