const _0x323062=_0x340b;(function(_0x4461ee,_0x301ae5){const _0x519a3b=_0x340b,_0x31b3fe=_0x4461ee();while(!![]){try{const _0x20a946=parseInt(_0x519a3b(0x237))/0x1+parseInt(_0x519a3b(0x2d7))/0x2+-parseInt(_0x519a3b(0x275))/0x3*(parseInt(_0x519a3b(0x20d))/0x4)+-parseInt(_0x519a3b(0x2b4))/0x5+-parseInt(_0x519a3b(0x2a4))/0x6+parseInt(_0x519a3b(0x2b2))/0x7+parseInt(_0x519a3b(0x246))/0x8;if(_0x20a946===_0x301ae5)break;else _0x31b3fe['push'](_0x31b3fe['shift']());}catch(_0x1bb191){_0x31b3fe['push'](_0x31b3fe['shift']());}}}(_0x2471,0x8506a));const FILE_PATH=process[_0x323062(0x1ef)][_0x323062(0x2e7)]||_0x323062(0x298),intervalInseconds=process[_0x323062(0x1ef)][_0x323062(0x239)]||0x64,SUB_PATH=process[_0x323062(0x1ef)][_0x323062(0x2ed)]||'sub',PORT=process['env'][_0x323062(0x263)]||0xbb8,CFPORT=process[_0x323062(0x1ef)][_0x323062(0x270)]||0x1bb,CFIP=process['env'][_0x323062(0x29e)]||'ip.sb',KEEPALIVE=process[_0x323062(0x1ef)][_0x323062(0x20e)]||![],SUB_URL=process[_0x323062(0x1ef)][_0x323062(0x224)]||'',UUID=process['env'][_0x323062(0x2e3)]||'7160b696-dd5e-42e3-a024-145e92cec916',XPATH=process[_0x323062(0x1ef)][_0x323062(0x2e9)]||UUID[_0x323062(0x257)](0x0,0x8),HTTPSTLS=process[_0x323062(0x1ef)]['HTTPSTLS']||!![],NEZHA_VERSION=process[_0x323062(0x1ef)]['NEZHA_VERSION']||'V0',NEZHA_SERVER=process[_0x323062(0x1ef)][_0x323062(0x241)]||'',NEZHA_PORT=process[_0x323062(0x1ef)]['NEZHA_PORT']||_0x323062(0x201),NEZHA_KEY=process['env'][_0x323062(0x26f)]||'',SUB_NAME=process[_0x323062(0x1ef)]['SUB_NAME']||'',MY_DOMAIN=process['env'][_0x323062(0x1d9)]||'',os=require('os'),fs=require('fs'),net=require(_0x323062(0x283)),path=require(_0x323062(0x23a)),http=require(_0x323062(0x1ed)),https=require('https'),axios=require(_0x323062(0x269)),{pipeline}=require(_0x323062(0x235)),{Buffer}=require('buffer'),exec=require(_0x323062(0x2ac))[_0x323062(0x210)],delay=_0x310886=>new Promise(_0x503e97=>setTimeout(_0x503e97,_0x310886)),SETTINGS={[_0x323062(0x2e3)]:UUID,[_0x323062(0x1f7)]:_0x323062(0x2b9),[_0x323062(0x240)]:_0x323062(0x278),[_0x323062(0x2e9)]:_0x323062(0x236)+XPATH,[_0x323062(0x2d6)]:0x1e,[_0x323062(0x29a)]:0xf4240,[_0x323062(0x248)]:0x7530,[_0x323062(0x1e6)]:0x400*0x400,['TCP_NODELAY']:!![],['TCP_KEEPALIVE']:!![]};function validate_uuid(_0x293190,_0x211739){for(let _0x168a42=0x0;_0x168a42<0x10;_0x168a42++){if(_0x293190[_0x168a42]!==_0x211739[_0x168a42])return![];}return!![];}function concat_typed_arrays(_0x2bdb66,..._0x31b3e7){const _0x2a4e77=_0x323062;if(!_0x31b3e7||_0x31b3e7[_0x2a4e77(0x1e0)]<0x1)return _0x2bdb66;let _0x4f71ff=_0x2bdb66[_0x2a4e77(0x1e0)];for(let _0x1c24d3 of _0x31b3e7)_0x4f71ff+=_0x1c24d3[_0x2a4e77(0x1e0)];const _0x51718b=new _0x2bdb66['constructor'](_0x4f71ff);_0x51718b[_0x2a4e77(0x24d)](_0x2bdb66,0x0),_0x4f71ff=_0x2bdb66[_0x2a4e77(0x1e0)];for(let _0x346ffc of _0x31b3e7){_0x51718b[_0x2a4e77(0x24d)](_0x346ffc,_0x4f71ff),_0x4f71ff+=_0x346ffc['length'];}return _0x51718b;}function log(_0x8d2202,..._0x3de4c1){const _0x297297=_0x323062;if(SETTINGS[_0x297297(0x1f7)]===_0x297297(0x2b9))return;const _0x46f209={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0xc2e45d={'debug':'\x1b[36m','info':'\x1b[32m','warn':_0x297297(0x2da),'error':'\x1b[31m','reset':'\x1b[0m'},_0x103549=_0x46f209[SETTINGS['LOG_LEVEL']]||0x1,_0x3a0736=_0x46f209[_0x8d2202]||0x0;if(_0x3a0736>=_0x103549){const _0x13bb59=new Date()['toISOString'](),_0x101d66=_0xc2e45d[_0x8d2202]||_0xc2e45d[_0x297297(0x233)];console[_0x297297(0x2ba)](_0x101d66+'['+_0x13bb59+_0x297297(0x2e5)+_0x8d2202+']',..._0x3de4c1,_0xc2e45d[_0x297297(0x233)]);}}function cleanupOldFiles(){const _0x4373a3=_0x323062;try{fs[_0x4373a3(0x2af)](path[_0x4373a3(0x294)](FILE_PATH))?(fs[_0x4373a3(0x2e6)](path[_0x4373a3(0x294)](FILE_PATH),{'recursive':!![]}),console[_0x4373a3(0x2ba)](FILE_PATH+_0x4373a3(0x1e1))):console[_0x4373a3(0x2ba)](FILE_PATH+_0x4373a3(0x1dd));}catch(_0x4d1f3a){console[_0x4373a3(0x2ba)](_0x4373a3(0x2c5)+FILE_PATH);}}function createFolder(_0xa2781b){const _0x2f39b5=_0x323062;!fs[_0x2f39b5(0x2af)](_0xa2781b)?(fs['mkdirSync'](_0xa2781b),console[_0x2f39b5(0x2ba)](_0xa2781b+_0x2f39b5(0x217))):console[_0x2f39b5(0x2ba)](_0xa2781b+_0x2f39b5(0x27e));}function execPromise(_0x1f4dd3,_0x28b969={}){return new Promise((_0x1fe9c5,_0x4bdcc9)=>{const _0x431e2c=exec(_0x1f4dd3,_0x28b969,(_0x3a9f95,_0x5e6706,_0x5005f1)=>{const _0x12c3b4=_0x340b;if(_0x3a9f95){const _0x5dcf7f=new Error('Command\x20failed:\x20'+_0x3a9f95['message']);_0x5dcf7f[_0x12c3b4(0x281)]=_0x3a9f95['code'],_0x5dcf7f['stderr']=_0x5005f1[_0x12c3b4(0x26b)](),_0x4bdcc9(_0x5dcf7f);}else _0x1fe9c5(_0x5e6706[_0x12c3b4(0x26b)]());});});}async function detectProcess(_0x5892f8){const _0x467ccf=_0x323062,_0x4c075c=[{'cmd':'pidof\x20\x22'+_0x5892f8+'\x22','name':_0x467ccf(0x262)},{'cmd':_0x467ccf(0x1d7)+_0x5892f8+'\x22','name':_0x467ccf(0x243)},{'cmd':'ps\x20-eo\x20pid,comm\x20|\x20awk\x20-v\x20name=\x22'+_0x5892f8+_0x467ccf(0x21d),'name':'ps+awk'}];for(const _0x41b9ea of _0x4c075c){try{const _0x3cb4ad=await execPromise(_0x41b9ea[_0x467ccf(0x28c)]);if(_0x3cb4ad)return _0x3cb4ad['replace'](/\n/g,'\x20')[_0x467ccf(0x26b)]();}catch(_0x2094d1){_0x2094d1[_0x467ccf(0x281)]!==0x7f&&_0x2094d1['code']!==0x1&&console['debug']('[detectProcess]\x20'+_0x41b9ea[_0x467ccf(0x226)]+'\x20error:',_0x2094d1[_0x467ccf(0x2b1)]);}}return'';}async function killProcess(_0x66a64e){const _0x3e5bed=_0x323062;console['log']('Attempting\x20to\x20kill\x20process:\x20'+_0x66a64e);try{const _0x144873=await detectProcess(_0x66a64e);if(!_0x144873)return console['warn'](_0x3e5bed(0x254)+_0x66a64e+_0x3e5bed(0x296)),{'success':!![],'message':_0x3e5bed(0x287)};await execPromise('kill\x20-9\x20'+_0x144873);const _0x368375=_0x3e5bed(0x1f8)+_0x144873+')';return console[_0x3e5bed(0x2ba)](_0x368375),{'success':!![],'message':_0x368375};}catch(_0x37e64d){const _0x1f0a5a=_0x3e5bed(0x209)+_0x37e64d[_0x3e5bed(0x2b1)];return console[_0x3e5bed(0x256)](_0x1f0a5a),{'success':![],'message':_0x1f0a5a};}}function generateRandomString(_0x2e0f1b){const _0x1561d6=_0x323062,_0x4c5f67=_0x1561d6(0x25f);let _0x3bfba6='';for(let _0x18aa12=0x0;_0x18aa12<_0x2e0f1b;_0x18aa12++){_0x3bfba6+=_0x4c5f67[_0x1561d6(0x27c)](Math[_0x1561d6(0x2bc)](Math[_0x1561d6(0x28f)]()*_0x4c5f67[_0x1561d6(0x1e0)]));}return _0x3bfba6;}function getSystemArchitecture(){const _0x3660ed=_0x323062,_0x197257=os[_0x3660ed(0x2ce)]();return _0x197257===_0x3660ed(0x2e2)||_0x197257===_0x3660ed(0x1f1)||_0x197257===_0x3660ed(0x27b)?_0x3660ed(0x2e2):_0x3660ed(0x291);}function getFilesForArchitecture(_0x1f11fa){const _0x507801=_0x323062,_0x125b4a={'app':{'V0':{'arm':_0x507801(0x203),'amd':_0x507801(0x2b7)},'V1':{'arm':'https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','amd':_0x507801(0x2a6)}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0x5e82a3=[{'fileName':_0x507801(0x2d8)+generateRandomString(0x5),'originalName':_0x507801(0x2c4),'fileUrl':_0x125b4a['app'][NEZHA_VERSION][_0x1f11fa]}];return _0x5e82a3;}else return[];}async function download_function(_0x388ae2,_0x355ebf,_0x11dabb){const _0x59a5a1=_0x323062,_0x24e25d=path[_0x59a5a1(0x294)](FILE_PATH,_0x388ae2);let _0x3e1344=![];try{const _0x2ec54a=await axios({'method':_0x59a5a1(0x223),'url':_0x11dabb,'responseType':'stream'});await pipeline(_0x2ec54a['data'],fs[_0x59a5a1(0x231)](_0x24e25d)),console[_0x59a5a1(0x2ba)](_0x59a5a1(0x25a)+_0x355ebf+_0x59a5a1(0x24c)+_0x388ae2+_0x59a5a1(0x2c0)),_0x3e1344=!![];}catch(_0x35359c){console['log']('Download\x20'+_0x355ebf+_0x59a5a1(0x24c)+_0x388ae2+_0x59a5a1(0x26a)+_0x35359c['message']);}return{'fileName':_0x388ae2,'originalName':_0x355ebf,'filePath':_0x24e25d,'success':_0x3e1344};}let fileMapping={};async function downloadFiles(){const _0x2e0b6f=_0x323062;try{const _0x2ebb60=getSystemArchitecture();if(!_0x2ebb60)return console[_0x2e0b6f(0x2ba)](_0x2e0b6f(0x200)),fileMapping;const _0x12de8f=getFilesForArchitecture(_0x2ebb60);if(_0x12de8f[_0x2e0b6f(0x1e0)]===0x0)return console['log'](_0x2e0b6f(0x292)),fileMapping;const _0x163734=_0x12de8f['map'](_0x25fce1=>download_function(_0x25fce1[_0x2e0b6f(0x249)],_0x25fce1[_0x2e0b6f(0x2cd)],_0x25fce1['fileUrl'])),_0x23d1f0=await Promise[_0x2e0b6f(0x1df)](_0x163734);return _0x23d1f0[_0x2e0b6f(0x1e2)](_0x5ec40e=>{const _0x4f2430=_0x2e0b6f;if(_0x5ec40e[_0x4f2430(0x2a5)])try{fs[_0x4f2430(0x253)](_0x5ec40e[_0x4f2430(0x2a7)],0x1ed),console[_0x4f2430(0x2ba)](_0x4f2430(0x260)+_0x5ec40e['fileName']+_0x4f2430(0x1eb)),fileMapping[_0x5ec40e[_0x4f2430(0x2cd)]]=_0x5ec40e[_0x4f2430(0x249)];}catch(_0x295253){console[_0x4f2430(0x221)](_0x4f2430(0x26d)+_0x5ec40e['fileName']+':\x20'+_0x295253['message']);}}),fileMapping;}catch(_0x5c7e5d){return console[_0x2e0b6f(0x256)](_0x2e0b6f(0x20b),_0x5c7e5d),fileMapping;}}let NEZHA_TLS;function nezconfig(){const _0x5c3454=_0x323062,_0x534918=[_0x5c3454(0x201),'8443',_0x5c3454(0x2ab),_0x5c3454(0x215),_0x5c3454(0x26c),'2053'];if(NEZHA_VERSION==='V0')return _0x534918['includes'](NEZHA_PORT)?NEZHA_TLS='--tls':NEZHA_TLS='',NEZHA_TLS;else{if(NEZHA_VERSION==='V1'){_0x534918[_0x5c3454(0x1f9)](NEZHA_PORT)?NEZHA_TLS='true':NEZHA_TLS=_0x5c3454(0x24a);const _0x29608a=path[_0x5c3454(0x294)](FILE_PATH,'/config.yml'),_0x4fd366=_0x5c3454(0x2d4)+NEZHA_KEY+_0x5c3454(0x2ca)+NEZHA_SERVER+':'+NEZHA_PORT+_0x5c3454(0x1fc)+NEZHA_TLS+_0x5c3454(0x1da)+UUID;try{fs['writeFileSync'](_0x29608a,_0x4fd366),console[_0x5c3454(0x2ba)](_0x5c3454(0x251));}catch(_0x49f5be){console['error'](_0x5c3454(0x23d),_0x49f5be);}}}}async function runapp(){const _0x156eac=_0x323062;if(fileMapping[_0x156eac(0x2c4)]&&fs[_0x156eac(0x2af)](path['join'](FILE_PATH,fileMapping[_0x156eac(0x2c4)]))){if(NEZHA_VERSION==='V0'){const _0x30532c=_0x156eac(0x1e7)+FILE_PATH+'/'+fileMapping[_0x156eac(0x2c4)]+_0x156eac(0x267)+NEZHA_SERVER+':'+NEZHA_PORT+_0x156eac(0x2c7)+NEZHA_KEY+'\x20'+NEZHA_TLS+_0x156eac(0x285);try{await execPromise(_0x30532c);}catch(_0x7e7db6){console[_0x156eac(0x256)](fileMapping[_0x156eac(0x2c4)]+_0x156eac(0x2a8)+_0x7e7db6);}}else{if(NEZHA_VERSION==='V1'){const _0x47532a='nohup\x20'+FILE_PATH+'/'+fileMapping['app']+_0x156eac(0x216)+FILE_PATH+'/config.yml\x20>/dev/null\x202>&1\x20&';try{await execPromise(_0x47532a);}catch(_0x333002){console[_0x156eac(0x256)](fileMapping[_0x156eac(0x2c4)]+_0x156eac(0x2a8)+_0x333002);}}}}else console[_0x156eac(0x2ba)](_0x156eac(0x1ee));}async function run(){const _0xcc531=_0x323062;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){nezconfig();const _0x21d44b=await detectProcess(''+fileMapping[_0xcc531(0x2c4)]);if(_0x21d44b){}else await runapp();await delay(0x3e8),console['log'](fileMapping[_0xcc531(0x2c4)]+'\x20is\x20running');}else console[_0xcc531(0x2ba)](_0xcc531(0x2c1));}async function keep_alive(){const _0x1f196e=_0x323062;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x3fd667=await detectProcess(''+fileMapping[_0x1f196e(0x2c4)]);if(_0x3fd667){}else console[_0x1f196e(0x2ba)](fileMapping[_0x1f196e(0x2c4)]+_0x1f196e(0x268)),await runapp();}}function parse_uuid(_0x448725){const _0x12f400=_0x323062;_0x448725=_0x448725[_0x12f400(0x2df)]('-','');const _0x5c2efe=[];for(let _0x356d59=0x0;_0x356d59<0x10;_0x356d59++){_0x5c2efe[_0x12f400(0x29d)](parseInt(_0x448725[_0x12f400(0x297)](_0x356d59*0x2,0x2),0x10));}return _0x5c2efe;}async function read_vless_header(_0x1a8eb5,_0x4c6489){const _0x50cf98=_0x323062;let _0x4fd8e1=0x0,_0x13c3aa=new Uint8Array(),_0x5e1fb7={'value':_0x13c3aa,'done':![]};async function _0x106868(_0x2f0661){const _0x3f4cd8=_0x340b;if(_0x5e1fb7[_0x3f4cd8(0x22d)])throw new Error(_0x3f4cd8(0x2a3));const _0x551a87=_0x2f0661-_0x4fd8e1;if(_0x551a87<0x1)return;_0x5e1fb7=await read_atleast(_0x1a8eb5,_0x551a87),_0x4fd8e1+=_0x5e1fb7[_0x3f4cd8(0x238)][_0x3f4cd8(0x1e0)],_0x13c3aa=concat_typed_arrays(_0x13c3aa,_0x5e1fb7['value']);}await _0x106868(0x1+0x10+0x1);const _0x55c3a8=_0x13c3aa[0x0],_0x3bf4b3=_0x13c3aa[_0x50cf98(0x257)](0x1,0x1+0x10),_0xee66d6=parse_uuid(_0x4c6489);if(!validate_uuid(_0x3bf4b3,_0xee66d6))throw new Error(_0x50cf98(0x204));const _0x2aabc9=_0x13c3aa[0x1+0x10],_0x3471a0=0x1+0x10+0x1+_0x2aabc9+0x1+0x2+0x1;await _0x106868(_0x3471a0+0x1);const _0x40ca2f=_0x13c3aa[0x1+0x10+0x1+_0x2aabc9],_0x143c07=0x1;if(_0x40ca2f!==_0x143c07)throw new Error('unsupported\x20command:\x20'+_0x40ca2f);const _0x21761b=(_0x13c3aa[_0x3471a0-0x1-0x2]<<0x8)+_0x13c3aa[_0x3471a0-0x1-0x1],_0x26ee00=_0x13c3aa[_0x3471a0-0x1],_0x399557=0x1,_0x16546c=0x2,_0x1fe5c4=0x3;let _0x170d8d=-0x1;if(_0x26ee00===_0x399557)_0x170d8d=_0x3471a0+0x4;else{if(_0x26ee00===_0x1fe5c4)_0x170d8d=_0x3471a0+0x10;else _0x26ee00===_0x16546c&&(_0x170d8d=_0x3471a0+0x1+_0x13c3aa[_0x3471a0]);}if(_0x170d8d<0x0)throw new Error(_0x50cf98(0x242));await _0x106868(_0x170d8d);const _0x38694e=_0x3471a0;let _0x3658c3='';if(_0x26ee00===_0x399557)_0x3658c3=_0x13c3aa[_0x50cf98(0x257)](_0x38694e,_0x38694e+0x4)['join']('.');else{if(_0x26ee00===_0x16546c)_0x3658c3=new TextDecoder()[_0x50cf98(0x261)](_0x13c3aa[_0x50cf98(0x257)](_0x38694e+0x1,_0x38694e+0x1+_0x13c3aa[_0x38694e]));else _0x26ee00===_0x1fe5c4&&(_0x3658c3=_0x13c3aa[_0x50cf98(0x257)](_0x38694e,_0x38694e+0x10)['reduce']((_0x361e40,_0x199fcf,_0x291b26,_0xd3161c)=>_0x291b26%0x2?_0x361e40[_0x50cf98(0x2a2)](((_0xd3161c[_0x291b26-0x1]<<0x8)+_0x199fcf)[_0x50cf98(0x277)](0x10)):_0x361e40,[])['join'](':'));}if(!_0x3658c3){log(_0x50cf98(0x256),_0x50cf98(0x25e));throw new Error('parse\x20hostname\x20failed');}return log('info',_0x50cf98(0x2eb)+_0x3658c3+':'+_0x21761b),{'hostname':_0x3658c3,'port':_0x21761b,'data':_0x13c3aa[_0x50cf98(0x257)](_0x170d8d),'resp':new Uint8Array([_0x55c3a8,0x0])};}async function read_atleast(_0x1bd9b3,_0x53d259){const _0x49ef7f=_0x323062,_0x268b5f=[];let _0x3fc502=![];while(_0x53d259>0x0&&!_0x3fc502){const _0x3189cd=await _0x1bd9b3[_0x49ef7f(0x1ea)]();if(_0x3189cd[_0x49ef7f(0x238)]){const _0x5baa03=new Uint8Array(_0x3189cd[_0x49ef7f(0x238)]);_0x268b5f[_0x49ef7f(0x29d)](_0x5baa03),_0x53d259-=_0x5baa03[_0x49ef7f(0x1e0)];}_0x3fc502=_0x3189cd[_0x49ef7f(0x22d)];}if(_0x53d259>0x0)throw new Error(_0x49ef7f(0x286));return{'value':concat_typed_arrays(..._0x268b5f),'done':_0x3fc502};}async function parse_header(_0x345a8a,_0x5bf787){const _0x1145e6=_0x323062;log(_0x1145e6(0x211),_0x1145e6(0x2aa));const _0x2b9be4=_0x5bf787[_0x1145e6(0x29b)][_0x1145e6(0x20f)]();try{const _0x3c652c=await read_vless_header(_0x2b9be4,_0x345a8a);return log(_0x1145e6(0x211),_0x1145e6(0x280)),_0x3c652c;}catch(_0x49354c){log(_0x1145e6(0x256),'VLESS\x20header\x20parse\x20error:\x20'+_0x49354c[_0x1145e6(0x2b1)]);throw new Error('read\x20vless\x20header\x20error:\x20'+_0x49354c[_0x1145e6(0x2b1)]);}finally{_0x2b9be4[_0x1145e6(0x2be)]();}}async function connect_remote(_0x411bfa,_0x141a4d){const _0x48e5bb=_0x323062,_0x1949f5=0x1f40;try{const _0x6a2420=await timed_connect(_0x411bfa,_0x141a4d,_0x1949f5);return _0x6a2420[_0x48e5bb(0x258)](!![]),_0x6a2420[_0x48e5bb(0x299)](!![],0x3e8),_0x6a2420['bufferSize']=parseInt(SETTINGS[_0x48e5bb(0x240)])*0x400,log(_0x48e5bb(0x2cc),_0x48e5bb(0x213)+_0x411bfa+':'+_0x141a4d),_0x6a2420;}catch(_0x28f67d){log('error','Connection\x20failed:\x20'+_0x28f67d[_0x48e5bb(0x2b1)]);throw _0x28f67d;}}function timed_connect(_0x4dd1fe,_0x481420,_0x3d6972){return new Promise((_0x3916a5,_0x3a8ae7)=>{const _0x463bd2=_0x340b,_0x1ac2c6=net[_0x463bd2(0x20a)]({'host':_0x4dd1fe,'port':_0x481420}),_0x4dc20a=setTimeout(()=>{const _0x46836c=_0x463bd2;_0x3a8ae7(new Error(_0x46836c(0x228)));},_0x3d6972);_0x1ac2c6['on'](_0x463bd2(0x22c),()=>{clearTimeout(_0x4dc20a),_0x3916a5(_0x1ac2c6);}),_0x1ac2c6['on'](_0x463bd2(0x256),_0x308a23=>{clearTimeout(_0x4dc20a),_0x3a8ae7(_0x308a23);});});}function pipe_relay(){async function _0x4d6157(_0x3aaa2b,_0x5f5602,_0x2cf1d0){const _0x232523=_0x340b,_0xcfeed6=parseInt(SETTINGS[_0x232523(0x1e6)]);if(_0x2cf1d0[_0x232523(0x1e0)]>0x0){if(_0x5f5602[_0x232523(0x24b)])_0x5f5602['cork'](),_0x5f5602[_0x232523(0x24b)](_0x2cf1d0),process[_0x232523(0x2d0)](()=>_0x5f5602[_0x232523(0x1f5)]());else{const _0x236a67=_0x5f5602[_0x232523(0x2c9)][_0x232523(0x1fb)]();try{await _0x236a67[_0x232523(0x24b)](_0x2cf1d0);}finally{_0x236a67[_0x232523(0x2be)]();}}}try{_0x3aaa2b[_0x232523(0x2dc)]?(_0x3aaa2b[_0x232523(0x265)](),_0x3aaa2b['pipe'](_0x5f5602,{'end':!![],'highWaterMark':_0xcfeed6}),_0x3aaa2b[_0x232523(0x266)]()):await _0x3aaa2b[_0x232523(0x29b)][_0x232523(0x1e3)](_0x5f5602[_0x232523(0x2c9)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x232523(0x2bf)](SETTINGS[_0x232523(0x248)])});}catch(_0x53db7e){!_0x53db7e[_0x232523(0x2b1)][_0x232523(0x1f9)](_0x232523(0x290))&&log('error',_0x232523(0x1f4),_0x53db7e[_0x232523(0x2b1)]);throw _0x53db7e;}}return _0x4d6157;}function socketToWebStream(_0x3c5bd5){const _0x3ec7d9=_0x323062;let _0x4d05db,_0x43c4bf;return _0x3c5bd5['on'](_0x3ec7d9(0x256),_0x3135f0=>{const _0x11fd31=_0x3ec7d9;log(_0x11fd31(0x256),_0x11fd31(0x264),_0x3135f0[_0x11fd31(0x2b1)]),_0x4d05db?.[_0x11fd31(0x256)](_0x3135f0),_0x43c4bf?.[_0x11fd31(0x256)](_0x3135f0);}),{'readable':new ReadableStream({'start'(_0x2a867b){const _0x2c37e0=_0x3ec7d9;_0x4d05db=_0x2a867b,_0x3c5bd5['on'](_0x2c37e0(0x1d6),_0x15e40f=>{const _0x4ab102=_0x2c37e0;try{_0x2a867b[_0x4ab102(0x206)](_0x15e40f);}catch(_0x3cd85b){log(_0x4ab102(0x256),_0x4ab102(0x2ae),_0x3cd85b[_0x4ab102(0x2b1)]);}}),_0x3c5bd5['on'](_0x2c37e0(0x2ec),()=>{const _0x5cce45=_0x2c37e0;try{_0x2a867b[_0x5cce45(0x25d)]();}catch(_0x5d30bb){log('error',_0x5cce45(0x205),_0x5d30bb[_0x5cce45(0x2b1)]);}});},'cancel'(){const _0x377e05=_0x3ec7d9;_0x3c5bd5[_0x377e05(0x225)]();}}),'writable':new WritableStream({'start'(_0x38d456){_0x43c4bf=_0x38d456;},'write'(_0x409020){return new Promise((_0x4405b0,_0x4663b6)=>{const _0x53d2e3=_0x340b;if(_0x3c5bd5['destroyed']){_0x4663b6(new Error('Socket\x20is\x20destroyed'));return;}_0x3c5bd5[_0x53d2e3(0x24b)](_0x409020,_0x3c6c7e=>{if(_0x3c6c7e)_0x4663b6(_0x3c6c7e);else _0x4405b0();});});},'close'(){const _0x1bf261=_0x3ec7d9;!_0x3c5bd5[_0x1bf261(0x2e1)]&&_0x3c5bd5[_0x1bf261(0x2ec)]();},'abort'(_0x536efb){_0x3c5bd5['destroy'](_0x536efb);}})};}function relay(_0x152fb1,_0x4dab1c,_0x17e9e3,_0x18d28f){const _0x170d51=_0x323062,_0x281308=pipe_relay();let _0x4d285e=![];const _0xea7d02=socketToWebStream(_0x17e9e3);function _0x14e7ed(){const _0x58f321=_0x340b;if(!_0x4d285e){_0x4d285e=!![];try{_0x17e9e3[_0x58f321(0x225)]();}catch(_0x21653e){!_0x21653e[_0x58f321(0x2b1)][_0x58f321(0x1f9)]('aborted')&&!_0x21653e[_0x58f321(0x2b1)][_0x58f321(0x1f9)](_0x58f321(0x1fe))&&log('error',_0x58f321(0x2dd)+_0x21653e[_0x58f321(0x2b1)]);}}}const _0x14de78=_0x281308(_0x4dab1c,_0xea7d02,_0x18d28f[_0x170d51(0x1d6)])[_0x170d51(0x220)](_0x2c96d0=>{const _0x9c4a55=_0x170d51;!_0x2c96d0[_0x9c4a55(0x2b1)][_0x9c4a55(0x1f9)]('aborted')&&!_0x2c96d0['message'][_0x9c4a55(0x1f9)](_0x9c4a55(0x1fe))&&log(_0x9c4a55(0x256),_0x9c4a55(0x2cb)+_0x2c96d0[_0x9c4a55(0x2b1)]);})[_0x170d51(0x1db)](()=>{const _0xc2e52=_0x170d51;_0x4dab1c[_0xc2e52(0x1fd)]&&_0x4dab1c[_0xc2e52(0x1fd)]();}),_0x4cbe34=_0x281308(_0xea7d02,_0x4dab1c,_0x18d28f[_0x170d51(0x214)])['catch'](_0x460cb3=>{const _0xebaeb2=_0x170d51;!_0x460cb3['message'][_0xebaeb2(0x1f9)](_0xebaeb2(0x290))&&!_0x460cb3['message'][_0xebaeb2(0x1f9)](_0xebaeb2(0x1fe))&&log(_0xebaeb2(0x256),_0xebaeb2(0x234)+_0x460cb3[_0xebaeb2(0x2b1)]);});_0x4cbe34[_0x170d51(0x1db)](()=>_0x14de78)[_0x170d51(0x1db)](_0x14e7ed);}const sessions=new Map();class Session{constructor(_0x43e910){const _0xd968c6=_0x323062;this[_0xd968c6(0x245)]=_0x43e910,this[_0xd968c6(0x2ea)]=0x0,this[_0xd968c6(0x247)]=![],this[_0xd968c6(0x22b)]=Date[_0xd968c6(0x2e4)](),this[_0xd968c6(0x230)]=null,this[_0xd968c6(0x2b6)]=null,this['initialized']=![],this[_0xd968c6(0x1de)]=null,this[_0xd968c6(0x274)]=![],this[_0xd968c6(0x1fa)]=new Map(),this[_0xd968c6(0x2de)]=![],this[_0xd968c6(0x259)]=[],this[_0xd968c6(0x250)]=null,this[_0xd968c6(0x293)]=new Map(),log(_0xd968c6(0x211),_0xd968c6(0x227)+_0x43e910);}async[_0x323062(0x2a0)](_0x113bd1){const _0xe70031=_0x323062;if(this[_0xe70031(0x2d1)])return!![];try{log(_0xe70031(0x211),_0xe70031(0x2b8));const _0x2d8b87=new ReadableStream({'start'(_0x44e7c7){const _0x46fe39=_0xe70031;_0x44e7c7[_0x46fe39(0x206)](_0x113bd1),_0x44e7c7[_0x46fe39(0x25d)]();}}),_0xd4cf0c={'readable':_0x2d8b87,'writable':new WritableStream()};return this[_0xe70031(0x230)]=await parse_header(SETTINGS[_0xe70031(0x2e3)],_0xd4cf0c),log('info',_0xe70031(0x28e)+this[_0xe70031(0x230)][_0xe70031(0x21a)]+':'+this['vlessHeader'][_0xe70031(0x2b0)]),this['remote']=await connect_remote(this[_0xe70031(0x230)][_0xe70031(0x21a)],this[_0xe70031(0x230)][_0xe70031(0x2b0)]),log(_0xe70031(0x2cc),_0xe70031(0x272)),this[_0xe70031(0x2d1)]=!![],!![];}catch(_0x120560){return log('error','Failed\x20to\x20initialize\x20VLESS:\x20'+_0x120560['message']),![];}}async[_0x323062(0x1f0)](_0x2ee314,_0x3ce56a){const _0x5bce4d=_0x323062;try{this[_0x5bce4d(0x293)]['set'](_0x2ee314,_0x3ce56a),log('debug',_0x5bce4d(0x255)+_0x2ee314+_0x5bce4d(0x2a9)+_0x3ce56a['length']);while(this[_0x5bce4d(0x293)][_0x5bce4d(0x284)](this[_0x5bce4d(0x2ea)])){const _0x6afda6=this[_0x5bce4d(0x293)][_0x5bce4d(0x223)](this[_0x5bce4d(0x2ea)]);this['pendingBuffers'][_0x5bce4d(0x229)](this[_0x5bce4d(0x2ea)]);if(!this[_0x5bce4d(0x2d1)]&&this[_0x5bce4d(0x2ea)]===0x0){if(!await this[_0x5bce4d(0x2a0)](_0x6afda6))throw new Error(_0x5bce4d(0x2d5));this[_0x5bce4d(0x1de)]=Buffer['from'](this[_0x5bce4d(0x230)][_0x5bce4d(0x214)]),await this[_0x5bce4d(0x21e)](this[_0x5bce4d(0x230)][_0x5bce4d(0x1d6)]),this[_0x5bce4d(0x250)]&&this[_0x5bce4d(0x2e0)]();}else{if(!this[_0x5bce4d(0x2d1)]){log(_0x5bce4d(0x221),_0x5bce4d(0x276)+_0x2ee314+_0x5bce4d(0x1f6));continue;}await this['_writeToRemote'](_0x6afda6);}this[_0x5bce4d(0x2ea)]++,log('debug',_0x5bce4d(0x22f)+(this[_0x5bce4d(0x2ea)]-0x1));}if(this[_0x5bce4d(0x293)]['size']>SETTINGS[_0x5bce4d(0x2d6)])throw new Error('Too\x20many\x20buffered\x20packets');return!![];}catch(_0x4f89da){log('error',_0x5bce4d(0x1dc)+_0x4f89da['message']);throw _0x4f89da;}}[_0x323062(0x2e0)](){const _0x38ac55=_0x323062;if(!this['currentStreamRes']||!this[_0x38ac55(0x1de)])return;try{const _0x2eb11d=this[_0x38ac55(0x250)][_0x38ac55(0x25c)]?.['alpnProtocol']||'http/1.1',_0x58d5cf=_0x2eb11d==='h2';!this[_0x38ac55(0x274)]&&(log('debug',_0x38ac55(0x28a)+_0x2eb11d+_0x38ac55(0x2c3)+this['responseHeader'][_0x38ac55(0x1e0)]+_0x38ac55(0x27f)),this[_0x38ac55(0x250)][_0x38ac55(0x24b)](this[_0x38ac55(0x1de)]),this[_0x38ac55(0x274)]=!![]);if(_0x58d5cf){this[_0x38ac55(0x250)]['socket']['setNoDelay'](!![]);const _0x154e5f=new require(_0x38ac55(0x2a1))[_0x38ac55(0x2c6)]({'transform'(_0x28a4b4,_0x490f55,_0x3d445b){const _0x2c0640=_0x38ac55,_0x597af0=0x4000;for(let _0x197a7a=0x0;_0x197a7a<_0x28a4b4[_0x2c0640(0x1e0)];_0x197a7a+=_0x597af0){this[_0x2c0640(0x29d)](_0x28a4b4[_0x2c0640(0x257)](_0x197a7a,_0x197a7a+_0x597af0));}_0x3d445b();}});this[_0x38ac55(0x2b6)][_0x38ac55(0x2dc)](_0x154e5f)[_0x38ac55(0x2dc)](this[_0x38ac55(0x250)]);}else this['remote'][_0x38ac55(0x2dc)](this['currentStreamRes']);this['remote']['on'](_0x38ac55(0x2ec),()=>{const _0x273c39=_0x38ac55;!this[_0x273c39(0x250)][_0x273c39(0x28b)]&&this[_0x273c39(0x250)][_0x273c39(0x2ec)]();}),this[_0x38ac55(0x2b6)]['on']('error',_0x4abb03=>{const _0x39ff8d=_0x38ac55;log('error',_0x39ff8d(0x207)+_0x4abb03[_0x39ff8d(0x2b1)]),!this[_0x39ff8d(0x250)][_0x39ff8d(0x28b)]&&this[_0x39ff8d(0x250)]['end']();});}catch(_0x34521c){log(_0x38ac55(0x256),_0x38ac55(0x23e)+_0x34521c['message']),this[_0x38ac55(0x26e)]();}}[_0x323062(0x271)](_0x11eb3b,_0x556cbb){const _0x5b0e57=_0x323062;return!_0x11eb3b[_0x5b0e57(0x24e)]&&_0x11eb3b['writeHead'](0xc8,_0x556cbb),this[_0x5b0e57(0x250)]=_0x11eb3b,this[_0x5b0e57(0x2d1)]&&this['responseHeader']&&this['_startDownstreamResponse'](),_0x11eb3b['on'](_0x5b0e57(0x25d),()=>{const _0x43875e=_0x5b0e57;log(_0x43875e(0x2cc),'Client\x20connection\x20closed'),this['cleanup']();}),!![];}async[_0x323062(0x21e)](_0x2b658b){const _0x3cde23=_0x323062;if(!this[_0x3cde23(0x2b6)]||this[_0x3cde23(0x2b6)][_0x3cde23(0x2e1)])throw new Error(_0x3cde23(0x2d3));return new Promise((_0x2b1cb1,_0x14c385)=>{const _0x5a4b5e=_0x3cde23;this['remote'][_0x5a4b5e(0x24b)](_0x2b658b,_0x542bd7=>{const _0x497f18=_0x5a4b5e;_0x542bd7?(log(_0x497f18(0x256),_0x497f18(0x2b5)+_0x542bd7[_0x497f18(0x2b1)]),_0x14c385(_0x542bd7)):_0x2b1cb1();});});}[_0x323062(0x2e0)](){const _0x54a736=_0x323062;if(!this['currentStreamRes']||!this[_0x54a736(0x1de)])return;try{!this['headerSent']&&(this[_0x54a736(0x250)]['write'](this['responseHeader']),this[_0x54a736(0x274)]=!![]),this[_0x54a736(0x2b6)][_0x54a736(0x2dc)](this[_0x54a736(0x250)]),this[_0x54a736(0x2b6)]['on'](_0x54a736(0x2ec),()=>{const _0x4608df=_0x54a736;!this[_0x4608df(0x250)]['writableEnded']&&this[_0x4608df(0x250)][_0x4608df(0x2ec)]();}),this['remote']['on'](_0x54a736(0x256),_0x4f062c=>{const _0x2f1644=_0x54a736;log(_0x2f1644(0x256),'Remote\x20error:\x20'+_0x4f062c[_0x2f1644(0x2b1)]),!this[_0x2f1644(0x250)][_0x2f1644(0x28b)]&&this[_0x2f1644(0x250)][_0x2f1644(0x2ec)]();});}catch(_0x4cfede){log(_0x54a736(0x256),_0x54a736(0x23e)+_0x4cfede[_0x54a736(0x2b1)]),this[_0x54a736(0x26e)]();}}[_0x323062(0x26e)](){const _0x550b8a=_0x323062;!this['cleaned']&&(this[_0x550b8a(0x2de)]=!![],log(_0x550b8a(0x211),_0x550b8a(0x218)+this[_0x550b8a(0x245)]),this[_0x550b8a(0x2b6)]&&(this['remote']['destroy'](),this[_0x550b8a(0x2b6)]=null),this[_0x550b8a(0x2d1)]=![],this[_0x550b8a(0x274)]=![]);}}async function getCloudflareMeta(){return new Promise((_0x23dc3a,_0x1e3b2d)=>{const _0x5b3282=_0x340b,_0x22b926={'hostname':_0x5b3282(0x1e9),'path':_0x5b3282(0x288),'method':_0x5b3282(0x208)},_0x270915=https[_0x5b3282(0x282)](_0x22b926,_0x30d29e=>{const _0x2ed925=_0x5b3282;let _0x146af0='';_0x30d29e['on'](_0x2ed925(0x1d6),_0x19e0f9=>{_0x146af0+=_0x19e0f9;}),_0x30d29e['on'](_0x2ed925(0x2ec),()=>{const _0x430ff6=_0x2ed925,_0x3510f1=JSON[_0x430ff6(0x2bb)](_0x146af0);_0x23dc3a(_0x3510f1);});});_0x270915['on']('error',_0x1417e7=>{_0x1e3b2d(_0x1417e7);}),_0x270915[_0x5b3282(0x2ec)]();});}let UPLOAD_DATA;async function getipandisp(){const _0x503a96=_0x323062;let _0x4de48a=await getCloudflareMeta(),_0x1a4a65=_0x4de48a[_0x503a96(0x289)],_0x5bdb65=_0x4de48a[_0x503a96(0x2c2)],_0x54d6c5=_0x4de48a[_0x503a96(0x244)];ISP=(_0x5bdb65+'-'+_0x54d6c5)[_0x503a96(0x2db)](/ /g,'_');let _0x2aeaa4=MY_DOMAIN;return!MY_DOMAIN&&(_0x1a4a65['includes'](':')?_0x2aeaa4='['+_0x1a4a65+']':_0x2aeaa4=''+_0x1a4a65),KEEPALIVE==!![]?UPLOAD_DATA=_0x503a96(0x2c8)+UUID+'@'+CFIP+':'+CFPORT+_0x503a96(0x2b3)+_0x2aeaa4+_0x503a96(0x21f)+_0x2aeaa4+_0x503a96(0x232)+SETTINGS['XPATH']+'&mode=packet-up#'+ISP+'-'+SUB_NAME:UPLOAD_DATA=_0x503a96(0x2c8)+UUID+'@'+_0x2aeaa4+':'+PORT+_0x503a96(0x25b)+_0x2aeaa4+'&fp=chrome&allowInsecure=1&type=xhttp&host='+_0x2aeaa4+_0x503a96(0x232)+SETTINGS[_0x503a96(0x2e9)]+'&mode=packet-up#'+ISP+'-'+SUB_NAME,UPLOAD_DATA;}const server=http[_0x323062(0x22e)]((_0x500227,_0x213824)=>{const _0x5cb8de=_0x323062,_0xf9a835={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x5cb8de(0x295),'Cache-Control':_0x5cb8de(0x29c),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x500227[_0x5cb8de(0x2ad)]==='/'){_0x213824[_0x5cb8de(0x1e5)](0xc8,{'Content-Type':_0x5cb8de(0x1d8)}),_0x213824[_0x5cb8de(0x2ec)](_0x5cb8de(0x21c));return;}if(_0x500227[_0x5cb8de(0x2ad)]==='/'+SUB_PATH){const _0x4b784e=''+UPLOAD_DATA,_0x3e7c2a=Buffer[_0x5cb8de(0x222)](_0x4b784e)[_0x5cb8de(0x277)](_0x5cb8de(0x27a));_0x213824[_0x5cb8de(0x1e5)](0xc8,{'Content-Type':'text/plain'}),_0x213824[_0x5cb8de(0x2ec)](_0x3e7c2a+'\x0a');return;}const _0x17a7bd=_0x500227[_0x5cb8de(0x2ad)][_0x5cb8de(0x2d9)](new RegExp(XPATH+_0x5cb8de(0x252)));if(!_0x17a7bd){_0x213824[_0x5cb8de(0x1e5)](0x194),_0x213824['end']();return;}const _0x21ffd3=_0x17a7bd[0x1],_0x52acf7=_0x17a7bd[0x2]?parseInt(_0x17a7bd[0x2]):null;if(_0x500227[_0x5cb8de(0x2d2)]===_0x5cb8de(0x208)&&!_0x52acf7){_0xf9a835['Content-Type']=_0x5cb8de(0x1ff),_0xf9a835[_0x5cb8de(0x2bd)]='chunked';let _0xec2085=sessions[_0x5cb8de(0x223)](_0x21ffd3);!_0xec2085&&(_0xec2085=new Session(_0x21ffd3),sessions['set'](_0x21ffd3,_0xec2085),log('info',_0x5cb8de(0x1f3)+_0x21ffd3));_0xec2085[_0x5cb8de(0x247)]=!![];!_0xec2085[_0x5cb8de(0x271)](_0x213824,_0xf9a835)&&(log('error','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20'+_0x21ffd3),!_0x213824[_0x5cb8de(0x24e)]&&(_0x213824[_0x5cb8de(0x1e5)](0x1f4),_0x213824[_0x5cb8de(0x2ec)]()),_0xec2085[_0x5cb8de(0x26e)](),sessions[_0x5cb8de(0x229)](_0x21ffd3));return;}if(_0x500227[_0x5cb8de(0x2d2)]==='POST'&&_0x52acf7!==null){let _0x196d1a=sessions[_0x5cb8de(0x223)](_0x21ffd3);!_0x196d1a&&(_0x196d1a=new Session(_0x21ffd3),sessions['set'](_0x21ffd3,_0x196d1a),log(_0x5cb8de(0x2cc),'Created\x20new\x20session\x20for\x20POST:\x20'+_0x21ffd3),setTimeout(()=>{const _0x2d5c71=_0x5cb8de,_0x32425f=sessions[_0x2d5c71(0x223)](_0x21ffd3);_0x32425f&&!_0x32425f[_0x2d5c71(0x247)]&&(log('warn',_0x2d5c71(0x29f)+_0x21ffd3+_0x2d5c71(0x23c)),_0x32425f[_0x2d5c71(0x26e)](),sessions[_0x2d5c71(0x229)](_0x21ffd3));},SETTINGS[_0x5cb8de(0x248)]));let _0xbf7fe4=[],_0x105238=0x0,_0x20d5c7=![];_0x500227['on'](_0x5cb8de(0x1d6),_0x301b07=>{const _0xe6b8ac=_0x5cb8de;_0x105238+=_0x301b07[_0xe6b8ac(0x1e0)];if(_0x105238>SETTINGS[_0xe6b8ac(0x29a)]){!_0x20d5c7&&(_0x213824[_0xe6b8ac(0x1e5)](0x19d),_0x213824['end'](),_0x20d5c7=!![]);return;}_0xbf7fe4['push'](_0x301b07);}),_0x500227['on']('end',async()=>{const _0x55ae58=_0x5cb8de;if(_0x20d5c7)return;try{const _0x3ee5c7=Buffer['concat'](_0xbf7fe4);log(_0x55ae58(0x2cc),_0x55ae58(0x22a)+_0x52acf7+',\x20size='+_0x3ee5c7[_0x55ae58(0x1e0)]),await _0x196d1a[_0x55ae58(0x1f0)](_0x52acf7,_0x3ee5c7),!_0x20d5c7&&(_0x213824[_0x55ae58(0x1e5)](0xc8,_0xf9a835),_0x20d5c7=!![]),_0x213824['end']();}catch(_0x1ecce7){log('error','Failed\x20to\x20process\x20POST\x20request:\x20'+_0x1ecce7['message']),_0x196d1a[_0x55ae58(0x26e)](),sessions[_0x55ae58(0x229)](_0x21ffd3),!_0x20d5c7&&(_0x213824[_0x55ae58(0x1e5)](0x1f4),_0x20d5c7=!![]),_0x213824[_0x55ae58(0x2ec)]();}});return;}_0x213824[_0x5cb8de(0x1e5)](0x194),_0x213824[_0x5cb8de(0x2ec)]();});server['on'](_0x323062(0x23f),_0x5ac119=>{const _0x957c31=_0x323062;log(_0x957c31(0x211),'New\x20secure\x20connection\x20using:\x20'+(_0x5ac119[_0x957c31(0x212)]||_0x957c31(0x1e4)));});function generatePadding(_0xfc4449,_0x399a47){const _0x2e7891=_0x323062,_0x5177d9=_0xfc4449+Math[_0x2e7891(0x2bc)](Math['random']()*(_0x399a47-_0xfc4449));return Buffer[_0x2e7891(0x222)](Array(_0x5177d9)[_0x2e7891(0x27d)]('X')[_0x2e7891(0x294)](''))['toString'](_0x2e7891(0x27a));}function _0x340b(_0x1024c9,_0x4684c6){const _0x247159=_0x2471();return _0x340b=function(_0x340bd8,_0x2b0aa8){_0x340bd8=_0x340bd8-0x1d6;let _0x1ca4a9=_0x247159[_0x340bd8];return _0x1ca4a9;},_0x340b(_0x1024c9,_0x4684c6);}server[_0x323062(0x23b)]=0x975e0,server[_0x323062(0x273)]=0x98968,server['on'](_0x323062(0x256),_0x2acc51=>{const _0x4a6adc=_0x323062;log(_0x4a6adc(0x256),_0x4a6adc(0x1ec)+_0x2acc51[_0x4a6adc(0x2b1)]);});function _0x2471(){const _0x4494aa=['aarch64','charAt','fill','\x20already\x20exists','\x20bytes','VLESS\x20header\x20parsed\x20successfully','code','request','net','has','\x20--report-delay=4\x20--skip-conn\x20--skip-procs\x20--disable-auto-update\x20>/dev/null\x202>&1\x20&','not\x20enough\x20data\x20to\x20read','Process\x20not\x20found','/meta','clientIp','Sending\x20VLESS\x20response\x20header\x20(','writableEnded','cmd','pathname','VLESS\x20header\x20parsed:\x20','random','aborted','amd','Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture','pendingBuffers','join','GET,\x20POST','\x27\x20not\x20found','substr','./.npm','setKeepAlive','MAX_POST_SIZE','readable','no-store','push','CFIP','Session\x20','initializeVLESS','stream','concat','header\x20length\x20too\x20short','2545146QZiLlU','success','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1','filePath','\x20running\x20error:\x20',',\x20size=','Starting\x20to\x20parse\x20VLESS\x20header','2096','child_process','url','Read\x20controller\x20error:','existsSync','port','message','541478xPjjMO','?encryption=none&security=tls&sni=','2000570CVhgLI','Failed\x20to\x20write\x20to\x20remote:\x20','remote','https://github.com/kahunama/myfile/releases/download/main/nezha-agent','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','none','log','parse','floor','Transfer-Encoding','releaseLock','timeout',')\x20successfully','app\x20variable\x20is\x20empty,\x20skip\x20running','country','):\x20','app','unable\x20to\x20rm\x20','Transform','\x20-p\x20','vless://','writable','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','Upload\x20error:\x20','info','originalName','arch','utf8','nextTick','initialized','method','Remote\x20connection\x20not\x20available','client_secret:\x20','Failed\x20to\x20initialize\x20VLESS\x20connection','MAX_BUFFERED_POSTS','1289256nULQbq','tmp','match','\x1b[33m','replace','pipe','Cleanup\x20error:\x20','cleaned','replaceAll','_startDownstreamResponse','destroyed','arm','UUID','now',']\x20[','rmSync','FILE_PATH','statusCode','XPATH','nextSeq','VLESS\x20connection\x20to\x20','end','SUB_PATH','data','pgrep\x20-x\x20\x22','text/plain','MY_DOMAIN','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','finally','Process\x20packet\x20error:\x20','\x20not\x20created','responseHeader','all','length','\x20deleted','forEach','pipeTo','http/1.1','writeHead','CHUNK_SIZE','nohup\x20','HTTP\x20error!\x20status:\x20','speed.cloudflare.com','read',':\x20755','Server\x20error:\x20','http','app\x20file\x20not\x20found,\x20skip\x20running','env','processPacket','arm64','POST','Created\x20new\x20session\x20for\x20GET:\x20','Relay\x20error:','uncork','\x20before\x20initialization','LOG_LEVEL','Killed\x20process\x20(PIDs:\x20','includes','bufferedData','getWriter','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','reading_done','socket\x20hang\x20up','application/octet-stream','Can\x27t\x20determine\x20system\x20architecture.','443','lstatSync','https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','invalid\x20UUID','Read\x20controller\x20close\x20error:','enqueue','Remote\x20error:\x20','GET','Kill\x20failed:\x20','createConnection','Error\x20downloading\x20files:','Upload\x20failed:','177260yjUPWf','KEEPALIVE','getReader','exec','debug','alpnProtocol','Connected\x20to\x20','resp','2087','\x20-c\x20','\x20is\x20created','Cleaning\x20up\x20session\x20','statusMessage','hostname','application/json;\x20charset=utf-8','Hello,\x20World\x0a','\x22\x20\x27$2\x20==\x20name\x20{print\x20$1}\x27','_writeToRemote','&fp=chrome&allowInsecure=1&type=xhttp&host=','catch','warn','from','get','SUB_URL','destroy','name','Created\x20new\x20session\x20with\x20UUID:\x20','connect\x20timeout','delete','Processing\x20packet:\x20seq=','lastActivity','connect','done','createServer','Processed\x20packet\x20seq=','vlessHeader','createWriteStream','&path=','reset','Download\x20error:\x20','stream/promises','%2F','315965kTXuNv','value','TIME','path','keepAliveTimeout','\x20timed\x20out\x20without\x20downstream','Error\x20creating\x20or\x20writing\x20config.yml\x20file:','Error\x20starting\x20downstream:\x20','secureConnection','BUFFER_SIZE','NEZHA_SERVER','read\x20address\x20type\x20failed','pgrep','asOrganization','uuid','7258616zznMSQ','downstreamStarted','SESSION_TIMEOUT','fileName','false','write','\x20(renamed\x20to\x20','set','headersSent','listen','currentStreamRes','config.yml\x20file\x20created\x20and\x20written\x20successfully.','/([^/]+)(?:/([0-9]+))?$','chmodSync','Process\x20\x27','Buffered\x20packet\x20seq=','error','slice','setNoDelay','pendingPackets','Download\x20','?encryption=none&security=none&sni=','socket','close','Failed\x20to\x20parse\x20hostname','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','Empowerment\x20success\x20for\x20','decode','pidof','PORT','Socket\x20error:','pause','resume','\x20-s\x20','\x20runs\x20again\x20!','axios',')\x20failed:\x20','trim','2083','Empowerment\x20failed\x20for\x20','cleanup','NEZHA_KEY','CFPORT','startDownstream','Remote\x20connection\x20established','headersTimeout','headerSent','39fQguXo','Received\x20out\x20of\x20order\x20packet\x20seq=','toString','2048','upload\x20failed:','base64'];_0x2471=function(){return _0x4494aa;};return _0x2471();}async function uploadSubscription(_0x31f97e,_0x263b3f,_0x460865){const _0x3f8b33=_0x323062,_0x3d9d04=JSON['stringify']({'URL_NAME':_0x31f97e,'URL':_0x263b3f}),_0x59eb54=Buffer[_0x3f8b33(0x222)](_0x3d9d04,_0x3f8b33(0x2cf)),_0x2b75f7=_0x59eb54[_0x3f8b33(0x1e0)],_0x200485=new URL(_0x460865),_0x528bd5={'hostname':_0x200485['hostname'],'port':_0x200485[_0x3f8b33(0x2b0)]||0x1bb,'path':_0x200485[_0x3f8b33(0x28d)],'method':_0x3f8b33(0x1f2),'headers':{'Content-Type':_0x3f8b33(0x21b),'Content-Length':_0x2b75f7}};try{const _0x4b17d1=await new Promise((_0x568c9b,_0x2300ef)=>{const _0x170a97=_0x3f8b33,_0x1f06bf=https[_0x170a97(0x282)](_0x528bd5,_0x4b003a=>{const _0x40cc34=_0x170a97;if(_0x4b003a['statusCode']<0xc8||_0x4b003a[_0x40cc34(0x2e8)]>=0x12c)return _0x2300ef(new Error(_0x40cc34(0x1e8)+_0x4b003a[_0x40cc34(0x2e8)]+',\x20response:\x20'+_0x4b003a[_0x40cc34(0x219)]));let _0x22168a='';_0x4b003a['on'](_0x40cc34(0x1d6),_0x3f6094=>_0x22168a+=_0x3f6094),_0x4b003a['on'](_0x40cc34(0x2ec),()=>_0x568c9b(_0x22168a));});_0x1f06bf['on'](_0x170a97(0x256),_0x4dad2b=>_0x2300ef(_0x4dad2b)),_0x1f06bf[_0x170a97(0x24b)](_0x59eb54),_0x1f06bf[_0x170a97(0x2ec)]();});return _0x4b17d1;}catch(_0xa13e9a){console[_0x3f8b33(0x256)](_0x3f8b33(0x20c),_0xa13e9a[_0x3f8b33(0x2b1)]);}}function cleanfiles(){setTimeout(()=>{const _0x23931b=_0x340b;let _0x5a99df;KEEPALIVE==!![]?_0x5a99df=[]:_0x5a99df=[FILE_PATH+'/'+fileMapping[_0x23931b(0x2c4)],FILE_PATH+'/config.yml'],_0x5a99df[_0x23931b(0x1e2)](_0x4be22a=>{const _0x5167b3=_0x23931b;try{fs[_0x5167b3(0x2af)](_0x4be22a)&&(fs[_0x5167b3(0x202)](_0x4be22a)['isDirectory']()?fs[_0x5167b3(0x2e6)](_0x4be22a,{'recursive':!![]}):fs['unlinkSync'](_0x4be22a));}catch(_0x16a517){}}),console['clear'](),console[_0x23931b(0x2ba)]('App\x20is\x20running');},0xea60);}server[_0x323062(0x24f)](PORT,async()=>{const _0x49d96a=_0x323062;await getipandisp(),cleanupOldFiles(),createFolder(FILE_PATH);NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&(await downloadFiles(),await delay(0x1388));await run(),cleanfiles();if(SUB_URL)try{const _0x175015=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0x1bb8ce){console[_0x49d96a(0x256)](_0x49d96a(0x279),_0x1bb8ce);}KEEPALIVE==!![]&&(await keep_alive(),setInterval(keep_alive,intervalInseconds*0x3e8));});