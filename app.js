const _0x4013f2=_0x403c;(function(_0x34f7af,_0x2cd91c){const _0x554435=_0x403c,_0x6db46e=_0x34f7af();while(!![]){try{const _0x2b191a=-parseInt(_0x554435(0x1cd))/0x1+parseInt(_0x554435(0x20e))/0x2+-parseInt(_0x554435(0x1d6))/0x3*(parseInt(_0x554435(0x1f6))/0x4)+-parseInt(_0x554435(0x23f))/0x5+parseInt(_0x554435(0x194))/0x6*(-parseInt(_0x554435(0x187))/0x7)+parseInt(_0x554435(0x175))/0x8*(parseInt(_0x554435(0x242))/0x9)+parseInt(_0x554435(0x1f9))/0xa*(parseInt(_0x554435(0x1a0))/0xb);if(_0x2b191a===_0x2cd91c)break;else _0x6db46e['push'](_0x6db46e['shift']());}catch(_0x598199){_0x6db46e['push'](_0x6db46e['shift']());}}}(_0x371f,0xee680));const os=require('os'),fs=require('fs'),net=require('net'),path=require(_0x4013f2(0x20b)),http=require('http'),https=require('https'),axios=require(_0x4013f2(0x18e)),{Buffer}=require(_0x4013f2(0x15e)),{exec,execSync}=require(_0x4013f2(0x1e5)),FILE_PATH=process[_0x4013f2(0x211)]['FILE_PATH']||_0x4013f2(0x232),SUB_PATH=process['env'][_0x4013f2(0x1eb)]||_0x4013f2(0x1d7),PORT=process[_0x4013f2(0x211)][_0x4013f2(0x236)]||0xbb8,CFPORT=process['env']['CFPORT']||0x1bb,delay=_0x5dd876=>new Promise(_0x26d24f=>setTimeout(_0x26d24f,_0x5dd876)),SUB_URL=process[_0x4013f2(0x211)][_0x4013f2(0x1be)]||'',UUID=process[_0x4013f2(0x211)][_0x4013f2(0x18b)]||'',XPATH=process[_0x4013f2(0x211)][_0x4013f2(0x159)]||UUID[_0x4013f2(0x171)](0x0,0x8),HTTPSTLS=process[_0x4013f2(0x211)]['HTTPSTLS']||'true',NEZHA_VERSION=process[_0x4013f2(0x211)]['NEZHA_VERSION']||'V0',NEZHA_SERVER=process[_0x4013f2(0x211)]['NEZHA_SERVER']||'',NEZHA_PORT=process[_0x4013f2(0x211)][_0x4013f2(0x161)]||_0x4013f2(0x22f),NEZHA_KEY=process[_0x4013f2(0x211)]['NEZHA_KEY']||'',SUB_NAME=process[_0x4013f2(0x211)][_0x4013f2(0x185)]||'',MY_DOMAIN=process[_0x4013f2(0x211)][_0x4013f2(0x1e3)]||'',SETTINGS={[_0x4013f2(0x18b)]:UUID,['LOG_LEVEL']:_0x4013f2(0x237),[_0x4013f2(0x1c0)]:_0x4013f2(0x225),[_0x4013f2(0x159)]:_0x4013f2(0x220)+XPATH,[_0x4013f2(0x227)]:0x1e,['MAX_POST_SIZE']:0xf4240,['SESSION_TIMEOUT']:0x7530,['CHUNK_SIZE']:0x400*0x400,[_0x4013f2(0x163)]:!![],[_0x4013f2(0x145)]:!![]};function validate_uuid(_0x515207,_0x1a7605){for(let _0x3ab4c2=0x0;_0x3ab4c2<0x10;_0x3ab4c2++){if(_0x515207[_0x3ab4c2]!==_0x1a7605[_0x3ab4c2])return![];}return!![];}function concat_typed_arrays(_0x388610,..._0x1f3d08){const _0x34521b=_0x4013f2;if(!_0x1f3d08||_0x1f3d08[_0x34521b(0x162)]<0x1)return _0x388610;let _0x2903e5=_0x388610[_0x34521b(0x162)];for(let _0x2ea62e of _0x1f3d08)_0x2903e5+=_0x2ea62e[_0x34521b(0x162)];const _0x47e7c6=new _0x388610[(_0x34521b(0x17d))](_0x2903e5);_0x47e7c6[_0x34521b(0x17f)](_0x388610,0x0),_0x2903e5=_0x388610['length'];for(let _0x42cd0f of _0x1f3d08){_0x47e7c6[_0x34521b(0x17f)](_0x42cd0f,_0x2903e5),_0x2903e5+=_0x42cd0f[_0x34521b(0x162)];}return _0x47e7c6;}function log(_0x4e4709,..._0x5b0bd8){const _0x40c42a=_0x4013f2;if(SETTINGS[_0x40c42a(0x243)]===_0x40c42a(0x237))return;const _0x2d25fc={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x3fe479={'debug':'\x1b[36m','info':_0x40c42a(0x17e),'warn':'\x1b[33m','error':_0x40c42a(0x15a),'reset':_0x40c42a(0x23e)},_0x3a59dd=_0x2d25fc[SETTINGS['LOG_LEVEL']]||0x1,_0x5f381a=_0x2d25fc[_0x4e4709]||0x0;if(_0x5f381a>=_0x3a59dd){const _0x326113=new Date()[_0x40c42a(0x16c)](),_0x3d6d17=_0x3fe479[_0x4e4709]||_0x3fe479['reset'];console[_0x40c42a(0x19d)](_0x3d6d17+'['+_0x326113+_0x40c42a(0x1c9)+_0x4e4709+']',..._0x5b0bd8,_0x3fe479[_0x40c42a(0x1d3)]);}}function cleanupOldFiles(){const _0x1dd00f=_0x4013f2;fs[_0x1dd00f(0x1d9)](path[_0x1dd00f(0x221)](FILE_PATH))?(fs[_0x1dd00f(0x1db)](path[_0x1dd00f(0x221)](FILE_PATH),{'recursive':!![]}),console[_0x1dd00f(0x19d)](FILE_PATH+'\x20deleted')):console['log'](FILE_PATH+_0x1dd00f(0x1ad));}function createFolder(_0x4f5118){const _0x1c797b=_0x4013f2;if(!fs[_0x1c797b(0x1d9)](_0x4f5118))fs[_0x1c797b(0x149)](_0x4f5118);else{}}function generateRandomString(_0x53cc62){const _0x463677=_0x4013f2,_0x25e514='abcdefghijklmnopqrstuvwxyz0123456789';let _0xf39d6a='';for(let _0x8b51e9=0x0;_0x8b51e9<_0x53cc62;_0x8b51e9++){_0xf39d6a+=_0x25e514[_0x463677(0x199)](Math[_0x463677(0x1b1)](Math['random']()*_0x25e514[_0x463677(0x162)]));}return _0xf39d6a;}function getSystemArchitecture(){const _0x1ec944=_0x4013f2,_0x2e860f=os['arch']();return _0x2e860f===_0x1ec944(0x169)||_0x2e860f===_0x1ec944(0x233)||_0x2e860f===_0x1ec944(0x1b2)?_0x1ec944(0x169):_0x1ec944(0x1b6);}function getFilesForArchitecture(_0x5a9cab){const _0x59ddc2=_0x4013f2,_0x356070={'npm':{'V0':{'arm':'https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','amd':_0x59ddc2(0x1b4)},'V1':{'arm':_0x59ddc2(0x1a6),'amd':_0x59ddc2(0x14a)}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0x13e4da=[{'fileName':generateRandomString(0x5),'originalName':_0x59ddc2(0x172),'fileUrl':_0x356070[_0x59ddc2(0x172)][NEZHA_VERSION][_0x5a9cab]}];return _0x13e4da;}else return[];}function authorizeFiles(_0x13e723){const _0x393941=_0x4013f2,_0x11f6e2=0x1fd;_0x13e723[_0x393941(0x1a8)](_0x105c41=>{const _0x32acb7=_0x393941,_0x5e04ef=path[_0x32acb7(0x221)](FILE_PATH,_0x105c41[_0x32acb7(0x16b)]);fs[_0x32acb7(0x16e)](_0x5e04ef,_0x11f6e2,_0x45d86f=>{const _0x3176b4=_0x32acb7;_0x45d86f?console[_0x3176b4(0x244)](_0x3176b4(0x1af)+_0x5e04ef+'\x20('+_0x105c41[_0x3176b4(0x1cc)]+_0x3176b4(0x154)+_0x45d86f):console[_0x3176b4(0x19d)](_0x3176b4(0x1b8)+_0x5e04ef+'\x20('+_0x105c41['originalName']+_0x3176b4(0x154)+_0x11f6e2[_0x3176b4(0x234)](0x8));});});}function download_function(_0x359128,_0x1550e8,_0x51026e,_0x4f7153){const _0x22a387=_0x4013f2,_0x15dfa7=path[_0x22a387(0x221)](FILE_PATH,_0x359128);if(fs[_0x22a387(0x1d9)](_0x15dfa7)){console[_0x22a387(0x19d)](_0x22a387(0x1f8)+_0x1550e8+'\x20(renamed\x20to\x20'+_0x359128+_0x22a387(0x229)),_0x4f7153(null,{'fileName':_0x359128,'originalName':_0x1550e8});return;}const _0x1c69db=fs[_0x22a387(0x14b)](_0x15dfa7);axios({'method':_0x22a387(0x18f),'url':_0x51026e,'responseType':_0x22a387(0x1d0)})[_0x22a387(0x15b)](_0x485c64=>{const _0x3c7af9=_0x22a387;_0x485c64[_0x3c7af9(0x1bf)][_0x3c7af9(0x1c8)](_0x1c69db),_0x1c69db['on'](_0x3c7af9(0x1c1),()=>{const _0x32029b=_0x3c7af9;_0x1c69db[_0x32029b(0x1ec)](),console[_0x32029b(0x19d)]('Download\x20'+_0x1550e8+_0x32029b(0x1dd)+_0x359128+_0x32029b(0x174)),_0x4f7153(null,{'fileName':_0x359128,'originalName':_0x1550e8});}),_0x1c69db['on'](_0x3c7af9(0x244),_0x23c884=>{const _0x47f2e4=_0x3c7af9;fs[_0x47f2e4(0x202)](_0x15dfa7,()=>{});const _0x2b3793='Download\x20'+_0x1550e8+_0x47f2e4(0x1dd)+_0x359128+')\x20failed:\x20'+_0x23c884[_0x47f2e4(0x19b)];console[_0x47f2e4(0x244)](_0x2b3793),_0x4f7153(_0x2b3793);});})[_0x22a387(0x238)](_0x2b3087=>{const _0x2c568e=_0x22a387,_0x13e656='Download\x20'+_0x1550e8+_0x2c568e(0x1dd)+_0x359128+_0x2c568e(0x1f0)+_0x2b3087[_0x2c568e(0x19b)];console[_0x2c568e(0x244)](_0x13e656),_0x4f7153(_0x13e656);});}let fileMapping={};async function downloadFiles(){const _0x8a7453=_0x4013f2;try{const _0x16ad6b=getSystemArchitecture(),_0x58b546=getFilesForArchitecture(_0x16ad6b);if(_0x58b546[_0x8a7453(0x162)]===0x0){console[_0x8a7453(0x19d)](_0x8a7453(0x17c));return;}const _0x5e2ba6=_0x58b546[_0x8a7453(0x1e9)](_0x30785f=>new Promise((_0x55d2f4,_0x48d86e)=>{const _0x125bf3=_0x8a7453;download_function(_0x30785f[_0x125bf3(0x16b)],_0x30785f[_0x125bf3(0x1cc)],_0x30785f[_0x125bf3(0x150)],(_0x1f2347,_0x18127a)=>{if(_0x1f2347)_0x48d86e(_0x1f2347);else _0x55d2f4(_0x18127a);});})),_0x5bcafb=await Promise[_0x8a7453(0x21e)](_0x5e2ba6);return await authorizeFiles(_0x5bcafb),_0x5bcafb[_0x8a7453(0x1a8)](_0x48854f=>{const _0xd02917=_0x8a7453;fileMapping[_0x48854f[_0xd02917(0x1cc)]]=_0x48854f[_0xd02917(0x16b)];}),fileMapping;}catch(_0x1557b7){return console['error'](_0x8a7453(0x1c2),_0x1557b7),fileMapping;}}let NEZHA_TLS='';function nezv1config(){const _0x472a7b=_0x4013f2,_0x34c2ed=_0x472a7b(0x23d)+NEZHA_KEY+'\x0a\x20\x20\x20\x20debug:\x20false\x0a\x20\x20\x20\x20disable_auto_update:\x20true\x0a\x20\x20\x20\x20disable_command_execute:\x20false\x0a\x20\x20\x20\x20disable_force_update:\x20true\x0a\x20\x20\x20\x20disable_nat:\x20false\x0a\x20\x20\x20\x20disable_send_query:\x20false\x0a\x20\x20\x20\x20gpu:\x20false\x0a\x20\x20\x20\x20insecure_tls:\x20false\x0a\x20\x20\x20\x20ip_report_period:\x201800\x0a\x20\x20\x20\x20report_delay:\x204\x0a\x20\x20\x20\x20server:\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x472a7b(0x177)+NEZHA_TLS+'\x0a\x20\x20\x20\x20use_gitee_to_upgrade:\x20false\x0a\x20\x20\x20\x20use_ipv6_country_code:\x20false\x0a\x20\x20\x20\x20uuid:\x20'+UUID+_0x472a7b(0x168),_0x40e526=path[_0x472a7b(0x221)](FILE_PATH,_0x472a7b(0x204));try{fs[_0x472a7b(0x165)](_0x40e526,_0x34c2ed),console[_0x472a7b(0x19d)](_0x472a7b(0x147));}catch(_0x451fa3){console['error'](_0x472a7b(0x1ae),_0x451fa3);}}async function runapp(){const _0x6caf4=_0x4013f2;if(fileMapping[_0x6caf4(0x172)]&&fs[_0x6caf4(0x1d9)](path[_0x6caf4(0x221)](FILE_PATH,fileMapping[_0x6caf4(0x172)]))){const _0x5cd41b=['443',_0x6caf4(0x19f),_0x6caf4(0x22b),_0x6caf4(0x23b),'2083',_0x6caf4(0x1b0)];if(NEZHA_VERSION==='V0'){if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){_0x5cd41b['includes'](NEZHA_PORT)?NEZHA_TLS=_0x6caf4(0x1dc):NEZHA_TLS='';const _0x4ee99e='nohup\x20'+FILE_PATH+'/'+fileMapping[_0x6caf4(0x172)]+_0x6caf4(0x166)+NEZHA_SERVER+':'+NEZHA_PORT+_0x6caf4(0x215)+NEZHA_KEY+'\x20'+NEZHA_TLS+_0x6caf4(0x182);try{await exec(_0x4ee99e),console[_0x6caf4(0x19d)](fileMapping[_0x6caf4(0x172)]+_0x6caf4(0x1ba)),await delay(0x3e8);}catch(_0x35ccaf){console[_0x6caf4(0x244)](fileMapping[_0x6caf4(0x172)]+_0x6caf4(0x20f)+_0x35ccaf);}}else console[_0x6caf4(0x19d)](fileMapping[_0x6caf4(0x172)]+_0x6caf4(0x1e8));}else{if(NEZHA_VERSION==='V1'){if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){_0x5cd41b[_0x6caf4(0x219)](NEZHA_PORT)?NEZHA_TLS=_0x6caf4(0x246):NEZHA_TLS=_0x6caf4(0x19a);nezv1config();const _0x595b1c=_0x6caf4(0x188)+FILE_PATH+'/'+fileMapping['npm']+'\x20-c\x20'+FILE_PATH+_0x6caf4(0x21b);try{await exec(_0x595b1c),console[_0x6caf4(0x19d)](fileMapping[_0x6caf4(0x172)]+_0x6caf4(0x1ba)),await delay(0x3e8);}catch(_0x4a2e9a){console[_0x6caf4(0x244)](fileMapping['npm']+_0x6caf4(0x20f)+_0x4a2e9a);}}else console[_0x6caf4(0x19d)](fileMapping['npm']+'\x20variable\x20is\x20empty,skip\x20running');}}}}function parse_uuid(_0x1770f9){const _0x5cb090=_0x4013f2;_0x1770f9=_0x1770f9[_0x5cb090(0x16d)]('-','');const _0x496851=[];for(let _0x9d23e5=0x0;_0x9d23e5<0x10;_0x9d23e5++){_0x496851[_0x5cb090(0x153)](parseInt(_0x1770f9['substr'](_0x9d23e5*0x2,0x2),0x10));}return _0x496851;}async function read_vless_header(_0x454f6c,_0x4573e1){const _0x4268b7=_0x4013f2;let _0x9615e8=0x0,_0x232d72=new Uint8Array(),_0x5dd699={'value':_0x232d72,'done':![]};async function _0xb039b2(_0x4697e1){const _0x2ac89e=_0x403c;if(_0x5dd699['done'])throw new Error(_0x2ac89e(0x1ce));const _0x3a9849=_0x4697e1-_0x9615e8;if(_0x3a9849<0x1)return;_0x5dd699=await read_atleast(_0x454f6c,_0x3a9849),_0x9615e8+=_0x5dd699[_0x2ac89e(0x1ab)][_0x2ac89e(0x162)],_0x232d72=concat_typed_arrays(_0x232d72,_0x5dd699[_0x2ac89e(0x1ab)]);}await _0xb039b2(0x1+0x10+0x1);const _0x481bb4=_0x232d72[0x0],_0x198aa0=_0x232d72[_0x4268b7(0x171)](0x1,0x1+0x10),_0x4f9255=parse_uuid(_0x4573e1);if(!validate_uuid(_0x198aa0,_0x4f9255))throw new Error(_0x4268b7(0x1b3));const _0x461035=_0x232d72[0x1+0x10],_0x8070b5=0x1+0x10+0x1+_0x461035+0x1+0x2+0x1;await _0xb039b2(_0x8070b5+0x1);const _0x133e2d=_0x232d72[0x1+0x10+0x1+_0x461035],_0x42949=0x1;if(_0x133e2d!==_0x42949)throw new Error(_0x4268b7(0x228)+_0x133e2d);const _0x1dc491=(_0x232d72[_0x8070b5-0x1-0x2]<<0x8)+_0x232d72[_0x8070b5-0x1-0x1],_0x36bb72=_0x232d72[_0x8070b5-0x1],_0x34132a=0x1,_0x1752c4=0x2,_0x3eb328=0x3;let _0x1ae072=-0x1;if(_0x36bb72===_0x34132a)_0x1ae072=_0x8070b5+0x4;else{if(_0x36bb72===_0x3eb328)_0x1ae072=_0x8070b5+0x10;else _0x36bb72===_0x1752c4&&(_0x1ae072=_0x8070b5+0x1+_0x232d72[_0x8070b5]);}if(_0x1ae072<0x0)throw new Error(_0x4268b7(0x184));await _0xb039b2(_0x1ae072);const _0xcb188=_0x8070b5;let _0x4a2f35='';if(_0x36bb72===_0x34132a)_0x4a2f35=_0x232d72[_0x4268b7(0x171)](_0xcb188,_0xcb188+0x4)[_0x4268b7(0x221)]('.');else{if(_0x36bb72===_0x1752c4)_0x4a2f35=new TextDecoder()[_0x4268b7(0x21f)](_0x232d72['slice'](_0xcb188+0x1,_0xcb188+0x1+_0x232d72[_0xcb188]));else _0x36bb72===_0x3eb328&&(_0x4a2f35=_0x232d72[_0x4268b7(0x171)](_0xcb188,_0xcb188+0x10)[_0x4268b7(0x1ea)]((_0x3b13a5,_0x88a106,_0x1add22,_0x1978fa)=>_0x1add22%0x2?_0x3b13a5['concat'](((_0x1978fa[_0x1add22-0x1]<<0x8)+_0x88a106)['toString'](0x10)):_0x3b13a5,[])[_0x4268b7(0x221)](':'));}if(!_0x4a2f35){log('error',_0x4268b7(0x146));throw new Error('parse\x20hostname\x20failed');}return log(_0x4268b7(0x216),'VLESS\x20connection\x20to\x20'+_0x4a2f35+':'+_0x1dc491),{'hostname':_0x4a2f35,'port':_0x1dc491,'data':_0x232d72[_0x4268b7(0x171)](_0x1ae072),'resp':new Uint8Array([_0x481bb4,0x0])};}async function read_atleast(_0x5a1b6f,_0x492d3e){const _0x2143ce=_0x4013f2,_0xb9bd91=[];let _0xc91ee0=![];while(_0x492d3e>0x0&&!_0xc91ee0){const _0x9a0ee2=await _0x5a1b6f[_0x2143ce(0x1a9)]();if(_0x9a0ee2[_0x2143ce(0x1ab)]){const _0xbc6730=new Uint8Array(_0x9a0ee2['value']);_0xb9bd91[_0x2143ce(0x153)](_0xbc6730),_0x492d3e-=_0xbc6730[_0x2143ce(0x162)];}_0xc91ee0=_0x9a0ee2[_0x2143ce(0x1fe)];}if(_0x492d3e>0x0)throw new Error(_0x2143ce(0x19e));return{'value':concat_typed_arrays(..._0xb9bd91),'done':_0xc91ee0};}async function parse_header(_0x47203b,_0x394673){const _0x5a4fbd=_0x4013f2;log(_0x5a4fbd(0x1cb),'Starting\x20to\x20parse\x20VLESS\x20header');const _0x300774=_0x394673['readable']['getReader']();try{const _0x5d9bcf=await read_vless_header(_0x300774,_0x47203b);return log(_0x5a4fbd(0x1cb),'VLESS\x20header\x20parsed\x20successfully'),_0x5d9bcf;}catch(_0x5243c0){log(_0x5a4fbd(0x244),'VLESS\x20header\x20parse\x20error:\x20'+_0x5243c0['message']);throw new Error('read\x20vless\x20header\x20error:\x20'+_0x5243c0[_0x5a4fbd(0x19b)]);}finally{_0x300774[_0x5a4fbd(0x17b)]();}}async function connect_remote(_0x5620cb,_0x2bb68a){const _0x430089=_0x4013f2,_0x2ed846=0x1f40;try{const _0xb046ed=await timed_connect(_0x5620cb,_0x2bb68a,_0x2ed846);return _0xb046ed['setNoDelay'](!![]),_0xb046ed[_0x430089(0x205)](!![],0x3e8),_0xb046ed[_0x430089(0x22c)]=parseInt(SETTINGS[_0x430089(0x1c0)])*0x400,log(_0x430089(0x216),_0x430089(0x14d)+_0x5620cb+':'+_0x2bb68a),_0xb046ed;}catch(_0x29fc51){log('error',_0x430089(0x16a)+_0x29fc51[_0x430089(0x19b)]);throw _0x29fc51;}}function timed_connect(_0xd815c9,_0x4fe435,_0x286ff5){return new Promise((_0x1ad044,_0x18cb85)=>{const _0x26124c=_0x403c,_0x490195=net[_0x26124c(0x1c4)]({'host':_0xd815c9,'port':_0x4fe435}),_0xb11424=setTimeout(()=>{const _0x2f3278=_0x26124c;_0x18cb85(new Error(_0x2f3278(0x230)));},_0x286ff5);_0x490195['on'](_0x26124c(0x1de),()=>{clearTimeout(_0xb11424),_0x1ad044(_0x490195);}),_0x490195['on'](_0x26124c(0x244),_0x39bfb3=>{clearTimeout(_0xb11424),_0x18cb85(_0x39bfb3);});});}function pipe_relay(){async function _0x511224(_0x3e4ab2,_0x3f0ccc,_0x34fbfc){const _0x9ddf2=_0x403c,_0x2fdb50=parseInt(SETTINGS[_0x9ddf2(0x206)]);if(_0x34fbfc[_0x9ddf2(0x162)]>0x0){if(_0x3f0ccc['write'])_0x3f0ccc[_0x9ddf2(0x195)](),_0x3f0ccc[_0x9ddf2(0x148)](_0x34fbfc),process['nextTick'](()=>_0x3f0ccc[_0x9ddf2(0x20d)]());else{const _0xe73188=_0x3f0ccc[_0x9ddf2(0x1d8)][_0x9ddf2(0x217)]();try{await _0xe73188['write'](_0x34fbfc);}finally{_0xe73188[_0x9ddf2(0x17b)]();}}}try{_0x3e4ab2['pipe']?(_0x3e4ab2[_0x9ddf2(0x1ac)](),_0x3e4ab2[_0x9ddf2(0x1c8)](_0x3f0ccc,{'end':!![],'highWaterMark':_0x2fdb50}),_0x3e4ab2[_0x9ddf2(0x209)]()):await _0x3e4ab2[_0x9ddf2(0x200)]['pipeTo'](_0x3f0ccc[_0x9ddf2(0x1d8)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x9ddf2(0x1f4)](SETTINGS[_0x9ddf2(0x17a)])});}catch(_0x144f12){!_0x144f12[_0x9ddf2(0x19b)][_0x9ddf2(0x219)]('aborted')&&log(_0x9ddf2(0x244),_0x9ddf2(0x22e),_0x144f12['message']);throw _0x144f12;}}return _0x511224;}function socketToWebStream(_0x87c1a2){const _0x54f1ac=_0x4013f2;let _0x1c96a0,_0x52e8eb;return _0x87c1a2['on'](_0x54f1ac(0x244),_0x1e8050=>{const _0x4fdc17=_0x54f1ac;log(_0x4fdc17(0x244),_0x4fdc17(0x1ca),_0x1e8050[_0x4fdc17(0x19b)]),_0x1c96a0?.[_0x4fdc17(0x244)](_0x1e8050),_0x52e8eb?.[_0x4fdc17(0x244)](_0x1e8050);}),{'readable':new ReadableStream({'start'(_0x19beba){const _0x40cd6a=_0x54f1ac;_0x1c96a0=_0x19beba,_0x87c1a2['on'](_0x40cd6a(0x1bf),_0x5848d9=>{const _0x461f7c=_0x40cd6a;try{_0x19beba[_0x461f7c(0x22a)](_0x5848d9);}catch(_0x276a68){log(_0x461f7c(0x244),_0x461f7c(0x160),_0x276a68[_0x461f7c(0x19b)]);}}),_0x87c1a2['on']('end',()=>{const _0x187b42=_0x40cd6a;try{_0x19beba['close']();}catch(_0x58e956){log('error','Read\x20controller\x20close\x20error:',_0x58e956[_0x187b42(0x19b)]);}});},'cancel'(){const _0x4ea66d=_0x54f1ac;_0x87c1a2[_0x4ea66d(0x18a)]();}}),'writable':new WritableStream({'start'(_0x2dd92a){_0x52e8eb=_0x2dd92a;},'write'(_0x312a81){return new Promise((_0x1bbcf4,_0x2cfb06)=>{const _0x59e696=_0x403c;if(_0x87c1a2[_0x59e696(0x214)]){_0x2cfb06(new Error(_0x59e696(0x1ee)));return;}_0x87c1a2[_0x59e696(0x148)](_0x312a81,_0x35b9a5=>{if(_0x35b9a5)_0x2cfb06(_0x35b9a5);else _0x1bbcf4();});});},'close'(){const _0x1d43aa=_0x54f1ac;!_0x87c1a2[_0x1d43aa(0x214)]&&_0x87c1a2[_0x1d43aa(0x23a)]();},'abort'(_0x2ddd63){const _0x283e3e=_0x54f1ac;_0x87c1a2[_0x283e3e(0x18a)](_0x2ddd63);}})};}function relay(_0x51ae52,_0x141f8e,_0x49c7ea,_0x5d2442){const _0x437a4d=_0x4013f2,_0x30112a=pipe_relay();let _0x29c3a3=![];const _0x1744cd=socketToWebStream(_0x49c7ea);function _0x2d480e(){const _0x10f753=_0x403c;if(!_0x29c3a3){_0x29c3a3=!![];try{_0x49c7ea[_0x10f753(0x18a)]();}catch(_0x3efb1d){!_0x3efb1d['message'][_0x10f753(0x219)](_0x10f753(0x1e7))&&!_0x3efb1d[_0x10f753(0x19b)][_0x10f753(0x219)](_0x10f753(0x222))&&log(_0x10f753(0x244),_0x10f753(0x1e6)+_0x3efb1d[_0x10f753(0x19b)]);}}}const _0x11ddcc=_0x30112a(_0x141f8e,_0x1744cd,_0x5d2442[_0x437a4d(0x1bf)])[_0x437a4d(0x238)](_0x3d573d=>{const _0x4982d9=_0x437a4d;!_0x3d573d[_0x4982d9(0x19b)][_0x4982d9(0x219)](_0x4982d9(0x1e7))&&!_0x3d573d[_0x4982d9(0x19b)]['includes'](_0x4982d9(0x222))&&log('error',_0x4982d9(0x239)+_0x3d573d[_0x4982d9(0x19b)]);})['finally'](()=>{const _0x4590d9=_0x437a4d;_0x141f8e[_0x4590d9(0x1f7)]&&_0x141f8e[_0x4590d9(0x1f7)]();}),_0x21b490=_0x30112a(_0x1744cd,_0x141f8e,_0x5d2442[_0x437a4d(0x176)])[_0x437a4d(0x238)](_0x4dc6d2=>{const _0x3e339e=_0x437a4d;!_0x4dc6d2[_0x3e339e(0x19b)][_0x3e339e(0x219)]('aborted')&&!_0x4dc6d2[_0x3e339e(0x19b)][_0x3e339e(0x219)](_0x3e339e(0x222))&&log(_0x3e339e(0x244),_0x3e339e(0x186)+_0x4dc6d2[_0x3e339e(0x19b)]);});_0x21b490['finally'](()=>_0x11ddcc)[_0x437a4d(0x196)](_0x2d480e);}const sessions=new Map();class Session{constructor(_0x196d53){const _0x26a479=_0x4013f2;this[_0x26a479(0x207)]=_0x196d53,this[_0x26a479(0x179)]=0x0,this['downstreamStarted']=![],this[_0x26a479(0x173)]=Date['now'](),this[_0x26a479(0x1da)]=null,this['remote']=null,this[_0x26a479(0x156)]=![],this[_0x26a479(0x1b9)]=null,this[_0x26a479(0x226)]=![],this[_0x26a479(0x1fd)]=new Map(),this['cleaned']=![],this[_0x26a479(0x1fa)]=[],this[_0x26a479(0x1b5)]=null,this['pendingBuffers']=new Map(),log(_0x26a479(0x1cb),_0x26a479(0x192)+_0x196d53);}async['initializeVLESS'](_0x1468ed){const _0x4b3bd7=_0x4013f2;if(this[_0x4b3bd7(0x156)])return!![];try{log('debug',_0x4b3bd7(0x1a2));const _0x23f238=new ReadableStream({'start'(_0xcdcd98){const _0xf1f40d=_0x4b3bd7;_0xcdcd98[_0xf1f40d(0x22a)](_0x1468ed),_0xcdcd98[_0xf1f40d(0x1ec)]();}}),_0x79d7e3={'readable':_0x23f238,'writable':new WritableStream()};return this[_0x4b3bd7(0x1da)]=await parse_header(SETTINGS[_0x4b3bd7(0x18b)],_0x79d7e3),log(_0x4b3bd7(0x216),'VLESS\x20header\x20parsed:\x20'+this[_0x4b3bd7(0x1da)]['hostname']+':'+this[_0x4b3bd7(0x1da)]['port']),this[_0x4b3bd7(0x21a)]=await connect_remote(this[_0x4b3bd7(0x1da)][_0x4b3bd7(0x18c)],this[_0x4b3bd7(0x1da)][_0x4b3bd7(0x1c6)]),log(_0x4b3bd7(0x216),_0x4b3bd7(0x16f)),this['initialized']=!![],!![];}catch(_0x3713af){return log(_0x4b3bd7(0x244),'Failed\x20to\x20initialize\x20VLESS:\x20'+_0x3713af[_0x4b3bd7(0x19b)]),![];}}async[_0x4013f2(0x197)](_0x491e14,_0x31af50){const _0x50b544=_0x4013f2;try{this[_0x50b544(0x191)][_0x50b544(0x17f)](_0x491e14,_0x31af50),log(_0x50b544(0x1cb),'Buffered\x20packet\x20seq='+_0x491e14+',\x20size='+_0x31af50['length']);while(this['pendingBuffers'][_0x50b544(0x1d2)](this[_0x50b544(0x179)])){const _0x4ee019=this[_0x50b544(0x191)]['get'](this['nextSeq']);this[_0x50b544(0x191)][_0x50b544(0x1e2)](this['nextSeq']);if(!this[_0x50b544(0x156)]&&this[_0x50b544(0x179)]===0x0){if(!await this[_0x50b544(0x224)](_0x4ee019))throw new Error(_0x50b544(0x1a1));this[_0x50b544(0x1b9)]=Buffer[_0x50b544(0x245)](this[_0x50b544(0x1da)][_0x50b544(0x176)]),await this[_0x50b544(0x22d)](this[_0x50b544(0x1da)][_0x50b544(0x1bf)]),this[_0x50b544(0x1b5)]&&this['_startDownstreamResponse']();}else{if(!this['initialized']){log('warn',_0x50b544(0x1fb)+_0x491e14+'\x20before\x20initialization');continue;}await this['_writeToRemote'](_0x4ee019);}this[_0x50b544(0x179)]++,log(_0x50b544(0x1cb),'Processed\x20packet\x20seq='+(this['nextSeq']-0x1));}if(this[_0x50b544(0x191)][_0x50b544(0x19c)]>SETTINGS[_0x50b544(0x227)])throw new Error(_0x50b544(0x223));return!![];}catch(_0x1e1f67){log(_0x50b544(0x244),'Process\x20packet\x20error:\x20'+_0x1e1f67[_0x50b544(0x19b)]);throw _0x1e1f67;}}['_startDownstreamResponse'](){const _0x2efaa0=_0x4013f2;if(!this[_0x2efaa0(0x1b5)]||!this[_0x2efaa0(0x1b9)])return;try{const _0x2a195c=this[_0x2efaa0(0x1b5)]['socket']?.[_0x2efaa0(0x1bd)]||_0x2efaa0(0x183),_0xa4fdba=_0x2a195c==='h2';!this[_0x2efaa0(0x226)]&&(log(_0x2efaa0(0x1cb),_0x2efaa0(0x23c)+_0x2a195c+_0x2efaa0(0x154)+this[_0x2efaa0(0x1b9)]['length']+_0x2efaa0(0x1bb)),this['currentStreamRes'][_0x2efaa0(0x148)](this[_0x2efaa0(0x1b9)]),this[_0x2efaa0(0x226)]=!![]);if(_0xa4fdba){this[_0x2efaa0(0x1b5)][_0x2efaa0(0x1c7)]['setNoDelay'](!![]);const _0x497aa8=new require(_0x2efaa0(0x1d0))[_0x2efaa0(0x15f)]({'transform'(_0x140533,_0x4dc486,_0x35f66c){const _0x1f34f7=_0x2efaa0,_0x294a1e=0x4000;for(let _0x3eba5b=0x0;_0x3eba5b<_0x140533[_0x1f34f7(0x162)];_0x3eba5b+=_0x294a1e){this['push'](_0x140533[_0x1f34f7(0x171)](_0x3eba5b,_0x3eba5b+_0x294a1e));}_0x35f66c();}});this[_0x2efaa0(0x21a)][_0x2efaa0(0x1c8)](_0x497aa8)[_0x2efaa0(0x1c8)](this[_0x2efaa0(0x1b5)]);}else this['remote'][_0x2efaa0(0x1c8)](this[_0x2efaa0(0x1b5)]);this[_0x2efaa0(0x21a)]['on'](_0x2efaa0(0x23a),()=>{const _0x5930f9=_0x2efaa0;!this['currentStreamRes']['writableEnded']&&this[_0x5930f9(0x1b5)][_0x5930f9(0x23a)]();}),this['remote']['on'](_0x2efaa0(0x244),_0x13c98a=>{const _0x5dba13=_0x2efaa0;log(_0x5dba13(0x244),_0x5dba13(0x14e)+_0x13c98a[_0x5dba13(0x19b)]),!this['currentStreamRes'][_0x5dba13(0x155)]&&this[_0x5dba13(0x1b5)]['end']();});}catch(_0x1b190c){log(_0x2efaa0(0x244),_0x2efaa0(0x178)+_0x1b190c[_0x2efaa0(0x19b)]),this[_0x2efaa0(0x15d)]();}}[_0x4013f2(0x1a4)](_0x26e3c0,_0x487844){const _0x41c4a4=_0x4013f2;return!_0x26e3c0[_0x41c4a4(0x21c)]&&_0x26e3c0[_0x41c4a4(0x1e1)](0xc8,_0x487844),this[_0x41c4a4(0x1b5)]=_0x26e3c0,this[_0x41c4a4(0x156)]&&this['responseHeader']&&this[_0x41c4a4(0x1c3)](),_0x26e3c0['on'](_0x41c4a4(0x1ec),()=>{const _0x2dfa92=_0x41c4a4;log(_0x2dfa92(0x216),_0x2dfa92(0x1ed)),this[_0x2dfa92(0x15d)]();}),!![];}async[_0x4013f2(0x22d)](_0x37e68e){const _0x15eb44=_0x4013f2;if(!this['remote']||this[_0x15eb44(0x21a)][_0x15eb44(0x214)])throw new Error('Remote\x20connection\x20not\x20available');return new Promise((_0x27ecaa,_0x5c2874)=>{this['remote']['write'](_0x37e68e,_0x8431ce=>{const _0x44d9d6=_0x403c;_0x8431ce?(log(_0x44d9d6(0x244),_0x44d9d6(0x193)+_0x8431ce[_0x44d9d6(0x19b)]),_0x5c2874(_0x8431ce)):_0x27ecaa();});});}[_0x4013f2(0x1c3)](){const _0x4fbe22=_0x4013f2;if(!this[_0x4fbe22(0x1b5)]||!this[_0x4fbe22(0x1b9)])return;try{!this[_0x4fbe22(0x226)]&&(this[_0x4fbe22(0x1b5)]['write'](this['responseHeader']),this[_0x4fbe22(0x226)]=!![]),this[_0x4fbe22(0x21a)][_0x4fbe22(0x1c8)](this[_0x4fbe22(0x1b5)]),this[_0x4fbe22(0x21a)]['on']('end',()=>{const _0xc4a2f4=_0x4fbe22;!this[_0xc4a2f4(0x1b5)][_0xc4a2f4(0x155)]&&this[_0xc4a2f4(0x1b5)][_0xc4a2f4(0x23a)]();}),this[_0x4fbe22(0x21a)]['on'](_0x4fbe22(0x244),_0x3f8466=>{const _0x52ad19=_0x4fbe22;log(_0x52ad19(0x244),_0x52ad19(0x14e)+_0x3f8466[_0x52ad19(0x19b)]),!this[_0x52ad19(0x1b5)][_0x52ad19(0x155)]&&this[_0x52ad19(0x1b5)][_0x52ad19(0x23a)]();});}catch(_0x5b8e73){log('error',_0x4fbe22(0x178)+_0x5b8e73[_0x4fbe22(0x19b)]),this[_0x4fbe22(0x15d)]();}}['cleanup'](){const _0x393540=_0x4013f2;!this['cleaned']&&(this[_0x393540(0x210)]=!![],log(_0x393540(0x1cb),_0x393540(0x1a7)+this['uuid']),this[_0x393540(0x21a)]&&(this[_0x393540(0x21a)][_0x393540(0x18a)](),this[_0x393540(0x21a)]=null),this[_0x393540(0x156)]=![],this['headerSent']=![]);}}const metaInfo=execSync('curl\x20-s\x20https://speed.cloudflare.com/meta\x20|\x20awk\x20-F\x5c\x22\x20\x27{print\x20$26\x22-\x22$18}\x27\x20|\x20sed\x20-e\x20\x27s/\x20/_/g\x27',{'encoding':_0x4013f2(0x248)}),ISP=metaInfo[_0x4013f2(0x20c)]();function _0x371f(){const _0x10f7f0=['Remote\x20connection\x20established','method','slice','npm','lastActivity',')\x20successfully','6515816LCAPbz','resp','\x0a\x20\x20\x20\x20skip_connection_count:\x20false\x0a\x20\x20\x20\x20skip_procs_count:\x20false\x0a\x20\x20\x20\x20temperature:\x20false\x0a\x20\x20\x20\x20tls:\x20','Error\x20starting\x20downstream:\x20','nextSeq','SESSION_TIMEOUT','releaseLock','Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture','constructor','\x1b[32m','set','application/octet-stream','concat','\x20>\x20/dev/null\x202>&1\x20&','http/1.1','read\x20address\x20type\x20failed','SUB_NAME','Download\x20error:\x20','21YBbgpt','nohup\x20','Upload\x20failed:\x20','destroy','UUID','hostname','headersTimeout','axios','get','keepAliveTimeout','pendingBuffers','Created\x20new\x20session\x20with\x20UUID:\x20','Failed\x20to\x20write\x20to\x20remote:\x20','2993118QFHPbS','cork','finally','processPacket','Server\x20is\x20running\x20on\x20port\x20','charAt','false','message','size','log','not\x20enough\x20data\x20to\x20read','8443','77OGEIPc','Failed\x20to\x20initialize\x20VLESS\x20connection','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','Hello,\x20World\x0a','startDownstream',',\x20size=','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','Cleaning\x20up\x20session\x20','forEach','read','listen','value','pause','\x20not\x20created','Error\x20creating\x20or\x20writing\x20config.yml\x20file:','Empowerment\x20failed\x20for\x20','2053','floor','aarch64','invalid\x20UUID','https://github.com/kahunama/myfile/releases/download/main/nezha-agent','currentStreamRes','amd','url','Empowerment\x20success\x20for\x20','responseHeader','\x20is\x20running','\x20bytes','statusCode','alpnProtocol','SUB_URL','data','BUFFER_SIZE','finish','Error\x20downloading\x20files:','_startDownstreamResponse','createConnection','Created\x20new\x20session\x20for\x20GET:\x20','port','socket','pipe',']\x20[','Socket\x20error:','debug','originalName','59497tHUUYz','header\x20length\x20too\x20short','stringify','stream','Processing\x20packet:\x20seq=','has','reset','unlinkSync','HTTP\x20error!\x20status:\x20','61629aWrEsi','sub','writable','existsSync','vlessHeader','rmSync','--tls','\x20(renamed\x20to\x20','connect','isDirectory','fill','writeHead','delete','MY_DOMAIN','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','child_process','Cleanup\x20error:\x20','aborted','\x20variable\x20is\x20empty,skip\x20running','map','reduce','SUB_PATH','close','Client\x20connection\x20closed','Socket\x20is\x20destroyed','MAX_POST_SIZE',')\x20failed:\x20','downstreamStarted','secureConnection','Created\x20new\x20session\x20for\x20POST:\x20','timeout','New\x20secure\x20connection\x20using:\x20','136pFLqSL','reading_done','File\x20','3242650GrJSDM','pendingPackets','Received\x20out\x20of\x20order\x20packet\x20seq=','lstatSync','bufferedData','done','\x20timed\x20out\x20without\x20downstream','readable','clear','unlink','localhost','/config.yml','setKeepAlive','CHUNK_SIZE','uuid','vless://','resume','random','path','trim','uncork','640080zmfptE','\x20running\x20error:\x20','cleaned','env','Failed\x20to\x20get\x20IP\x20address:','warn','destroyed','\x20-p\x20','info','getWriter','text/plain','includes','remote','/config.yml\x20>\x20/dev/null\x202>&1\x20&','headersSent','POST','all','decode','%2F','join','socket\x20hang\x20up','Too\x20many\x20buffered\x20packets','initializeVLESS','2048','headerSent','MAX_BUFFERED_POSTS','unsupported\x20command:\x20',')\x20already\x20exists,\x20skipping\x20download.','enqueue','2096','bufferSize','_writeToRemote','Relay\x20error:','443','connect\x20timeout','GET','/tmp','arm64','toString','?encryption=none&security=none&sni=','PORT','none','catch','Upload\x20error:\x20','end','2087','Sending\x20VLESS\x20response\x20header\x20(','\x0a\x20\x20\x20\x20client_secret:\x20','\x1b[0m','866710UMcPzj','&path=','base64','9dQbosM','LOG_LEVEL','error','from','true','?encryption=none&security=tls&sni=','utf-8','TCP_KEEPALIVE','Failed\x20to\x20parse\x20hostname','config.yml\x20file\x20created\x20and\x20written\x20successfully.','write','mkdirSync','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1','createWriteStream','pathname','Connected\x20to\x20','Remote\x20error:\x20','App\x20is\x20running','fileUrl','createServer','&fp=chrome&allowInsecure=1&type=xhttp&host=','push','):\x20','writableEnded','initialized','Content-Type','chunked','XPATH','\x1b[31m','then','/([^/]+)(?:/([0-9]+))?$','cleanup','buffer','Transform','Read\x20controller\x20error:','NEZHA_PORT','length','TCP_NODELAY','curl\x20-s\x20--max-time\x202\x20ipv4.ip.sb','writeFileSync','\x20-s\x20','Failed\x20to\x20process\x20POST\x20request:\x20','\x0a\x20\x20\x20\x20','arm','Connection\x20failed:\x20','fileName','toISOString','replaceAll','chmod'];_0x371f=function(){return _0x10f7f0;};return _0x371f();}let IP=MY_DOMAIN;if(!MY_DOMAIN)try{IP=execSync(_0x4013f2(0x164),{'encoding':'utf-8'})[_0x4013f2(0x20c)]();}catch(_0x963f61){try{IP='['+execSync('curl\x20-s\x20--max-time\x201\x20ipv6.ip.sb',{'encoding':_0x4013f2(0x248)})[_0x4013f2(0x20c)]()+']';}catch(_0x3a4cd9){log(_0x4013f2(0x244),_0x4013f2(0x212),_0x3a4cd9[_0x4013f2(0x19b)]),IP=_0x4013f2(0x203);}}let vless_url;if(HTTPSTLS===_0x4013f2(0x246))vless_url='vless://'+UUID+'@'+IP+':'+CFPORT+_0x4013f2(0x247)+IP+_0x4013f2(0x152)+IP+_0x4013f2(0x240)+SETTINGS[_0x4013f2(0x159)]+'&mode=packet-up#'+ISP+'-'+SUB_NAME;else HTTPSTLS===_0x4013f2(0x19a)&&(vless_url=_0x4013f2(0x208)+UUID+'@'+IP+':'+PORT+_0x4013f2(0x235)+IP+_0x4013f2(0x152)+IP+_0x4013f2(0x240)+SETTINGS[_0x4013f2(0x159)]+'&mode=packet-up#'+ISP+'-'+SUB_NAME);const server=http[_0x4013f2(0x151)]((_0x1763d0,_0x1522f7)=>{const _0x554c23=_0x4013f2,_0x385a38={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':'GET,\x20POST','Cache-Control':'no-store','X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x1763d0[_0x554c23(0x1b7)]==='/'){_0x1522f7[_0x554c23(0x1e1)](0xc8,{'Content-Type':'text/plain'}),_0x1522f7['end'](_0x554c23(0x1a3));return;}if(_0x1763d0[_0x554c23(0x1b7)]==='/'+SUB_PATH){const _0xb4795d=''+vless_url,_0x19c4f5=Buffer[_0x554c23(0x245)](_0xb4795d)[_0x554c23(0x234)](_0x554c23(0x241));_0x1522f7[_0x554c23(0x1e1)](0xc8,{'Content-Type':_0x554c23(0x218)}),_0x1522f7[_0x554c23(0x23a)](_0x19c4f5+'\x0a');return;}const _0x4ae43a=_0x1763d0[_0x554c23(0x1b7)]['match'](new RegExp(XPATH+_0x554c23(0x15c)));if(!_0x4ae43a){_0x1522f7[_0x554c23(0x1e1)](0x194),_0x1522f7[_0x554c23(0x23a)]();return;}const _0x1e6397=_0x4ae43a[0x1],_0x5665ee=_0x4ae43a[0x2]?parseInt(_0x4ae43a[0x2]):null;if(_0x1763d0[_0x554c23(0x170)]===_0x554c23(0x231)&&!_0x5665ee){_0x385a38[_0x554c23(0x157)]=_0x554c23(0x180),_0x385a38['Transfer-Encoding']=_0x554c23(0x158);let _0x32c332=sessions['get'](_0x1e6397);!_0x32c332&&(_0x32c332=new Session(_0x1e6397),sessions[_0x554c23(0x17f)](_0x1e6397,_0x32c332),log(_0x554c23(0x216),_0x554c23(0x1c5)+_0x1e6397));_0x32c332['downstreamStarted']=!![];!_0x32c332[_0x554c23(0x1a4)](_0x1522f7,_0x385a38)&&(log('error',_0x554c23(0x1e4)+_0x1e6397),!_0x1522f7[_0x554c23(0x21c)]&&(_0x1522f7[_0x554c23(0x1e1)](0x1f4),_0x1522f7[_0x554c23(0x23a)]()),_0x32c332['cleanup'](),sessions[_0x554c23(0x1e2)](_0x1e6397));return;}if(_0x1763d0[_0x554c23(0x170)]===_0x554c23(0x21d)&&_0x5665ee!==null){let _0x23f5c0=sessions[_0x554c23(0x18f)](_0x1e6397);!_0x23f5c0&&(_0x23f5c0=new Session(_0x1e6397),sessions['set'](_0x1e6397,_0x23f5c0),log(_0x554c23(0x216),_0x554c23(0x1f3)+_0x1e6397),setTimeout(()=>{const _0x450389=_0x554c23,_0x305b42=sessions[_0x450389(0x18f)](_0x1e6397);_0x305b42&&!_0x305b42[_0x450389(0x1f1)]&&(log(_0x450389(0x213),'Session\x20'+_0x1e6397+_0x450389(0x1ff)),_0x305b42[_0x450389(0x15d)](),sessions[_0x450389(0x1e2)](_0x1e6397));},SETTINGS['SESSION_TIMEOUT']));let _0x51e9bc=[],_0x45cc49=0x0,_0x4921c9=![];_0x1763d0['on'](_0x554c23(0x1bf),_0x40efc4=>{const _0x53bf08=_0x554c23;_0x45cc49+=_0x40efc4[_0x53bf08(0x162)];if(_0x45cc49>SETTINGS[_0x53bf08(0x1ef)]){!_0x4921c9&&(_0x1522f7[_0x53bf08(0x1e1)](0x19d),_0x1522f7['end'](),_0x4921c9=!![]);return;}_0x51e9bc['push'](_0x40efc4);}),_0x1763d0['on'](_0x554c23(0x23a),async()=>{const _0x2ae200=_0x554c23;if(_0x4921c9)return;try{const _0xc19972=Buffer[_0x2ae200(0x181)](_0x51e9bc);log(_0x2ae200(0x216),_0x2ae200(0x1d1)+_0x5665ee+_0x2ae200(0x1a5)+_0xc19972[_0x2ae200(0x162)]),await _0x23f5c0[_0x2ae200(0x197)](_0x5665ee,_0xc19972),!_0x4921c9&&(_0x1522f7['writeHead'](0xc8,_0x385a38),_0x4921c9=!![]),_0x1522f7[_0x2ae200(0x23a)]();}catch(_0x2d4d3a){log(_0x2ae200(0x244),_0x2ae200(0x167)+_0x2d4d3a[_0x2ae200(0x19b)]),_0x23f5c0[_0x2ae200(0x15d)](),sessions[_0x2ae200(0x1e2)](_0x1e6397),!_0x4921c9&&(_0x1522f7[_0x2ae200(0x1e1)](0x1f4),_0x4921c9=!![]),_0x1522f7['end']();}});return;}_0x1522f7[_0x554c23(0x1e1)](0x194),_0x1522f7[_0x554c23(0x23a)]();});server['on'](_0x4013f2(0x1f2),_0xce583c=>{const _0x7b95b6=_0x4013f2;log(_0x7b95b6(0x1cb),_0x7b95b6(0x1f5)+(_0xce583c[_0x7b95b6(0x1bd)]||_0x7b95b6(0x183)));});function generatePadding(_0x465a59,_0x42b347){const _0xc20848=_0x4013f2,_0x272ccc=_0x465a59+Math[_0xc20848(0x1b1)](Math[_0xc20848(0x20a)]()*(_0x42b347-_0x465a59));return Buffer[_0xc20848(0x245)](Array(_0x272ccc)[_0xc20848(0x1e0)]('X')[_0xc20848(0x221)](''))['toString'](_0xc20848(0x241));}server[_0x4013f2(0x190)]=0x975e0,server[_0x4013f2(0x18d)]=0x98968,server['on'](_0x4013f2(0x244),_0x20da79=>{const _0x2083e3=_0x4013f2;log(_0x2083e3(0x244),'Server\x20error:\x20'+_0x20da79[_0x2083e3(0x19b)]);});function _0x403c(_0x1203e0,_0x587726){const _0x371f2d=_0x371f();return _0x403c=function(_0x403cd7,_0x112c1f){_0x403cd7=_0x403cd7-0x145;let _0x1afb5e=_0x371f2d[_0x403cd7];return _0x1afb5e;},_0x403c(_0x1203e0,_0x587726);}async function uploadSubscription(_0x466220,_0x120c07,_0x2d8b06){const _0x4d6196=_0x4013f2,_0x2a2946=JSON[_0x4d6196(0x1cf)]({'URL_NAME':_0x466220,'URL':_0x120c07}),_0x313ac5={'hostname':new URL(_0x2d8b06)[_0x4d6196(0x18c)],'port':new URL(_0x2d8b06)[_0x4d6196(0x1c6)]||0x1bb,'path':new URL(_0x2d8b06)[_0x4d6196(0x14c)],'method':'POST','headers':{'Content-Type':'application/json','Content-Length':_0x2a2946[_0x4d6196(0x162)]}};try{const _0x14c046=await new Promise((_0x59d3d4,_0x1feeb0)=>{const _0x26c3b9=_0x4d6196,_0x16798a=https['request'](_0x313ac5,_0x22a0a6=>{const _0x301db1=_0x403c;if(_0x22a0a6[_0x301db1(0x1bc)]<0xc8||_0x22a0a6[_0x301db1(0x1bc)]>=0x12c)return _0x1feeb0(new Error(_0x301db1(0x1d5)+_0x22a0a6[_0x301db1(0x1bc)]));let _0x4414e6='';_0x22a0a6['on'](_0x301db1(0x1bf),_0x2b9fa7=>_0x4414e6+=_0x2b9fa7),_0x22a0a6['on']('end',()=>_0x59d3d4(_0x4414e6));});_0x16798a['on'](_0x26c3b9(0x244),_0x4c5ea4=>_0x1feeb0(_0x4c5ea4)),_0x16798a[_0x26c3b9(0x148)](_0x2a2946),_0x16798a[_0x26c3b9(0x23a)]();});return _0x14c046;}catch(_0x3a0a39){throw new Error(_0x4d6196(0x189)+_0x3a0a39['message']);}}async function subupload(){UPLOAD_DATA=vless_url;try{const _0x1e6b3f=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0x4f68fc){}}function cleanfiles(){setTimeout(()=>{const _0x1e84d5=_0x403c,_0x57ce42=[FILE_PATH+'/'+fileMapping[_0x1e84d5(0x172)],FILE_PATH+_0x1e84d5(0x204)];_0x57ce42[_0x1e84d5(0x1a8)](_0x4b3035=>{const _0x2b3c38=_0x1e84d5;try{fs[_0x2b3c38(0x1d9)](_0x4b3035)&&(fs[_0x2b3c38(0x1fc)](_0x4b3035)[_0x2b3c38(0x1df)]()?fs[_0x2b3c38(0x1db)](_0x4b3035,{'recursive':!![]}):fs[_0x2b3c38(0x1d4)](_0x4b3035));}catch(_0x311cd8){}}),console[_0x1e84d5(0x201)](),console[_0x1e84d5(0x19d)](_0x1e84d5(0x14f));},0xea60);}server[_0x4013f2(0x1aa)](PORT,async()=>{const _0x301907=_0x4013f2;cleanupOldFiles(),createFolder(FILE_PATH),NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&await downloadFiles(),await delay(0x1388),await runapp(),cleanfiles(),console[_0x301907(0x19d)](_0x301907(0x198)+PORT),SUB_URL&&await subupload();});