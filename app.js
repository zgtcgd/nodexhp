const _0x69ab8d=_0x22bc;(function(_0x5a8262,_0x20abae){const _0x3b6115=_0x22bc,_0x306459=_0x5a8262();while(!![]){try{const _0x46dcde=-parseInt(_0x3b6115(0x297))/0x1*(parseInt(_0x3b6115(0x227))/0x2)+-parseInt(_0x3b6115(0x216))/0x3+-parseInt(_0x3b6115(0x2e4))/0x4+parseInt(_0x3b6115(0x26e))/0x5*(parseInt(_0x3b6115(0x1f2))/0x6)+-parseInt(_0x3b6115(0x252))/0x7*(-parseInt(_0x3b6115(0x247))/0x8)+-parseInt(_0x3b6115(0x1f6))/0x9*(parseInt(_0x3b6115(0x1e2))/0xa)+parseInt(_0x3b6115(0x269))/0xb;if(_0x46dcde===_0x20abae)break;else _0x306459['push'](_0x306459['shift']());}catch(_0x45d802){_0x306459['push'](_0x306459['shift']());}}}(_0x35de,0xc5c3c));const FILE_PATH=process[_0x69ab8d(0x20e)][_0x69ab8d(0x2ae)]||_0x69ab8d(0x295),intervalInseconds=process[_0x69ab8d(0x20e)]['TIME']||0x64,PORT=process[_0x69ab8d(0x20e)]['PORT']||0xbb8,CFPORT=process[_0x69ab8d(0x20e)]['CFPORT']||0x1bb,CFIP=process[_0x69ab8d(0x20e)][_0x69ab8d(0x22f)]||_0x69ab8d(0x209),KEEPALIVE=process[_0x69ab8d(0x20e)][_0x69ab8d(0x201)]==='true',SUB_URL=process[_0x69ab8d(0x20e)][_0x69ab8d(0x279)]||'',UUID=process['env'][_0x69ab8d(0x229)]||_0x69ab8d(0x2b0),XPATH=process[_0x69ab8d(0x20e)][_0x69ab8d(0x20f)]||UUID['slice'](0x0,0x8),HTTPSTLS=process[_0x69ab8d(0x20e)][_0x69ab8d(0x259)]===_0x69ab8d(0x2c3),NEZHA_VERSION=process[_0x69ab8d(0x20e)][_0x69ab8d(0x274)]||'V0',NEZHA_SERVER=process[_0x69ab8d(0x20e)][_0x69ab8d(0x22d)]||'',NEZHA_PORT=process['env']['NEZHA_PORT']||_0x69ab8d(0x2dd),NEZHA_KEY=process['env'][_0x69ab8d(0x29e)]||'',SUB_NAME=process['env'][_0x69ab8d(0x2aa)]||'',MY_DOMAIN=process[_0x69ab8d(0x20e)]['MY_DOMAIN']||'',LOCAL_DOMAIN=process[_0x69ab8d(0x20e)]['LOCAL_DOMAIN']||'',os=require('os'),fs=require('fs'),net=require(_0x69ab8d(0x243)),path=require(_0x69ab8d(0x1ed)),http=require(_0x69ab8d(0x2bf)),https=require(_0x69ab8d(0x267)),axios=require(_0x69ab8d(0x20a)),{pipeline}=require('stream/promises'),{Buffer}=require('buffer'),exec=require('child_process')[_0x69ab8d(0x2a2)],delay=_0x40d98d=>new Promise(_0x3ebdc1=>setTimeout(_0x3ebdc1,_0x40d98d)),SETTINGS={[_0x69ab8d(0x229)]:UUID,[_0x69ab8d(0x24f)]:_0x69ab8d(0x2d8),[_0x69ab8d(0x2ca)]:'2048',[_0x69ab8d(0x20f)]:_0x69ab8d(0x286)+XPATH,[_0x69ab8d(0x289)]:0x1e,[_0x69ab8d(0x208)]:0xf4240,['SESSION_TIMEOUT']:0x7530,['CHUNK_SIZE']:0x400*0x400,[_0x69ab8d(0x2e2)]:!![],[_0x69ab8d(0x1fb)]:!![]};function validate_uuid(_0x5a3bdc,_0x192f4a){for(let _0xd50099=0x0;_0xd50099<0x10;_0xd50099++){if(_0x5a3bdc[_0xd50099]!==_0x192f4a[_0xd50099])return![];}return!![];}function concat_typed_arrays(_0x509008,..._0x102293){const _0x84d953=_0x69ab8d;if(!_0x102293||_0x102293['length']<0x1)return _0x509008;let _0x5c756c=_0x509008[_0x84d953(0x1e1)];for(let _0x11900c of _0x102293)_0x5c756c+=_0x11900c['length'];const _0x50790d=new _0x509008[(_0x84d953(0x2dc))](_0x5c756c);_0x50790d[_0x84d953(0x28f)](_0x509008,0x0),_0x5c756c=_0x509008['length'];for(let _0x502906 of _0x102293){_0x50790d['set'](_0x502906,_0x5c756c),_0x5c756c+=_0x502906['length'];}return _0x50790d;}function log(_0x3e1948,..._0x344f93){const _0xbaa9bd=_0x69ab8d;if(SETTINGS[_0xbaa9bd(0x24f)]==='none')return;const _0xd10719={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x8b83c3={'debug':_0xbaa9bd(0x2a6),'info':_0xbaa9bd(0x291),'warn':'\x1b[33m','error':_0xbaa9bd(0x2c5),'reset':_0xbaa9bd(0x23c)},_0x52c6a5=_0xd10719[SETTINGS[_0xbaa9bd(0x24f)]]||0x1,_0x5b5b04=_0xd10719[_0x3e1948]||0x0;if(_0x5b5b04>=_0x52c6a5){const _0x62ed91=new Date()['toISOString'](),_0x427fca=_0x8b83c3[_0x3e1948]||_0x8b83c3[_0xbaa9bd(0x228)];console['log'](_0x427fca+'['+_0x62ed91+_0xbaa9bd(0x2de)+_0x3e1948+']',..._0x344f93,_0x8b83c3[_0xbaa9bd(0x228)]);}}function execPromise(_0x4a2d2e,_0x572ed4={}){return new Promise((_0x448feb,_0x32aa6f)=>{const _0x4630b9=exec(_0x4a2d2e,_0x572ed4,(_0x55349c,_0x363fc8,_0x12e266)=>{const _0x35d9b4=_0x22bc;if(_0x55349c){const _0x39ccac=new Error(_0x35d9b4(0x1f1)+_0x55349c[_0x35d9b4(0x2d6)]);_0x39ccac['code']=_0x55349c[_0x35d9b4(0x28e)],_0x39ccac[_0x35d9b4(0x2c9)]=_0x12e266[_0x35d9b4(0x265)](),_0x32aa6f(_0x39ccac);}else _0x448feb(_0x363fc8['trim']());});});}async function detectProcess(_0x20fddd){const _0x5ef971=_0x69ab8d,_0x4d2ff2=[{'cmd':'pidof\x20\x22'+_0x20fddd+'\x22','name':_0x5ef971(0x2c1)},{'cmd':_0x5ef971(0x205)+_0x20fddd+'\x22','name':_0x5ef971(0x299)},{'cmd':'ps\x20-eo\x20pid,comm\x20|\x20awk\x20-v\x20name=\x22'+_0x20fddd+'\x22\x20\x27$2\x20==\x20name\x20{print\x20$1}\x27','name':_0x5ef971(0x21e)}];for(const _0x3b20b6 of _0x4d2ff2){try{const _0x238a2c=await execPromise(_0x3b20b6[_0x5ef971(0x253)]);if(_0x238a2c)return _0x238a2c['replace'](/\n/g,'\x20')[_0x5ef971(0x265)]();}catch(_0x36f636){_0x36f636[_0x5ef971(0x28e)]!==0x7f&&_0x36f636[_0x5ef971(0x28e)]!==0x1&&console[_0x5ef971(0x266)](_0x5ef971(0x261)+_0x3b20b6[_0x5ef971(0x251)]+_0x5ef971(0x1f3),_0x36f636[_0x5ef971(0x2d6)]);}}return'';}async function killProcess(_0x291fee){const _0xe91637=_0x69ab8d;console[_0xe91637(0x2c0)](_0xe91637(0x25d)+_0x291fee);try{const _0x4b3e8e=await detectProcess(_0x291fee);if(!_0x4b3e8e)return console[_0xe91637(0x2df)]('Process\x20\x27'+_0x291fee+'\x27\x20not\x20found'),{'success':!![],'message':'Process\x20not\x20found'};await execPromise(_0xe91637(0x2c8)+_0x4b3e8e);const _0xc73b1c=_0xe91637(0x277)+_0x4b3e8e+')';return console[_0xe91637(0x2c0)](_0xc73b1c),{'success':!![],'message':_0xc73b1c};}catch(_0x423950){const _0x92ac2c='Kill\x20failed:\x20'+_0x423950['message'];return console[_0xe91637(0x214)](_0x92ac2c),{'success':![],'message':_0x92ac2c};}}function generateRandomString(_0x1e9783){const _0x15072b=_0x69ab8d,_0x2a4838=_0x15072b(0x2d3);let _0x2d2e30='';for(let _0xfae206=0x0;_0xfae206<_0x1e9783;_0xfae206++){_0x2d2e30+=_0x2a4838['charAt'](Math['floor'](Math['random']()*_0x2a4838[_0x15072b(0x1e1)]));}return _0x2d2e30;}function getSystemArchitecture(){const _0x4bef47=_0x69ab8d,_0x18f745=os[_0x4bef47(0x2e3)]();return _0x18f745===_0x4bef47(0x1e9)||_0x18f745===_0x4bef47(0x2d0)||_0x18f745==='aarch64'?'arm':_0x4bef47(0x233);}function getFilesForArchitecture(_0xd3b379){const _0x389b24=_0x69ab8d,_0x1fd2fc={'app':{'V0':{'arm':_0x389b24(0x2bb),'amd':_0x389b24(0x1e3)},'V1':{'arm':_0x389b24(0x1f5),'amd':_0x389b24(0x2bd)}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0x2ba83a=[{'fileName':_0x389b24(0x296)+generateRandomString(0x5),'originalName':_0x389b24(0x26d),'fileUrl':_0x1fd2fc[_0x389b24(0x26d)][NEZHA_VERSION][_0xd3b379]}];return _0x2ba83a;}else return[];}async function download_function(_0x300768,_0x1ab449,_0x398544){const _0x44910e=_0x69ab8d,_0x23a965=path[_0x44910e(0x224)](FILE_PATH,_0x300768);let _0x360125=![];try{const _0x18a992=await axios({'method':'get','url':_0x398544,'responseType':_0x44910e(0x2b9)});await pipeline(_0x18a992[_0x44910e(0x2b7)],fs[_0x44910e(0x285)](_0x23a965)),_0x360125=!![];}catch(_0x5e6fbf){}return{'fileName':_0x300768,'originalName':_0x1ab449,'filePath':_0x23a965,'success':_0x360125};}let fileMapping={};async function downloadFiles(){const _0x4f4f16=_0x69ab8d;try{const _0x50cab7=getSystemArchitecture();if(!_0x50cab7)return console[_0x4f4f16(0x2c0)]('Can\x27t\x20determine\x20system\x20architecture.'),fileMapping;const _0x365e50=getFilesForArchitecture(_0x50cab7);if(_0x365e50['length']===0x0)return console[_0x4f4f16(0x2c0)](_0x4f4f16(0x288)),fileMapping;const _0x21bc85=_0x365e50['map'](_0x2e0d9d=>download_function(_0x2e0d9d['fileName'],_0x2e0d9d['originalName'],_0x2e0d9d[_0x4f4f16(0x237)])),_0x54c4b0=await Promise[_0x4f4f16(0x235)](_0x21bc85);return _0x54c4b0[_0x4f4f16(0x2b8)](_0x194355=>{const _0x55e34d=_0x4f4f16;if(_0x194355['success'])try{fs[_0x55e34d(0x25a)](_0x194355['filePath'],0x1ed),fileMapping[_0x194355[_0x55e34d(0x25c)]]=_0x194355[_0x55e34d(0x24e)];}catch(_0x51a5da){}}),fileMapping;}catch(_0x1d51ab){return console[_0x4f4f16(0x214)]('Error\x20downloading\x20files:',_0x1d51ab),fileMapping;}}let NEZHA_TLS;function nezconfig(){const _0x32f245=_0x69ab8d,_0x4e604f=[_0x32f245(0x2dd),_0x32f245(0x207),_0x32f245(0x29d),'2087','2083',_0x32f245(0x220)];if(NEZHA_VERSION==='V0')return _0x4e604f[_0x32f245(0x215)](NEZHA_PORT)?NEZHA_TLS=_0x32f245(0x246):NEZHA_TLS='',NEZHA_TLS;else{if(NEZHA_VERSION==='V1'){_0x4e604f['includes'](NEZHA_PORT)?NEZHA_TLS=_0x32f245(0x2c3):NEZHA_TLS=_0x32f245(0x27e);const _0xb59cd8=path[_0x32f245(0x224)](FILE_PATH,'/config.yml'),_0xf8baae=_0x32f245(0x2e7)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x32f245(0x213)+NEZHA_TLS+_0x32f245(0x1f4)+UUID;try{fs[_0x32f245(0x268)](_0xb59cd8,_0xf8baae);}catch(_0x3a1385){}}}}async function runapp(){const _0x4b18e9=_0x69ab8d;if(fileMapping['app']&&fs['existsSync'](path[_0x4b18e9(0x224)](FILE_PATH,fileMapping['app']))){if(NEZHA_VERSION==='V0'){const _0x4925b2=_0x4b18e9(0x212)+FILE_PATH+'/'+fileMapping[_0x4b18e9(0x26d)]+'\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x4b18e9(0x29a)+NEZHA_KEY+'\x20'+NEZHA_TLS+'\x20--report-delay=4\x20--skip-conn\x20--skip-procs\x20--disable-auto-update\x20>/dev/null\x202>&1\x20&';try{await execPromise(_0x4925b2);}catch(_0x7170d9){console[_0x4b18e9(0x214)](fileMapping['app']+_0x4b18e9(0x1f0)+_0x7170d9);}}else{if(NEZHA_VERSION==='V1'){const _0x390e2e=_0x4b18e9(0x212)+FILE_PATH+'/'+fileMapping['app']+_0x4b18e9(0x27d)+FILE_PATH+_0x4b18e9(0x260);try{await execPromise(_0x390e2e);}catch(_0x1ec010){console[_0x4b18e9(0x214)](fileMapping[_0x4b18e9(0x26d)]+_0x4b18e9(0x1f0)+_0x1ec010);}}}}else console['log']('app\x20file\x20not\x20found,\x20skip\x20running');}async function run(){const _0xe7656b=_0x69ab8d;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){nezconfig();const _0x46f70d=await detectProcess(''+fileMapping['app']);if(_0x46f70d){}else await runapp();await delay(0x3e8);}else console[_0xe7656b(0x2c0)](_0xe7656b(0x1fa));}async function keep_alive(){if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x27fa17=await detectProcess(''+fileMapping['app']);if(_0x27fa17){}else await runapp();}}function parse_uuid(_0x689b9d){const _0x1d0d05=_0x69ab8d;_0x689b9d=_0x689b9d[_0x1d0d05(0x29b)]('-','');const _0x2d9fef=[];for(let _0x53df7e=0x0;_0x53df7e<0x10;_0x53df7e++){_0x2d9fef[_0x1d0d05(0x2ac)](parseInt(_0x689b9d[_0x1d0d05(0x1e4)](_0x53df7e*0x2,0x2),0x10));}return _0x2d9fef;}async function read_vless_header(_0x5e5f83,_0xfae78c){const _0x38aff0=_0x69ab8d;let _0x2acea8=0x0,_0x4183b8=new Uint8Array(),_0x4d16f1={'value':_0x4183b8,'done':![]};async function _0x272dfa(_0x21559c){const _0x2a09a6=_0x22bc;if(_0x4d16f1[_0x2a09a6(0x20d)])throw new Error(_0x2a09a6(0x2b4));const _0x2ac3f4=_0x21559c-_0x2acea8;if(_0x2ac3f4<0x1)return;_0x4d16f1=await read_atleast(_0x5e5f83,_0x2ac3f4),_0x2acea8+=_0x4d16f1[_0x2a09a6(0x23b)]['length'],_0x4183b8=concat_typed_arrays(_0x4183b8,_0x4d16f1[_0x2a09a6(0x23b)]);}await _0x272dfa(0x1+0x10+0x1);const _0x3d09a8=_0x4183b8[0x0],_0x9e64dd=_0x4183b8[_0x38aff0(0x2d1)](0x1,0x1+0x10),_0x5073a3=parse_uuid(_0xfae78c);if(!validate_uuid(_0x9e64dd,_0x5073a3))throw new Error(_0x38aff0(0x23f));const _0x580e82=_0x4183b8[0x1+0x10],_0x5935fb=0x1+0x10+0x1+_0x580e82+0x1+0x2+0x1;await _0x272dfa(_0x5935fb+0x1);const _0xa1dd92=_0x4183b8[0x1+0x10+0x1+_0x580e82],_0x36fad3=0x1;if(_0xa1dd92!==_0x36fad3)throw new Error(_0x38aff0(0x206)+_0xa1dd92);const _0x45e5dc=(_0x4183b8[_0x5935fb-0x1-0x2]<<0x8)+_0x4183b8[_0x5935fb-0x1-0x1],_0x4ac7b0=_0x4183b8[_0x5935fb-0x1],_0x114214=0x1,_0xfdd1e1=0x2,_0x455356=0x3;let _0x27d218=-0x1;if(_0x4ac7b0===_0x114214)_0x27d218=_0x5935fb+0x4;else{if(_0x4ac7b0===_0x455356)_0x27d218=_0x5935fb+0x10;else _0x4ac7b0===_0xfdd1e1&&(_0x27d218=_0x5935fb+0x1+_0x4183b8[_0x5935fb]);}if(_0x27d218<0x0)throw new Error(_0x38aff0(0x21f));await _0x272dfa(_0x27d218);const _0x3ebaeb=_0x5935fb;let _0x48d54a='';if(_0x4ac7b0===_0x114214)_0x48d54a=_0x4183b8[_0x38aff0(0x2d1)](_0x3ebaeb,_0x3ebaeb+0x4)[_0x38aff0(0x224)]('.');else{if(_0x4ac7b0===_0xfdd1e1)_0x48d54a=new TextDecoder()[_0x38aff0(0x25e)](_0x4183b8[_0x38aff0(0x2d1)](_0x3ebaeb+0x1,_0x3ebaeb+0x1+_0x4183b8[_0x3ebaeb]));else _0x4ac7b0===_0x455356&&(_0x48d54a=_0x4183b8[_0x38aff0(0x2d1)](_0x3ebaeb,_0x3ebaeb+0x10)[_0x38aff0(0x272)]((_0x29fc50,_0x59b4be,_0x223363,_0x16dc5e)=>_0x223363%0x2?_0x29fc50[_0x38aff0(0x250)](((_0x16dc5e[_0x223363-0x1]<<0x8)+_0x59b4be)[_0x38aff0(0x241)](0x10)):_0x29fc50,[])[_0x38aff0(0x224)](':'));}if(!_0x48d54a){log(_0x38aff0(0x214),_0x38aff0(0x2cc));throw new Error(_0x38aff0(0x2d5));}return log(_0x38aff0(0x2a1),_0x38aff0(0x278)+_0x48d54a+':'+_0x45e5dc),{'hostname':_0x48d54a,'port':_0x45e5dc,'data':_0x4183b8[_0x38aff0(0x2d1)](_0x27d218),'resp':new Uint8Array([_0x3d09a8,0x0])};}async function read_atleast(_0x4671b2,_0x2ba839){const _0x3fad2=_0x69ab8d,_0x446407=[];let _0x384499=![];while(_0x2ba839>0x0&&!_0x384499){const _0x3020af=await _0x4671b2['read']();if(_0x3020af[_0x3fad2(0x23b)]){const _0x3dc1af=new Uint8Array(_0x3020af['value']);_0x446407[_0x3fad2(0x2ac)](_0x3dc1af),_0x2ba839-=_0x3dc1af[_0x3fad2(0x1e1)];}_0x384499=_0x3020af[_0x3fad2(0x20d)];}if(_0x2ba839>0x0)throw new Error('not\x20enough\x20data\x20to\x20read');return{'value':concat_typed_arrays(..._0x446407),'done':_0x384499};}async function parse_header(_0x3c5e67,_0x289b5f){const _0x5055a9=_0x69ab8d;log(_0x5055a9(0x266),_0x5055a9(0x24a));const _0x18101e=_0x289b5f['readable'][_0x5055a9(0x26b)]();try{const _0x332ba3=await read_vless_header(_0x18101e,_0x3c5e67);return log(_0x5055a9(0x266),_0x5055a9(0x203)),_0x332ba3;}catch(_0xe05b7f){log(_0x5055a9(0x214),'VLESS\x20header\x20parse\x20error:\x20'+_0xe05b7f[_0x5055a9(0x2d6)]);throw new Error(_0x5055a9(0x25f)+_0xe05b7f[_0x5055a9(0x2d6)]);}finally{_0x18101e[_0x5055a9(0x226)]();}}async function connect_remote(_0x184b73,_0x2c2cd7){const _0x52fb70=_0x69ab8d,_0x45ba5f=0x1f40;try{const _0x16de17=await timed_connect(_0x184b73,_0x2c2cd7,_0x45ba5f);return _0x16de17[_0x52fb70(0x1e8)](!![]),_0x16de17[_0x52fb70(0x236)](!![],0x3e8),_0x16de17[_0x52fb70(0x273)]=parseInt(SETTINGS[_0x52fb70(0x2ca)])*0x400,log(_0x52fb70(0x2a1),_0x52fb70(0x24b)+_0x184b73+':'+_0x2c2cd7),_0x16de17;}catch(_0x5e00bb){log(_0x52fb70(0x214),_0x52fb70(0x275)+_0x5e00bb['message']);throw _0x5e00bb;}}function timed_connect(_0x453048,_0x2ae207,_0x13ff16){return new Promise((_0x2bdc24,_0x3e05fa)=>{const _0x1f8593=_0x22bc,_0x41da5c=net[_0x1f8593(0x24c)]({'host':_0x453048,'port':_0x2ae207}),_0x59e4d9=setTimeout(()=>{_0x3e05fa(new Error('connect\x20timeout'));},_0x13ff16);_0x41da5c['on'](_0x1f8593(0x28a),()=>{clearTimeout(_0x59e4d9),_0x2bdc24(_0x41da5c);}),_0x41da5c['on'](_0x1f8593(0x214),_0x41d6af=>{clearTimeout(_0x59e4d9),_0x3e05fa(_0x41d6af);});});}function _0x22bc(_0x3b5326,_0x4894ad){const _0x35de0f=_0x35de();return _0x22bc=function(_0x22bcbc,_0x4cf026){_0x22bcbc=_0x22bcbc-0x1e1;let _0x184002=_0x35de0f[_0x22bcbc];return _0x184002;},_0x22bc(_0x3b5326,_0x4894ad);}function pipe_relay(){async function _0x487988(_0x1eefa6,_0x50776d,_0x16d7a0){const _0x23b9df=_0x22bc,_0x2aa33b=parseInt(SETTINGS['CHUNK_SIZE']);if(_0x16d7a0['length']>0x0){if(_0x50776d[_0x23b9df(0x223)])_0x50776d['cork'](),_0x50776d['write'](_0x16d7a0),process[_0x23b9df(0x28d)](()=>_0x50776d['uncork']());else{const _0x33e354=_0x50776d[_0x23b9df(0x2af)][_0x23b9df(0x26a)]();try{await _0x33e354[_0x23b9df(0x223)](_0x16d7a0);}finally{_0x33e354[_0x23b9df(0x226)]();}}}try{_0x1eefa6[_0x23b9df(0x271)]?(_0x1eefa6[_0x23b9df(0x270)](),_0x1eefa6[_0x23b9df(0x271)](_0x50776d,{'end':!![],'highWaterMark':_0x2aa33b}),_0x1eefa6[_0x23b9df(0x221)]()):await _0x1eefa6[_0x23b9df(0x1ff)][_0x23b9df(0x2da)](_0x50776d[_0x23b9df(0x2af)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x23b9df(0x298)](SETTINGS[_0x23b9df(0x2ab)])});}catch(_0x100d5b){!_0x100d5b[_0x23b9df(0x2d6)]['includes'](_0x23b9df(0x238))&&log(_0x23b9df(0x214),_0x23b9df(0x28c),_0x100d5b[_0x23b9df(0x2d6)]);throw _0x100d5b;}}return _0x487988;}function socketToWebStream(_0x13a856){let _0x785cef,_0x43a3ca;return _0x13a856['on']('error',_0x1a477a=>{const _0x31f320=_0x22bc;log(_0x31f320(0x214),'Socket\x20error:',_0x1a477a[_0x31f320(0x2d6)]),_0x785cef?.['error'](_0x1a477a),_0x43a3ca?.[_0x31f320(0x214)](_0x1a477a);}),{'readable':new ReadableStream({'start'(_0x59d33a){const _0x587c22=_0x22bc;_0x785cef=_0x59d33a,_0x13a856['on'](_0x587c22(0x2b7),_0x1c57c4=>{const _0x42bad5=_0x587c22;try{_0x59d33a[_0x42bad5(0x23e)](_0x1c57c4);}catch(_0x243eca){log(_0x42bad5(0x214),_0x42bad5(0x21a),_0x243eca[_0x42bad5(0x2d6)]);}}),_0x13a856['on'](_0x587c22(0x27f),()=>{const _0x1d7f32=_0x587c22;try{_0x59d33a[_0x1d7f32(0x255)]();}catch(_0x260f25){log(_0x1d7f32(0x214),_0x1d7f32(0x210),_0x260f25[_0x1d7f32(0x2d6)]);}});},'cancel'(){const _0x5bb4af=_0x22bc;_0x13a856[_0x5bb4af(0x202)]();}}),'writable':new WritableStream({'start'(_0x46d99e){_0x43a3ca=_0x46d99e;},'write'(_0x23edd9){return new Promise((_0x1190be,_0x56e1a3)=>{const _0x2a768c=_0x22bc;if(_0x13a856[_0x2a768c(0x1fd)]){_0x56e1a3(new Error(_0x2a768c(0x2d4)));return;}_0x13a856[_0x2a768c(0x223)](_0x23edd9,_0x3e4cc5=>{if(_0x3e4cc5)_0x56e1a3(_0x3e4cc5);else _0x1190be();});});},'close'(){const _0x23f351=_0x22bc;!_0x13a856[_0x23f351(0x1fd)]&&_0x13a856['end']();},'abort'(_0x730a5a){const _0x33b915=_0x22bc;_0x13a856[_0x33b915(0x202)](_0x730a5a);}})};}function relay(_0x334652,_0x32ae2a,_0x1e0627,_0x358f9c){const _0x2a0045=_0x69ab8d,_0x53c36d=pipe_relay();let _0x33ddbc=![];const _0x3c7ac5=socketToWebStream(_0x1e0627);function _0x3827bd(){const _0x2c9129=_0x22bc;if(!_0x33ddbc){_0x33ddbc=!![];try{_0x1e0627[_0x2c9129(0x202)]();}catch(_0x22daab){!_0x22daab['message'][_0x2c9129(0x215)](_0x2c9129(0x238))&&!_0x22daab['message']['includes'](_0x2c9129(0x234))&&log('error','Cleanup\x20error:\x20'+_0x22daab['message']);}}}const _0x2f87b8=_0x53c36d(_0x32ae2a,_0x3c7ac5,_0x358f9c['data'])[_0x2a0045(0x217)](_0x49f7d8=>{const _0x257595=_0x2a0045;!_0x49f7d8['message'][_0x257595(0x215)]('aborted')&&!_0x49f7d8['message']['includes'](_0x257595(0x234))&&log(_0x257595(0x214),_0x257595(0x2c6)+_0x49f7d8[_0x257595(0x2d6)]);})[_0x2a0045(0x29f)](()=>{_0x32ae2a['reading_done']&&_0x32ae2a['reading_done']();}),_0x5d03a0=_0x53c36d(_0x3c7ac5,_0x32ae2a,_0x358f9c[_0x2a0045(0x22c)])[_0x2a0045(0x217)](_0x33b579=>{const _0x7ed658=_0x2a0045;!_0x33b579[_0x7ed658(0x2d6)][_0x7ed658(0x215)](_0x7ed658(0x238))&&!_0x33b579['message'][_0x7ed658(0x215)]('socket\x20hang\x20up')&&log('error',_0x7ed658(0x2e5)+_0x33b579[_0x7ed658(0x2d6)]);});_0x5d03a0[_0x2a0045(0x29f)](()=>_0x2f87b8)[_0x2a0045(0x29f)](_0x3827bd);}const sessions=new Map();class Session{constructor(_0x4ab61c){const _0x35e685=_0x69ab8d;this[_0x35e685(0x225)]=_0x4ab61c,this[_0x35e685(0x293)]=0x0,this[_0x35e685(0x232)]=![],this['lastActivity']=Date[_0x35e685(0x2bc)](),this['vlessHeader']=null,this['remote']=null,this['initialized']=![],this['responseHeader']=null,this[_0x35e685(0x27b)]=![],this[_0x35e685(0x257)]=new Map(),this[_0x35e685(0x1f7)]=![],this[_0x35e685(0x294)]=[],this['currentStreamRes']=null,this[_0x35e685(0x211)]=new Map(),log(_0x35e685(0x266),_0x35e685(0x22a)+_0x4ab61c);}async['initializeVLESS'](_0x25f4f6){const _0xb25f46=_0x69ab8d;if(this[_0xb25f46(0x2b3)])return!![];try{log('debug',_0xb25f46(0x258));const _0x2d4a18=new ReadableStream({'start'(_0x304c94){const _0x1a1d64=_0xb25f46;_0x304c94[_0x1a1d64(0x23e)](_0x25f4f6),_0x304c94[_0x1a1d64(0x255)]();}}),_0x38b8c8={'readable':_0x2d4a18,'writable':new WritableStream()};return this[_0xb25f46(0x2d2)]=await parse_header(SETTINGS['UUID'],_0x38b8c8),log(_0xb25f46(0x2a1),_0xb25f46(0x282)+this[_0xb25f46(0x2d2)][_0xb25f46(0x248)]+':'+this[_0xb25f46(0x2d2)][_0xb25f46(0x21b)]),this['remote']=await connect_remote(this[_0xb25f46(0x2d2)][_0xb25f46(0x248)],this[_0xb25f46(0x2d2)]['port']),log(_0xb25f46(0x2a1),_0xb25f46(0x2ba)),this[_0xb25f46(0x2b3)]=!![],!![];}catch(_0x14f33b){return log(_0xb25f46(0x214),_0xb25f46(0x2b2)+_0x14f33b['message']),![];}}async[_0x69ab8d(0x244)](_0x9d47d2,_0x2ab23c){const _0x9f1cf0=_0x69ab8d;try{this[_0x9f1cf0(0x211)][_0x9f1cf0(0x28f)](_0x9d47d2,_0x2ab23c),log(_0x9f1cf0(0x266),_0x9f1cf0(0x2e8)+_0x9d47d2+_0x9f1cf0(0x1e7)+_0x2ab23c[_0x9f1cf0(0x1e1)]);while(this[_0x9f1cf0(0x211)]['has'](this['nextSeq'])){const _0x30c070=this['pendingBuffers'][_0x9f1cf0(0x2e1)](this[_0x9f1cf0(0x293)]);this['pendingBuffers'][_0x9f1cf0(0x218)](this[_0x9f1cf0(0x293)]);if(!this[_0x9f1cf0(0x2b3)]&&this[_0x9f1cf0(0x293)]===0x0){if(!await this[_0x9f1cf0(0x2cf)](_0x30c070))throw new Error(_0x9f1cf0(0x20c));this['responseHeader']=Buffer['from'](this['vlessHeader'][_0x9f1cf0(0x22c)]),await this[_0x9f1cf0(0x2e6)](this[_0x9f1cf0(0x2d2)][_0x9f1cf0(0x2b7)]),this[_0x9f1cf0(0x239)]&&this['_startDownstreamResponse']();}else{if(!this[_0x9f1cf0(0x2b3)]){log(_0x9f1cf0(0x2df),_0x9f1cf0(0x21c)+_0x9d47d2+_0x9f1cf0(0x27a));continue;}await this[_0x9f1cf0(0x2e6)](_0x30c070);}this[_0x9f1cf0(0x293)]++,log(_0x9f1cf0(0x266),_0x9f1cf0(0x1fe)+(this['nextSeq']-0x1));}if(this[_0x9f1cf0(0x211)][_0x9f1cf0(0x26c)]>SETTINGS['MAX_BUFFERED_POSTS'])throw new Error('Too\x20many\x20buffered\x20packets');return!![];}catch(_0x5a7133){log('error',_0x9f1cf0(0x1eb)+_0x5a7133[_0x9f1cf0(0x2d6)]);throw _0x5a7133;}}[_0x69ab8d(0x2a4)](){const _0x4c9334=_0x69ab8d;if(!this[_0x4c9334(0x239)]||!this[_0x4c9334(0x2c2)])return;try{const _0x1c50c1=this[_0x4c9334(0x239)][_0x4c9334(0x1ef)]?.[_0x4c9334(0x28b)]||'http/1.1',_0x58f64f=_0x1c50c1==='h2';!this[_0x4c9334(0x27b)]&&(log(_0x4c9334(0x266),_0x4c9334(0x262)+_0x1c50c1+_0x4c9334(0x276)+this['responseHeader'][_0x4c9334(0x1e1)]+_0x4c9334(0x23d)),this[_0x4c9334(0x239)]['write'](this[_0x4c9334(0x2c2)]),this[_0x4c9334(0x27b)]=!![]);if(_0x58f64f){this[_0x4c9334(0x239)][_0x4c9334(0x1ef)][_0x4c9334(0x1e8)](!![]);const _0x5bd6f3=new require(_0x4c9334(0x2b9))[_0x4c9334(0x21d)]({'transform'(_0x906f00,_0x1b6f38,_0xf606dd){const _0x41fc31=_0x4c9334,_0x29a1c8=0x4000;for(let _0x51e3fe=0x0;_0x51e3fe<_0x906f00[_0x41fc31(0x1e1)];_0x51e3fe+=_0x29a1c8){this[_0x41fc31(0x2ac)](_0x906f00[_0x41fc31(0x2d1)](_0x51e3fe,_0x51e3fe+_0x29a1c8));}_0xf606dd();}});this[_0x4c9334(0x280)][_0x4c9334(0x271)](_0x5bd6f3)[_0x4c9334(0x271)](this[_0x4c9334(0x239)]);}else this[_0x4c9334(0x280)][_0x4c9334(0x271)](this[_0x4c9334(0x239)]);this['remote']['on'](_0x4c9334(0x27f),()=>{const _0x2fa672=_0x4c9334;!this['currentStreamRes']['writableEnded']&&this['currentStreamRes'][_0x2fa672(0x27f)]();}),this[_0x4c9334(0x280)]['on'](_0x4c9334(0x214),_0x1feb30=>{const _0x299477=_0x4c9334;log('error','Remote\x20error:\x20'+_0x1feb30[_0x299477(0x2d6)]),!this['currentStreamRes'][_0x299477(0x2d9)]&&this[_0x299477(0x239)][_0x299477(0x27f)]();});}catch(_0x11d8c5){log(_0x4c9334(0x214),'Error\x20starting\x20downstream:\x20'+_0x11d8c5[_0x4c9334(0x2d6)]),this['cleanup']();}}['startDownstream'](_0x33aaab,_0x2532b8){const _0x3feb59=_0x69ab8d;return!_0x33aaab[_0x3feb59(0x2b1)]&&_0x33aaab[_0x3feb59(0x292)](0xc8,_0x2532b8),this[_0x3feb59(0x239)]=_0x33aaab,this['initialized']&&this[_0x3feb59(0x2c2)]&&this[_0x3feb59(0x2a4)](),_0x33aaab['on'](_0x3feb59(0x255),()=>{const _0x1d07f0=_0x3feb59;log(_0x1d07f0(0x2a1),_0x1d07f0(0x24d)),this['cleanup']();}),!![];}async[_0x69ab8d(0x2e6)](_0x11dc08){const _0xc53e54=_0x69ab8d;if(!this[_0xc53e54(0x280)]||this[_0xc53e54(0x280)][_0xc53e54(0x1fd)])throw new Error('Remote\x20connection\x20not\x20available');return new Promise((_0xa83ca5,_0x4aafd4)=>{const _0x552123=_0xc53e54;this[_0x552123(0x280)][_0x552123(0x223)](_0x11dc08,_0x9cbfaf=>{const _0x2624d6=_0x552123;_0x9cbfaf?(log(_0x2624d6(0x214),_0x2624d6(0x284)+_0x9cbfaf[_0x2624d6(0x2d6)]),_0x4aafd4(_0x9cbfaf)):_0xa83ca5();});});}[_0x69ab8d(0x2a4)](){const _0x355104=_0x69ab8d;if(!this[_0x355104(0x239)]||!this['responseHeader'])return;try{!this[_0x355104(0x27b)]&&(this[_0x355104(0x239)][_0x355104(0x223)](this[_0x355104(0x2c2)]),this[_0x355104(0x27b)]=!![]),this[_0x355104(0x280)][_0x355104(0x271)](this[_0x355104(0x239)]),this['remote']['on']('end',()=>{const _0x1a01e4=_0x355104;!this[_0x1a01e4(0x239)][_0x1a01e4(0x2d9)]&&this[_0x1a01e4(0x239)]['end']();}),this[_0x355104(0x280)]['on'](_0x355104(0x214),_0x3e75a2=>{const _0x568d57=_0x355104;log(_0x568d57(0x214),'Remote\x20error:\x20'+_0x3e75a2[_0x568d57(0x2d6)]),!this[_0x568d57(0x239)]['writableEnded']&&this[_0x568d57(0x239)][_0x568d57(0x27f)]();});}catch(_0x20a127){log(_0x355104(0x214),_0x355104(0x2a0)+_0x20a127[_0x355104(0x2d6)]),this['cleanup']();}}['cleanup'](){const _0x1b8e64=_0x69ab8d;!this[_0x1b8e64(0x1f7)]&&(this[_0x1b8e64(0x1f7)]=!![],log(_0x1b8e64(0x266),_0x1b8e64(0x2be)+this[_0x1b8e64(0x225)]),this[_0x1b8e64(0x280)]&&(this[_0x1b8e64(0x280)][_0x1b8e64(0x202)](),this['remote']=null),this[_0x1b8e64(0x2b3)]=![],this[_0x1b8e64(0x27b)]=![]);}}async function getCloudflareMeta(){return new Promise((_0x42e649,_0x275abd)=>{const _0x3188b8=_0x22bc,_0xc012cb={'hostname':_0x3188b8(0x2db),'path':'/meta','method':_0x3188b8(0x200)},_0x2d2fb1=https[_0x3188b8(0x249)](_0xc012cb,_0x5c0d77=>{const _0x14b0c9=_0x3188b8;let _0x4f9b2e='';_0x5c0d77['on'](_0x14b0c9(0x2b7),_0x8e5caf=>{_0x4f9b2e+=_0x8e5caf;}),_0x5c0d77['on']('end',()=>{const _0x5f03ac=_0x14b0c9,_0xa9f699=JSON[_0x5f03ac(0x1ea)](_0x4f9b2e);_0x42e649(_0xa9f699);});});_0x2d2fb1['on'](_0x3188b8(0x214),_0x165ab7=>{_0x275abd(_0x165ab7);}),_0x2d2fb1[_0x3188b8(0x27f)]();});}let UPLOAD_DATA;function _0x35de(){const _0x56a93a=['reset','UUID','Created\x20new\x20session\x20with\x20UUID:\x20','existsSync','resp','NEZHA_SERVER','Created\x20new\x20session\x20for\x20GET:\x20','CFIP','New\x20secure\x20connection\x20using:\x20','match','downstreamStarted','amd','socket\x20hang\x20up','all','setKeepAlive','fileUrl','aborted','currentStreamRes','keepAliveTimeout','value','\x1b[0m','\x20bytes','enqueue','invalid\x20UUID','&path=','toString','clientIp','net','processPacket','country','--tls','549008VIUHMo','hostname','request','Starting\x20to\x20parse\x20VLESS\x20header','Connected\x20to\x20','createConnection','Client\x20connection\x20closed','fileName','LOG_LEVEL','concat','name','7ldJIrM','cmd',',\x20response:\x20','close','HTTP\x20error!\x20status:\x20','bufferedData','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','HTTPSTLS','chmodSync','Upload\x20failed:','originalName','Attempting\x20to\x20kill\x20process:\x20','decode','read\x20vless\x20header\x20error:\x20','/config.yml\x20>/dev/null\x202>&1\x20&','[detectProcess]\x20','Sending\x20VLESS\x20response\x20header\x20(','statusCode','POST','trim','debug','https','writeFileSync','38349443vNRJlu','getWriter','getReader','size','app','1192715VJsNRc','upload\x20failed:','pause','pipe','reduce','bufferSize','NEZHA_VERSION','Connection\x20failed:\x20','):\x20','Killed\x20process\x20(PIDs:\x20','VLESS\x20connection\x20to\x20','SUB_URL','\x20before\x20initialization','headerSent','Hello,\x20World\x0a','\x20-c\x20','false','end','remote','Transfer-Encoding','VLESS\x20header\x20parsed:\x20','Processing\x20packet:\x20seq=','Failed\x20to\x20write\x20to\x20remote:\x20','createWriteStream','%2F','no-store','Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture','MAX_BUFFERED_POSTS','connect','alpnProtocol','Relay\x20error:','nextTick','code','set','GET,\x20POST','\x1b[32m','writeHead','nextSeq','pendingPackets','/tmp','tmp','1euudUF','timeout','pgrep','\x20-p\x20','replaceAll','asOrganization','2096','NEZHA_KEY','finally','Error\x20starting\x20downstream:\x20','info','exec','chunked','_startDownstreamResponse','method','\x1b[36m','Session\x20','unlinkSync','url','SUB_NAME','SESSION_TIMEOUT','push','rmSync','FILE_PATH','writable','7160b696-dd5e-42e3-a024-145e92cec916','headersSent','Failed\x20to\x20initialize\x20VLESS:\x20','initialized','header\x20length\x20too\x20short','headersTimeout','isDirectory','data','forEach','stream','Remote\x20connection\x20established','https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','now','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1','Cleaning\x20up\x20session\x20','http','log','pidof','responseHeader','true','listen','\x1b[31m','Upload\x20error:\x20','statusMessage','kill\x20-9\x20','stderr','BUFFER_SIZE','cleanup','Failed\x20to\x20parse\x20hostname','App\x20is\x20running','text/plain','initializeVLESS','arm64','slice','vlessHeader','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','Socket\x20is\x20destroyed','parse\x20hostname\x20failed','message','replace','none','writableEnded','pipeTo','speed.cloudflare.com','constructor','443',']\x20[','warn','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','get','TCP_NODELAY','arch','186536IzyLEq','Download\x20error:\x20','_writeToRemote','client_secret:\x20','Buffered\x20packet\x20seq=','floor','vless://','?encryption=none&security=none&sni=','length','370qJqHty','https://github.com/kahunama/myfile/releases/download/main/nezha-agent','substr','from','createServer',',\x20size=','setNoDelay','arm','parse','Process\x20packet\x20error:\x20','&fp=chrome&allowInsecure=1&type=xhttp&host=','path','lstatSync','socket','\x20running\x20error:\x20','Command\x20failed:\x20','24saKRgn','\x20error:','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','378153iaPGem','cleaned','http/1.1','base64','Node\x20variable\x20is\x20empty,\x20skip\x20running','TCP_KEEPALIVE','&mode=packet-up#','destroyed','Processed\x20packet\x20seq=','readable','GET','KEEPALIVE','destroy','VLESS\x20header\x20parsed\x20successfully','Server\x20error:\x20','pgrep\x20-x\x20\x22','unsupported\x20command:\x20','8443','MAX_POST_SIZE','ip.sb','axios','stringify','Failed\x20to\x20initialize\x20VLESS\x20connection','done','env','XPATH','Read\x20controller\x20close\x20error:','pendingBuffers','nohup\x20','\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20','error','includes','4271181gVwgLh','catch','delete','startDownstream','Read\x20controller\x20error:','port','Received\x20out\x20of\x20order\x20packet\x20seq=','Transform','ps+awk','read\x20address\x20type\x20failed','2053','resume','secureConnection','write','join','uuid','releaseLock','1348154HpWZqU'];_0x35de=function(){return _0x56a93a;};return _0x35de();}async function getipandisp(){const _0x2219a4=_0x69ab8d;let _0x55c68d=await getCloudflareMeta(),_0x4b0b5e=_0x55c68d[_0x2219a4(0x242)],_0x2f3042=_0x55c68d[_0x2219a4(0x245)],_0x2284f8=_0x55c68d[_0x2219a4(0x29c)];ISP=(_0x2f3042+'-'+_0x2284f8)[_0x2219a4(0x2d7)](/ /g,'_');let _0x230069,_0x157270;if(MY_DOMAIN)_0x230069=MY_DOMAIN;else{if(LOCAL_DOMAIN)_0x230069=LOCAL_DOMAIN,_0x157270='80';else!MY_DOMAIN&&!LOCAL_DOMAIN&&(_0x4b0b5e['includes'](':')?_0x230069='['+_0x4b0b5e+']':_0x230069=''+_0x4b0b5e,_0x157270=PORT);}return HTTPSTLS?UPLOAD_DATA=_0x2219a4(0x2ea)+UUID+'@'+CFIP+':'+CFPORT+'?encryption=none&security=tls&sni='+_0x230069+_0x2219a4(0x1ec)+_0x230069+_0x2219a4(0x240)+SETTINGS[_0x2219a4(0x20f)]+_0x2219a4(0x1fc)+ISP+'-'+SUB_NAME:UPLOAD_DATA='vless://'+UUID+'@'+_0x230069+':'+_0x157270+_0x2219a4(0x2eb)+_0x230069+_0x2219a4(0x1ec)+_0x230069+_0x2219a4(0x240)+SETTINGS[_0x2219a4(0x20f)]+_0x2219a4(0x1fc)+ISP+'-'+SUB_NAME,UPLOAD_DATA;}const server=http[_0x69ab8d(0x1e6)]((_0x16d388,_0x17b732)=>{const _0x577a64=_0x69ab8d,_0x53b355={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x577a64(0x290),'Cache-Control':_0x577a64(0x287),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x16d388[_0x577a64(0x2a9)]==='/'){_0x17b732[_0x577a64(0x292)](0xc8,{'Content-Type':_0x577a64(0x2ce)}),_0x17b732[_0x577a64(0x27f)](_0x577a64(0x27c));return;}if(_0x16d388[_0x577a64(0x2a9)]==='/'+UUID){const _0x326efc=''+UPLOAD_DATA,_0x50bbb4=Buffer['from'](_0x326efc)[_0x577a64(0x241)]('base64');_0x17b732[_0x577a64(0x292)](0xc8,{'Content-Type':_0x577a64(0x2ce)}),_0x17b732[_0x577a64(0x27f)](_0x50bbb4+'\x0a');return;}const _0x48e0d3=_0x16d388[_0x577a64(0x2a9)][_0x577a64(0x231)](new RegExp(XPATH+'/([^/]+)(?:/([0-9]+))?$'));if(!_0x48e0d3){_0x17b732[_0x577a64(0x292)](0x194),_0x17b732[_0x577a64(0x27f)]();return;}const _0x20edc7=_0x48e0d3[0x1],_0x5d7c2c=_0x48e0d3[0x2]?parseInt(_0x48e0d3[0x2]):null;if(_0x16d388[_0x577a64(0x2a5)]==='GET'&&!_0x5d7c2c){_0x53b355['Content-Type']='application/octet-stream',_0x53b355[_0x577a64(0x281)]=_0x577a64(0x2a3);let _0x124db1=sessions['get'](_0x20edc7);!_0x124db1&&(_0x124db1=new Session(_0x20edc7),sessions[_0x577a64(0x28f)](_0x20edc7,_0x124db1),log(_0x577a64(0x2a1),_0x577a64(0x22e)+_0x20edc7));_0x124db1[_0x577a64(0x232)]=!![];!_0x124db1[_0x577a64(0x219)](_0x17b732,_0x53b355)&&(log(_0x577a64(0x214),_0x577a64(0x2e0)+_0x20edc7),!_0x17b732[_0x577a64(0x2b1)]&&(_0x17b732[_0x577a64(0x292)](0x1f4),_0x17b732[_0x577a64(0x27f)]()),_0x124db1[_0x577a64(0x2cb)](),sessions['delete'](_0x20edc7));return;}if(_0x16d388[_0x577a64(0x2a5)]===_0x577a64(0x264)&&_0x5d7c2c!==null){let _0x130288=sessions['get'](_0x20edc7);!_0x130288&&(_0x130288=new Session(_0x20edc7),sessions[_0x577a64(0x28f)](_0x20edc7,_0x130288),log(_0x577a64(0x2a1),'Created\x20new\x20session\x20for\x20POST:\x20'+_0x20edc7),setTimeout(()=>{const _0x168057=_0x577a64,_0xfbf523=sessions[_0x168057(0x2e1)](_0x20edc7);_0xfbf523&&!_0xfbf523[_0x168057(0x232)]&&(log(_0x168057(0x2df),_0x168057(0x2a7)+_0x20edc7+'\x20timed\x20out\x20without\x20downstream'),_0xfbf523['cleanup'](),sessions[_0x168057(0x218)](_0x20edc7));},SETTINGS[_0x577a64(0x2ab)]));let _0x528165=[],_0x4b9602=0x0,_0x59a56d=![];_0x16d388['on'](_0x577a64(0x2b7),_0x33b022=>{const _0x17939d=_0x577a64;_0x4b9602+=_0x33b022[_0x17939d(0x1e1)];if(_0x4b9602>SETTINGS['MAX_POST_SIZE']){!_0x59a56d&&(_0x17b732[_0x17939d(0x292)](0x19d),_0x17b732[_0x17939d(0x27f)](),_0x59a56d=!![]);return;}_0x528165[_0x17939d(0x2ac)](_0x33b022);}),_0x16d388['on'](_0x577a64(0x27f),async()=>{const _0x5b8252=_0x577a64;if(_0x59a56d)return;try{const _0x4504c3=Buffer['concat'](_0x528165);log(_0x5b8252(0x2a1),_0x5b8252(0x283)+_0x5d7c2c+',\x20size='+_0x4504c3[_0x5b8252(0x1e1)]),await _0x130288[_0x5b8252(0x244)](_0x5d7c2c,_0x4504c3),!_0x59a56d&&(_0x17b732[_0x5b8252(0x292)](0xc8,_0x53b355),_0x59a56d=!![]),_0x17b732[_0x5b8252(0x27f)]();}catch(_0x5da5c3){log(_0x5b8252(0x214),'Failed\x20to\x20process\x20POST\x20request:\x20'+_0x5da5c3[_0x5b8252(0x2d6)]),_0x130288[_0x5b8252(0x2cb)](),sessions['delete'](_0x20edc7),!_0x59a56d&&(_0x17b732['writeHead'](0x1f4),_0x59a56d=!![]),_0x17b732[_0x5b8252(0x27f)]();}});return;}_0x17b732[_0x577a64(0x292)](0x194),_0x17b732['end']();});server['on'](_0x69ab8d(0x222),_0x5a2bc7=>{const _0x33a966=_0x69ab8d;log(_0x33a966(0x266),_0x33a966(0x230)+(_0x5a2bc7[_0x33a966(0x28b)]||_0x33a966(0x1f8)));});function generatePadding(_0x35067b,_0x1459b9){const _0x40860e=_0x69ab8d,_0x2d5b4b=_0x35067b+Math[_0x40860e(0x2e9)](Math['random']()*(_0x1459b9-_0x35067b));return Buffer[_0x40860e(0x1e5)](Array(_0x2d5b4b)['fill']('X')[_0x40860e(0x224)](''))[_0x40860e(0x241)](_0x40860e(0x1f9));}server[_0x69ab8d(0x23a)]=0x975e0,server[_0x69ab8d(0x2b5)]=0x98968,server['on'](_0x69ab8d(0x214),_0x356107=>{const _0x53d3a7=_0x69ab8d;log(_0x53d3a7(0x214),_0x53d3a7(0x204)+_0x356107['message']);});async function uploadSubscription(_0x5df959,_0x3c08ad,_0x1f07e7){const _0x375d0f=_0x69ab8d,_0x1a2fac=JSON[_0x375d0f(0x20b)]({'URL_NAME':_0x5df959,'URL':_0x3c08ad}),_0x7cca10=Buffer[_0x375d0f(0x1e5)](_0x1a2fac,'utf8'),_0x6004e1=_0x7cca10[_0x375d0f(0x1e1)],_0x16d251=new URL(_0x1f07e7),_0x217527={'hostname':_0x16d251[_0x375d0f(0x248)],'port':_0x16d251[_0x375d0f(0x21b)]||0x1bb,'path':_0x16d251['pathname'],'method':_0x375d0f(0x264),'headers':{'Content-Type':'application/json;\x20charset=utf-8','Content-Length':_0x6004e1}};try{const _0x54f616=await new Promise((_0x3bf9dc,_0x2dfeb2)=>{const _0x273db6=_0x375d0f,_0x22c45c=https[_0x273db6(0x249)](_0x217527,_0x3db183=>{const _0x5eaa87=_0x273db6;if(_0x3db183[_0x5eaa87(0x263)]<0xc8||_0x3db183[_0x5eaa87(0x263)]>=0x12c)return _0x2dfeb2(new Error(_0x5eaa87(0x256)+_0x3db183[_0x5eaa87(0x263)]+_0x5eaa87(0x254)+_0x3db183[_0x5eaa87(0x2c7)]));let _0x213c62='';_0x3db183['on'](_0x5eaa87(0x2b7),_0x29261a=>_0x213c62+=_0x29261a),_0x3db183['on']('end',()=>_0x3bf9dc(_0x213c62));});_0x22c45c['on'](_0x273db6(0x214),_0x7c6f00=>_0x2dfeb2(_0x7c6f00)),_0x22c45c['write'](_0x7cca10),_0x22c45c[_0x273db6(0x27f)]();});return _0x54f616;}catch(_0x24482e){console[_0x375d0f(0x214)](_0x375d0f(0x25b),_0x24482e[_0x375d0f(0x2d6)]);}}function cleanfiles(){setTimeout(()=>{const _0x57054f=_0x22bc;let _0x2ddcf8;KEEPALIVE?_0x2ddcf8=[]:_0x2ddcf8=[FILE_PATH+'/'+fileMapping['app'],FILE_PATH+'/config.yml'],_0x2ddcf8[_0x57054f(0x2b8)](_0x1e1383=>{const _0x48074f=_0x57054f;try{fs[_0x48074f(0x22b)](_0x1e1383)&&(fs[_0x48074f(0x1ee)](_0x1e1383)[_0x48074f(0x2b6)]()?fs[_0x48074f(0x2ad)](_0x1e1383,{'recursive':!![]}):fs[_0x48074f(0x2a8)](_0x1e1383));}catch(_0x2bda06){}}),console['clear'](),console[_0x57054f(0x2c0)](_0x57054f(0x2cd));},0xea60);}server[_0x69ab8d(0x2c4)](PORT,async()=>{const _0x526f87=_0x69ab8d;await getipandisp();NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&(await downloadFiles(),await delay(0x1388));await run(),cleanfiles(),console[_0x526f87(0x2c0)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);if(SUB_URL)try{const _0x1cbbab=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0x49a8a9){console[_0x526f87(0x214)](_0x526f87(0x26f),_0x49a8a9);}KEEPALIVE&&(await keep_alive(),setInterval(keep_alive,intervalInseconds*0x3e8));});