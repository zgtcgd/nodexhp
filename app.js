const _0x2aad5d=_0x37d2;(function(_0x46a32b,_0x37b47c){const _0x396095=_0x37d2,_0x1a0f64=_0x46a32b();while(!![]){try{const _0x3a2926=-parseInt(_0x396095(0xd9))/0x1*(parseInt(_0x396095(0x160))/0x2)+parseInt(_0x396095(0x104))/0x3*(-parseInt(_0x396095(0x7f))/0x4)+parseInt(_0x396095(0x101))/0x5*(-parseInt(_0x396095(0xb5))/0x6)+-parseInt(_0x396095(0xe8))/0x7*(parseInt(_0x396095(0x14e))/0x8)+-parseInt(_0x396095(0x106))/0x9*(parseInt(_0x396095(0x78))/0xa)+-parseInt(_0x396095(0x109))/0xb+parseInt(_0x396095(0xe6))/0xc;if(_0x3a2926===_0x37b47c)break;else _0x1a0f64['push'](_0x1a0f64['shift']());}catch(_0xe0d2ba){_0x1a0f64['push'](_0x1a0f64['shift']());}}}(_0x1300,0xdb18b));const os=require('os'),fs=require('fs'),net=require(_0x2aad5d(0x89)),path=require(_0x2aad5d(0x159)),http=require(_0x2aad5d(0x11a)),https=require(_0x2aad5d(0xb3)),axios=require(_0x2aad5d(0x10f)),{Buffer}=require(_0x2aad5d(0x117)),{exec,execSync}=require('child_process'),FILE_PATH=process[_0x2aad5d(0xde)][_0x2aad5d(0x137)]||_0x2aad5d(0xc4),SUB_PATH=process[_0x2aad5d(0xde)][_0x2aad5d(0x8b)]||_0x2aad5d(0x150),PORT=process[_0x2aad5d(0xde)][_0x2aad5d(0x12c)]||0xbb8,CFPORT=process['env'][_0x2aad5d(0x145)]||0x1bb,delay=_0x263450=>new Promise(_0x7a6e2c=>setTimeout(_0x7a6e2c,_0x263450)),SUB_URL=process[_0x2aad5d(0xde)][_0x2aad5d(0xcc)]||'',UUID=process[_0x2aad5d(0xde)][_0x2aad5d(0x10a)]||'',XPATH=process['env'][_0x2aad5d(0xbb)]||UUID['slice'](0x0,0x8),HTTPSTLS=process[_0x2aad5d(0xde)][_0x2aad5d(0x152)]||_0x2aad5d(0xd0),NEZHA_VERSION=process[_0x2aad5d(0xde)][_0x2aad5d(0x147)]||'V1',NEZHA_SERVER=process[_0x2aad5d(0xde)][_0x2aad5d(0xc9)]||'',NEZHA_PORT=process[_0x2aad5d(0xde)][_0x2aad5d(0x11f)]||_0x2aad5d(0x67),NEZHA_KEY=process['env'][_0x2aad5d(0x83)]||'',SUB_NAME=process[_0x2aad5d(0xde)][_0x2aad5d(0x65)]||'',MY_DOMAIN=process[_0x2aad5d(0xde)][_0x2aad5d(0xe3)]||'',SETTINGS={[_0x2aad5d(0x10a)]:UUID,['LOG_LEVEL']:_0x2aad5d(0x12d),['BUFFER_SIZE']:_0x2aad5d(0x166),[_0x2aad5d(0xbb)]:_0x2aad5d(0x10c)+XPATH,[_0x2aad5d(0x133)]:0x1e,[_0x2aad5d(0x112)]:0xf4240,[_0x2aad5d(0x144)]:0x7530,['CHUNK_SIZE']:0x400*0x400,[_0x2aad5d(0xbf)]:!![],[_0x2aad5d(0xc8)]:!![]};function validate_uuid(_0x321056,_0x5f3ded){for(let _0x42eae4=0x0;_0x42eae4<0x10;_0x42eae4++){if(_0x321056[_0x42eae4]!==_0x5f3ded[_0x42eae4])return![];}return!![];}function concat_typed_arrays(_0x58f3d6,..._0x43da7c){const _0x4dfd9=_0x2aad5d;if(!_0x43da7c||_0x43da7c['length']<0x1)return _0x58f3d6;let _0x15082c=_0x58f3d6['length'];for(let _0x480792 of _0x43da7c)_0x15082c+=_0x480792['length'];const _0x1c032e=new _0x58f3d6[(_0x4dfd9(0x149))](_0x15082c);_0x1c032e[_0x4dfd9(0x71)](_0x58f3d6,0x0),_0x15082c=_0x58f3d6[_0x4dfd9(0x141)];for(let _0x35b6e6 of _0x43da7c){_0x1c032e[_0x4dfd9(0x71)](_0x35b6e6,_0x15082c),_0x15082c+=_0x35b6e6[_0x4dfd9(0x141)];}return _0x1c032e;}function log(_0x2a416d,..._0x6beb3d){const _0x59f9cf=_0x2aad5d;if(SETTINGS['LOG_LEVEL']===_0x59f9cf(0x12d))return;const _0x35785c={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x41f654={'debug':_0x59f9cf(0x9c),'info':'\x1b[32m','warn':_0x59f9cf(0xe0),'error':'\x1b[31m','reset':_0x59f9cf(0x9d)},_0x272355=_0x35785c[SETTINGS[_0x59f9cf(0x66)]]||0x1,_0x524cf3=_0x35785c[_0x2a416d]||0x0;if(_0x524cf3>=_0x272355){const _0xacdf5c=new Date()[_0x59f9cf(0x11e)](),_0x2731a0=_0x41f654[_0x2a416d]||_0x41f654['reset'];console[_0x59f9cf(0x14b)](_0x2731a0+'['+_0xacdf5c+_0x59f9cf(0xaa)+_0x2a416d+']',..._0x6beb3d,_0x41f654[_0x59f9cf(0xdf)]);}}function cleanupOldFiles(){const _0x242420=_0x2aad5d;fs[_0x242420(0xbd)](path[_0x242420(0x15c)](FILE_PATH))?(fs[_0x242420(0xb8)](path['join'](FILE_PATH),{'recursive':!![]}),console['log'](FILE_PATH+'\x20deleted')):console[_0x242420(0x14b)](FILE_PATH+_0x242420(0xd7));}function createFolder(_0xfacbe4){const _0x2a0b7d=_0x2aad5d;if(!fs[_0x2a0b7d(0xbd)](_0xfacbe4))fs[_0x2a0b7d(0xe5)](_0xfacbe4);else{}}function generateRandomString(_0x1028ae){const _0x4304c6=_0x2aad5d,_0x341c96=_0x4304c6(0xc7);let _0x442474='';for(let _0x1094c0=0x0;_0x1094c0<_0x1028ae;_0x1094c0++){_0x442474+=_0x341c96['charAt'](Math[_0x4304c6(0x146)](Math[_0x4304c6(0x70)]()*_0x341c96[_0x4304c6(0x141)]));}return _0x442474;}function getSystemArchitecture(){const _0xa52763=_0x2aad5d,_0x5c5083=os[_0xa52763(0x130)]();return _0x5c5083===_0xa52763(0x124)||_0x5c5083===_0xa52763(0x15b)||_0x5c5083===_0xa52763(0x98)?_0xa52763(0x124):_0xa52763(0x139);}function getFilesForArchitecture(_0x1b9514){const _0x43a614=_0x2aad5d,_0x53c4dd={'npm':{'V0':{'arm':_0x43a614(0xf5),'amd':'https://github.com/kahunama/myfile/releases/download/main/nezha-agent'},'V1':{'arm':_0x43a614(0xb2),'amd':_0x43a614(0x123)}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0xcda459=[{'fileName':generateRandomString(0x5),'originalName':_0x43a614(0x107),'fileUrl':_0x53c4dd[_0x43a614(0x107)][NEZHA_VERSION][_0x1b9514]}];return _0xcda459;}else return[];}function _0x37d2(_0x30f0b3,_0x16975d){const _0x130043=_0x1300();return _0x37d2=function(_0x37d213,_0x5ea85e){_0x37d213=_0x37d213-0x65;let _0x284363=_0x130043[_0x37d213];return _0x284363;},_0x37d2(_0x30f0b3,_0x16975d);}function _0x1300(){const _0x3a5ad0=['responseHeader','Failed\x20to\x20parse\x20hostname','_writeToRemote','&mode=packet-up#','timeout','write','initializeVLESS','_startDownstreamResponse','2814865VdZxEl','Connected\x20to\x20','Server\x20error:\x20','96519TKzfzl','request','136269lkPJSt','npm','remote','13163227fNVMhH','UUID','&path=','%2F','Hello,\x20World\x0a','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','axios','forEach','chmod','MAX_POST_SIZE','cleanup','Read\x20controller\x20error:','VLESS\x20connection\x20to\x20','debug','buffer','connect\x20timeout','downstreamStarted','http','\x0a\x20\x20\x20\x20debug:\x20false\x0a\x20\x20\x20\x20disable_auto_update:\x20true\x0a\x20\x20\x20\x20disable_command_execute:\x20false\x0a\x20\x20\x20\x20disable_force_update:\x20true\x0a\x20\x20\x20\x20disable_nat:\x20false\x0a\x20\x20\x20\x20disable_send_query:\x20false\x0a\x20\x20\x20\x20gpu:\x20false\x0a\x20\x20\x20\x20insecure_tls:\x20false\x0a\x20\x20\x20\x20ip_report_period:\x201800\x0a\x20\x20\x20\x20report_delay:\x204\x0a\x20\x20\x20\x20server:\x20','?encryption=none&security=tls&sni=','all','toISOString','NEZHA_PORT','\x20timed\x20out\x20without\x20downstream','finish','):\x20','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1','arm','writable','headersTimeout','initialized','toString','\x20before\x20initialization','Received\x20out\x20of\x20order\x20packet\x20seq=','get','PORT','none','value','chunked','arch','originalName','Cleaning\x20up\x20session\x20','MAX_BUFFERED_POSTS','Server\x20is\x20running\x20on\x20port\x20','pathname','\x20(renamed\x20to\x20','FILE_PATH','Processing\x20packet:\x20seq=','amd','Starting\x20to\x20parse\x20VLESS\x20header','config.yml\x20file\x20created\x20and\x20written\x20successfully.','Download\x20','\x20>\x20/dev/null\x202>&1\x20&','stringify','Error\x20starting\x20downstream:\x20','Download\x20error:\x20','length','Remote\x20connection\x20established','false','SESSION_TIMEOUT','CFPORT','floor','NEZHA_VERSION','Content-Type','constructor','CHUNK_SIZE','log','resp','close','200ItsqMZ','text/plain','sub','\x0a\x20\x20\x20\x20skip_connection_count:\x20false\x0a\x20\x20\x20\x20skip_procs_count:\x20false\x0a\x20\x20\x20\x20temperature:\x20false\x0a\x20\x20\x20\x20tls:\x20','HTTPSTLS','VLESS\x20header\x20parsed:\x20','replaceAll','size','Remote\x20connection\x20not\x20available','message','Error\x20creating\x20or\x20writing\x20config.yml\x20file:','path','vlessHeader','arm64','join','Failed\x20to\x20initialize\x20VLESS:\x20','pause','\x20running\x20error:\x20','174JFZDrm','aborted','Client\x20connection\x20closed','method','getReader','headersSent','2048','uncork','\x0a\x20\x20\x20\x20client_secret:\x20','SUB_NAME','LOG_LEVEL','443','read','HTTP\x20error!\x20status:\x20','Created\x20new\x20session\x20for\x20POST:\x20','pipe','writeFileSync','connect','fill','enqueue','random','set','Failed\x20to\x20get\x20IP\x20address:',')\x20failed:\x20','File\x20','pendingBuffers','localhost','New\x20secure\x20connection\x20using:\x20','100MkRJlk','statusCode','Connection\x20failed:\x20','slice','/config.yml','no-store','push','68scsGkk','Relay\x20error:','utf-8','socket\x20hang\x20up','NEZHA_KEY','http/1.1','processPacket','not\x20enough\x20data\x20to\x20read',')\x20successfully','secureConnection','net','Too\x20many\x20buffered\x20packets','SUB_PATH','Read\x20controller\x20close\x20error:','error','&fp=chrome&allowInsecure=1&type=xhttp&host=','bufferSize','GET','Socket\x20is\x20destroyed','Failed\x20to\x20process\x20POST\x20request:\x20','application/json','info','BUFFER_SIZE','readable','createWriteStream','aarch64','stream','fileUrl','nextSeq','\x1b[36m','\x1b[0m','Session\x20','isDirectory','includes','done','unlinkSync','getWriter','application/octet-stream','POST','destroy','headerSent','Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture','--tls',']\x20[','\x20-s\x20','2053','Created\x20new\x20session\x20with\x20UUID:\x20','curl\x20-s\x20https://speed.cloudflare.com/meta\x20|\x20awk\x20-F\x5c\x22\x20\x27{print\x20$26\x22-\x22$18}\x27\x20|\x20sed\x20-e\x20\x27s/\x20/_/g\x27','writableEnded',',\x20size=','/config.yml\x20>\x20/dev/null\x202>&1\x20&','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','https','concat','6bquePW','url','hostname','rmSync','vless://','reading_done','XPATH',')\x20already\x20exists,\x20skipping\x20download.','existsSync','Created\x20new\x20session\x20for\x20GET:\x20','TCP_NODELAY','catch','trim','VLESS\x20header\x20parsed\x20successfully','Remote\x20error:\x20','/tmp','end','startDownstream','abcdefghijklmnopqrstuvwxyz0123456789','TCP_KEEPALIVE','NEZHA_SERVER','destroyed','Sending\x20VLESS\x20response\x20header\x20(','SUB_URL','GET,\x20POST','2083','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','true','finally','warn','delete','base64','lastActivity','currentStreamRes','\x20not\x20created','setNoDelay','7825ELBkZF','\x20variable\x20is\x20empty,skip\x20running','Buffered\x20packet\x20seq=','\x20is\x20running','read\x20address\x20type\x20failed','env','reset','\x1b[33m','Processed\x20packet\x20seq=','alpnProtocol','MY_DOMAIN','port','mkdirSync','50267700AbzklW','VLESS\x20header\x20parse\x20error:\x20','42784bGYJPm','Transfer-Encoding','data','pendingPackets','from','cleaned','writeHead','map','releaseLock','fileName','header\x20length\x20too\x20short','lstatSync','Empowerment\x20success\x20for\x20','https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','substr','uuid','nohup\x20'];_0x1300=function(){return _0x3a5ad0;};return _0x1300();}function authorizeFiles(_0x2312b4){const _0x19791f=0x1fd;_0x2312b4['forEach'](_0x25df6d=>{const _0x3b85aa=_0x37d2,_0x10de28=path[_0x3b85aa(0x15c)](FILE_PATH,_0x25df6d[_0x3b85aa(0xf1)]);fs[_0x3b85aa(0x111)](_0x10de28,_0x19791f,_0x389780=>{const _0x2beb29=_0x3b85aa;_0x389780?console[_0x2beb29(0x8d)]('Empowerment\x20failed\x20for\x20'+_0x10de28+'\x20('+_0x25df6d['originalName']+_0x2beb29(0x122)+_0x389780):console['log'](_0x2beb29(0xf4)+_0x10de28+'\x20('+_0x25df6d[_0x2beb29(0x131)]+'):\x20'+_0x19791f['toString'](0x8));});});}function download_function(_0x1cb903,_0x30b97c,_0x51a4d3,_0x292b04){const _0x52d09f=_0x2aad5d,_0x58e70f=path[_0x52d09f(0x15c)](FILE_PATH,_0x1cb903);if(fs[_0x52d09f(0xbd)](_0x58e70f)){console[_0x52d09f(0x14b)](_0x52d09f(0x74)+_0x30b97c+_0x52d09f(0x136)+_0x1cb903+_0x52d09f(0xbc)),_0x292b04(null,{'fileName':_0x1cb903,'originalName':_0x30b97c});return;}const _0x464e24=fs[_0x52d09f(0x97)](_0x58e70f);axios({'method':_0x52d09f(0x12b),'url':_0x51a4d3,'responseType':_0x52d09f(0x99)})['then'](_0x5f590f=>{const _0x4b6886=_0x52d09f;_0x5f590f['data']['pipe'](_0x464e24),_0x464e24['on'](_0x4b6886(0x121),()=>{const _0x1dfc5b=_0x4b6886;_0x464e24[_0x1dfc5b(0x14d)](),console[_0x1dfc5b(0x14b)]('Download\x20'+_0x30b97c+_0x1dfc5b(0x136)+_0x1cb903+_0x1dfc5b(0x87)),_0x292b04(null,{'fileName':_0x1cb903,'originalName':_0x30b97c});}),_0x464e24['on']('error',_0x19bae5=>{const _0x3d2dbf=_0x4b6886;fs['unlink'](_0x58e70f,()=>{});const _0x47f0ba=_0x3d2dbf(0x13c)+_0x30b97c+_0x3d2dbf(0x136)+_0x1cb903+')\x20failed:\x20'+_0x19bae5[_0x3d2dbf(0x157)];console[_0x3d2dbf(0x8d)](_0x47f0ba),_0x292b04(_0x47f0ba);});})[_0x52d09f(0xc0)](_0x4408b9=>{const _0x59f9bc=_0x52d09f,_0x7bbe93=_0x59f9bc(0x13c)+_0x30b97c+'\x20(renamed\x20to\x20'+_0x1cb903+_0x59f9bc(0x73)+_0x4408b9[_0x59f9bc(0x157)];console[_0x59f9bc(0x8d)](_0x7bbe93),_0x292b04(_0x7bbe93);});}let fileMapping={};async function downloadFiles(){const _0x284459=_0x2aad5d;try{const _0x3095b6=getSystemArchitecture(),_0x2870c2=getFilesForArchitecture(_0x3095b6);if(_0x2870c2['length']===0x0){console[_0x284459(0x14b)](_0x284459(0xa8));return;}const _0x561e48=_0x2870c2[_0x284459(0xef)](_0x1e993f=>new Promise((_0x30af7b,_0x49eeee)=>{const _0x1703d4=_0x284459;download_function(_0x1e993f[_0x1703d4(0xf1)],_0x1e993f[_0x1703d4(0x131)],_0x1e993f[_0x1703d4(0x9a)],(_0x40daae,_0x44322c)=>{if(_0x40daae)_0x49eeee(_0x40daae);else _0x30af7b(_0x44322c);});})),_0x54f63e=await Promise[_0x284459(0x11d)](_0x561e48);return await authorizeFiles(_0x54f63e),_0x54f63e[_0x284459(0x110)](_0x11f326=>{const _0xb62571=_0x284459;fileMapping[_0x11f326['originalName']]=_0x11f326[_0xb62571(0xf1)];}),fileMapping;}catch(_0x2679a7){return console[_0x284459(0x8d)]('Error\x20downloading\x20files:',_0x2679a7),fileMapping;}}let NEZHA_TLS='';function nezv1config(){const _0x522f78=_0x2aad5d,_0x574228=_0x522f78(0x168)+NEZHA_KEY+_0x522f78(0x11b)+NEZHA_SERVER+':'+NEZHA_PORT+_0x522f78(0x151)+NEZHA_TLS+'\x0a\x20\x20\x20\x20use_gitee_to_upgrade:\x20false\x0a\x20\x20\x20\x20use_ipv6_country_code:\x20false\x0a\x20\x20\x20\x20uuid:\x20'+UUID+'\x0a\x20\x20\x20\x20',_0x4fe5b8=path[_0x522f78(0x15c)](FILE_PATH,_0x522f78(0x7c));try{fs[_0x522f78(0x6c)](_0x4fe5b8,_0x574228),console[_0x522f78(0x14b)](_0x522f78(0x13b));}catch(_0x313335){console[_0x522f78(0x8d)](_0x522f78(0x158),_0x313335);}}async function runapp(){const _0x14277a=_0x2aad5d;if(fileMapping[_0x14277a(0x107)]&&fs[_0x14277a(0xbd)](path['join'](FILE_PATH,fileMapping['npm']))){const _0x3a2b11=[_0x14277a(0x67),'8443','2096','2087',_0x14277a(0xce),_0x14277a(0xac)];if(NEZHA_VERSION==='V0'){if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){_0x3a2b11[_0x14277a(0xa0)](NEZHA_PORT)?NEZHA_TLS=_0x14277a(0xa9):NEZHA_TLS='';const _0x358f83=_0x14277a(0xf8)+FILE_PATH+'/'+fileMapping['npm']+_0x14277a(0xab)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+NEZHA_TLS+_0x14277a(0x13d);try{await exec(_0x358f83),console[_0x14277a(0x14b)](fileMapping[_0x14277a(0x107)]+_0x14277a(0xdc)),await delay(0x3e8);}catch(_0x310cdf){console[_0x14277a(0x8d)](fileMapping[_0x14277a(0x107)]+_0x14277a(0x15f)+_0x310cdf);}}else console[_0x14277a(0x14b)](fileMapping[_0x14277a(0x107)]+_0x14277a(0xda));}else{if(NEZHA_VERSION==='V1'){if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){_0x3a2b11['includes'](NEZHA_PORT)?NEZHA_TLS='true':NEZHA_TLS=_0x14277a(0x143);nezv1config();const _0x547b3c=_0x14277a(0xf8)+FILE_PATH+'/'+fileMapping[_0x14277a(0x107)]+'\x20-c\x20'+FILE_PATH+_0x14277a(0xb1);try{await exec(_0x547b3c),console[_0x14277a(0x14b)](fileMapping[_0x14277a(0x107)]+_0x14277a(0xdc)),await delay(0x3e8);}catch(_0x1bf2a8){console[_0x14277a(0x8d)](fileMapping[_0x14277a(0x107)]+_0x14277a(0x15f)+_0x1bf2a8);}}else console[_0x14277a(0x14b)](fileMapping[_0x14277a(0x107)]+_0x14277a(0xda));}}}}function parse_uuid(_0x58be6b){const _0x299c02=_0x2aad5d;_0x58be6b=_0x58be6b[_0x299c02(0x154)]('-','');const _0x2ba56a=[];for(let _0x17eda2=0x0;_0x17eda2<0x10;_0x17eda2++){_0x2ba56a[_0x299c02(0x7e)](parseInt(_0x58be6b[_0x299c02(0xf6)](_0x17eda2*0x2,0x2),0x10));}return _0x2ba56a;}async function read_vless_header(_0x5a929d,_0x2af429){const _0x507c62=_0x2aad5d;let _0x222252=0x0,_0x409c5e=new Uint8Array(),_0x5751c4={'value':_0x409c5e,'done':![]};async function _0x1aa0be(_0x13d4c5){const _0x1e83be=_0x37d2;if(_0x5751c4[_0x1e83be(0xa1)])throw new Error(_0x1e83be(0xf2));const _0x432bfc=_0x13d4c5-_0x222252;if(_0x432bfc<0x1)return;_0x5751c4=await read_atleast(_0x5a929d,_0x432bfc),_0x222252+=_0x5751c4[_0x1e83be(0x12e)][_0x1e83be(0x141)],_0x409c5e=concat_typed_arrays(_0x409c5e,_0x5751c4[_0x1e83be(0x12e)]);}await _0x1aa0be(0x1+0x10+0x1);const _0x11627b=_0x409c5e[0x0],_0x3f4b12=_0x409c5e['slice'](0x1,0x1+0x10),_0x14ba17=parse_uuid(_0x2af429);if(!validate_uuid(_0x3f4b12,_0x14ba17))throw new Error('invalid\x20UUID');const _0x51092a=_0x409c5e[0x1+0x10],_0xc92095=0x1+0x10+0x1+_0x51092a+0x1+0x2+0x1;await _0x1aa0be(_0xc92095+0x1);const _0x2b2b7a=_0x409c5e[0x1+0x10+0x1+_0x51092a],_0x40c4e5=0x1;if(_0x2b2b7a!==_0x40c4e5)throw new Error('unsupported\x20command:\x20'+_0x2b2b7a);const _0x388ec7=(_0x409c5e[_0xc92095-0x1-0x2]<<0x8)+_0x409c5e[_0xc92095-0x1-0x1],_0x8a25e=_0x409c5e[_0xc92095-0x1],_0x501e70=0x1,_0x20816f=0x2,_0x4e4898=0x3;let _0x3517ad=-0x1;if(_0x8a25e===_0x501e70)_0x3517ad=_0xc92095+0x4;else{if(_0x8a25e===_0x4e4898)_0x3517ad=_0xc92095+0x10;else _0x8a25e===_0x20816f&&(_0x3517ad=_0xc92095+0x1+_0x409c5e[_0xc92095]);}if(_0x3517ad<0x0)throw new Error(_0x507c62(0xdd));await _0x1aa0be(_0x3517ad);const _0x4d67a3=_0xc92095;let _0x440105='';if(_0x8a25e===_0x501e70)_0x440105=_0x409c5e[_0x507c62(0x7b)](_0x4d67a3,_0x4d67a3+0x4)[_0x507c62(0x15c)]('.');else{if(_0x8a25e===_0x20816f)_0x440105=new TextDecoder()['decode'](_0x409c5e[_0x507c62(0x7b)](_0x4d67a3+0x1,_0x4d67a3+0x1+_0x409c5e[_0x4d67a3]));else _0x8a25e===_0x4e4898&&(_0x440105=_0x409c5e[_0x507c62(0x7b)](_0x4d67a3,_0x4d67a3+0x10)['reduce']((_0x5811d9,_0x31da46,_0x380764,_0x11780a)=>_0x380764%0x2?_0x5811d9[_0x507c62(0xb4)](((_0x11780a[_0x380764-0x1]<<0x8)+_0x31da46)[_0x507c62(0x128)](0x10)):_0x5811d9,[])[_0x507c62(0x15c)](':'));}if(!_0x440105){log(_0x507c62(0x8d),_0x507c62(0xfa));throw new Error('parse\x20hostname\x20failed');}return log(_0x507c62(0x94),_0x507c62(0x115)+_0x440105+':'+_0x388ec7),{'hostname':_0x440105,'port':_0x388ec7,'data':_0x409c5e[_0x507c62(0x7b)](_0x3517ad),'resp':new Uint8Array([_0x11627b,0x0])};}async function read_atleast(_0x231d9a,_0x4adb2e){const _0x47ba84=_0x2aad5d,_0x29de06=[];let _0x1439fa=![];while(_0x4adb2e>0x0&&!_0x1439fa){const _0x5108ad=await _0x231d9a[_0x47ba84(0x68)]();if(_0x5108ad[_0x47ba84(0x12e)]){const _0x24f8e2=new Uint8Array(_0x5108ad[_0x47ba84(0x12e)]);_0x29de06[_0x47ba84(0x7e)](_0x24f8e2),_0x4adb2e-=_0x24f8e2[_0x47ba84(0x141)];}_0x1439fa=_0x5108ad[_0x47ba84(0xa1)];}if(_0x4adb2e>0x0)throw new Error(_0x47ba84(0x86));return{'value':concat_typed_arrays(..._0x29de06),'done':_0x1439fa};}async function parse_header(_0x5e9ec9,_0x53a115){const _0x102207=_0x2aad5d;log('debug',_0x102207(0x13a));const _0x44913a=_0x53a115[_0x102207(0x96)][_0x102207(0x164)]();try{const _0x42e255=await read_vless_header(_0x44913a,_0x5e9ec9);return log('debug',_0x102207(0xc2)),_0x42e255;}catch(_0x4fc98f){log('error',_0x102207(0xe7)+_0x4fc98f['message']);throw new Error('read\x20vless\x20header\x20error:\x20'+_0x4fc98f['message']);}finally{_0x44913a[_0x102207(0xf0)]();}}async function connect_remote(_0x3b6eaf,_0x44d5af){const _0x4476ce=_0x2aad5d,_0x407428=0x1f40;try{const _0x3d8cbf=await timed_connect(_0x3b6eaf,_0x44d5af,_0x407428);return _0x3d8cbf[_0x4476ce(0xd8)](!![]),_0x3d8cbf['setKeepAlive'](!![],0x3e8),_0x3d8cbf[_0x4476ce(0x8f)]=parseInt(SETTINGS[_0x4476ce(0x95)])*0x400,log(_0x4476ce(0x94),_0x4476ce(0x102)+_0x3b6eaf+':'+_0x44d5af),_0x3d8cbf;}catch(_0x3705cc){log(_0x4476ce(0x8d),_0x4476ce(0x7a)+_0x3705cc[_0x4476ce(0x157)]);throw _0x3705cc;}}function timed_connect(_0x21ce89,_0x4516e9,_0x1078e7){return new Promise((_0x226577,_0x54a297)=>{const _0x508f50=_0x37d2,_0x4fe330=net['createConnection']({'host':_0x21ce89,'port':_0x4516e9}),_0x3086fa=setTimeout(()=>{const _0x5f4b44=_0x37d2;_0x54a297(new Error(_0x5f4b44(0x118)));},_0x1078e7);_0x4fe330['on'](_0x508f50(0x6d),()=>{clearTimeout(_0x3086fa),_0x226577(_0x4fe330);}),_0x4fe330['on'](_0x508f50(0x8d),_0x359646=>{clearTimeout(_0x3086fa),_0x54a297(_0x359646);});});}function pipe_relay(){async function _0x3cec30(_0x2ce05a,_0x2dbe8e,_0x5dc530){const _0x16bc7d=_0x37d2,_0x1a34e2=parseInt(SETTINGS[_0x16bc7d(0x14a)]);if(_0x5dc530[_0x16bc7d(0x141)]>0x0){if(_0x2dbe8e[_0x16bc7d(0xfe)])_0x2dbe8e['cork'](),_0x2dbe8e[_0x16bc7d(0xfe)](_0x5dc530),process['nextTick'](()=>_0x2dbe8e[_0x16bc7d(0x167)]());else{const _0x14df0e=_0x2dbe8e[_0x16bc7d(0x125)][_0x16bc7d(0xa3)]();try{await _0x14df0e['write'](_0x5dc530);}finally{_0x14df0e[_0x16bc7d(0xf0)]();}}}try{_0x2ce05a[_0x16bc7d(0x6b)]?(_0x2ce05a[_0x16bc7d(0x15e)](),_0x2ce05a['pipe'](_0x2dbe8e,{'end':!![],'highWaterMark':_0x1a34e2}),_0x2ce05a['resume']()):await _0x2ce05a[_0x16bc7d(0x96)]['pipeTo'](_0x2dbe8e[_0x16bc7d(0x125)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x16bc7d(0xfd)](SETTINGS[_0x16bc7d(0x144)])});}catch(_0x2acb5e){!_0x2acb5e[_0x16bc7d(0x157)]['includes'](_0x16bc7d(0x161))&&log(_0x16bc7d(0x8d),_0x16bc7d(0x80),_0x2acb5e[_0x16bc7d(0x157)]);throw _0x2acb5e;}}return _0x3cec30;}function socketToWebStream(_0x452eaf){const _0x19e818=_0x2aad5d;let _0x44ee29,_0x2788e0;return _0x452eaf['on'](_0x19e818(0x8d),_0x3acd91=>{const _0xbcc639=_0x19e818;log(_0xbcc639(0x8d),'Socket\x20error:',_0x3acd91['message']),_0x44ee29?.[_0xbcc639(0x8d)](_0x3acd91),_0x2788e0?.[_0xbcc639(0x8d)](_0x3acd91);}),{'readable':new ReadableStream({'start'(_0x1842be){const _0x63767=_0x19e818;_0x44ee29=_0x1842be,_0x452eaf['on'](_0x63767(0xea),_0x3151bd=>{const _0x27fc81=_0x63767;try{_0x1842be[_0x27fc81(0x6f)](_0x3151bd);}catch(_0x448071){log(_0x27fc81(0x8d),_0x27fc81(0x114),_0x448071[_0x27fc81(0x157)]);}}),_0x452eaf['on'](_0x63767(0xc5),()=>{const _0x3ff2b1=_0x63767;try{_0x1842be['close']();}catch(_0x4f4cc9){log(_0x3ff2b1(0x8d),_0x3ff2b1(0x8c),_0x4f4cc9[_0x3ff2b1(0x157)]);}});},'cancel'(){const _0x4027f3=_0x19e818;_0x452eaf[_0x4027f3(0xa6)]();}}),'writable':new WritableStream({'start'(_0x512a4e){_0x2788e0=_0x512a4e;},'write'(_0x2ec589){return new Promise((_0x3ae0f0,_0x4a8808)=>{const _0x3e199f=_0x37d2;if(_0x452eaf['destroyed']){_0x4a8808(new Error(_0x3e199f(0x91)));return;}_0x452eaf[_0x3e199f(0xfe)](_0x2ec589,_0x45873f=>{if(_0x45873f)_0x4a8808(_0x45873f);else _0x3ae0f0();});});},'close'(){const _0x123e11=_0x19e818;!_0x452eaf[_0x123e11(0xca)]&&_0x452eaf[_0x123e11(0xc5)]();},'abort'(_0x25a5e5){const _0x52c276=_0x19e818;_0x452eaf[_0x52c276(0xa6)](_0x25a5e5);}})};}function relay(_0x43bf33,_0x29a07e,_0x322f78,_0x556446){const _0x573efe=_0x2aad5d,_0x1892b9=pipe_relay();let _0x59966f=![];const _0x52184d=socketToWebStream(_0x322f78);function _0x12d56c(){const _0xcc1c79=_0x37d2;if(!_0x59966f){_0x59966f=!![];try{_0x322f78[_0xcc1c79(0xa6)]();}catch(_0x4fd81c){!_0x4fd81c[_0xcc1c79(0x157)][_0xcc1c79(0xa0)]('aborted')&&!_0x4fd81c['message'][_0xcc1c79(0xa0)](_0xcc1c79(0x82))&&log(_0xcc1c79(0x8d),'Cleanup\x20error:\x20'+_0x4fd81c[_0xcc1c79(0x157)]);}}}const _0x3a149a=_0x1892b9(_0x29a07e,_0x52184d,_0x556446[_0x573efe(0xea)])[_0x573efe(0xc0)](_0x29017a=>{const _0x357076=_0x573efe;!_0x29017a['message'][_0x357076(0xa0)](_0x357076(0x161))&&!_0x29017a[_0x357076(0x157)][_0x357076(0xa0)](_0x357076(0x82))&&log(_0x357076(0x8d),'Upload\x20error:\x20'+_0x29017a[_0x357076(0x157)]);})[_0x573efe(0xd1)](()=>{const _0x470868=_0x573efe;_0x29a07e[_0x470868(0xba)]&&_0x29a07e[_0x470868(0xba)]();}),_0x4ca611=_0x1892b9(_0x52184d,_0x29a07e,_0x556446[_0x573efe(0x14c)])['catch'](_0x40abb5=>{const _0x4cf280=_0x573efe;!_0x40abb5[_0x4cf280(0x157)][_0x4cf280(0xa0)](_0x4cf280(0x161))&&!_0x40abb5[_0x4cf280(0x157)][_0x4cf280(0xa0)]('socket\x20hang\x20up')&&log('error',_0x4cf280(0x140)+_0x40abb5['message']);});_0x4ca611['finally'](()=>_0x3a149a)[_0x573efe(0xd1)](_0x12d56c);}const sessions=new Map();class Session{constructor(_0x5cd941){const _0x35a73d=_0x2aad5d;this[_0x35a73d(0xf7)]=_0x5cd941,this[_0x35a73d(0x9b)]=0x0,this['downstreamStarted']=![],this[_0x35a73d(0xd5)]=Date['now'](),this[_0x35a73d(0x15a)]=null,this['remote']=null,this[_0x35a73d(0x127)]=![],this[_0x35a73d(0xf9)]=null,this[_0x35a73d(0xa7)]=![],this['bufferedData']=new Map(),this['cleaned']=![],this[_0x35a73d(0xeb)]=[],this[_0x35a73d(0xd6)]=null,this[_0x35a73d(0x75)]=new Map(),log(_0x35a73d(0x116),_0x35a73d(0xad)+_0x5cd941);}async[_0x2aad5d(0xff)](_0x1a8cfc){const _0x170b9b=_0x2aad5d;if(this[_0x170b9b(0x127)])return!![];try{log(_0x170b9b(0x116),_0x170b9b(0x10e));const _0x591f62=new ReadableStream({'start'(_0x19c5b7){const _0x51fe96=_0x170b9b;_0x19c5b7['enqueue'](_0x1a8cfc),_0x19c5b7[_0x51fe96(0x14d)]();}}),_0x1e3366={'readable':_0x591f62,'writable':new WritableStream()};return this[_0x170b9b(0x15a)]=await parse_header(SETTINGS[_0x170b9b(0x10a)],_0x1e3366),log(_0x170b9b(0x94),_0x170b9b(0x153)+this['vlessHeader'][_0x170b9b(0xb7)]+':'+this[_0x170b9b(0x15a)]['port']),this[_0x170b9b(0x108)]=await connect_remote(this['vlessHeader']['hostname'],this['vlessHeader']['port']),log('info',_0x170b9b(0x142)),this[_0x170b9b(0x127)]=!![],!![];}catch(_0x393ff3){return log(_0x170b9b(0x8d),_0x170b9b(0x15d)+_0x393ff3[_0x170b9b(0x157)]),![];}}async['processPacket'](_0x36d927,_0x55a47c){const _0x3c3c14=_0x2aad5d;try{this[_0x3c3c14(0x75)][_0x3c3c14(0x71)](_0x36d927,_0x55a47c),log(_0x3c3c14(0x116),_0x3c3c14(0xdb)+_0x36d927+_0x3c3c14(0xb0)+_0x55a47c[_0x3c3c14(0x141)]);while(this['pendingBuffers']['has'](this[_0x3c3c14(0x9b)])){const _0x566631=this[_0x3c3c14(0x75)]['get'](this[_0x3c3c14(0x9b)]);this[_0x3c3c14(0x75)][_0x3c3c14(0xd3)](this['nextSeq']);if(!this[_0x3c3c14(0x127)]&&this[_0x3c3c14(0x9b)]===0x0){if(!await this[_0x3c3c14(0xff)](_0x566631))throw new Error('Failed\x20to\x20initialize\x20VLESS\x20connection');this[_0x3c3c14(0xf9)]=Buffer['from'](this['vlessHeader']['resp']),await this[_0x3c3c14(0xfb)](this[_0x3c3c14(0x15a)][_0x3c3c14(0xea)]),this[_0x3c3c14(0xd6)]&&this['_startDownstreamResponse']();}else{if(!this[_0x3c3c14(0x127)]){log(_0x3c3c14(0xd2),_0x3c3c14(0x12a)+_0x36d927+_0x3c3c14(0x129));continue;}await this[_0x3c3c14(0xfb)](_0x566631);}this[_0x3c3c14(0x9b)]++,log(_0x3c3c14(0x116),_0x3c3c14(0xe1)+(this[_0x3c3c14(0x9b)]-0x1));}if(this[_0x3c3c14(0x75)][_0x3c3c14(0x155)]>SETTINGS[_0x3c3c14(0x133)])throw new Error(_0x3c3c14(0x8a));return!![];}catch(_0x1805b5){log(_0x3c3c14(0x8d),'Process\x20packet\x20error:\x20'+_0x1805b5['message']);throw _0x1805b5;}}[_0x2aad5d(0x100)](){const _0x42877a=_0x2aad5d;if(!this[_0x42877a(0xd6)]||!this[_0x42877a(0xf9)])return;try{const _0xad7306=this[_0x42877a(0xd6)]['socket']?.[_0x42877a(0xe2)]||'http/1.1',_0x54ddf5=_0xad7306==='h2';!this[_0x42877a(0xa7)]&&(log(_0x42877a(0x116),_0x42877a(0xcb)+_0xad7306+_0x42877a(0x122)+this['responseHeader'][_0x42877a(0x141)]+'\x20bytes'),this[_0x42877a(0xd6)]['write'](this[_0x42877a(0xf9)]),this['headerSent']=!![]);if(_0x54ddf5){this[_0x42877a(0xd6)]['socket'][_0x42877a(0xd8)](!![]);const _0x57a9b8=new require(_0x42877a(0x99))['Transform']({'transform'(_0xc1486e,_0xa35efa,_0x21bd55){const _0x563bb4=_0x42877a,_0x5f831e=0x4000;for(let _0x42ccd7=0x0;_0x42ccd7<_0xc1486e[_0x563bb4(0x141)];_0x42ccd7+=_0x5f831e){this[_0x563bb4(0x7e)](_0xc1486e[_0x563bb4(0x7b)](_0x42ccd7,_0x42ccd7+_0x5f831e));}_0x21bd55();}});this[_0x42877a(0x108)]['pipe'](_0x57a9b8)[_0x42877a(0x6b)](this[_0x42877a(0xd6)]);}else this[_0x42877a(0x108)][_0x42877a(0x6b)](this[_0x42877a(0xd6)]);this[_0x42877a(0x108)]['on'](_0x42877a(0xc5),()=>{const _0x144e60=_0x42877a;!this[_0x144e60(0xd6)][_0x144e60(0xaf)]&&this[_0x144e60(0xd6)][_0x144e60(0xc5)]();}),this[_0x42877a(0x108)]['on'](_0x42877a(0x8d),_0x391742=>{const _0x55a306=_0x42877a;log(_0x55a306(0x8d),_0x55a306(0xc3)+_0x391742['message']),!this[_0x55a306(0xd6)][_0x55a306(0xaf)]&&this[_0x55a306(0xd6)]['end']();});}catch(_0x3d46b3){log(_0x42877a(0x8d),_0x42877a(0x13f)+_0x3d46b3[_0x42877a(0x157)]),this[_0x42877a(0x113)]();}}[_0x2aad5d(0xc6)](_0x23b9af,_0x14a616){const _0x11a6a9=_0x2aad5d;return!_0x23b9af['headersSent']&&_0x23b9af[_0x11a6a9(0xee)](0xc8,_0x14a616),this[_0x11a6a9(0xd6)]=_0x23b9af,this[_0x11a6a9(0x127)]&&this[_0x11a6a9(0xf9)]&&this['_startDownstreamResponse'](),_0x23b9af['on']('close',()=>{const _0x69289e=_0x11a6a9;log(_0x69289e(0x94),_0x69289e(0x162)),this['cleanup']();}),!![];}async['_writeToRemote'](_0x5b379e){const _0x383781=_0x2aad5d;if(!this[_0x383781(0x108)]||this[_0x383781(0x108)][_0x383781(0xca)])throw new Error(_0x383781(0x156));return new Promise((_0x5ed931,_0x207863)=>{const _0x4231d0=_0x383781;this[_0x4231d0(0x108)][_0x4231d0(0xfe)](_0x5b379e,_0xde047e=>{const _0x48b1c2=_0x4231d0;_0xde047e?(log(_0x48b1c2(0x8d),'Failed\x20to\x20write\x20to\x20remote:\x20'+_0xde047e[_0x48b1c2(0x157)]),_0x207863(_0xde047e)):_0x5ed931();});});}['_startDownstreamResponse'](){const _0x23bc4f=_0x2aad5d;if(!this[_0x23bc4f(0xd6)]||!this['responseHeader'])return;try{!this['headerSent']&&(this[_0x23bc4f(0xd6)][_0x23bc4f(0xfe)](this['responseHeader']),this['headerSent']=!![]),this['remote']['pipe'](this['currentStreamRes']),this[_0x23bc4f(0x108)]['on'](_0x23bc4f(0xc5),()=>{const _0x43c146=_0x23bc4f;!this[_0x43c146(0xd6)][_0x43c146(0xaf)]&&this[_0x43c146(0xd6)][_0x43c146(0xc5)]();}),this[_0x23bc4f(0x108)]['on'](_0x23bc4f(0x8d),_0x4b902f=>{const _0x4f9ab5=_0x23bc4f;log(_0x4f9ab5(0x8d),_0x4f9ab5(0xc3)+_0x4b902f[_0x4f9ab5(0x157)]),!this[_0x4f9ab5(0xd6)]['writableEnded']&&this[_0x4f9ab5(0xd6)][_0x4f9ab5(0xc5)]();});}catch(_0x4f9d88){log(_0x23bc4f(0x8d),_0x23bc4f(0x13f)+_0x4f9d88['message']),this['cleanup']();}}[_0x2aad5d(0x113)](){const _0x325288=_0x2aad5d;!this['cleaned']&&(this[_0x325288(0xed)]=!![],log('debug',_0x325288(0x132)+this['uuid']),this[_0x325288(0x108)]&&(this[_0x325288(0x108)]['destroy'](),this[_0x325288(0x108)]=null),this[_0x325288(0x127)]=![],this['headerSent']=![]);}}const metaInfo=execSync(_0x2aad5d(0xae),{'encoding':'utf-8'}),ISP=metaInfo['trim']();let IP=MY_DOMAIN;if(!MY_DOMAIN)try{IP=execSync('curl\x20-s\x20--max-time\x202\x20ipv4.ip.sb',{'encoding':_0x2aad5d(0x81)})['trim']();}catch(_0x373c01){try{IP='['+execSync('curl\x20-s\x20--max-time\x201\x20ipv6.ip.sb',{'encoding':'utf-8'})[_0x2aad5d(0xc1)]()+']';}catch(_0xd14ae0){log(_0x2aad5d(0x8d),_0x2aad5d(0x72),_0xd14ae0[_0x2aad5d(0x157)]),IP=_0x2aad5d(0x76);}}let vless_url;if(HTTPSTLS===_0x2aad5d(0xd0))vless_url=_0x2aad5d(0xb9)+UUID+'@'+IP+':'+CFPORT+_0x2aad5d(0x11c)+IP+_0x2aad5d(0x8e)+IP+_0x2aad5d(0x10b)+SETTINGS[_0x2aad5d(0xbb)]+_0x2aad5d(0xfc)+ISP+'-'+SUB_NAME;else HTTPSTLS===_0x2aad5d(0x143)&&(vless_url='vless://'+UUID+'@'+IP+':'+PORT+'?encryption=none&security=none&sni='+IP+_0x2aad5d(0x8e)+IP+'&path='+SETTINGS[_0x2aad5d(0xbb)]+'&mode=packet-up#'+ISP+'-'+SUB_NAME);const server=http['createServer']((_0x181250,_0x398637)=>{const _0x1d4b2a=_0x2aad5d,_0x162266={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x1d4b2a(0xcd),'Cache-Control':_0x1d4b2a(0x7d),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x181250[_0x1d4b2a(0xb6)]==='/'){_0x398637[_0x1d4b2a(0xee)](0xc8,{'Content-Type':_0x1d4b2a(0x14f)}),_0x398637[_0x1d4b2a(0xc5)](_0x1d4b2a(0x10d));return;}if(_0x181250[_0x1d4b2a(0xb6)]==='/'+SUB_PATH){const _0x4ffee3=''+vless_url,_0x171360=Buffer[_0x1d4b2a(0xec)](_0x4ffee3)[_0x1d4b2a(0x128)](_0x1d4b2a(0xd4));_0x398637['writeHead'](0xc8,{'Content-Type':_0x1d4b2a(0x14f)}),_0x398637[_0x1d4b2a(0xc5)](_0x171360+'\x0a');return;}const _0x4f78d7=_0x181250[_0x1d4b2a(0xb6)]['match'](new RegExp(XPATH+'/([^/]+)(?:/([0-9]+))?$'));if(!_0x4f78d7){_0x398637[_0x1d4b2a(0xee)](0x194),_0x398637[_0x1d4b2a(0xc5)]();return;}const _0x21231a=_0x4f78d7[0x1],_0x5ebe47=_0x4f78d7[0x2]?parseInt(_0x4f78d7[0x2]):null;if(_0x181250[_0x1d4b2a(0x163)]===_0x1d4b2a(0x90)&&!_0x5ebe47){_0x162266[_0x1d4b2a(0x148)]=_0x1d4b2a(0xa4),_0x162266[_0x1d4b2a(0xe9)]=_0x1d4b2a(0x12f);let _0x27bfa9=sessions['get'](_0x21231a);!_0x27bfa9&&(_0x27bfa9=new Session(_0x21231a),sessions[_0x1d4b2a(0x71)](_0x21231a,_0x27bfa9),log(_0x1d4b2a(0x94),_0x1d4b2a(0xbe)+_0x21231a));_0x27bfa9[_0x1d4b2a(0x119)]=!![];!_0x27bfa9[_0x1d4b2a(0xc6)](_0x398637,_0x162266)&&(log('error',_0x1d4b2a(0xcf)+_0x21231a),!_0x398637[_0x1d4b2a(0x165)]&&(_0x398637['writeHead'](0x1f4),_0x398637['end']()),_0x27bfa9[_0x1d4b2a(0x113)](),sessions[_0x1d4b2a(0xd3)](_0x21231a));return;}if(_0x181250[_0x1d4b2a(0x163)]===_0x1d4b2a(0xa5)&&_0x5ebe47!==null){let _0x2c2be0=sessions['get'](_0x21231a);!_0x2c2be0&&(_0x2c2be0=new Session(_0x21231a),sessions['set'](_0x21231a,_0x2c2be0),log(_0x1d4b2a(0x94),_0x1d4b2a(0x6a)+_0x21231a),setTimeout(()=>{const _0x2101a6=_0x1d4b2a,_0x826a4=sessions[_0x2101a6(0x12b)](_0x21231a);_0x826a4&&!_0x826a4[_0x2101a6(0x119)]&&(log(_0x2101a6(0xd2),_0x2101a6(0x9e)+_0x21231a+_0x2101a6(0x120)),_0x826a4[_0x2101a6(0x113)](),sessions['delete'](_0x21231a));},SETTINGS[_0x1d4b2a(0x144)]));let _0x58f018=[],_0x355b13=0x0,_0x3e9693=![];_0x181250['on'](_0x1d4b2a(0xea),_0x919154=>{const _0x48b725=_0x1d4b2a;_0x355b13+=_0x919154[_0x48b725(0x141)];if(_0x355b13>SETTINGS[_0x48b725(0x112)]){!_0x3e9693&&(_0x398637[_0x48b725(0xee)](0x19d),_0x398637[_0x48b725(0xc5)](),_0x3e9693=!![]);return;}_0x58f018[_0x48b725(0x7e)](_0x919154);}),_0x181250['on'](_0x1d4b2a(0xc5),async()=>{const _0x3f3c77=_0x1d4b2a;if(_0x3e9693)return;try{const _0xa90564=Buffer[_0x3f3c77(0xb4)](_0x58f018);log(_0x3f3c77(0x94),_0x3f3c77(0x138)+_0x5ebe47+_0x3f3c77(0xb0)+_0xa90564['length']),await _0x2c2be0[_0x3f3c77(0x85)](_0x5ebe47,_0xa90564),!_0x3e9693&&(_0x398637[_0x3f3c77(0xee)](0xc8,_0x162266),_0x3e9693=!![]),_0x398637[_0x3f3c77(0xc5)]();}catch(_0x262ab2){log(_0x3f3c77(0x8d),_0x3f3c77(0x92)+_0x262ab2[_0x3f3c77(0x157)]),_0x2c2be0[_0x3f3c77(0x113)](),sessions[_0x3f3c77(0xd3)](_0x21231a),!_0x3e9693&&(_0x398637[_0x3f3c77(0xee)](0x1f4),_0x3e9693=!![]),_0x398637[_0x3f3c77(0xc5)]();}});return;}_0x398637[_0x1d4b2a(0xee)](0x194),_0x398637[_0x1d4b2a(0xc5)]();});server['on'](_0x2aad5d(0x88),_0x28e9fa=>{const _0x4c03b7=_0x2aad5d;log(_0x4c03b7(0x116),_0x4c03b7(0x77)+(_0x28e9fa[_0x4c03b7(0xe2)]||_0x4c03b7(0x84)));});function generatePadding(_0x68916f,_0x258d4a){const _0x112793=_0x2aad5d,_0x5b6cc9=_0x68916f+Math['floor'](Math['random']()*(_0x258d4a-_0x68916f));return Buffer[_0x112793(0xec)](Array(_0x5b6cc9)[_0x112793(0x6e)]('X')[_0x112793(0x15c)](''))[_0x112793(0x128)](_0x112793(0xd4));}server['keepAliveTimeout']=0x975e0,server[_0x2aad5d(0x126)]=0x98968,server['on'](_0x2aad5d(0x8d),_0x427a00=>{const _0x1ef42b=_0x2aad5d;log(_0x1ef42b(0x8d),_0x1ef42b(0x103)+_0x427a00[_0x1ef42b(0x157)]);});async function uploadSubscription(_0x398734,_0x3e43df,_0x585510){const _0x2f63c5=_0x2aad5d,_0x53e021=JSON[_0x2f63c5(0x13e)]({'URL_NAME':_0x398734,'URL':_0x3e43df}),_0x317343={'hostname':new URL(_0x585510)[_0x2f63c5(0xb7)],'port':new URL(_0x585510)[_0x2f63c5(0xe4)]||0x1bb,'path':new URL(_0x585510)[_0x2f63c5(0x135)],'method':'POST','headers':{'Content-Type':_0x2f63c5(0x93),'Content-Length':_0x53e021[_0x2f63c5(0x141)]}};try{const _0x288897=await new Promise((_0x4afa07,_0x79ea37)=>{const _0xa83236=_0x2f63c5,_0x1d00e8=https[_0xa83236(0x105)](_0x317343,_0x1c1a45=>{const _0x3f7a62=_0xa83236;if(_0x1c1a45['statusCode']<0xc8||_0x1c1a45[_0x3f7a62(0x79)]>=0x12c)return _0x79ea37(new Error(_0x3f7a62(0x69)+_0x1c1a45[_0x3f7a62(0x79)]));let _0x118d4c='';_0x1c1a45['on'](_0x3f7a62(0xea),_0x12958f=>_0x118d4c+=_0x12958f),_0x1c1a45['on']('end',()=>_0x4afa07(_0x118d4c));});_0x1d00e8['on'](_0xa83236(0x8d),_0x43a2ef=>_0x79ea37(_0x43a2ef)),_0x1d00e8[_0xa83236(0xfe)](_0x53e021),_0x1d00e8['end']();});return _0x288897;}catch(_0x131d88){throw new Error('Upload\x20failed:\x20'+_0x131d88[_0x2f63c5(0x157)]);}}async function subupload(){UPLOAD_DATA=vless_url;try{const _0x1db552=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0xd025c){}}function cleanfiles(){setTimeout(()=>{const _0x559bfc=_0x37d2,_0xf3c613=[FILE_PATH+'/'+fileMapping[_0x559bfc(0x107)],FILE_PATH+_0x559bfc(0x7c)];_0xf3c613[_0x559bfc(0x110)](_0x22eba=>{const _0x3747da=_0x559bfc;try{fs['existsSync'](_0x22eba)&&(fs[_0x3747da(0xf3)](_0x22eba)[_0x3747da(0x9f)]()?fs[_0x3747da(0xb8)](_0x22eba,{'recursive':!![]}):fs[_0x3747da(0xa2)](_0x22eba));}catch(_0x42b799){}}),console['clear'](),console[_0x559bfc(0x14b)]('App\x20is\x20running');},0xea60);}server['listen'](PORT,async()=>{const _0x5627d7=_0x2aad5d;cleanupOldFiles(),createFolder(FILE_PATH),NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&await downloadFiles(),await delay(0x1388),await runapp(),cleanfiles(),console[_0x5627d7(0x14b)](_0x5627d7(0x134)+PORT),SUB_URL&&await subupload();});