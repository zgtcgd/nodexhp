const _0x35e88a=_0x1617;(function(_0x473eb7,_0x43b65c){const _0x246f3f=_0x1617,_0x449952=_0x473eb7();while(!![]){try{const _0x3e8b52=-parseInt(_0x246f3f(0x1e3))/0x1+-parseInt(_0x246f3f(0x193))/0x2+parseInt(_0x246f3f(0x169))/0x3+-parseInt(_0x246f3f(0x15b))/0x4*(-parseInt(_0x246f3f(0x192))/0x5)+parseInt(_0x246f3f(0x1a6))/0x6+parseInt(_0x246f3f(0x20b))/0x7+parseInt(_0x246f3f(0x1b6))/0x8*(-parseInt(_0x246f3f(0x1fe))/0x9);if(_0x3e8b52===_0x43b65c)break;else _0x449952['push'](_0x449952['shift']());}catch(_0x398fa6){_0x449952['push'](_0x449952['shift']());}}}(_0x4ace,0x30f2d));const FILE_PATH=process[_0x35e88a(0x183)]['FILE_PATH']||_0x35e88a(0x15a),intervalInseconds=process[_0x35e88a(0x183)][_0x35e88a(0x116)]||0x64,SUB_PATH=process['env'][_0x35e88a(0x1f2)]||_0x35e88a(0x1de),PORT=process['env']['PORT']||0xbb8,CFPORT=process[_0x35e88a(0x183)][_0x35e88a(0x1c1)]||0x1bb,CFIP=process['env'][_0x35e88a(0x1cb)]||'ip.sb',KEEPALIVE=process[_0x35e88a(0x183)][_0x35e88a(0x221)]||![],SUB_URL=process[_0x35e88a(0x183)][_0x35e88a(0x1b8)]||'',UUID=process['env'][_0x35e88a(0x1fc)]||_0x35e88a(0x160),XPATH=process['env']['XPATH']||UUID[_0x35e88a(0x113)](0x0,0x8),HTTPSTLS=process['env'][_0x35e88a(0x18b)]||!![],NEZHA_VERSION=process[_0x35e88a(0x183)][_0x35e88a(0x1e0)]||'V0',NEZHA_SERVER=process[_0x35e88a(0x183)][_0x35e88a(0x117)]||'',NEZHA_PORT=process[_0x35e88a(0x183)]['NEZHA_PORT']||_0x35e88a(0x1ea),NEZHA_KEY=process[_0x35e88a(0x183)]['NEZHA_KEY']||'',SUB_NAME=process[_0x35e88a(0x183)]['SUB_NAME']||'',MY_DOMAIN=process[_0x35e88a(0x183)][_0x35e88a(0x10f)]||'',LOCAL_DOMAIN=process[_0x35e88a(0x183)]['LOCAL_DOMAIN']||'',os=require('os'),fs=require('fs'),net=require(_0x35e88a(0x146)),path=require('path'),http=require(_0x35e88a(0x14b)),https=require(_0x35e88a(0x189)),axios=require(_0x35e88a(0x219)),{pipeline}=require(_0x35e88a(0x1f0)),{Buffer}=require(_0x35e88a(0x203)),exec=require(_0x35e88a(0x1e9))['exec'],delay=_0x523552=>new Promise(_0x5aca2d=>setTimeout(_0x5aca2d,_0x523552)),SETTINGS={['UUID']:UUID,[_0x35e88a(0x190)]:_0x35e88a(0x12f),['BUFFER_SIZE']:_0x35e88a(0x141),[_0x35e88a(0x1c7)]:_0x35e88a(0x15f)+XPATH,[_0x35e88a(0x19f)]:0x1e,[_0x35e88a(0x185)]:0xf4240,[_0x35e88a(0x1ba)]:0x7530,[_0x35e88a(0x1ef)]:0x400*0x400,[_0x35e88a(0x156)]:!![],[_0x35e88a(0x125)]:!![]};function validate_uuid(_0x14777e,_0x58807c){for(let _0x2dcc0d=0x0;_0x2dcc0d<0x10;_0x2dcc0d++){if(_0x14777e[_0x2dcc0d]!==_0x58807c[_0x2dcc0d])return![];}return!![];}function concat_typed_arrays(_0xf6a914,..._0x17ce58){const _0x5cd1ce=_0x35e88a;if(!_0x17ce58||_0x17ce58[_0x5cd1ce(0x122)]<0x1)return _0xf6a914;let _0x433637=_0xf6a914[_0x5cd1ce(0x122)];for(let _0x52908e of _0x17ce58)_0x433637+=_0x52908e[_0x5cd1ce(0x122)];const _0x4f3c8b=new _0xf6a914[(_0x5cd1ce(0x1bf))](_0x433637);_0x4f3c8b[_0x5cd1ce(0x126)](_0xf6a914,0x0),_0x433637=_0xf6a914[_0x5cd1ce(0x122)];for(let _0x5787b3 of _0x17ce58){_0x4f3c8b[_0x5cd1ce(0x126)](_0x5787b3,_0x433637),_0x433637+=_0x5787b3['length'];}return _0x4f3c8b;}function log(_0x3a714c,..._0x5130b7){const _0x3a8f10=_0x35e88a;if(SETTINGS['LOG_LEVEL']===_0x3a8f10(0x12f))return;const _0x48c3d9={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x42154f={'debug':'\x1b[36m','info':_0x3a8f10(0x112),'warn':_0x3a8f10(0x1cd),'error':'\x1b[31m','reset':_0x3a8f10(0x11f)},_0x4fd400=_0x48c3d9[SETTINGS[_0x3a8f10(0x190)]]||0x1,_0x342f24=_0x48c3d9[_0x3a714c]||0x0;if(_0x342f24>=_0x4fd400){const _0xb22e0f=new Date()[_0x3a8f10(0x16b)](),_0x32de7e=_0x42154f[_0x3a714c]||_0x42154f[_0x3a8f10(0x1e8)];console[_0x3a8f10(0x172)](_0x32de7e+'['+_0xb22e0f+_0x3a8f10(0x1b3)+_0x3a714c+']',..._0x5130b7,_0x42154f['reset']);}}function cleanupOldFiles(){const _0x338d72=_0x35e88a;try{if(fs[_0x338d72(0x1aa)](path[_0x338d72(0x161)](FILE_PATH)))fs[_0x338d72(0x10c)](path[_0x338d72(0x161)](FILE_PATH),{'recursive':!![]});else{}}catch(_0x53af5e){}}function createFolder(_0x15de86){const _0x151314=_0x35e88a;if(!fs[_0x151314(0x1aa)](_0x15de86))fs['mkdirSync'](_0x15de86);else{}}function execPromise(_0x234b89,_0x1d4d50={}){return new Promise((_0x36116a,_0x320eb6)=>{const _0x186beb=exec(_0x234b89,_0x1d4d50,(_0xe3ce81,_0x4083fe,_0x5a736c)=>{const _0x8ac4df=_0x1617;if(_0xe3ce81){const _0x440474=new Error(_0x8ac4df(0x17a)+_0xe3ce81[_0x8ac4df(0x15e)]);_0x440474[_0x8ac4df(0x166)]=_0xe3ce81[_0x8ac4df(0x166)],_0x440474[_0x8ac4df(0x1e5)]=_0x5a736c[_0x8ac4df(0x16e)](),_0x320eb6(_0x440474);}else _0x36116a(_0x4083fe[_0x8ac4df(0x16e)]());});});}async function detectProcess(_0x32fdb1){const _0x5c250e=_0x35e88a,_0xda7033=[{'cmd':'pidof\x20\x22'+_0x32fdb1+'\x22','name':_0x5c250e(0x206)},{'cmd':_0x5c250e(0x17b)+_0x32fdb1+'\x22','name':_0x5c250e(0x17c)},{'cmd':_0x5c250e(0x184)+_0x32fdb1+'\x22\x20\x27$2\x20==\x20name\x20{print\x20$1}\x27','name':_0x5c250e(0x15c)}];for(const _0x291264 of _0xda7033){try{const _0xa3d41b=await execPromise(_0x291264[_0x5c250e(0x211)]);if(_0xa3d41b)return _0xa3d41b[_0x5c250e(0x1c2)](/\n/g,'\x20')[_0x5c250e(0x16e)]();}catch(_0x5449a3){_0x5449a3[_0x5c250e(0x166)]!==0x7f&&_0x5449a3[_0x5c250e(0x166)]!==0x1&&console[_0x5c250e(0x196)](_0x5c250e(0x133)+_0x291264[_0x5c250e(0x16a)]+_0x5c250e(0x209),_0x5449a3[_0x5c250e(0x15e)]);}}return'';}async function killProcess(_0x108d71){const _0x308942=_0x35e88a;console[_0x308942(0x172)](_0x308942(0x1a0)+_0x108d71);try{const _0x4765f6=await detectProcess(_0x108d71);if(!_0x4765f6)return console[_0x308942(0x200)](_0x308942(0x1a3)+_0x108d71+_0x308942(0x1ac)),{'success':!![],'message':_0x308942(0x1f8)};await execPromise(_0x308942(0x119)+_0x4765f6);const _0x224412=_0x308942(0x1d2)+_0x4765f6+')';return console[_0x308942(0x172)](_0x224412),{'success':!![],'message':_0x224412};}catch(_0x22cb8c){const _0x3d11cc='Kill\x20failed:\x20'+_0x22cb8c[_0x308942(0x15e)];return console[_0x308942(0x210)](_0x3d11cc),{'success':![],'message':_0x3d11cc};}}function generateRandomString(_0x4598f5){const _0x3444d1=_0x35e88a,_0x4b0952='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';let _0x4a5327='';for(let _0x161485=0x0;_0x161485<_0x4598f5;_0x161485++){_0x4a5327+=_0x4b0952[_0x3444d1(0x11b)](Math[_0x3444d1(0x18a)](Math['random']()*_0x4b0952[_0x3444d1(0x122)]));}return _0x4a5327;}function getSystemArchitecture(){const _0x2c5341=_0x35e88a,_0x5e73be=os['arch']();return _0x5e73be===_0x2c5341(0x1bc)||_0x5e73be===_0x2c5341(0x1f5)||_0x5e73be===_0x2c5341(0x1e1)?'arm':_0x2c5341(0x1fd);}function getFilesForArchitecture(_0x490035){const _0x66e429=_0x35e88a,_0x47bb58={'app':{'V0':{'arm':_0x66e429(0x1df),'amd':_0x66e429(0x1bb)},'V1':{'arm':_0x66e429(0x1e4),'amd':_0x66e429(0x150)}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0x2b3241=[{'fileName':_0x66e429(0x123)+generateRandomString(0x5),'originalName':'app','fileUrl':_0x47bb58[_0x66e429(0x20d)][NEZHA_VERSION][_0x490035]}];return _0x2b3241;}else return[];}async function download_function(_0x54b9de,_0x3f4b50,_0x44ef83){const _0x3cbd2f=_0x35e88a,_0x19bb59=path[_0x3cbd2f(0x161)](FILE_PATH,_0x54b9de);let _0xff2877=![];try{const _0x5509cb=await axios({'method':_0x3cbd2f(0x204),'url':_0x44ef83,'responseType':_0x3cbd2f(0x1e6)});await pipeline(_0x5509cb['data'],fs[_0x3cbd2f(0x18c)](_0x19bb59)),_0xff2877=!![];}catch(_0x9680a2){}return{'fileName':_0x54b9de,'originalName':_0x3f4b50,'filePath':_0x19bb59,'success':_0xff2877};}let fileMapping={};async function downloadFiles(){const _0x51518c=_0x35e88a;try{const _0x5e6d28=getSystemArchitecture();if(!_0x5e6d28)return console[_0x51518c(0x172)](_0x51518c(0x21d)),fileMapping;const _0x127133=getFilesForArchitecture(_0x5e6d28);if(_0x127133['length']===0x0)return console[_0x51518c(0x172)](_0x51518c(0x165)),fileMapping;const _0x55309d=_0x127133[_0x51518c(0x1fb)](_0x87ce13=>download_function(_0x87ce13['fileName'],_0x87ce13['originalName'],_0x87ce13['fileUrl'])),_0x589443=await Promise[_0x51518c(0x1ca)](_0x55309d);return _0x589443[_0x51518c(0x188)](_0x5cbdc1=>{const _0x321b75=_0x51518c;if(_0x5cbdc1[_0x321b75(0x11c)])try{fs[_0x321b75(0x1e7)](_0x5cbdc1[_0x321b75(0x121)],0x1ed),fileMapping[_0x5cbdc1[_0x321b75(0x194)]]=_0x5cbdc1[_0x321b75(0x19c)];}catch(_0x5afe33){}}),fileMapping;}catch(_0x3ec53b){return console[_0x51518c(0x210)]('Error\x20downloading\x20files:',_0x3ec53b),fileMapping;}}let NEZHA_TLS;function nezconfig(){const _0x55c754=_0x35e88a,_0x49ece7=[_0x55c754(0x1ea),_0x55c754(0x212),_0x55c754(0x216),_0x55c754(0x220),_0x55c754(0x14c),_0x55c754(0x182)];if(NEZHA_VERSION==='V0')return _0x49ece7[_0x55c754(0x1d8)](NEZHA_PORT)?NEZHA_TLS=_0x55c754(0x1f1):NEZHA_TLS='',NEZHA_TLS;else{if(NEZHA_VERSION==='V1'){_0x49ece7['includes'](NEZHA_PORT)?NEZHA_TLS='true':NEZHA_TLS=_0x55c754(0x143);const _0xd95d05=path['join'](FILE_PATH,_0x55c754(0x111)),_0x2c2640=_0x55c754(0x135)+NEZHA_KEY+_0x55c754(0x147)+NEZHA_SERVER+':'+NEZHA_PORT+'\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20'+NEZHA_TLS+_0x55c754(0x214)+UUID;try{fs[_0x55c754(0x1fa)](_0xd95d05,_0x2c2640);}catch(_0xf7541a){}}}}async function runapp(){const _0x1a65d6=_0x35e88a;if(fileMapping['app']&&fs[_0x1a65d6(0x1aa)](path[_0x1a65d6(0x161)](FILE_PATH,fileMapping['app']))){if(NEZHA_VERSION==='V0'){const _0x19ff86=_0x1a65d6(0x1c5)+FILE_PATH+'/'+fileMapping['app']+'\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x1a65d6(0x137)+NEZHA_KEY+'\x20'+NEZHA_TLS+_0x1a65d6(0x151);try{await execPromise(_0x19ff86);}catch(_0x3f6701){console[_0x1a65d6(0x210)](fileMapping[_0x1a65d6(0x20d)]+_0x1a65d6(0x1a8)+_0x3f6701);}}else{if(NEZHA_VERSION==='V1'){const _0x426aac=_0x1a65d6(0x1c5)+FILE_PATH+'/'+fileMapping['app']+_0x1a65d6(0x17e)+FILE_PATH+_0x1a65d6(0x16d);try{await execPromise(_0x426aac);}catch(_0x4e0d94){console['error'](fileMapping['app']+_0x1a65d6(0x1a8)+_0x4e0d94);}}}}else console[_0x1a65d6(0x172)](_0x1a65d6(0x1c8));}function _0x4ace(){const _0x15385c=['releaseLock','Process\x20not\x20found','push','writeFileSync','map','UUID','amd','45WkguTm','Connection\x20failed:\x20','warn','application/octet-stream','Created\x20new\x20session\x20for\x20POST:\x20','buffer','get','socket','pidof','Server\x20error:\x20','\x20before\x20initialization','\x20error:','clientIp','1307425zxfXyH','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','app','Content-Type','lastActivity','error','cmd','8443','write','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','getWriter','2096','&path=','substr','axios','readable','pipe','hostname','Can\x27t\x20determine\x20system\x20architecture.','destroy','isDirectory','2087','KEEPALIVE','rmSync','from','Read\x20controller\x20error:','MY_DOMAIN','now','/config.yml','\x1b[32m','slice','Failed\x20to\x20initialize\x20VLESS\x20connection','Read\x20controller\x20close\x20error:','TIME','NEZHA_SERVER','POST','kill\x20-9\x20','uuid','charAt','success','unlinkSync','secureConnection','\x1b[0m','has','filePath','length','tmp','getReader','TCP_KEEPALIVE','set','finally','fill','startDownstream','Processing\x20packet:\x20seq=','match','&fp=chrome&allowInsecure=1&type=xhttp&host=','bufferedData','url','none','method','Server\x20is\x20running\x20on\x20port\x20','Too\x20many\x20buffered\x20packets','[detectProcess]\x20','vless://','client_secret:\x20','chunked','\x20-p\x20','writableEnded','&mode=packet-up#','Failed\x20to\x20process\x20POST\x20request:\x20','Upload\x20failed:','Buffered\x20packet\x20seq=','VLESS\x20header\x20parsed:\x20','clear','base64','connect\x20timeout','2048','utf8','false','pendingPackets','listen','net','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','cork','GET,\x20POST','Socket\x20is\x20destroyed','http','2083','read\x20address\x20type\x20failed','bufferSize','pathname','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1','\x20--report-delay=4\x20--skip-conn\x20--skip-procs\x20--disable-auto-update\x20>/dev/null\x202>&1\x20&','unsupported\x20command:\x20','statusCode','read','aborted','TCP_NODELAY','initializeVLESS','not\x20enough\x20data\x20to\x20read','setNoDelay','/tmp','196qPuAXx','ps+awk','header\x20length\x20too\x20short','message','%2F','7160b696-dd5e-42e3-a024-145e92cec916','join','invalid\x20UUID','concat','timeout','Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture','code','Client\x20connection\x20closed','?encryption=none&security=tls&sni=','1046916bTbLRI','name','toISOString','read\x20vless\x20header\x20error:\x20','/config.yml\x20>/dev/null\x202>&1\x20&','trim','port','Relay\x20error:','random','log','downstreamStarted','upload\x20failed:','?encryption=none&security=none&sni=','App\x20is\x20running','size','Starting\x20to\x20parse\x20VLESS\x20header','lstatSync','Command\x20failed:\x20','pgrep\x20-x\x20\x22','pgrep','asOrganization','\x20-c\x20','done','processPacket','currentStreamRes','2053','env','ps\x20-eo\x20pid,comm\x20|\x20awk\x20-v\x20name=\x22','MAX_POST_SIZE','Failed\x20to\x20write\x20to\x20remote:\x20','Received\x20out\x20of\x20order\x20packet\x20seq=','forEach','https','floor','HTTPSTLS','createWriteStream','Session\x20','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','info','LOG_LEVEL','Socket\x20error:','19855UbpdNg','533762zNYPGt','originalName','enqueue','debug','resp','Remote\x20connection\x20not\x20available',',\x20response:\x20','alpnProtocol',',\x20size=','fileName','toString','_startDownstreamResponse','MAX_BUFFERED_POSTS','Attempting\x20to\x20kill\x20process:\x20','GET','\x20bytes','Process\x20\x27','writeHead','cleanup','978924zWwbDB','nextTick','\x20running\x20error:\x20','Cleaning\x20up\x20session\x20','existsSync','Failed\x20to\x20initialize\x20VLESS:\x20','\x27\x20not\x20found','Transfer-Encoding','Error\x20starting\x20downstream:\x20','parse\x20hostname\x20failed','initialized','nextSeq','stringify',']\x20[','statusMessage','responseHeader','229232yddThD','Cleanup\x20error:\x20','SUB_URL','VLESS\x20header\x20parsed\x20successfully','SESSION_TIMEOUT','https://github.com/kahunama/myfile/releases/download/main/nezha-agent','arm','country','request','constructor','remote','CFPORT','replace','createServer','end','nohup\x20','headerSent','XPATH','app\x20file\x20not\x20found,\x20skip\x20running','Download\x20error:\x20','all','CFIP','reduce','\x1b[33m','data','createConnection','delete','close','Killed\x20process\x20(PIDs:\x20','setKeepAlive','Transform','value','_writeToRemote','socket\x20hang\x20up','includes','http/1.1','vlessHeader','destroyed','pendingBuffers','Created\x20new\x20session\x20with\x20UUID:\x20','sub','https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','NEZHA_VERSION','aarch64','cleaned','282836PoZGNj','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','stderr','stream','chmodSync','reset','child_process','443','VLESS\x20header\x20parse\x20error:\x20','reading_done','uncork','decode','CHUNK_SIZE','stream/promises','--tls','SUB_PATH','writable','):\x20','arm64','catch'];_0x4ace=function(){return _0x15385c;};return _0x4ace();}async function run(){const _0x3b6386=_0x35e88a;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){nezconfig();const _0x514fe9=await detectProcess(''+fileMapping[_0x3b6386(0x20d)]);if(_0x514fe9){}else await runapp();await delay(0x3e8);}else console['log']('Node\x20variable\x20is\x20empty,\x20skip\x20running');}async function keep_alive(){const _0x1d2c06=_0x35e88a;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x1cd5bc=await detectProcess(''+fileMapping[_0x1d2c06(0x20d)]);if(_0x1cd5bc){}else await runapp();}}function parse_uuid(_0xb2bc6f){const _0x526292=_0x35e88a;_0xb2bc6f=_0xb2bc6f['replaceAll']('-','');const _0x489ff3=[];for(let _0xb4a0f3=0x0;_0xb4a0f3<0x10;_0xb4a0f3++){_0x489ff3[_0x526292(0x1f9)](parseInt(_0xb2bc6f[_0x526292(0x218)](_0xb4a0f3*0x2,0x2),0x10));}return _0x489ff3;}async function read_vless_header(_0x59f38f,_0x53cd9e){const _0x3fe938=_0x35e88a;let _0x897265=0x0,_0x261f0b=new Uint8Array(),_0x38ec4c={'value':_0x261f0b,'done':![]};async function _0x24eb94(_0x11207a){const _0x496f8c=_0x1617;if(_0x38ec4c[_0x496f8c(0x17f)])throw new Error(_0x496f8c(0x15d));const _0x507a42=_0x11207a-_0x897265;if(_0x507a42<0x1)return;_0x38ec4c=await read_atleast(_0x59f38f,_0x507a42),_0x897265+=_0x38ec4c[_0x496f8c(0x1d5)][_0x496f8c(0x122)],_0x261f0b=concat_typed_arrays(_0x261f0b,_0x38ec4c['value']);}await _0x24eb94(0x1+0x10+0x1);const _0x520b56=_0x261f0b[0x0],_0x3258c3=_0x261f0b[_0x3fe938(0x113)](0x1,0x1+0x10),_0x2db556=parse_uuid(_0x53cd9e);if(!validate_uuid(_0x3258c3,_0x2db556))throw new Error(_0x3fe938(0x162));const _0x46ad68=_0x261f0b[0x1+0x10],_0x3cfe8e=0x1+0x10+0x1+_0x46ad68+0x1+0x2+0x1;await _0x24eb94(_0x3cfe8e+0x1);const _0x939a17=_0x261f0b[0x1+0x10+0x1+_0x46ad68],_0x586731=0x1;if(_0x939a17!==_0x586731)throw new Error(_0x3fe938(0x152)+_0x939a17);const _0xb1ee4c=(_0x261f0b[_0x3cfe8e-0x1-0x2]<<0x8)+_0x261f0b[_0x3cfe8e-0x1-0x1],_0x10232a=_0x261f0b[_0x3cfe8e-0x1],_0xc013ac=0x1,_0xb6b35b=0x2,_0x327361=0x3;let _0x45370b=-0x1;if(_0x10232a===_0xc013ac)_0x45370b=_0x3cfe8e+0x4;else{if(_0x10232a===_0x327361)_0x45370b=_0x3cfe8e+0x10;else _0x10232a===_0xb6b35b&&(_0x45370b=_0x3cfe8e+0x1+_0x261f0b[_0x3cfe8e]);}if(_0x45370b<0x0)throw new Error(_0x3fe938(0x14d));await _0x24eb94(_0x45370b);const _0x551edd=_0x3cfe8e;let _0x57bf5b='';if(_0x10232a===_0xc013ac)_0x57bf5b=_0x261f0b[_0x3fe938(0x113)](_0x551edd,_0x551edd+0x4)[_0x3fe938(0x161)]('.');else{if(_0x10232a===_0xb6b35b)_0x57bf5b=new TextDecoder()[_0x3fe938(0x1ee)](_0x261f0b[_0x3fe938(0x113)](_0x551edd+0x1,_0x551edd+0x1+_0x261f0b[_0x551edd]));else _0x10232a===_0x327361&&(_0x57bf5b=_0x261f0b[_0x3fe938(0x113)](_0x551edd,_0x551edd+0x10)[_0x3fe938(0x1cc)]((_0x29b740,_0x1d8a26,_0x4bdba2,_0x2d61d0)=>_0x4bdba2%0x2?_0x29b740[_0x3fe938(0x163)](((_0x2d61d0[_0x4bdba2-0x1]<<0x8)+_0x1d8a26)[_0x3fe938(0x19d)](0x10)):_0x29b740,[])[_0x3fe938(0x161)](':'));}if(!_0x57bf5b){log(_0x3fe938(0x210),'Failed\x20to\x20parse\x20hostname');throw new Error(_0x3fe938(0x1af));}return log(_0x3fe938(0x18f),'VLESS\x20connection\x20to\x20'+_0x57bf5b+':'+_0xb1ee4c),{'hostname':_0x57bf5b,'port':_0xb1ee4c,'data':_0x261f0b[_0x3fe938(0x113)](_0x45370b),'resp':new Uint8Array([_0x520b56,0x0])};}async function read_atleast(_0x30d546,_0x18072f){const _0x35dd5f=_0x35e88a,_0x2db32b=[];let _0x39b72f=![];while(_0x18072f>0x0&&!_0x39b72f){const _0xf814af=await _0x30d546[_0x35dd5f(0x154)]();if(_0xf814af['value']){const _0x4fef82=new Uint8Array(_0xf814af[_0x35dd5f(0x1d5)]);_0x2db32b[_0x35dd5f(0x1f9)](_0x4fef82),_0x18072f-=_0x4fef82['length'];}_0x39b72f=_0xf814af[_0x35dd5f(0x17f)];}if(_0x18072f>0x0)throw new Error(_0x35dd5f(0x158));return{'value':concat_typed_arrays(..._0x2db32b),'done':_0x39b72f};}async function parse_header(_0x4f98c0,_0x1c2e9c){const _0x2e18bc=_0x35e88a;log(_0x2e18bc(0x196),_0x2e18bc(0x178));const _0x4afb4d=_0x1c2e9c[_0x2e18bc(0x21a)][_0x2e18bc(0x124)]();try{const _0x307043=await read_vless_header(_0x4afb4d,_0x4f98c0);return log(_0x2e18bc(0x196),_0x2e18bc(0x1b9)),_0x307043;}catch(_0x6366ad){log(_0x2e18bc(0x210),_0x2e18bc(0x1eb)+_0x6366ad[_0x2e18bc(0x15e)]);throw new Error(_0x2e18bc(0x16c)+_0x6366ad[_0x2e18bc(0x15e)]);}finally{_0x4afb4d[_0x2e18bc(0x1f7)]();}}async function connect_remote(_0x4c150a,_0x2a129f){const _0x150b92=_0x35e88a,_0x2537a4=0x1f40;try{const _0x205dee=await timed_connect(_0x4c150a,_0x2a129f,_0x2537a4);return _0x205dee[_0x150b92(0x159)](!![]),_0x205dee[_0x150b92(0x1d3)](!![],0x3e8),_0x205dee[_0x150b92(0x14e)]=parseInt(SETTINGS['BUFFER_SIZE'])*0x400,log(_0x150b92(0x18f),'Connected\x20to\x20'+_0x4c150a+':'+_0x2a129f),_0x205dee;}catch(_0x53d694){log(_0x150b92(0x210),_0x150b92(0x1ff)+_0x53d694['message']);throw _0x53d694;}}function timed_connect(_0xcea533,_0x4a563b,_0x4a336c){return new Promise((_0x38858e,_0x236a48)=>{const _0x163360=_0x1617,_0x2079ac=net[_0x163360(0x1cf)]({'host':_0xcea533,'port':_0x4a563b}),_0x11afad=setTimeout(()=>{const _0x484b84=_0x163360;_0x236a48(new Error(_0x484b84(0x140)));},_0x4a336c);_0x2079ac['on']('connect',()=>{clearTimeout(_0x11afad),_0x38858e(_0x2079ac);}),_0x2079ac['on']('error',_0x15a8a2=>{clearTimeout(_0x11afad),_0x236a48(_0x15a8a2);});});}function pipe_relay(){async function _0x2a9964(_0x308760,_0x1b0f1b,_0x43b562){const _0x52a084=_0x1617,_0x257211=parseInt(SETTINGS[_0x52a084(0x1ef)]);if(_0x43b562['length']>0x0){if(_0x1b0f1b[_0x52a084(0x213)])_0x1b0f1b[_0x52a084(0x148)](),_0x1b0f1b[_0x52a084(0x213)](_0x43b562),process[_0x52a084(0x1a7)](()=>_0x1b0f1b[_0x52a084(0x1ed)]());else{const _0x3bf67b=_0x1b0f1b[_0x52a084(0x1f3)][_0x52a084(0x215)]();try{await _0x3bf67b[_0x52a084(0x213)](_0x43b562);}finally{_0x3bf67b['releaseLock']();}}}try{_0x308760['pipe']?(_0x308760['pause'](),_0x308760[_0x52a084(0x21b)](_0x1b0f1b,{'end':!![],'highWaterMark':_0x257211}),_0x308760['resume']()):await _0x308760[_0x52a084(0x21a)]['pipeTo'](_0x1b0f1b[_0x52a084(0x1f3)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x52a084(0x164)](SETTINGS[_0x52a084(0x1ba)])});}catch(_0x31fc73){!_0x31fc73[_0x52a084(0x15e)]['includes'](_0x52a084(0x155))&&log(_0x52a084(0x210),_0x52a084(0x170),_0x31fc73[_0x52a084(0x15e)]);throw _0x31fc73;}}return _0x2a9964;}function socketToWebStream(_0x43a58f){const _0xbd0317=_0x35e88a;let _0x3d0df3,_0x20d2b8;return _0x43a58f['on'](_0xbd0317(0x210),_0x367be8=>{const _0x278dba=_0xbd0317;log(_0x278dba(0x210),_0x278dba(0x191),_0x367be8[_0x278dba(0x15e)]),_0x3d0df3?.[_0x278dba(0x210)](_0x367be8),_0x20d2b8?.[_0x278dba(0x210)](_0x367be8);}),{'readable':new ReadableStream({'start'(_0x4c3781){const _0x2309db=_0xbd0317;_0x3d0df3=_0x4c3781,_0x43a58f['on'](_0x2309db(0x1ce),_0x4d3ac8=>{const _0x371bf8=_0x2309db;try{_0x4c3781[_0x371bf8(0x195)](_0x4d3ac8);}catch(_0x13b12a){log(_0x371bf8(0x210),_0x371bf8(0x10e),_0x13b12a[_0x371bf8(0x15e)]);}}),_0x43a58f['on'](_0x2309db(0x1c4),()=>{const _0x514eaa=_0x2309db;try{_0x4c3781['close']();}catch(_0x54c631){log(_0x514eaa(0x210),_0x514eaa(0x115),_0x54c631[_0x514eaa(0x15e)]);}});},'cancel'(){const _0xcac4c8=_0xbd0317;_0x43a58f[_0xcac4c8(0x21e)]();}}),'writable':new WritableStream({'start'(_0x26d133){_0x20d2b8=_0x26d133;},'write'(_0x2e24d6){return new Promise((_0x479cde,_0x21547f)=>{const _0x173c0f=_0x1617;if(_0x43a58f[_0x173c0f(0x1db)]){_0x21547f(new Error(_0x173c0f(0x14a)));return;}_0x43a58f[_0x173c0f(0x213)](_0x2e24d6,_0x2eb743=>{if(_0x2eb743)_0x21547f(_0x2eb743);else _0x479cde();});});},'close'(){const _0x2fae00=_0xbd0317;!_0x43a58f[_0x2fae00(0x1db)]&&_0x43a58f['end']();},'abort'(_0x483ca0){_0x43a58f['destroy'](_0x483ca0);}})};}function relay(_0x3901f3,_0x240b87,_0x1e0a30,_0x5e9b41){const _0x334dcf=_0x35e88a,_0x1b3a73=pipe_relay();let _0x2a4826=![];const _0x383345=socketToWebStream(_0x1e0a30);function _0x175b15(){const _0x3e3af2=_0x1617;if(!_0x2a4826){_0x2a4826=!![];try{_0x1e0a30[_0x3e3af2(0x21e)]();}catch(_0x4befba){!_0x4befba[_0x3e3af2(0x15e)]['includes'](_0x3e3af2(0x155))&&!_0x4befba['message'][_0x3e3af2(0x1d8)](_0x3e3af2(0x1d7))&&log('error',_0x3e3af2(0x1b7)+_0x4befba['message']);}}}const _0x5c7f59=_0x1b3a73(_0x240b87,_0x383345,_0x5e9b41[_0x334dcf(0x1ce)])[_0x334dcf(0x1f6)](_0x3a61d9=>{const _0xdfd51d=_0x334dcf;!_0x3a61d9['message'][_0xdfd51d(0x1d8)](_0xdfd51d(0x155))&&!_0x3a61d9['message']['includes'](_0xdfd51d(0x1d7))&&log('error','Upload\x20error:\x20'+_0x3a61d9[_0xdfd51d(0x15e)]);})[_0x334dcf(0x127)](()=>{const _0x4c2957=_0x334dcf;_0x240b87[_0x4c2957(0x1ec)]&&_0x240b87['reading_done']();}),_0x32dca1=_0x1b3a73(_0x383345,_0x240b87,_0x5e9b41[_0x334dcf(0x197)])[_0x334dcf(0x1f6)](_0x130311=>{const _0x3b9894=_0x334dcf;!_0x130311[_0x3b9894(0x15e)][_0x3b9894(0x1d8)](_0x3b9894(0x155))&&!_0x130311['message'][_0x3b9894(0x1d8)]('socket\x20hang\x20up')&&log(_0x3b9894(0x210),_0x3b9894(0x1c9)+_0x130311[_0x3b9894(0x15e)]);});_0x32dca1[_0x334dcf(0x127)](()=>_0x5c7f59)[_0x334dcf(0x127)](_0x175b15);}const sessions=new Map();class Session{constructor(_0x57f09b){const _0x2b56de=_0x35e88a;this[_0x2b56de(0x11a)]=_0x57f09b,this[_0x2b56de(0x1b1)]=0x0,this[_0x2b56de(0x173)]=![],this[_0x2b56de(0x20f)]=Date[_0x2b56de(0x110)](),this[_0x2b56de(0x1da)]=null,this[_0x2b56de(0x1c0)]=null,this[_0x2b56de(0x1b0)]=![],this[_0x2b56de(0x1b5)]=null,this[_0x2b56de(0x1c6)]=![],this[_0x2b56de(0x12d)]=new Map(),this[_0x2b56de(0x1e2)]=![],this[_0x2b56de(0x144)]=[],this[_0x2b56de(0x181)]=null,this[_0x2b56de(0x1dc)]=new Map(),log(_0x2b56de(0x196),_0x2b56de(0x1dd)+_0x57f09b);}async[_0x35e88a(0x157)](_0x108fb5){const _0x2e3ee1=_0x35e88a;if(this['initialized'])return!![];try{log('debug',_0x2e3ee1(0x18e));const _0x4b134=new ReadableStream({'start'(_0x1e067c){const _0x79354=_0x2e3ee1;_0x1e067c[_0x79354(0x195)](_0x108fb5),_0x1e067c[_0x79354(0x1d1)]();}}),_0xb85882={'readable':_0x4b134,'writable':new WritableStream()};return this['vlessHeader']=await parse_header(SETTINGS[_0x2e3ee1(0x1fc)],_0xb85882),log(_0x2e3ee1(0x18f),_0x2e3ee1(0x13d)+this[_0x2e3ee1(0x1da)][_0x2e3ee1(0x21c)]+':'+this[_0x2e3ee1(0x1da)][_0x2e3ee1(0x16f)]),this[_0x2e3ee1(0x1c0)]=await connect_remote(this[_0x2e3ee1(0x1da)][_0x2e3ee1(0x21c)],this[_0x2e3ee1(0x1da)]['port']),log('info','Remote\x20connection\x20established'),this[_0x2e3ee1(0x1b0)]=!![],!![];}catch(_0x5b95a4){return log(_0x2e3ee1(0x210),_0x2e3ee1(0x1ab)+_0x5b95a4[_0x2e3ee1(0x15e)]),![];}}async[_0x35e88a(0x180)](_0x7602c7,_0x52ba9e){const _0x2966a9=_0x35e88a;try{this[_0x2966a9(0x1dc)][_0x2966a9(0x126)](_0x7602c7,_0x52ba9e),log(_0x2966a9(0x196),_0x2966a9(0x13c)+_0x7602c7+_0x2966a9(0x19b)+_0x52ba9e[_0x2966a9(0x122)]);while(this['pendingBuffers'][_0x2966a9(0x120)](this[_0x2966a9(0x1b1)])){const _0x2f5a4c=this[_0x2966a9(0x1dc)]['get'](this[_0x2966a9(0x1b1)]);this[_0x2966a9(0x1dc)][_0x2966a9(0x1d0)](this[_0x2966a9(0x1b1)]);if(!this[_0x2966a9(0x1b0)]&&this[_0x2966a9(0x1b1)]===0x0){if(!await this[_0x2966a9(0x157)](_0x2f5a4c))throw new Error(_0x2966a9(0x114));this[_0x2966a9(0x1b5)]=Buffer[_0x2966a9(0x10d)](this['vlessHeader'][_0x2966a9(0x197)]),await this[_0x2966a9(0x1d6)](this[_0x2966a9(0x1da)][_0x2966a9(0x1ce)]),this[_0x2966a9(0x181)]&&this[_0x2966a9(0x19e)]();}else{if(!this[_0x2966a9(0x1b0)]){log('warn',_0x2966a9(0x187)+_0x7602c7+_0x2966a9(0x208));continue;}await this[_0x2966a9(0x1d6)](_0x2f5a4c);}this[_0x2966a9(0x1b1)]++,log(_0x2966a9(0x196),'Processed\x20packet\x20seq='+(this[_0x2966a9(0x1b1)]-0x1));}if(this[_0x2966a9(0x1dc)][_0x2966a9(0x177)]>SETTINGS['MAX_BUFFERED_POSTS'])throw new Error(_0x2966a9(0x132));return!![];}catch(_0x53c22f){log(_0x2966a9(0x210),'Process\x20packet\x20error:\x20'+_0x53c22f[_0x2966a9(0x15e)]);throw _0x53c22f;}}[_0x35e88a(0x19e)](){const _0x39325b=_0x35e88a;if(!this[_0x39325b(0x181)]||!this[_0x39325b(0x1b5)])return;try{const _0x5b2494=this[_0x39325b(0x181)]['socket']?.[_0x39325b(0x19a)]||_0x39325b(0x1d9),_0x1240be=_0x5b2494==='h2';!this[_0x39325b(0x1c6)]&&(log(_0x39325b(0x196),'Sending\x20VLESS\x20response\x20header\x20('+_0x5b2494+_0x39325b(0x1f4)+this[_0x39325b(0x1b5)]['length']+_0x39325b(0x1a2)),this[_0x39325b(0x181)][_0x39325b(0x213)](this[_0x39325b(0x1b5)]),this['headerSent']=!![]);if(_0x1240be){this[_0x39325b(0x181)][_0x39325b(0x205)][_0x39325b(0x159)](!![]);const _0x4e2a59=new require(_0x39325b(0x1e6))[_0x39325b(0x1d4)]({'transform'(_0x2743eb,_0xaeeb05,_0x219a6d){const _0x378534=_0x39325b,_0x29fcac=0x4000;for(let _0x42174e=0x0;_0x42174e<_0x2743eb[_0x378534(0x122)];_0x42174e+=_0x29fcac){this['push'](_0x2743eb['slice'](_0x42174e,_0x42174e+_0x29fcac));}_0x219a6d();}});this[_0x39325b(0x1c0)][_0x39325b(0x21b)](_0x4e2a59)[_0x39325b(0x21b)](this[_0x39325b(0x181)]);}else this[_0x39325b(0x1c0)][_0x39325b(0x21b)](this[_0x39325b(0x181)]);this['remote']['on'](_0x39325b(0x1c4),()=>{const _0xa21e9f=_0x39325b;!this[_0xa21e9f(0x181)][_0xa21e9f(0x138)]&&this['currentStreamRes'][_0xa21e9f(0x1c4)]();}),this[_0x39325b(0x1c0)]['on']('error',_0x2c847c=>{const _0x49245a=_0x39325b;log(_0x49245a(0x210),'Remote\x20error:\x20'+_0x2c847c[_0x49245a(0x15e)]),!this[_0x49245a(0x181)]['writableEnded']&&this[_0x49245a(0x181)][_0x49245a(0x1c4)]();});}catch(_0x157d0b){log(_0x39325b(0x210),_0x39325b(0x1ae)+_0x157d0b['message']),this[_0x39325b(0x1a5)]();}}[_0x35e88a(0x129)](_0x558aa0,_0x5eb781){const _0x45c42a=_0x35e88a;return!_0x558aa0['headersSent']&&_0x558aa0[_0x45c42a(0x1a4)](0xc8,_0x5eb781),this[_0x45c42a(0x181)]=_0x558aa0,this[_0x45c42a(0x1b0)]&&this['responseHeader']&&this[_0x45c42a(0x19e)](),_0x558aa0['on'](_0x45c42a(0x1d1),()=>{const _0xf99782=_0x45c42a;log(_0xf99782(0x18f),_0xf99782(0x167)),this[_0xf99782(0x1a5)]();}),!![];}async[_0x35e88a(0x1d6)](_0x9d3ecc){const _0x4a683f=_0x35e88a;if(!this[_0x4a683f(0x1c0)]||this['remote'][_0x4a683f(0x1db)])throw new Error(_0x4a683f(0x198));return new Promise((_0x3bcc78,_0x5c045b)=>{const _0x553fab=_0x4a683f;this['remote'][_0x553fab(0x213)](_0x9d3ecc,_0x22857a=>{const _0x5b334f=_0x553fab;_0x22857a?(log(_0x5b334f(0x210),_0x5b334f(0x186)+_0x22857a['message']),_0x5c045b(_0x22857a)):_0x3bcc78();});});}[_0x35e88a(0x19e)](){const _0x1d0a94=_0x35e88a;if(!this[_0x1d0a94(0x181)]||!this[_0x1d0a94(0x1b5)])return;try{!this[_0x1d0a94(0x1c6)]&&(this[_0x1d0a94(0x181)][_0x1d0a94(0x213)](this[_0x1d0a94(0x1b5)]),this[_0x1d0a94(0x1c6)]=!![]),this[_0x1d0a94(0x1c0)]['pipe'](this[_0x1d0a94(0x181)]),this[_0x1d0a94(0x1c0)]['on'](_0x1d0a94(0x1c4),()=>{const _0x375292=_0x1d0a94;!this[_0x375292(0x181)][_0x375292(0x138)]&&this['currentStreamRes'][_0x375292(0x1c4)]();}),this['remote']['on'](_0x1d0a94(0x210),_0x2cdf51=>{const _0x24ab37=_0x1d0a94;log(_0x24ab37(0x210),'Remote\x20error:\x20'+_0x2cdf51[_0x24ab37(0x15e)]),!this[_0x24ab37(0x181)][_0x24ab37(0x138)]&&this[_0x24ab37(0x181)][_0x24ab37(0x1c4)]();});}catch(_0x308fd3){log(_0x1d0a94(0x210),_0x1d0a94(0x1ae)+_0x308fd3[_0x1d0a94(0x15e)]),this['cleanup']();}}[_0x35e88a(0x1a5)](){const _0x79d192=_0x35e88a;!this['cleaned']&&(this['cleaned']=!![],log('debug',_0x79d192(0x1a9)+this['uuid']),this['remote']&&(this[_0x79d192(0x1c0)][_0x79d192(0x21e)](),this[_0x79d192(0x1c0)]=null),this['initialized']=![],this[_0x79d192(0x1c6)]=![]);}}async function getCloudflareMeta(){return new Promise((_0x28cb88,_0x175e23)=>{const _0x5a846b=_0x1617,_0x30d5f9={'hostname':'speed.cloudflare.com','path':'/meta','method':_0x5a846b(0x1a1)},_0x9c0b44=https[_0x5a846b(0x1be)](_0x30d5f9,_0x306834=>{const _0x5ca53e=_0x5a846b;let _0x14673c='';_0x306834['on'](_0x5ca53e(0x1ce),_0xed64ff=>{_0x14673c+=_0xed64ff;}),_0x306834['on'](_0x5ca53e(0x1c4),()=>{const _0x2f5efc=JSON['parse'](_0x14673c);_0x28cb88(_0x2f5efc);});});_0x9c0b44['on']('error',_0x23c58d=>{_0x175e23(_0x23c58d);}),_0x9c0b44[_0x5a846b(0x1c4)]();});}let UPLOAD_DATA;async function getipandisp(){const _0x94b708=_0x35e88a;let _0x178273=await getCloudflareMeta(),_0x1e7961=_0x178273[_0x94b708(0x20a)],_0x1079ce=_0x178273[_0x94b708(0x1bd)],_0x3414db=_0x178273[_0x94b708(0x17d)];ISP=(_0x1079ce+'-'+_0x3414db)['replace'](/ /g,'_');if(MY_DOMAIN)IP=MY_DOMAIN;else{if(LOCAL_DOMAIN)IP=LOCAL_DOMAIN;else!MY_DOMAIN&&!LOCAL_DOMAIN&&(_0x1e7961[_0x94b708(0x1d8)](':')?IP='['+_0x1e7961+']':IP=''+_0x1e7961);}if(HTTPSTLS==!![])UPLOAD_DATA='vless://'+UUID+'@'+CFIP+':'+CFPORT+_0x94b708(0x168)+IP+_0x94b708(0x12c)+IP+_0x94b708(0x217)+SETTINGS['XPATH']+_0x94b708(0x139)+ISP+'-'+SUB_NAME;else HTTPSTLS==![]&&(UPLOAD_DATA=_0x94b708(0x134)+UUID+'@'+IP+':'+PORT+_0x94b708(0x175)+IP+'&fp=chrome&allowInsecure=1&type=xhttp&host='+IP+_0x94b708(0x217)+SETTINGS['XPATH']+_0x94b708(0x139)+ISP+'-'+SUB_NAME);return UPLOAD_DATA;}const server=http[_0x35e88a(0x1c3)]((_0x252036,_0x99bc34)=>{const _0x371cc7=_0x35e88a,_0x4334cb={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x371cc7(0x149),'Cache-Control':'no-store','X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x252036[_0x371cc7(0x12e)]==='/'){_0x99bc34[_0x371cc7(0x1a4)](0xc8,{'Content-Type':'text/plain'}),_0x99bc34[_0x371cc7(0x1c4)]('Hello,\x20World\x0a');return;}if(_0x252036[_0x371cc7(0x12e)]==='/'+SUB_PATH){const _0x1b3947=''+UPLOAD_DATA,_0x590beb=Buffer[_0x371cc7(0x10d)](_0x1b3947)[_0x371cc7(0x19d)](_0x371cc7(0x13f));_0x99bc34['writeHead'](0xc8,{'Content-Type':'text/plain'}),_0x99bc34['end'](_0x590beb+'\x0a');return;}const _0x148ed6=_0x252036[_0x371cc7(0x12e)][_0x371cc7(0x12b)](new RegExp(XPATH+'/([^/]+)(?:/([0-9]+))?$'));if(!_0x148ed6){_0x99bc34[_0x371cc7(0x1a4)](0x194),_0x99bc34['end']();return;}const _0x593c0f=_0x148ed6[0x1],_0x309259=_0x148ed6[0x2]?parseInt(_0x148ed6[0x2]):null;if(_0x252036[_0x371cc7(0x130)]===_0x371cc7(0x1a1)&&!_0x309259){_0x4334cb[_0x371cc7(0x20e)]=_0x371cc7(0x201),_0x4334cb[_0x371cc7(0x1ad)]=_0x371cc7(0x136);let _0x1fd171=sessions['get'](_0x593c0f);!_0x1fd171&&(_0x1fd171=new Session(_0x593c0f),sessions[_0x371cc7(0x126)](_0x593c0f,_0x1fd171),log(_0x371cc7(0x18f),'Created\x20new\x20session\x20for\x20GET:\x20'+_0x593c0f));_0x1fd171[_0x371cc7(0x173)]=!![];!_0x1fd171[_0x371cc7(0x129)](_0x99bc34,_0x4334cb)&&(log(_0x371cc7(0x210),_0x371cc7(0x20c)+_0x593c0f),!_0x99bc34['headersSent']&&(_0x99bc34[_0x371cc7(0x1a4)](0x1f4),_0x99bc34['end']()),_0x1fd171[_0x371cc7(0x1a5)](),sessions[_0x371cc7(0x1d0)](_0x593c0f));return;}if(_0x252036[_0x371cc7(0x130)]==='POST'&&_0x309259!==null){let _0x4c9b21=sessions['get'](_0x593c0f);!_0x4c9b21&&(_0x4c9b21=new Session(_0x593c0f),sessions[_0x371cc7(0x126)](_0x593c0f,_0x4c9b21),log('info',_0x371cc7(0x202)+_0x593c0f),setTimeout(()=>{const _0x20e8e9=_0x371cc7,_0x3cb6d6=sessions[_0x20e8e9(0x204)](_0x593c0f);_0x3cb6d6&&!_0x3cb6d6['downstreamStarted']&&(log(_0x20e8e9(0x200),_0x20e8e9(0x18d)+_0x593c0f+'\x20timed\x20out\x20without\x20downstream'),_0x3cb6d6[_0x20e8e9(0x1a5)](),sessions['delete'](_0x593c0f));},SETTINGS[_0x371cc7(0x1ba)]));let _0x57d7b4=[],_0x190033=0x0,_0xa82ef8=![];_0x252036['on']('data',_0x33bfa3=>{const _0x26688b=_0x371cc7;_0x190033+=_0x33bfa3[_0x26688b(0x122)];if(_0x190033>SETTINGS[_0x26688b(0x185)]){!_0xa82ef8&&(_0x99bc34[_0x26688b(0x1a4)](0x19d),_0x99bc34[_0x26688b(0x1c4)](),_0xa82ef8=!![]);return;}_0x57d7b4[_0x26688b(0x1f9)](_0x33bfa3);}),_0x252036['on'](_0x371cc7(0x1c4),async()=>{const _0x4f564e=_0x371cc7;if(_0xa82ef8)return;try{const _0x1d0ae9=Buffer[_0x4f564e(0x163)](_0x57d7b4);log(_0x4f564e(0x18f),_0x4f564e(0x12a)+_0x309259+_0x4f564e(0x19b)+_0x1d0ae9[_0x4f564e(0x122)]),await _0x4c9b21[_0x4f564e(0x180)](_0x309259,_0x1d0ae9),!_0xa82ef8&&(_0x99bc34[_0x4f564e(0x1a4)](0xc8,_0x4334cb),_0xa82ef8=!![]),_0x99bc34[_0x4f564e(0x1c4)]();}catch(_0x161f5e){log(_0x4f564e(0x210),_0x4f564e(0x13a)+_0x161f5e[_0x4f564e(0x15e)]),_0x4c9b21[_0x4f564e(0x1a5)](),sessions[_0x4f564e(0x1d0)](_0x593c0f),!_0xa82ef8&&(_0x99bc34[_0x4f564e(0x1a4)](0x1f4),_0xa82ef8=!![]),_0x99bc34['end']();}});return;}_0x99bc34[_0x371cc7(0x1a4)](0x194),_0x99bc34[_0x371cc7(0x1c4)]();});server['on'](_0x35e88a(0x11e),_0x39a6c7=>{const _0x14d7d7=_0x35e88a;log(_0x14d7d7(0x196),'New\x20secure\x20connection\x20using:\x20'+(_0x39a6c7[_0x14d7d7(0x19a)]||_0x14d7d7(0x1d9)));});function generatePadding(_0x50fcf4,_0x4931ea){const _0x53fab8=_0x35e88a,_0x501c45=_0x50fcf4+Math[_0x53fab8(0x18a)](Math[_0x53fab8(0x171)]()*(_0x4931ea-_0x50fcf4));return Buffer[_0x53fab8(0x10d)](Array(_0x501c45)[_0x53fab8(0x128)]('X')[_0x53fab8(0x161)](''))[_0x53fab8(0x19d)](_0x53fab8(0x13f));}server['keepAliveTimeout']=0x975e0,server['headersTimeout']=0x98968,server['on']('error',_0x51bf78=>{const _0x15de78=_0x35e88a;log(_0x15de78(0x210),_0x15de78(0x207)+_0x51bf78['message']);});async function uploadSubscription(_0x112bc1,_0x316a87,_0x4e6197){const _0x50eb65=_0x35e88a,_0x4b3103=JSON[_0x50eb65(0x1b2)]({'URL_NAME':_0x112bc1,'URL':_0x316a87}),_0x1e1dd0=Buffer[_0x50eb65(0x10d)](_0x4b3103,_0x50eb65(0x142)),_0x2b2fce=_0x1e1dd0[_0x50eb65(0x122)],_0x3ea83d=new URL(_0x4e6197),_0x1aeff5={'hostname':_0x3ea83d[_0x50eb65(0x21c)],'port':_0x3ea83d['port']||0x1bb,'path':_0x3ea83d[_0x50eb65(0x14f)],'method':_0x50eb65(0x118),'headers':{'Content-Type':'application/json;\x20charset=utf-8','Content-Length':_0x2b2fce}};try{const _0x3d9af0=await new Promise((_0xc22289,_0x33ca8d)=>{const _0x518db9=_0x50eb65,_0x56dd92=https[_0x518db9(0x1be)](_0x1aeff5,_0x56e062=>{const _0x2785e6=_0x518db9;if(_0x56e062[_0x2785e6(0x153)]<0xc8||_0x56e062['statusCode']>=0x12c)return _0x33ca8d(new Error('HTTP\x20error!\x20status:\x20'+_0x56e062[_0x2785e6(0x153)]+_0x2785e6(0x199)+_0x56e062[_0x2785e6(0x1b4)]));let _0x25d671='';_0x56e062['on'](_0x2785e6(0x1ce),_0x3ad021=>_0x25d671+=_0x3ad021),_0x56e062['on'](_0x2785e6(0x1c4),()=>_0xc22289(_0x25d671));});_0x56dd92['on'](_0x518db9(0x210),_0xe5e3d3=>_0x33ca8d(_0xe5e3d3)),_0x56dd92['write'](_0x1e1dd0),_0x56dd92[_0x518db9(0x1c4)]();});return _0x3d9af0;}catch(_0x18b148){console[_0x50eb65(0x210)](_0x50eb65(0x13b),_0x18b148['message']);}}function _0x1617(_0x536015,_0x22f0a2){const _0x4acea9=_0x4ace();return _0x1617=function(_0x161708,_0x4e355c){_0x161708=_0x161708-0x10c;let _0x2a78a7=_0x4acea9[_0x161708];return _0x2a78a7;},_0x1617(_0x536015,_0x22f0a2);}function cleanfiles(){setTimeout(()=>{const _0x6d39f4=_0x1617;let _0xa9bb1b;KEEPALIVE==!![]?_0xa9bb1b=[]:_0xa9bb1b=[FILE_PATH+'/'+fileMapping[_0x6d39f4(0x20d)],FILE_PATH+'/config.yml'],_0xa9bb1b['forEach'](_0x35105d=>{const _0x3db995=_0x6d39f4;try{fs['existsSync'](_0x35105d)&&(fs[_0x3db995(0x179)](_0x35105d)[_0x3db995(0x21f)]()?fs[_0x3db995(0x10c)](_0x35105d,{'recursive':!![]}):fs[_0x3db995(0x11d)](_0x35105d));}catch(_0x1e34bb){}}),console[_0x6d39f4(0x13e)](),console[_0x6d39f4(0x172)](_0x6d39f4(0x176));},0xea60);}server[_0x35e88a(0x145)](PORT,async()=>{const _0x395691=_0x35e88a;await getipandisp(),cleanupOldFiles(),createFolder(FILE_PATH);NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&(await downloadFiles(),await delay(0x1388));await run(),cleanfiles(),console['log'](_0x395691(0x131)+PORT);if(SUB_URL)try{const _0x57f3ea=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0x36abc6){console[_0x395691(0x210)](_0x395691(0x174),_0x36abc6);}KEEPALIVE==!![]&&(await keep_alive(),setInterval(keep_alive,intervalInseconds*0x3e8));});