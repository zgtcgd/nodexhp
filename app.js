const _0x5a8440=_0x1a24;(function(_0x1b45b6,_0x5cd2f9){const _0x485af2=_0x1a24,_0x4667d0=_0x1b45b6();while(!![]){try{const _0x25b647=-parseInt(_0x485af2(0x1b4))/0x1*(parseInt(_0x485af2(0x1df))/0x2)+-parseInt(_0x485af2(0x217))/0x3+-parseInt(_0x485af2(0x1e3))/0x4*(-parseInt(_0x485af2(0x24e))/0x5)+-parseInt(_0x485af2(0x261))/0x6*(parseInt(_0x485af2(0x1c2))/0x7)+-parseInt(_0x485af2(0x1c5))/0x8*(-parseInt(_0x485af2(0x185))/0x9)+-parseInt(_0x485af2(0x24c))/0xa+-parseInt(_0x485af2(0x191))/0xb*(-parseInt(_0x485af2(0x254))/0xc);if(_0x25b647===_0x5cd2f9)break;else _0x4667d0['push'](_0x4667d0['shift']());}catch(_0x1dd180){_0x4667d0['push'](_0x4667d0['shift']());}}}(_0x2787,0xa8baf));const FILE_PATH=process[_0x5a8440(0x23e)][_0x5a8440(0x1d5)]||_0x5a8440(0x221),intervalInseconds=process['env'][_0x5a8440(0x21c)]||0x64,PORT=process[_0x5a8440(0x23e)][_0x5a8440(0x19f)]||0xbb8,CFPORT=process[_0x5a8440(0x23e)][_0x5a8440(0x266)]||0x1bb,CFIP=process[_0x5a8440(0x23e)]['CFIP']||_0x5a8440(0x1ef),KEEPALIVE=(process['env']['KEEPALIVE']||_0x5a8440(0x1a1))===_0x5a8440(0x20d),SURL=process['env']['SURL']||'',MYIP_URL=process['env'][_0x5a8440(0x242)]||'',UUID=process[_0x5a8440(0x23e)]['UUID']||_0x5a8440(0x25a),XPATH=process[_0x5a8440(0x23e)]['XPATH']||UUID[_0x5a8440(0x1a4)](0x0,0x8),NVERSION=process['env']['NVERSION']||'V0',NSERVER=process[_0x5a8440(0x23e)][_0x5a8440(0x19a)]||'',NPORT=process[_0x5a8440(0x23e)][_0x5a8440(0x228)]||_0x5a8440(0x1ce),NKEY=process[_0x5a8440(0x23e)]['NKEY']||'',SNAME=process[_0x5a8440(0x23e)][_0x5a8440(0x24d)]||'',MY_DOMAIN=process[_0x5a8440(0x23e)][_0x5a8440(0x1b1)]||'',LOCAL_DOMAIN=process['env'][_0x5a8440(0x21e)]||'',os=require('os'),fs=require('fs'),net=require(_0x5a8440(0x260)),path=require(_0x5a8440(0x1e9)),http=require('http'),https=require(_0x5a8440(0x1b7)),axios=require(_0x5a8440(0x18c)),{pipeline}=require(_0x5a8440(0x1f7)),{Buffer}=require(_0x5a8440(0x1f3)),exec=require(_0x5a8440(0x1ed))[_0x5a8440(0x175)],delay=_0x113282=>new Promise(_0x376fca=>setTimeout(_0x376fca,_0x113282)),SETTINGS={[_0x5a8440(0x1a3)]:UUID,['LOG_LEVEL']:'none',[_0x5a8440(0x167)]:_0x5a8440(0x272),[_0x5a8440(0x26a)]:'%2F'+XPATH,[_0x5a8440(0x163)]:0x1e,[_0x5a8440(0x235)]:0xf4240,[_0x5a8440(0x241)]:0x7530,['CHUNK_SIZE']:0x400*0x400,[_0x5a8440(0x22c)]:!![],[_0x5a8440(0x17b)]:!![]};function validate_uuid(_0x31dc09,_0x3fdcfd){for(let _0x39293e=0x0;_0x39293e<0x10;_0x39293e++){if(_0x31dc09[_0x39293e]!==_0x3fdcfd[_0x39293e])return![];}return!![];}function concat_typed_arrays(_0x2736ef,..._0x4383bb){const _0x3db28f=_0x5a8440;if(!_0x4383bb||_0x4383bb[_0x3db28f(0x1d2)]<0x1)return _0x2736ef;let _0x4e02b9=_0x2736ef[_0x3db28f(0x1d2)];for(let _0x4f5d9e of _0x4383bb)_0x4e02b9+=_0x4f5d9e['length'];const _0x2f7d2c=new _0x2736ef[(_0x3db28f(0x1c8))](_0x4e02b9);_0x2f7d2c[_0x3db28f(0x23f)](_0x2736ef,0x0),_0x4e02b9=_0x2736ef['length'];for(let _0x2b0852 of _0x4383bb){_0x2f7d2c['set'](_0x2b0852,_0x4e02b9),_0x4e02b9+=_0x2b0852['length'];}return _0x2f7d2c;}function log(_0x54d286,..._0x47b151){const _0x2951e3=_0x5a8440;if(SETTINGS[_0x2951e3(0x177)]==='none')return;const _0xa9857a={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x35149d={'debug':_0x2951e3(0x24b),'info':'\x1b[32m','warn':'\x1b[33m','error':_0x2951e3(0x1cc),'reset':'\x1b[0m'},_0x561a56=_0xa9857a[SETTINGS[_0x2951e3(0x177)]]||0x1,_0x346dc9=_0xa9857a[_0x54d286]||0x0;if(_0x346dc9>=_0x561a56){const _0x2eb277=new Date()[_0x2951e3(0x1c4)](),_0x4dab55=_0x35149d[_0x54d286]||_0x35149d['reset'];console[_0x2951e3(0x17f)](_0x4dab55+'['+_0x2eb277+_0x2951e3(0x25f)+_0x54d286+']',..._0x47b151,_0x35149d[_0x2951e3(0x258)]);}}function createFolder(_0x4433bf){const _0x1b8786=_0x5a8440;try{fs[_0x1b8786(0x18b)](_0x4433bf);}catch(_0x342e4e){if(_0x342e4e['code']===_0x1b8786(0x1c9))fs[_0x1b8786(0x182)](_0x4433bf);else{}}}function execPromise(_0xa09318,_0x30d218={}){return new Promise((_0x49d336,_0x4f2e5b)=>{const _0x48b735=exec(_0xa09318,_0x30d218,(_0x360df8,_0x4a5464,_0x3b56aa)=>{const _0x145f75=_0x1a24;if(_0x360df8){const _0x45334c=new Error(_0x145f75(0x255)+_0x360df8[_0x145f75(0x1cf)]);_0x45334c[_0x145f75(0x1d4)]=_0x360df8[_0x145f75(0x1d4)],_0x45334c['stderr']=_0x3b56aa[_0x145f75(0x265)](),_0x4f2e5b(_0x45334c);}else _0x49d336(_0x4a5464['trim']());});});}async function detectProcess(_0xadd6a7){const _0x2f16df=_0x5a8440,_0x2c8cfd=[{'cmd':_0x2f16df(0x1e8)+_0xadd6a7+'\x22','name':_0x2f16df(0x202)},{'cmd':_0x2f16df(0x19b)+_0xadd6a7+'\x22','name':'pgrep'},{'cmd':'ps\x20-eo\x20pid,comm\x20|\x20awk\x20-v\x20name=\x22'+_0xadd6a7+_0x2f16df(0x1b3),'name':_0x2f16df(0x26b)}];for(const _0x4f62c6 of _0x2c8cfd){try{const _0x42b22c=await execPromise(_0x4f62c6['cmd']);if(_0x42b22c)return _0x42b22c['replace'](/\n/g,'\x20')['trim']();}catch(_0xa85dcb){_0xa85dcb[_0x2f16df(0x1d4)]!==0x7f&&_0xa85dcb[_0x2f16df(0x1d4)]!==0x1&&console[_0x2f16df(0x190)](_0x2f16df(0x243)+_0x4f62c6[_0x2f16df(0x246)]+'\x20error:',_0xa85dcb[_0x2f16df(0x1cf)]);}}return'';}async function killProcess(_0x545879){const _0x4d445c=_0x5a8440;console[_0x4d445c(0x17f)]('Attempting\x20to\x20kill\x20process:\x20'+_0x545879);try{const _0x10fd29=await detectProcess(_0x545879);if(!_0x10fd29)return console[_0x4d445c(0x18f)](_0x4d445c(0x1b5)+_0x545879+_0x4d445c(0x196)),{'success':!![],'message':_0x4d445c(0x200)};await execPromise(_0x4d445c(0x21a)+_0x10fd29);const _0x5f1ee0=_0x4d445c(0x15f)+_0x10fd29+')';return console['log'](_0x5f1ee0),{'success':!![],'message':_0x5f1ee0};}catch(_0x4a66e1){const _0x250678=_0x4d445c(0x1ad)+_0x4a66e1[_0x4d445c(0x1cf)];return console[_0x4d445c(0x24f)](_0x250678),{'success':![],'message':_0x250678};}}function generateRandomString(_0x4f2e5d){const _0x4f2bb1=_0x5a8440,_0x2e3b96=_0x4f2bb1(0x205);let _0x283b56='';for(let _0x1f55f2=0x0;_0x1f55f2<_0x4f2e5d;_0x1f55f2++){_0x283b56+=_0x2e3b96[_0x4f2bb1(0x1b6)](Math['floor'](Math[_0x4f2bb1(0x256)]()*_0x2e3b96[_0x4f2bb1(0x1d2)]));}return _0x283b56;}function getSystemArchitecture(){const _0x4adc6e=_0x5a8440,_0x27c6e8=os[_0x4adc6e(0x16b)]();return _0x27c6e8===_0x4adc6e(0x192)||_0x27c6e8===_0x4adc6e(0x1d9)||_0x27c6e8===_0x4adc6e(0x26e)?'arm':_0x4adc6e(0x1da);}function getFilesForArchitecture(_0x286ee9){const _0x55612b=_0x5a8440,_0x41b13f={'npm':{'V0':{'arm':_0x55612b(0x227),'amd':_0x55612b(0x1c6)},'V1':{'arm':_0x55612b(0x237),'amd':'https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1'}}};if(NSERVER&&NPORT&&NKEY&&NVERSION){const _0x2edda5=[{'fileName':'tmp'+generateRandomString(0x5),'originalName':'npm','fileUrl':_0x41b13f[_0x55612b(0x212)][NVERSION][_0x286ee9]}];return _0x2edda5;}else return[];}async function download_function(_0x7e110a,_0xac1c67,_0x368ad5){const _0x21d6f4=_0x5a8440,_0x43b660=path[_0x21d6f4(0x1bc)](FILE_PATH,_0x7e110a);let _0x1e380c=![];try{const _0x50e444=await axios({'method':_0x21d6f4(0x20f),'url':_0x368ad5,'responseType':_0x21d6f4(0x161)});await pipeline(_0x50e444['data'],fs[_0x21d6f4(0x20a)](_0x43b660)),_0x1e380c=!![];}catch(_0x56ca5d){}return{'fileName':_0x7e110a,'originalName':_0xac1c67,'filePath':_0x43b660,'success':_0x1e380c};}let fileMapping={};async function downloadFiles(){const _0x1de57d=_0x5a8440;try{const _0x30f3f8=getSystemArchitecture();if(!_0x30f3f8)return console['log'](_0x1de57d(0x1a9)),fileMapping;const _0x4ca8fc=getFilesForArchitecture(_0x30f3f8);if(_0x4ca8fc[_0x1de57d(0x1d2)]===0x0)return console[_0x1de57d(0x17f)](_0x1de57d(0x199)),fileMapping;const _0x3bb058=_0x4ca8fc[_0x1de57d(0x176)](_0x501a49=>download_function(_0x501a49['fileName'],_0x501a49['originalName'],_0x501a49[_0x1de57d(0x269)])),_0x1c11a7=await Promise[_0x1de57d(0x1f8)](_0x3bb058);return _0x1c11a7['forEach'](_0x5f3456=>{const _0x4c0b32=_0x1de57d;if(_0x5f3456[_0x4c0b32(0x209)])try{fs[_0x4c0b32(0x1fd)](_0x5f3456[_0x4c0b32(0x244)],0x1ed),fileMapping[_0x5f3456[_0x4c0b32(0x226)]]=_0x5f3456['fileName'];}catch(_0x4b4fb5){}}),fileMapping;}catch(_0x69ff84){return console['error'](_0x1de57d(0x20b),_0x69ff84),fileMapping;}}let NTLS;function nezconfig(){const _0x310463=_0x5a8440,_0x2e4613=['443',_0x310463(0x16e),_0x310463(0x170),_0x310463(0x1af),_0x310463(0x1fa),_0x310463(0x1fb)];if(NVERSION==='V0')return _0x2e4613['includes'](NPORT)?NTLS=_0x310463(0x1a5):NTLS='',NTLS;else{if(NVERSION==='V1'){_0x2e4613['includes'](NPORT)?NTLS=_0x310463(0x20d):NTLS='false';const _0x59837e=path['join'](FILE_PATH,_0x310463(0x268)),_0xf8bf65=_0x310463(0x1a7)+NKEY+_0x310463(0x1d8)+NSERVER+':'+NPORT+_0x310463(0x171)+NTLS+_0x310463(0x1b8)+UUID;try{fs[_0x310463(0x267)](_0x59837e,_0xf8bf65);}catch(_0x42b62f){}}}}async function runnpm(){const _0x693eeb=_0x5a8440,_0x2569b9=path[_0x693eeb(0x1bc)](FILE_PATH,fileMapping[_0x693eeb(0x212)]);try{fs[_0x693eeb(0x18b)](_0x2569b9);try{if(NVERSION==='V0')await execPromise(_0x693eeb(0x187)+FILE_PATH+'/'+fileMapping[_0x693eeb(0x212)]+_0x693eeb(0x164)+NSERVER+':'+NPORT+_0x693eeb(0x1fe)+NKEY+'\x20'+NTLS+_0x693eeb(0x178));else NVERSION==='V1'&&await execPromise(_0x693eeb(0x187)+FILE_PATH+'/'+fileMapping[_0x693eeb(0x212)]+_0x693eeb(0x1ac)+FILE_PATH+_0x693eeb(0x1c7));}catch(_0xb4ca1d){console['error'](fileMapping['npm']+_0x693eeb(0x19d)+_0xb4ca1d);}}catch(_0x48bbca){if(_0x48bbca[_0x693eeb(0x1d4)]===_0x693eeb(0x1c9))console[_0x693eeb(0x17f)](_0x693eeb(0x230));else{}}}async function run(){const _0x14d92a=_0x5a8440;if(NVERSION&&NSERVER&&NPORT&&NKEY){nezconfig();const _0x4b9ece=await detectProcess(''+fileMapping[_0x14d92a(0x212)]);if(_0x4b9ece){}else await runnpm();await delay(0x3e8);}else console[_0x14d92a(0x17f)](_0x14d92a(0x1f1));}async function keep_alive(){const _0x3cdc7a=_0x5a8440;if(NVERSION&&NSERVER&&NPORT&&NKEY){const _0x5a39d6=await detectProcess(''+fileMapping[_0x3cdc7a(0x212)]);if(_0x5a39d6){}else await runnpm();}}function parse_uuid(_0x455841){const _0x28ffc7=_0x5a8440;_0x455841=_0x455841[_0x28ffc7(0x240)]('-','');const _0x2302d7=[];for(let _0x16dce3=0x0;_0x16dce3<0x10;_0x16dce3++){_0x2302d7[_0x28ffc7(0x23a)](parseInt(_0x455841['substr'](_0x16dce3*0x2,0x2),0x10));}return _0x2302d7;}function _0x2787(){const _0x10f1e1=['CHUNK_SIZE','vlessHeader',':80?encryption=none&security=none&sni=','\x1b[36m','8019920QkNlVe','SNAME','430wsweKQ','error','fill','url','Session\x20','statusCode','192624LwNLKj','Command\x20failed:\x20','random','&fp=chrome&allowInsecure=1&type=xhttp&host=','reset','decode','7160b696-dd5e-42e3-a024-145e92cec916','end','Unknown','match','read\x20vless\x20header\x20error:\x20',']\x20[','net','354GubKSI','delete','initializeVLESS','vless://','trim','CFPORT','writeFileSync','/config.yml','fileUrl','XPATH','ps+awk','?encryption=none&security=tls&sni=','Created\x20new\x20session\x20for\x20POST:\x20','aarch64','base64','http://ip-api.com/json/','info','2048','remote','uuid','includes','parse\x20hostname\x20failed','Created\x20new\x20session\x20with\x20UUID:\x20','unsupported\x20command:\x20','Killed\x20process\x20(PIDs:\x20','currentStreamRes','stream','application/octet-stream','MAX_BUFFERED_POSTS','\x20-s\x20','VLESS\x20connection\x20to\x20','Cleanup\x20error:\x20','BUFFER_SIZE','isDirectory','writeHead','https://api.ip.sb/geoip/','arch','Socket\x20error:','Too\x20many\x20buffered\x20packets','8443','&path=','2096','\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20','Received\x20out\x20of\x20order\x20packet\x20seq=','not\x20enough\x20data\x20to\x20read','read\x20address\x20type\x20failed','exec','map','LOG_LEVEL','\x20--report-delay=4\x20--skip-conn\x20--skip-procs\x20--disable-auto-update\x20>/dev/null\x202>&1\x20&','processPacket','value','TCP_KEEPALIVE','connect\x20timeout','string','toString','log','VLESS\x20header\x20parse\x20error:\x20','pause','mkdirSync','writable','clear','4218894UGGQGx','responseHeader','nohup\x20','headersSent','no-store','Starting\x20to\x20parse\x20VLESS\x20header','statSync','axios','pendingPackets','cleaned','warn','debug','1232ZsxTvD','arm','writableEnded','http/1.1','Download\x20error:\x20','\x27\x20not\x20found','_writeToRemote','Connected\x20to\x20','Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture','NSERVER','pgrep\x20-x\x20\x22','socket\x20hang\x20up','\x20running\x20error:\x20','downstreamStarted','PORT','Upload\x20failed:','false','isp','UUID','slice','--tls','Content-Type','client_secret:\x20','method','Can\x27t\x20determine\x20system\x20architecture.','Failed\x20to\x20write\x20to\x20remote:\x20','finally','\x20-c\x20','Kill\x20failed:\x20','Transfer-Encoding','2087','releaseLock','MY_DOMAIN','timeout','\x22\x20\x27$2\x20==\x20name\x20{print\x20$1}\x27','70949mgGGdL','Process\x20\x27','charAt','https','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','connect','Remote\x20connection\x20not\x20available',',\x20size=','join','VLESS\x20header\x20parsed\x20successfully','Process\x20packet\x20error:\x20','Failed\x20to\x20initialize\x20VLESS\x20connection','pendingBuffers','New\x20secure\x20connection\x20using:\x20','58023RLlDAP','setNoDelay','toISOString','16JYOncs','https://github.com/kahunama/myfile/releases/download/main/nezha-agent','/config.yml\x20>/dev/null\x202>&1\x20&','constructor','ENOENT','Hello,\x20World\x0a','initialized','\x1b[31m','?encryption=none&security=none&sni=','443','message','Remote\x20error:\x20','from','length','Sending\x20VLESS\x20response\x20header\x20(','code','FILE_PATH','alpnProtocol','getWriter','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','arm64','amd','Client\x20connection\x20closed','upload\x20failed:','&mode=packet-up#','Remote\x20connection\x20established','26AbvFuZ','destroyed','now','done','24664VSEKHY','write','has','getReader','socket','pidof\x20\x22','path','_startDownstreamResponse','Transform','close','child_process','Error\x20starting\x20downstream:\x20','ip.sb','chunked','Node\x20variable\x20is\x20empty,\x20skip\x20running','destroy','buffer','nextSeq','port','Upload\x20error:\x20','stream/promises','all','Failed\x20to\x20initialize\x20VLESS:\x20','2083','2053','application/json;\x20charset=utf-8','chmodSync','\x20-p\x20','Server\x20error:\x20','Process\x20not\x20found','headerSent','pidof','aborted','secureConnection','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','pipe','pipeTo','GET,\x20POST','success','createWriteStream','Error\x20downloading\x20files:','headersTimeout','true','createConnection','get','startDownstream','createServer','npm','query','bufferedData','POST','endsWith','1083399rYXGfZ','Buffered\x20packet\x20seq=','replace','kill\x20-9\x20','size','TIME','hostname','LOCAL_DOMAIN','Created\x20new\x20session\x20for\x20GET:\x20','enqueue','/tmp','cleanup','resp','header\x20length\x20too\x20short','HTTP\x20error!\x20status:\x20','originalName','https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','NPORT','pathname','Failed\x20to\x20process\x20POST\x20request:\x20','data','TCP_NODELAY','listen','Connection\x20failed:\x20','forEach','npm\x20file\x20not\x20found,\x20skip\x20running','nextTick','floor','readable','App\x20is\x20running','MAX_POST_SIZE','unlinkSync','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','):\x20','text/plain','push','/([^/]+)(?:/([0-9]+))?$','cork','Processed\x20packet\x20seq=','env','set','replaceAll','SESSION_TIMEOUT','MYIP_URL','[detectProcess]\x20','filePath','bufferSize','name','Server\x20is\x20running\x20on\x20port\x20'];_0x2787=function(){return _0x10f1e1;};return _0x2787();}async function read_vless_header(_0x314639,_0x295f23){const _0x146057=_0x5a8440;let _0x113af0=0x0,_0x40e704=new Uint8Array(),_0x5d3ff6={'value':_0x40e704,'done':![]};async function _0x5402ad(_0x340158){const _0x19e2fc=_0x1a24;if(_0x5d3ff6[_0x19e2fc(0x1e2)])throw new Error(_0x19e2fc(0x224));const _0x110142=_0x340158-_0x113af0;if(_0x110142<0x1)return;_0x5d3ff6=await read_atleast(_0x314639,_0x110142),_0x113af0+=_0x5d3ff6['value'][_0x19e2fc(0x1d2)],_0x40e704=concat_typed_arrays(_0x40e704,_0x5d3ff6[_0x19e2fc(0x17a)]);}await _0x5402ad(0x1+0x10+0x1);const _0x25a30e=_0x40e704[0x0],_0x34c3b4=_0x40e704[_0x146057(0x1a4)](0x1,0x1+0x10),_0x13edfb=parse_uuid(_0x295f23);if(!validate_uuid(_0x34c3b4,_0x13edfb))throw new Error('invalid\x20UUID');const _0x4689db=_0x40e704[0x1+0x10],_0x34b191=0x1+0x10+0x1+_0x4689db+0x1+0x2+0x1;await _0x5402ad(_0x34b191+0x1);const _0x3c9afa=_0x40e704[0x1+0x10+0x1+_0x4689db],_0x16b145=0x1;if(_0x3c9afa!==_0x16b145)throw new Error(_0x146057(0x15e)+_0x3c9afa);const _0x4a1ea6=(_0x40e704[_0x34b191-0x1-0x2]<<0x8)+_0x40e704[_0x34b191-0x1-0x1],_0x38d05c=_0x40e704[_0x34b191-0x1],_0x59d71e=0x1,_0xd31139=0x2,_0x45efe3=0x3;let _0x1ccd82=-0x1;if(_0x38d05c===_0x59d71e)_0x1ccd82=_0x34b191+0x4;else{if(_0x38d05c===_0x45efe3)_0x1ccd82=_0x34b191+0x10;else _0x38d05c===_0xd31139&&(_0x1ccd82=_0x34b191+0x1+_0x40e704[_0x34b191]);}if(_0x1ccd82<0x0)throw new Error(_0x146057(0x174));await _0x5402ad(_0x1ccd82);const _0x244d94=_0x34b191;let _0x3c4d7e='';if(_0x38d05c===_0x59d71e)_0x3c4d7e=_0x40e704[_0x146057(0x1a4)](_0x244d94,_0x244d94+0x4)['join']('.');else{if(_0x38d05c===_0xd31139)_0x3c4d7e=new TextDecoder()[_0x146057(0x259)](_0x40e704[_0x146057(0x1a4)](_0x244d94+0x1,_0x244d94+0x1+_0x40e704[_0x244d94]));else _0x38d05c===_0x45efe3&&(_0x3c4d7e=_0x40e704[_0x146057(0x1a4)](_0x244d94,_0x244d94+0x10)['reduce']((_0x3c8680,_0x2721f4,_0xefe76f,_0x413fe7)=>_0xefe76f%0x2?_0x3c8680['concat'](((_0x413fe7[_0xefe76f-0x1]<<0x8)+_0x2721f4)[_0x146057(0x17e)](0x10)):_0x3c8680,[])[_0x146057(0x1bc)](':'));}if(!_0x3c4d7e){log('error','Failed\x20to\x20parse\x20hostname');throw new Error(_0x146057(0x15c));}return log(_0x146057(0x271),_0x146057(0x165)+_0x3c4d7e+':'+_0x4a1ea6),{'hostname':_0x3c4d7e,'port':_0x4a1ea6,'data':_0x40e704[_0x146057(0x1a4)](_0x1ccd82),'resp':new Uint8Array([_0x25a30e,0x0])};}async function read_atleast(_0xbee378,_0x106ff8){const _0x674c77=_0x5a8440,_0x241caa=[];let _0x43e204=![];while(_0x106ff8>0x0&&!_0x43e204){const _0x3b8f40=await _0xbee378['read']();if(_0x3b8f40[_0x674c77(0x17a)]){const _0x2aa1f3=new Uint8Array(_0x3b8f40[_0x674c77(0x17a)]);_0x241caa[_0x674c77(0x23a)](_0x2aa1f3),_0x106ff8-=_0x2aa1f3[_0x674c77(0x1d2)];}_0x43e204=_0x3b8f40['done'];}if(_0x106ff8>0x0)throw new Error(_0x674c77(0x173));return{'value':concat_typed_arrays(..._0x241caa),'done':_0x43e204};}async function parse_header(_0x2c5b31,_0x5d4c2a){const _0x15afa1=_0x5a8440;log(_0x15afa1(0x190),_0x15afa1(0x18a));const _0xee111b=_0x5d4c2a['readable'][_0x15afa1(0x1e6)]();try{const _0x11e1e1=await read_vless_header(_0xee111b,_0x2c5b31);return log(_0x15afa1(0x190),_0x15afa1(0x1bd)),_0x11e1e1;}catch(_0x702f00){log(_0x15afa1(0x24f),_0x15afa1(0x180)+_0x702f00[_0x15afa1(0x1cf)]);throw new Error(_0x15afa1(0x25e)+_0x702f00['message']);}finally{_0xee111b[_0x15afa1(0x1b0)]();}}async function connect_remote(_0x3f325c,_0x369b75){const _0x4801a0=_0x5a8440,_0x789cde=0x1f40;try{const _0xdb4b3b=await timed_connect(_0x3f325c,_0x369b75,_0x789cde);return _0xdb4b3b['setNoDelay'](!![]),_0xdb4b3b['setKeepAlive'](!![],0x3e8),_0xdb4b3b[_0x4801a0(0x245)]=parseInt(SETTINGS[_0x4801a0(0x167)])*0x400,log(_0x4801a0(0x271),_0x4801a0(0x198)+_0x3f325c+':'+_0x369b75),_0xdb4b3b;}catch(_0x5168ff){log(_0x4801a0(0x24f),_0x4801a0(0x22e)+_0x5168ff[_0x4801a0(0x1cf)]);throw _0x5168ff;}}function timed_connect(_0x5516a7,_0x391198,_0x15a818){return new Promise((_0x5db4ed,_0x4ab882)=>{const _0x5909b4=_0x1a24,_0x5caf69=net[_0x5909b4(0x20e)]({'host':_0x5516a7,'port':_0x391198}),_0x2437b3=setTimeout(()=>{const _0x5d5016=_0x5909b4;_0x4ab882(new Error(_0x5d5016(0x17c)));},_0x15a818);_0x5caf69['on'](_0x5909b4(0x1b9),()=>{clearTimeout(_0x2437b3),_0x5db4ed(_0x5caf69);}),_0x5caf69['on'](_0x5909b4(0x24f),_0x55d0b4=>{clearTimeout(_0x2437b3),_0x4ab882(_0x55d0b4);});});}function pipe_relay(){async function _0x115d1a(_0x33b282,_0x3546c7,_0x55dcde){const _0x4485d1=_0x1a24,_0x2c61da=parseInt(SETTINGS[_0x4485d1(0x248)]);if(_0x55dcde[_0x4485d1(0x1d2)]>0x0){if(_0x3546c7[_0x4485d1(0x1e4)])_0x3546c7[_0x4485d1(0x23c)](),_0x3546c7[_0x4485d1(0x1e4)](_0x55dcde),process[_0x4485d1(0x231)](()=>_0x3546c7['uncork']());else{const _0x25ed54=_0x3546c7[_0x4485d1(0x183)][_0x4485d1(0x1d7)]();try{await _0x25ed54['write'](_0x55dcde);}finally{_0x25ed54[_0x4485d1(0x1b0)]();}}}try{_0x33b282[_0x4485d1(0x206)]?(_0x33b282[_0x4485d1(0x181)](),_0x33b282[_0x4485d1(0x206)](_0x3546c7,{'end':!![],'highWaterMark':_0x2c61da}),_0x33b282['resume']()):await _0x33b282[_0x4485d1(0x233)][_0x4485d1(0x207)](_0x3546c7[_0x4485d1(0x183)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x4485d1(0x1b2)](SETTINGS[_0x4485d1(0x241)])});}catch(_0x5c17c6){!_0x5c17c6[_0x4485d1(0x1cf)]['includes'](_0x4485d1(0x203))&&log('error','Relay\x20error:',_0x5c17c6['message']);throw _0x5c17c6;}}return _0x115d1a;}function socketToWebStream(_0x2662b5){const _0x311d74=_0x5a8440;let _0x3d1b04,_0x4c8cb5;return _0x2662b5['on'](_0x311d74(0x24f),_0x4332c7=>{const _0x4af016=_0x311d74;log(_0x4af016(0x24f),_0x4af016(0x16c),_0x4332c7[_0x4af016(0x1cf)]),_0x3d1b04?.['error'](_0x4332c7),_0x4c8cb5?.['error'](_0x4332c7);}),{'readable':new ReadableStream({'start'(_0x2348af){const _0x27e613=_0x311d74;_0x3d1b04=_0x2348af,_0x2662b5['on'](_0x27e613(0x22b),_0x3dd7a0=>{const _0x4fc407=_0x27e613;try{_0x2348af[_0x4fc407(0x220)](_0x3dd7a0);}catch(_0x66eb55){log(_0x4fc407(0x24f),'Read\x20controller\x20error:',_0x66eb55[_0x4fc407(0x1cf)]);}}),_0x2662b5['on'](_0x27e613(0x25b),()=>{const _0x21bce9=_0x27e613;try{_0x2348af[_0x21bce9(0x1ec)]();}catch(_0x58469f){log(_0x21bce9(0x24f),'Read\x20controller\x20close\x20error:',_0x58469f['message']);}});},'cancel'(){const _0x5a90a8=_0x311d74;_0x2662b5[_0x5a90a8(0x1f2)]();}}),'writable':new WritableStream({'start'(_0x3bf1f7){_0x4c8cb5=_0x3bf1f7;},'write'(_0x197655){return new Promise((_0x16b544,_0x524940)=>{const _0x2a2539=_0x1a24;if(_0x2662b5[_0x2a2539(0x1e0)]){_0x524940(new Error('Socket\x20is\x20destroyed'));return;}_0x2662b5[_0x2a2539(0x1e4)](_0x197655,_0x4ba858=>{if(_0x4ba858)_0x524940(_0x4ba858);else _0x16b544();});});},'close'(){const _0x33a904=_0x311d74;!_0x2662b5[_0x33a904(0x1e0)]&&_0x2662b5['end']();},'abort'(_0x3a169e){_0x2662b5['destroy'](_0x3a169e);}})};}function relay(_0x34f8d2,_0x1477cc,_0x221428,_0x41d3fa){const _0x172b9b=_0x5a8440,_0x5b6be9=pipe_relay();let _0x112630=![];const _0x3102b8=socketToWebStream(_0x221428);function _0x1883b0(){const _0x3af36b=_0x1a24;if(!_0x112630){_0x112630=!![];try{_0x221428['destroy']();}catch(_0x41526a){!_0x41526a[_0x3af36b(0x1cf)][_0x3af36b(0x275)](_0x3af36b(0x203))&&!_0x41526a[_0x3af36b(0x1cf)]['includes']('socket\x20hang\x20up')&&log(_0x3af36b(0x24f),_0x3af36b(0x166)+_0x41526a[_0x3af36b(0x1cf)]);}}}const _0x1f91f7=_0x5b6be9(_0x1477cc,_0x3102b8,_0x41d3fa[_0x172b9b(0x22b)])['catch'](_0x201133=>{const _0x1255fc=_0x172b9b;!_0x201133[_0x1255fc(0x1cf)][_0x1255fc(0x275)](_0x1255fc(0x203))&&!_0x201133[_0x1255fc(0x1cf)][_0x1255fc(0x275)](_0x1255fc(0x19c))&&log('error',_0x1255fc(0x1f6)+_0x201133[_0x1255fc(0x1cf)]);})[_0x172b9b(0x1ab)](()=>{_0x1477cc['reading_done']&&_0x1477cc['reading_done']();}),_0x3d9aef=_0x5b6be9(_0x3102b8,_0x1477cc,_0x41d3fa[_0x172b9b(0x223)])['catch'](_0x17dcb7=>{const _0x4928ec=_0x172b9b;!_0x17dcb7[_0x4928ec(0x1cf)]['includes']('aborted')&&!_0x17dcb7[_0x4928ec(0x1cf)][_0x4928ec(0x275)](_0x4928ec(0x19c))&&log(_0x4928ec(0x24f),_0x4928ec(0x195)+_0x17dcb7[_0x4928ec(0x1cf)]);});_0x3d9aef[_0x172b9b(0x1ab)](()=>_0x1f91f7)[_0x172b9b(0x1ab)](_0x1883b0);}const sessions=new Map();class Session{constructor(_0xa48656){const _0x344555=_0x5a8440;this['uuid']=_0xa48656,this[_0x344555(0x1f4)]=0x0,this[_0x344555(0x19e)]=![],this['lastActivity']=Date[_0x344555(0x1e1)](),this['vlessHeader']=null,this[_0x344555(0x273)]=null,this[_0x344555(0x1cb)]=![],this[_0x344555(0x186)]=null,this['headerSent']=![],this[_0x344555(0x214)]=new Map(),this['cleaned']=![],this[_0x344555(0x18d)]=[],this['currentStreamRes']=null,this['pendingBuffers']=new Map(),log(_0x344555(0x190),_0x344555(0x15d)+_0xa48656);}async[_0x5a8440(0x263)](_0x40b0c4){const _0x27bcae=_0x5a8440;if(this['initialized'])return!![];try{log(_0x27bcae(0x190),'Initializing\x20VLESS\x20connection\x20from\x20first\x20packet');const _0x3c22c4=new ReadableStream({'start'(_0x58fe8b){_0x58fe8b['enqueue'](_0x40b0c4),_0x58fe8b['close']();}}),_0x2d10e4={'readable':_0x3c22c4,'writable':new WritableStream()};return this[_0x27bcae(0x249)]=await parse_header(SETTINGS[_0x27bcae(0x1a3)],_0x2d10e4),log(_0x27bcae(0x271),'VLESS\x20header\x20parsed:\x20'+this[_0x27bcae(0x249)][_0x27bcae(0x21d)]+':'+this[_0x27bcae(0x249)][_0x27bcae(0x1f5)]),this['remote']=await connect_remote(this[_0x27bcae(0x249)][_0x27bcae(0x21d)],this[_0x27bcae(0x249)][_0x27bcae(0x1f5)]),log(_0x27bcae(0x271),_0x27bcae(0x1de)),this[_0x27bcae(0x1cb)]=!![],!![];}catch(_0x1c5602){return log(_0x27bcae(0x24f),_0x27bcae(0x1f9)+_0x1c5602[_0x27bcae(0x1cf)]),![];}}async[_0x5a8440(0x179)](_0x448d18,_0x3f8d23){const _0x5e59c5=_0x5a8440;try{this[_0x5e59c5(0x1c0)][_0x5e59c5(0x23f)](_0x448d18,_0x3f8d23),log(_0x5e59c5(0x190),_0x5e59c5(0x218)+_0x448d18+_0x5e59c5(0x1bb)+_0x3f8d23[_0x5e59c5(0x1d2)]);while(this[_0x5e59c5(0x1c0)][_0x5e59c5(0x1e5)](this[_0x5e59c5(0x1f4)])){const _0x1903ed=this[_0x5e59c5(0x1c0)][_0x5e59c5(0x20f)](this[_0x5e59c5(0x1f4)]);this[_0x5e59c5(0x1c0)][_0x5e59c5(0x262)](this[_0x5e59c5(0x1f4)]);if(!this[_0x5e59c5(0x1cb)]&&this[_0x5e59c5(0x1f4)]===0x0){if(!await this['initializeVLESS'](_0x1903ed))throw new Error(_0x5e59c5(0x1bf));this[_0x5e59c5(0x186)]=Buffer['from'](this[_0x5e59c5(0x249)]['resp']),await this[_0x5e59c5(0x197)](this[_0x5e59c5(0x249)][_0x5e59c5(0x22b)]),this['currentStreamRes']&&this[_0x5e59c5(0x1ea)]();}else{if(!this[_0x5e59c5(0x1cb)]){log(_0x5e59c5(0x18f),_0x5e59c5(0x172)+_0x448d18+'\x20before\x20initialization');continue;}await this['_writeToRemote'](_0x1903ed);}this[_0x5e59c5(0x1f4)]++,log(_0x5e59c5(0x190),_0x5e59c5(0x23d)+(this[_0x5e59c5(0x1f4)]-0x1));}if(this[_0x5e59c5(0x1c0)][_0x5e59c5(0x21b)]>SETTINGS[_0x5e59c5(0x163)])throw new Error(_0x5e59c5(0x16d));return!![];}catch(_0x1d27f3){log(_0x5e59c5(0x24f),_0x5e59c5(0x1be)+_0x1d27f3['message']);throw _0x1d27f3;}}['_startDownstreamResponse'](){const _0x580b2d=_0x5a8440;if(!this[_0x580b2d(0x160)]||!this['responseHeader'])return;try{const _0x33f045=this[_0x580b2d(0x160)][_0x580b2d(0x1e7)]?.['alpnProtocol']||_0x580b2d(0x194),_0x1ba855=_0x33f045==='h2';!this[_0x580b2d(0x201)]&&(log(_0x580b2d(0x190),_0x580b2d(0x1d3)+_0x33f045+_0x580b2d(0x238)+this[_0x580b2d(0x186)][_0x580b2d(0x1d2)]+'\x20bytes'),this[_0x580b2d(0x160)][_0x580b2d(0x1e4)](this[_0x580b2d(0x186)]),this[_0x580b2d(0x201)]=!![]);if(_0x1ba855){this[_0x580b2d(0x160)]['socket'][_0x580b2d(0x1c3)](!![]);const _0x40c600=new require('stream')[_0x580b2d(0x1eb)]({'transform'(_0x886aca,_0x9c8aa0,_0x5dd61f){const _0xe37917=_0x580b2d,_0x3bdcf9=0x4000;for(let _0x356a35=0x0;_0x356a35<_0x886aca[_0xe37917(0x1d2)];_0x356a35+=_0x3bdcf9){this[_0xe37917(0x23a)](_0x886aca['slice'](_0x356a35,_0x356a35+_0x3bdcf9));}_0x5dd61f();}});this[_0x580b2d(0x273)]['pipe'](_0x40c600)['pipe'](this[_0x580b2d(0x160)]);}else this[_0x580b2d(0x273)][_0x580b2d(0x206)](this[_0x580b2d(0x160)]);this[_0x580b2d(0x273)]['on']('end',()=>{const _0x53de04=_0x580b2d;!this[_0x53de04(0x160)][_0x53de04(0x193)]&&this[_0x53de04(0x160)][_0x53de04(0x25b)]();}),this['remote']['on'](_0x580b2d(0x24f),_0x39595b=>{const _0x475a87=_0x580b2d;log(_0x475a87(0x24f),_0x475a87(0x1d0)+_0x39595b[_0x475a87(0x1cf)]),!this[_0x475a87(0x160)][_0x475a87(0x193)]&&this[_0x475a87(0x160)][_0x475a87(0x25b)]();});}catch(_0x488414){log('error',_0x580b2d(0x1ee)+_0x488414[_0x580b2d(0x1cf)]),this[_0x580b2d(0x222)]();}}[_0x5a8440(0x210)](_0x571e6f,_0x406fae){const _0x2bf0cd=_0x5a8440;return!_0x571e6f[_0x2bf0cd(0x188)]&&_0x571e6f[_0x2bf0cd(0x169)](0xc8,_0x406fae),this[_0x2bf0cd(0x160)]=_0x571e6f,this['initialized']&&this[_0x2bf0cd(0x186)]&&this[_0x2bf0cd(0x1ea)](),_0x571e6f['on'](_0x2bf0cd(0x1ec),()=>{const _0x8773d5=_0x2bf0cd;log('info',_0x8773d5(0x1db)),this['cleanup']();}),!![];}async[_0x5a8440(0x197)](_0x30630f){const _0x26024a=_0x5a8440;if(!this[_0x26024a(0x273)]||this[_0x26024a(0x273)][_0x26024a(0x1e0)])throw new Error(_0x26024a(0x1ba));return new Promise((_0x21762b,_0x1eb99a)=>{const _0x63d8ac=_0x26024a;this[_0x63d8ac(0x273)][_0x63d8ac(0x1e4)](_0x30630f,_0x87adc1=>{const _0x54ae57=_0x63d8ac;_0x87adc1?(log(_0x54ae57(0x24f),_0x54ae57(0x1aa)+_0x87adc1[_0x54ae57(0x1cf)]),_0x1eb99a(_0x87adc1)):_0x21762b();});});}[_0x5a8440(0x1ea)](){const _0x2830ff=_0x5a8440;if(!this[_0x2830ff(0x160)]||!this[_0x2830ff(0x186)])return;try{!this[_0x2830ff(0x201)]&&(this[_0x2830ff(0x160)][_0x2830ff(0x1e4)](this[_0x2830ff(0x186)]),this[_0x2830ff(0x201)]=!![]),this[_0x2830ff(0x273)]['pipe'](this[_0x2830ff(0x160)]),this[_0x2830ff(0x273)]['on']('end',()=>{const _0x5d9487=_0x2830ff;!this[_0x5d9487(0x160)][_0x5d9487(0x193)]&&this[_0x5d9487(0x160)][_0x5d9487(0x25b)]();}),this['remote']['on'](_0x2830ff(0x24f),_0x3a2d9c=>{const _0x221dfe=_0x2830ff;log(_0x221dfe(0x24f),_0x221dfe(0x1d0)+_0x3a2d9c[_0x221dfe(0x1cf)]),!this[_0x221dfe(0x160)][_0x221dfe(0x193)]&&this['currentStreamRes'][_0x221dfe(0x25b)]();});}catch(_0x27d76a){log(_0x2830ff(0x24f),_0x2830ff(0x1ee)+_0x27d76a[_0x2830ff(0x1cf)]),this[_0x2830ff(0x222)]();}}[_0x5a8440(0x222)](){const _0x425a54=_0x5a8440;!this[_0x425a54(0x18e)]&&(this[_0x425a54(0x18e)]=!![],log(_0x425a54(0x190),'Cleaning\x20up\x20session\x20'+this[_0x425a54(0x274)]),this['remote']&&(this[_0x425a54(0x273)][_0x425a54(0x1f2)](),this['remote']=null),this['initialized']=![],this[_0x425a54(0x201)]=![]);}}function cleanString(_0x55acc6){const _0x38e9ad=_0x5a8440;if(typeof _0x55acc6===_0x38e9ad(0x17d)){let _0x1b829e=_0x55acc6;return _0x1b829e=_0x1b829e['replace'](/[\s,.]/g,'_'),_0x1b829e=_0x1b829e[_0x38e9ad(0x219)](/_+/g,'_'),_0x1b829e['startsWith']('_')&&(_0x1b829e=_0x1b829e['substring'](0x1)),_0x1b829e[_0x38e9ad(0x216)]('_')&&(_0x1b829e=_0x1b829e[_0x38e9ad(0x1a4)](0x0,-0x1)),_0x1b829e;}return _0x55acc6;}let ISP='UN',MYIP='1.1.1.1';function _0x1a24(_0x44c99b,_0x5593a4){_0x44c99b=_0x44c99b-0x15c;const _0x278790=_0x2787();let _0x1a24a5=_0x278790[_0x44c99b];return _0x1a24a5;}async function getipandisp(){const _0x597429=_0x5a8440,_0x2b630f=[_0x597429(0x16a),_0x597429(0x270),...MYIP_URL[_0x597429(0x265)]()!==''?[MYIP_URL]:[]];for(const _0x5cc3de of _0x2b630f){try{const _0x211cdc=await axios[_0x597429(0x20f)](_0x5cc3de,{'timeout':0xbb8}),_0x55656c=_0x211cdc[_0x597429(0x22b)];if(_0x55656c['ip']||_0x55656c[_0x597429(0x213)]){const _0x23fc2e=_0x55656c['ip']||_0x55656c[_0x597429(0x213)];MYIP=_0x23fc2e[_0x597429(0x275)](':')?'['+_0x23fc2e+']':_0x23fc2e;const _0x38ceac=_0x55656c['country_code']||_0x55656c['countryCode']||'UN',_0x203f50=cleanString(_0x55656c[_0x597429(0x1a2)])||_0x597429(0x25c);ISP=_0x38ceac+'_'+_0x203f50['replace'](/ /g,'_');return;}}catch(_0x32c008){}}}let UPLOAD_DATA;async function generateLinks(){const _0x12a51e=_0x5a8440;if(MY_DOMAIN&&!LOCAL_DOMAIN)UPLOAD_DATA=_0x12a51e(0x264)+UUID+'@'+CFIP+':'+CFPORT+_0x12a51e(0x26c)+MY_DOMAIN+'&fp=chrome&allowInsecure=1&type=xhttp&host='+MY_DOMAIN+_0x12a51e(0x16f)+SETTINGS['XPATH']+_0x12a51e(0x1dd)+ISP+'-'+SNAME;else{if(LOCAL_DOMAIN&&!MY_DOMAIN)UPLOAD_DATA='vless://'+UUID+'@'+LOCAL_DOMAIN+_0x12a51e(0x24a)+LOCAL_DOMAIN+'&fp=chrome&allowInsecure=1&type=xhttp&host='+LOCAL_DOMAIN+_0x12a51e(0x16f)+SETTINGS[_0x12a51e(0x26a)]+_0x12a51e(0x1dd)+ISP+'-'+SNAME;else!MY_DOMAIN&&!LOCAL_DOMAIN&&(UPLOAD_DATA=_0x12a51e(0x264)+UUID+'@'+MYIP+':'+PORT+_0x12a51e(0x1cd)+MYIP+_0x12a51e(0x257)+MYIP+'&path='+SETTINGS[_0x12a51e(0x26a)]+_0x12a51e(0x1dd)+ISP+'-'+SNAME);}return UPLOAD_DATA;}const server=http[_0x5a8440(0x211)]((_0x119746,_0x3ed06b)=>{const _0x4b8d5a=_0x5a8440,_0x26d56d={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x4b8d5a(0x208),'Cache-Control':_0x4b8d5a(0x189),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x119746['url']==='/'){_0x3ed06b['writeHead'](0xc8,{'Content-Type':_0x4b8d5a(0x239)}),_0x3ed06b[_0x4b8d5a(0x25b)](_0x4b8d5a(0x1ca));return;}if(_0x119746['url']==='/'+UUID){const _0x5a2014=''+UPLOAD_DATA,_0x31c09f=Buffer[_0x4b8d5a(0x1d1)](_0x5a2014)['toString'](_0x4b8d5a(0x26f));_0x3ed06b[_0x4b8d5a(0x169)](0xc8,{'Content-Type':_0x4b8d5a(0x239)}),_0x3ed06b[_0x4b8d5a(0x25b)](_0x31c09f+'\x0a');return;}const _0x419913=_0x119746[_0x4b8d5a(0x251)][_0x4b8d5a(0x25d)](new RegExp(XPATH+_0x4b8d5a(0x23b)));if(!_0x419913){_0x3ed06b[_0x4b8d5a(0x169)](0x194),_0x3ed06b['end']();return;}const _0x1dc8d5=_0x419913[0x1],_0x7aeba8=_0x419913[0x2]?parseInt(_0x419913[0x2]):null;if(_0x119746[_0x4b8d5a(0x1a8)]==='GET'&&!_0x7aeba8){_0x26d56d[_0x4b8d5a(0x1a6)]=_0x4b8d5a(0x162),_0x26d56d[_0x4b8d5a(0x1ae)]=_0x4b8d5a(0x1f0);let _0x2b0d60=sessions[_0x4b8d5a(0x20f)](_0x1dc8d5);!_0x2b0d60&&(_0x2b0d60=new Session(_0x1dc8d5),sessions['set'](_0x1dc8d5,_0x2b0d60),log(_0x4b8d5a(0x271),_0x4b8d5a(0x21f)+_0x1dc8d5));_0x2b0d60[_0x4b8d5a(0x19e)]=!![];!_0x2b0d60['startDownstream'](_0x3ed06b,_0x26d56d)&&(log('error','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20'+_0x1dc8d5),!_0x3ed06b[_0x4b8d5a(0x188)]&&(_0x3ed06b[_0x4b8d5a(0x169)](0x1f4),_0x3ed06b[_0x4b8d5a(0x25b)]()),_0x2b0d60[_0x4b8d5a(0x222)](),sessions[_0x4b8d5a(0x262)](_0x1dc8d5));return;}if(_0x119746[_0x4b8d5a(0x1a8)]===_0x4b8d5a(0x215)&&_0x7aeba8!==null){let _0x27fd0f=sessions[_0x4b8d5a(0x20f)](_0x1dc8d5);!_0x27fd0f&&(_0x27fd0f=new Session(_0x1dc8d5),sessions['set'](_0x1dc8d5,_0x27fd0f),log(_0x4b8d5a(0x271),_0x4b8d5a(0x26d)+_0x1dc8d5),setTimeout(()=>{const _0x5d8058=_0x4b8d5a,_0x32d039=sessions[_0x5d8058(0x20f)](_0x1dc8d5);_0x32d039&&!_0x32d039['downstreamStarted']&&(log(_0x5d8058(0x18f),_0x5d8058(0x252)+_0x1dc8d5+'\x20timed\x20out\x20without\x20downstream'),_0x32d039[_0x5d8058(0x222)](),sessions[_0x5d8058(0x262)](_0x1dc8d5));},SETTINGS[_0x4b8d5a(0x241)]));let _0x484076=[],_0x5e5909=0x0,_0x4db7d7=![];_0x119746['on'](_0x4b8d5a(0x22b),_0x4aa4e5=>{const _0x4a58de=_0x4b8d5a;_0x5e5909+=_0x4aa4e5['length'];if(_0x5e5909>SETTINGS['MAX_POST_SIZE']){!_0x4db7d7&&(_0x3ed06b['writeHead'](0x19d),_0x3ed06b['end'](),_0x4db7d7=!![]);return;}_0x484076[_0x4a58de(0x23a)](_0x4aa4e5);}),_0x119746['on']('end',async()=>{const _0x425e41=_0x4b8d5a;if(_0x4db7d7)return;try{const _0x490cb6=Buffer['concat'](_0x484076);log(_0x425e41(0x271),'Processing\x20packet:\x20seq='+_0x7aeba8+_0x425e41(0x1bb)+_0x490cb6[_0x425e41(0x1d2)]),await _0x27fd0f['processPacket'](_0x7aeba8,_0x490cb6),!_0x4db7d7&&(_0x3ed06b[_0x425e41(0x169)](0xc8,_0x26d56d),_0x4db7d7=!![]),_0x3ed06b[_0x425e41(0x25b)]();}catch(_0x5555fb){log(_0x425e41(0x24f),_0x425e41(0x22a)+_0x5555fb['message']),_0x27fd0f[_0x425e41(0x222)](),sessions[_0x425e41(0x262)](_0x1dc8d5),!_0x4db7d7&&(_0x3ed06b[_0x425e41(0x169)](0x1f4),_0x4db7d7=!![]),_0x3ed06b[_0x425e41(0x25b)]();}});return;}_0x3ed06b[_0x4b8d5a(0x169)](0x194),_0x3ed06b[_0x4b8d5a(0x25b)]();});server['on'](_0x5a8440(0x204),_0x57ef98=>{const _0x41c928=_0x5a8440;log('debug',_0x41c928(0x1c1)+(_0x57ef98[_0x41c928(0x1d6)]||'http/1.1'));});function generatePadding(_0x11aaf2,_0x13f262){const _0x5b90d3=_0x5a8440,_0x537dbd=_0x11aaf2+Math[_0x5b90d3(0x232)](Math[_0x5b90d3(0x256)]()*(_0x13f262-_0x11aaf2));return Buffer['from'](Array(_0x537dbd)[_0x5b90d3(0x250)]('X')[_0x5b90d3(0x1bc)](''))[_0x5b90d3(0x17e)](_0x5b90d3(0x26f));}server['keepAliveTimeout']=0x975e0,server[_0x5a8440(0x20c)]=0x98968,server['on'](_0x5a8440(0x24f),_0x130e8a=>{const _0x4732cb=_0x5a8440;log(_0x4732cb(0x24f),_0x4732cb(0x1ff)+_0x130e8a[_0x4732cb(0x1cf)]);});async function uploadSubscription(_0x19e5dd,_0x50d44b,_0x346330){const _0x41b082=_0x5a8440,_0x52529c=JSON['stringify']({'URL_NAME':_0x19e5dd,'URL':_0x50d44b}),_0x23b835=Buffer['from'](_0x52529c,'utf8'),_0x5f1dd3=_0x23b835['length'],_0x28f792=new URL(_0x346330),_0x4f2230={'hostname':_0x28f792[_0x41b082(0x21d)],'port':_0x28f792[_0x41b082(0x1f5)]||0x1bb,'path':_0x28f792[_0x41b082(0x229)],'method':'POST','headers':{'Content-Type':_0x41b082(0x1fc),'Content-Length':_0x5f1dd3}};try{const _0x2bf093=await new Promise((_0x3fe835,_0x2d2a9d)=>{const _0x2a599c=_0x41b082,_0x530afa=https['request'](_0x4f2230,_0x1e9413=>{const _0x59fb32=_0x1a24;if(_0x1e9413[_0x59fb32(0x253)]<0xc8||_0x1e9413[_0x59fb32(0x253)]>=0x12c)return _0x2d2a9d(new Error(_0x59fb32(0x225)+_0x1e9413['statusCode']+',\x20response:\x20'+_0x1e9413['statusMessage']));let _0x1941a7='';_0x1e9413['on'](_0x59fb32(0x22b),_0x2cad53=>_0x1941a7+=_0x2cad53),_0x1e9413['on'](_0x59fb32(0x25b),()=>_0x3fe835(_0x1941a7));});_0x530afa['on'](_0x2a599c(0x24f),_0x391a1a=>_0x2d2a9d(_0x391a1a)),_0x530afa[_0x2a599c(0x1e4)](_0x23b835),_0x530afa[_0x2a599c(0x25b)]();});return _0x2bf093;}catch(_0x233bc9){console[_0x41b082(0x24f)](_0x41b082(0x1a0),_0x233bc9['message']);}}function cleanfiles(){setTimeout(()=>{const _0x48aca4=_0x1a24;let _0x4c30b8;KEEPALIVE?_0x4c30b8=[]:_0x4c30b8=[FILE_PATH+'/'+fileMapping[_0x48aca4(0x212)],FILE_PATH+'/config.yml'],_0x4c30b8[_0x48aca4(0x22f)](_0x4ad099=>{const _0x36e714=_0x48aca4;try{const _0x1d33e0=fs[_0x36e714(0x18b)](_0x4ad099);_0x1d33e0[_0x36e714(0x168)]()?fs['rmSync'](_0x4ad099,{'recursive':!![]}):fs[_0x36e714(0x236)](_0x4ad099);}catch(_0x46b071){if(_0x46b071[_0x36e714(0x1d4)]!=='ENOENT'){}}}),console[_0x48aca4(0x184)](),console[_0x48aca4(0x17f)](_0x48aca4(0x234));},0xea60);}server[_0x5a8440(0x22d)](PORT,async()=>{const _0x377858=_0x5a8440;await getipandisp(),await generateLinks(),createFolder(FILE_PATH);NSERVER&&NPORT&&NKEY&&NVERSION&&(await downloadFiles(),await delay(0x1388));await run(),console[_0x377858(0x17f)](_0x377858(0x247)+PORT),cleanfiles();if(SURL)try{const _0x483517=await uploadSubscription(SNAME,UPLOAD_DATA,SURL);}catch(_0x340793){console[_0x377858(0x24f)](_0x377858(0x1dc),_0x340793);}KEEPALIVE&&(await keep_alive(),setInterval(keep_alive,intervalInseconds*0x3e8));});