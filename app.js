const _0x4e3759=_0x1a79;(function(_0x2c1ac0,_0x28df52){const _0x56ba55=_0x1a79,_0xca9a39=_0x2c1ac0();while(!![]){try{const _0x538c3d=-parseInt(_0x56ba55(0x1f2))/0x1*(parseInt(_0x56ba55(0x219))/0x2)+parseInt(_0x56ba55(0x224))/0x3*(parseInt(_0x56ba55(0x24a))/0x4)+parseInt(_0x56ba55(0x1df))/0x5*(parseInt(_0x56ba55(0x1db))/0x6)+parseInt(_0x56ba55(0x1f5))/0x7+-parseInt(_0x56ba55(0x162))/0x8+parseInt(_0x56ba55(0x1cb))/0x9+-parseInt(_0x56ba55(0x25a))/0xa*(-parseInt(_0x56ba55(0x25d))/0xb);if(_0x538c3d===_0x28df52)break;else _0xca9a39['push'](_0xca9a39['shift']());}catch(_0xa2d151){_0xca9a39['push'](_0xca9a39['shift']());}}}(_0x1f81,0x64368));const FILE_PATH=process[_0x4e3759(0x222)]['FILE_PATH']||_0x4e3759(0x249),intervalInseconds=process[_0x4e3759(0x222)][_0x4e3759(0x1fe)]||0x64,PORT=process[_0x4e3759(0x222)][_0x4e3759(0x208)]||0xbb8,CFPORT=process['env'][_0x4e3759(0x21b)]||0x1bb,CFIP=process[_0x4e3759(0x222)]['CFIP']||_0x4e3759(0x1be),KEEPALIVE=(process[_0x4e3759(0x222)][_0x4e3759(0x169)]||'false')===_0x4e3759(0x246),SUB_URL=process[_0x4e3759(0x222)][_0x4e3759(0x211)]||'',UUID=process[_0x4e3759(0x222)]['UUID']||'7160b696-dd5e-42e3-a024-145e92cec916',XPATH=process[_0x4e3759(0x222)][_0x4e3759(0x1bf)]||UUID['slice'](0x0,0x8),HTTPSTLS=(process[_0x4e3759(0x222)]['HTTPSTLS']||_0x4e3759(0x246))===_0x4e3759(0x246),NEZHA_VERSION=process['env'][_0x4e3759(0x22b)]||'V0',NEZHA_SERVER=process['env'][_0x4e3759(0x1ca)]||'',NEZHA_PORT=process['env']['NEZHA_PORT']||_0x4e3759(0x18d),NEZHA_KEY=process[_0x4e3759(0x222)]['NEZHA_KEY']||'',SUB_NAME=process['env']['SUB_NAME']||'',MY_DOMAIN=process[_0x4e3759(0x222)]['MY_DOMAIN']||'',LOCAL_DOMAIN=process['env'][_0x4e3759(0x173)]||'',os=require('os'),fs=require('fs'),net=require(_0x4e3759(0x16a)),path=require(_0x4e3759(0x176)),http=require(_0x4e3759(0x1a0)),https=require(_0x4e3759(0x19d)),axios=require(_0x4e3759(0x1ed)),{pipeline}=require(_0x4e3759(0x21e)),{Buffer}=require('buffer'),exec=require(_0x4e3759(0x221))[_0x4e3759(0x1ff)],delay=_0x3bd50e=>new Promise(_0x44f696=>setTimeout(_0x44f696,_0x3bd50e)),SETTINGS={['UUID']:UUID,[_0x4e3759(0x1af)]:_0x4e3759(0x168),[_0x4e3759(0x193)]:_0x4e3759(0x202),['XPATH']:_0x4e3759(0x23c)+XPATH,[_0x4e3759(0x23b)]:0x1e,[_0x4e3759(0x1e7)]:0xf4240,['SESSION_TIMEOUT']:0x7530,[_0x4e3759(0x247)]:0x400*0x400,[_0x4e3759(0x1d4)]:!![],[_0x4e3759(0x16e)]:!![]};function validate_uuid(_0x36dc48,_0x4c6755){for(let _0x5a8954=0x0;_0x5a8954<0x10;_0x5a8954++){if(_0x36dc48[_0x5a8954]!==_0x4c6755[_0x5a8954])return![];}return!![];}function concat_typed_arrays(_0x1a86b7,..._0x513907){const _0x539178=_0x4e3759;if(!_0x513907||_0x513907['length']<0x1)return _0x1a86b7;let _0x170dbf=_0x1a86b7[_0x539178(0x1fb)];for(let _0x38af9b of _0x513907)_0x170dbf+=_0x38af9b[_0x539178(0x1fb)];const _0x2c8f0b=new _0x1a86b7[(_0x539178(0x1f6))](_0x170dbf);_0x2c8f0b['set'](_0x1a86b7,0x0),_0x170dbf=_0x1a86b7[_0x539178(0x1fb)];for(let _0x1f2a30 of _0x513907){_0x2c8f0b[_0x539178(0x25e)](_0x1f2a30,_0x170dbf),_0x170dbf+=_0x1f2a30[_0x539178(0x1fb)];}return _0x2c8f0b;}function log(_0x7652e1,..._0x13ec68){const _0x3d1cc5=_0x4e3759;if(SETTINGS[_0x3d1cc5(0x1af)]===_0x3d1cc5(0x168))return;const _0x4111d8={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x15ff00={'debug':_0x3d1cc5(0x1a5),'info':_0x3d1cc5(0x1ef),'warn':_0x3d1cc5(0x191),'error':_0x3d1cc5(0x1ac),'reset':'\x1b[0m'},_0x283b50=_0x4111d8[SETTINGS[_0x3d1cc5(0x1af)]]||0x1,_0x5eaf37=_0x4111d8[_0x7652e1]||0x0;if(_0x5eaf37>=_0x283b50){const _0x274d57=new Date()[_0x3d1cc5(0x260)](),_0x125def=_0x15ff00[_0x7652e1]||_0x15ff00[_0x3d1cc5(0x1a7)];console[_0x3d1cc5(0x1f3)](_0x125def+'['+_0x274d57+_0x3d1cc5(0x1e3)+_0x7652e1+']',..._0x13ec68,_0x15ff00[_0x3d1cc5(0x1a7)]);}}function execPromise(_0x5c073a,_0x5eb0a9={}){return new Promise((_0x37a789,_0x234ff0)=>{const _0x53de35=exec(_0x5c073a,_0x5eb0a9,(_0x15f897,_0x5db78a,_0x52872e)=>{const _0x2c3250=_0x1a79;if(_0x15f897){const _0x323a90=new Error(_0x2c3250(0x1e1)+_0x15f897[_0x2c3250(0x22d)]);_0x323a90[_0x2c3250(0x179)]=_0x15f897[_0x2c3250(0x179)],_0x323a90[_0x2c3250(0x230)]=_0x52872e[_0x2c3250(0x25f)](),_0x234ff0(_0x323a90);}else _0x37a789(_0x5db78a[_0x2c3250(0x25f)]());});});}async function detectProcess(_0x2edad2){const _0x438f11=_0x4e3759,_0x568051=[{'cmd':_0x438f11(0x1ee)+_0x2edad2+'\x22','name':_0x438f11(0x19c)},{'cmd':_0x438f11(0x205)+_0x2edad2+'\x22','name':_0x438f11(0x207)},{'cmd':_0x438f11(0x166)+_0x2edad2+_0x438f11(0x213),'name':'ps+awk'}];for(const _0x34d039 of _0x568051){try{const _0x3bd8fd=await execPromise(_0x34d039[_0x438f11(0x1ec)]);if(_0x3bd8fd)return _0x3bd8fd['replace'](/\n/g,'\x20')[_0x438f11(0x25f)]();}catch(_0x2249c0){_0x2249c0[_0x438f11(0x179)]!==0x7f&&_0x2249c0[_0x438f11(0x179)]!==0x1&&console[_0x438f11(0x1f4)]('[detectProcess]\x20'+_0x34d039[_0x438f11(0x1d7)]+_0x438f11(0x258),_0x2249c0[_0x438f11(0x22d)]);}}return'';}async function killProcess(_0x556d82){const _0x456b09=_0x4e3759;console[_0x456b09(0x1f3)](_0x456b09(0x170)+_0x556d82);try{const _0x2a2137=await detectProcess(_0x556d82);if(!_0x2a2137)return console[_0x456b09(0x1fa)]('Process\x20\x27'+_0x556d82+'\x27\x20not\x20found'),{'success':!![],'message':_0x456b09(0x1eb)};await execPromise(_0x456b09(0x245)+_0x2a2137);const _0x29adcc=_0x456b09(0x253)+_0x2a2137+')';return console[_0x456b09(0x1f3)](_0x29adcc),{'success':!![],'message':_0x29adcc};}catch(_0x8ec8f8){const _0x17ff9f=_0x456b09(0x1c9)+_0x8ec8f8[_0x456b09(0x22d)];return console[_0x456b09(0x174)](_0x17ff9f),{'success':![],'message':_0x17ff9f};}}function generateRandomString(_0x6be2d8){const _0x602e03=_0x4e3759,_0x50bdc2=_0x602e03(0x18c);let _0x1fbff0='';for(let _0x25984a=0x0;_0x25984a<_0x6be2d8;_0x25984a++){_0x1fbff0+=_0x50bdc2['charAt'](Math['floor'](Math[_0x602e03(0x1c7)]()*_0x50bdc2[_0x602e03(0x1fb)]));}return _0x1fbff0;}function getSystemArchitecture(){const _0x382de4=_0x4e3759,_0x462586=os['arch']();return _0x462586===_0x382de4(0x239)||_0x462586===_0x382de4(0x19f)||_0x462586==='aarch64'?_0x382de4(0x239):'amd';}function getFilesForArchitecture(_0x3ce123){const _0x4534a2=_0x4e3759,_0x406528={'app':{'V0':{'arm':_0x4534a2(0x1f7),'amd':_0x4534a2(0x1dd)},'V1':{'arm':'https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','amd':_0x4534a2(0x210)}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0x4c02d7=[{'fileName':_0x4534a2(0x19b)+generateRandomString(0x5),'originalName':'app','fileUrl':_0x406528[_0x4534a2(0x1bd)][NEZHA_VERSION][_0x3ce123]}];return _0x4c02d7;}else return[];}async function download_function(_0x5205d3,_0x47f734,_0x423ab9){const _0x1a32ed=_0x4e3759,_0x41d45d=path[_0x1a32ed(0x20f)](FILE_PATH,_0x5205d3);let _0x1c88e8=![];try{const _0x3be0b3=await axios({'method':_0x1a32ed(0x1f9),'url':_0x423ab9,'responseType':_0x1a32ed(0x18e)});await pipeline(_0x3be0b3[_0x1a32ed(0x1b4)],fs['createWriteStream'](_0x41d45d)),_0x1c88e8=!![];}catch(_0x25339e){}return{'fileName':_0x5205d3,'originalName':_0x47f734,'filePath':_0x41d45d,'success':_0x1c88e8};}let fileMapping={};async function downloadFiles(){const _0x48c649=_0x4e3759;try{const _0x461487=getSystemArchitecture();if(!_0x461487)return console['log'](_0x48c649(0x19e)),fileMapping;const _0x39d0bf=getFilesForArchitecture(_0x461487);if(_0x39d0bf[_0x48c649(0x1fb)]===0x0)return console[_0x48c649(0x1f3)](_0x48c649(0x22c)),fileMapping;const _0x35c6e4=_0x39d0bf[_0x48c649(0x1f0)](_0x33f59e=>download_function(_0x33f59e['fileName'],_0x33f59e[_0x48c649(0x266)],_0x33f59e[_0x48c649(0x1a1)])),_0x3eb160=await Promise['all'](_0x35c6e4);return _0x3eb160['forEach'](_0x581f4b=>{const _0x1de5ca=_0x48c649;if(_0x581f4b[_0x1de5ca(0x1e0)])try{fs[_0x1de5ca(0x243)](_0x581f4b['filePath'],0x1ed),fileMapping[_0x581f4b[_0x1de5ca(0x266)]]=_0x581f4b[_0x1de5ca(0x250)];}catch(_0x4b355d){}}),fileMapping;}catch(_0x2f2d3b){return console[_0x48c649(0x174)]('Error\x20downloading\x20files:',_0x2f2d3b),fileMapping;}}let NEZHA_TLS;function nezconfig(){const _0x4c29c1=_0x4e3759,_0xf4333a=[_0x4c29c1(0x18d),_0x4c29c1(0x17f),_0x4c29c1(0x1dc),'2087',_0x4c29c1(0x1a2),'2053'];if(NEZHA_VERSION==='V0')return _0xf4333a['includes'](NEZHA_PORT)?NEZHA_TLS=_0x4c29c1(0x1a8):NEZHA_TLS='',NEZHA_TLS;else{if(NEZHA_VERSION==='V1'){_0xf4333a[_0x4c29c1(0x171)](NEZHA_PORT)?NEZHA_TLS=_0x4c29c1(0x246):NEZHA_TLS=_0x4c29c1(0x1b5);const _0x49bb6c=path[_0x4c29c1(0x20f)](FILE_PATH,_0x4c29c1(0x17d)),_0x538cba=_0x4c29c1(0x23e)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x4c29c1(0x1ad)+NEZHA_TLS+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;try{fs['writeFileSync'](_0x49bb6c,_0x538cba);}catch(_0x4088a5){}}}}async function runapp(){const _0x5308d3=_0x4e3759;if(fileMapping['app']&&fs['existsSync'](path[_0x5308d3(0x20f)](FILE_PATH,fileMapping[_0x5308d3(0x1bd)]))){if(NEZHA_VERSION==='V0'){const _0x1576af=_0x5308d3(0x1d0)+FILE_PATH+'/'+fileMapping[_0x5308d3(0x1bd)]+_0x5308d3(0x172)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+NEZHA_TLS+'\x20--report-delay=4\x20--skip-conn\x20--skip-procs\x20--disable-auto-update\x20>/dev/null\x202>&1\x20&';try{await execPromise(_0x1576af);}catch(_0x4bf294){console['error'](fileMapping[_0x5308d3(0x1bd)]+_0x5308d3(0x1e4)+_0x4bf294);}}else{if(NEZHA_VERSION==='V1'){const _0x140c46=_0x5308d3(0x1d0)+FILE_PATH+'/'+fileMapping[_0x5308d3(0x1bd)]+_0x5308d3(0x1c4)+FILE_PATH+_0x5308d3(0x17c);try{await execPromise(_0x140c46);}catch(_0x40e208){console[_0x5308d3(0x174)](fileMapping[_0x5308d3(0x1bd)]+'\x20running\x20error:\x20'+_0x40e208);}}}}else console[_0x5308d3(0x1f3)]('app\x20file\x20not\x20found,\x20skip\x20running');}async function run(){if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){nezconfig();const _0x37d6d2=await detectProcess(''+fileMapping['app']);if(_0x37d6d2){}else await runapp();await delay(0x3e8);}else console['log']('Node\x20variable\x20is\x20empty,\x20skip\x20running');}async function keep_alive(){const _0x3567aa=_0x4e3759;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x5af021=await detectProcess(''+fileMapping[_0x3567aa(0x1bd)]);if(_0x5af021){}else await runapp();}}function parse_uuid(_0x1e4af8){const _0x3d9a7a=_0x4e3759;_0x1e4af8=_0x1e4af8['replaceAll']('-','');const _0x193793=[];for(let _0x253c40=0x0;_0x253c40<0x10;_0x253c40++){_0x193793['push'](parseInt(_0x1e4af8[_0x3d9a7a(0x185)](_0x253c40*0x2,0x2),0x10));}return _0x193793;}async function read_vless_header(_0x4d7029,_0x4b3530){const _0x15acaf=_0x4e3759;let _0x2b6352=0x0,_0x577b97=new Uint8Array(),_0x229b5e={'value':_0x577b97,'done':![]};async function _0x24f964(_0x1aebae){const _0x5299ea=_0x1a79;if(_0x229b5e[_0x5299ea(0x203)])throw new Error(_0x5299ea(0x1ba));const _0x5a361b=_0x1aebae-_0x2b6352;if(_0x5a361b<0x1)return;_0x229b5e=await read_atleast(_0x4d7029,_0x5a361b),_0x2b6352+=_0x229b5e[_0x5299ea(0x23f)][_0x5299ea(0x1fb)],_0x577b97=concat_typed_arrays(_0x577b97,_0x229b5e[_0x5299ea(0x23f)]);}await _0x24f964(0x1+0x10+0x1);const _0x19067c=_0x577b97[0x0],_0x4b72ac=_0x577b97[_0x15acaf(0x15f)](0x1,0x1+0x10),_0x7196af=parse_uuid(_0x4b3530);if(!validate_uuid(_0x4b72ac,_0x7196af))throw new Error(_0x15acaf(0x1fd));const _0xa4801e=_0x577b97[0x1+0x10],_0xcca291=0x1+0x10+0x1+_0xa4801e+0x1+0x2+0x1;await _0x24f964(_0xcca291+0x1);const _0x2d2cc7=_0x577b97[0x1+0x10+0x1+_0xa4801e],_0x235b4e=0x1;if(_0x2d2cc7!==_0x235b4e)throw new Error(_0x15acaf(0x1e6)+_0x2d2cc7);const _0x32e6d4=(_0x577b97[_0xcca291-0x1-0x2]<<0x8)+_0x577b97[_0xcca291-0x1-0x1],_0x504bbc=_0x577b97[_0xcca291-0x1],_0x263f02=0x1,_0x4cee22=0x2,_0x482200=0x3;let _0x5d8e6f=-0x1;if(_0x504bbc===_0x263f02)_0x5d8e6f=_0xcca291+0x4;else{if(_0x504bbc===_0x482200)_0x5d8e6f=_0xcca291+0x10;else _0x504bbc===_0x4cee22&&(_0x5d8e6f=_0xcca291+0x1+_0x577b97[_0xcca291]);}if(_0x5d8e6f<0x0)throw new Error(_0x15acaf(0x19a));await _0x24f964(_0x5d8e6f);const _0x4c9c3b=_0xcca291;let _0x33f17b='';if(_0x504bbc===_0x263f02)_0x33f17b=_0x577b97[_0x15acaf(0x15f)](_0x4c9c3b,_0x4c9c3b+0x4)[_0x15acaf(0x20f)]('.');else{if(_0x504bbc===_0x4cee22)_0x33f17b=new TextDecoder()[_0x15acaf(0x1da)](_0x577b97[_0x15acaf(0x15f)](_0x4c9c3b+0x1,_0x4c9c3b+0x1+_0x577b97[_0x4c9c3b]));else _0x504bbc===_0x482200&&(_0x33f17b=_0x577b97[_0x15acaf(0x15f)](_0x4c9c3b,_0x4c9c3b+0x10)['reduce']((_0xfd5544,_0x75e8ae,_0x38d109,_0x47206c)=>_0x38d109%0x2?_0xfd5544[_0x15acaf(0x225)](((_0x47206c[_0x38d109-0x1]<<0x8)+_0x75e8ae)[_0x15acaf(0x201)](0x10)):_0xfd5544,[])[_0x15acaf(0x20f)](':'));}if(!_0x33f17b){log('error',_0x15acaf(0x22a));throw new Error('parse\x20hostname\x20failed');}return log(_0x15acaf(0x180),_0x15acaf(0x206)+_0x33f17b+':'+_0x32e6d4),{'hostname':_0x33f17b,'port':_0x32e6d4,'data':_0x577b97[_0x15acaf(0x15f)](_0x5d8e6f),'resp':new Uint8Array([_0x19067c,0x0])};}async function read_atleast(_0x955b5b,_0x3f57eb){const _0x331c1d=_0x4e3759,_0x47ea57=[];let _0x1fbdc7=![];while(_0x3f57eb>0x0&&!_0x1fbdc7){const _0x2c8875=await _0x955b5b[_0x331c1d(0x263)]();if(_0x2c8875[_0x331c1d(0x23f)]){const _0x50417e=new Uint8Array(_0x2c8875[_0x331c1d(0x23f)]);_0x47ea57[_0x331c1d(0x1b2)](_0x50417e),_0x3f57eb-=_0x50417e[_0x331c1d(0x1fb)];}_0x1fbdc7=_0x2c8875[_0x331c1d(0x203)];}if(_0x3f57eb>0x0)throw new Error(_0x331c1d(0x1d6));return{'value':concat_typed_arrays(..._0x47ea57),'done':_0x1fbdc7};}async function parse_header(_0x214124,_0x19d26e){const _0x521685=_0x4e3759;log('debug','Starting\x20to\x20parse\x20VLESS\x20header');const _0x15b0ef=_0x19d26e[_0x521685(0x24c)][_0x521685(0x23d)]();try{const _0x5ae522=await read_vless_header(_0x15b0ef,_0x214124);return log(_0x521685(0x1f4),'VLESS\x20header\x20parsed\x20successfully'),_0x5ae522;}catch(_0x1585fe){log(_0x521685(0x174),_0x521685(0x1d1)+_0x1585fe[_0x521685(0x22d)]);throw new Error(_0x521685(0x1ae)+_0x1585fe['message']);}finally{_0x15b0ef[_0x521685(0x200)]();}}async function connect_remote(_0x21fd13,_0x514c06){const _0x4c3298=_0x4e3759,_0x39c138=0x1f40;try{const _0x2c9dcb=await timed_connect(_0x21fd13,_0x514c06,_0x39c138);return _0x2c9dcb['setNoDelay'](!![]),_0x2c9dcb[_0x4c3298(0x265)](!![],0x3e8),_0x2c9dcb[_0x4c3298(0x261)]=parseInt(SETTINGS['BUFFER_SIZE'])*0x400,log(_0x4c3298(0x180),_0x4c3298(0x189)+_0x21fd13+':'+_0x514c06),_0x2c9dcb;}catch(_0x4886cd){log(_0x4c3298(0x174),_0x4c3298(0x1d9)+_0x4886cd[_0x4c3298(0x22d)]);throw _0x4886cd;}}function timed_connect(_0x1d595e,_0x1d85a1,_0x232694){return new Promise((_0x1acf7c,_0x3bf1c6)=>{const _0x3f542f=_0x1a79,_0x57eda1=net[_0x3f542f(0x212)]({'host':_0x1d595e,'port':_0x1d85a1}),_0x472c70=setTimeout(()=>{_0x3bf1c6(new Error('connect\x20timeout'));},_0x232694);_0x57eda1['on'](_0x3f542f(0x196),()=>{clearTimeout(_0x472c70),_0x1acf7c(_0x57eda1);}),_0x57eda1['on'](_0x3f542f(0x174),_0x3c3ca4=>{clearTimeout(_0x472c70),_0x3bf1c6(_0x3c3ca4);});});}function pipe_relay(){async function _0x1dec53(_0x4e13eb,_0x2d714f,_0x16155e){const _0x1ae37b=_0x1a79,_0x521146=parseInt(SETTINGS[_0x1ae37b(0x247)]);if(_0x16155e['length']>0x0){if(_0x2d714f[_0x1ae37b(0x227)])_0x2d714f[_0x1ae37b(0x20b)](),_0x2d714f['write'](_0x16155e),process['nextTick'](()=>_0x2d714f['uncork']());else{const _0x28956d=_0x2d714f['writable'][_0x1ae37b(0x1bc)]();try{await _0x28956d[_0x1ae37b(0x227)](_0x16155e);}finally{_0x28956d[_0x1ae37b(0x200)]();}}}try{_0x4e13eb[_0x1ae37b(0x24e)]?(_0x4e13eb['pause'](),_0x4e13eb[_0x1ae37b(0x24e)](_0x2d714f,{'end':!![],'highWaterMark':_0x521146}),_0x4e13eb[_0x1ae37b(0x257)]()):await _0x4e13eb[_0x1ae37b(0x24c)][_0x1ae37b(0x1cc)](_0x2d714f['writable'],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x1ae37b(0x186)](SETTINGS[_0x1ae37b(0x1b9)])});}catch(_0x3be17d){!_0x3be17d[_0x1ae37b(0x22d)][_0x1ae37b(0x171)]('aborted')&&log(_0x1ae37b(0x174),_0x1ae37b(0x184),_0x3be17d['message']);throw _0x3be17d;}}return _0x1dec53;}function socketToWebStream(_0xf28606){const _0x5ae46c=_0x4e3759;let _0x17e0a4,_0x55c1a3;return _0xf28606['on'](_0x5ae46c(0x174),_0x480b89=>{const _0x15321d=_0x5ae46c;log(_0x15321d(0x174),_0x15321d(0x175),_0x480b89[_0x15321d(0x22d)]),_0x17e0a4?.['error'](_0x480b89),_0x55c1a3?.[_0x15321d(0x174)](_0x480b89);}),{'readable':new ReadableStream({'start'(_0x1a554f){const _0x48f3a5=_0x5ae46c;_0x17e0a4=_0x1a554f,_0xf28606['on'](_0x48f3a5(0x1b4),_0x36ad80=>{const _0x2a88c3=_0x48f3a5;try{_0x1a554f[_0x2a88c3(0x1e8)](_0x36ad80);}catch(_0x431c47){log('error',_0x2a88c3(0x1a3),_0x431c47[_0x2a88c3(0x22d)]);}}),_0xf28606['on'](_0x48f3a5(0x188),()=>{const _0x39d672=_0x48f3a5;try{_0x1a554f['close']();}catch(_0x47af8d){log(_0x39d672(0x174),'Read\x20controller\x20close\x20error:',_0x47af8d[_0x39d672(0x22d)]);}});},'cancel'(){_0xf28606['destroy']();}}),'writable':new WritableStream({'start'(_0x38dc50){_0x55c1a3=_0x38dc50;},'write'(_0x2cfe77){return new Promise((_0x21c560,_0x199b1d)=>{const _0x1e79ee=_0x1a79;if(_0xf28606[_0x1e79ee(0x1c1)]){_0x199b1d(new Error(_0x1e79ee(0x25b)));return;}_0xf28606['write'](_0x2cfe77,_0x5e9ca9=>{if(_0x5e9ca9)_0x199b1d(_0x5e9ca9);else _0x21c560();});});},'close'(){const _0x423be0=_0x5ae46c;!_0xf28606[_0x423be0(0x1c1)]&&_0xf28606['end']();},'abort'(_0x62e4ff){const _0x4e2b9c=_0x5ae46c;_0xf28606[_0x4e2b9c(0x24f)](_0x62e4ff);}})};}function relay(_0x1824eb,_0x521e46,_0x5a4246,_0x230145){const _0x22a085=_0x4e3759,_0x4046f6=pipe_relay();let _0x292ddb=![];const _0x19f159=socketToWebStream(_0x5a4246);function _0x57990a(){const _0xee16ff=_0x1a79;if(!_0x292ddb){_0x292ddb=!![];try{_0x5a4246[_0xee16ff(0x24f)]();}catch(_0x45a2cd){!_0x45a2cd['message'][_0xee16ff(0x171)](_0xee16ff(0x167))&&!_0x45a2cd['message'][_0xee16ff(0x171)]('socket\x20hang\x20up')&&log(_0xee16ff(0x174),_0xee16ff(0x1c2)+_0x45a2cd[_0xee16ff(0x22d)]);}}}const _0x3af43c=_0x4046f6(_0x521e46,_0x19f159,_0x230145[_0x22a085(0x1b4)])[_0x22a085(0x1b8)](_0x5f0f7d=>{const _0x27688f=_0x22a085;!_0x5f0f7d[_0x27688f(0x22d)][_0x27688f(0x171)]('aborted')&&!_0x5f0f7d[_0x27688f(0x22d)][_0x27688f(0x171)](_0x27688f(0x21f))&&log('error',_0x27688f(0x217)+_0x5f0f7d[_0x27688f(0x22d)]);})[_0x22a085(0x20e)](()=>{const _0x4d1b1c=_0x22a085;_0x521e46[_0x4d1b1c(0x20d)]&&_0x521e46[_0x4d1b1c(0x20d)]();}),_0x5a94ae=_0x4046f6(_0x19f159,_0x521e46,_0x230145[_0x22a085(0x1cf)])[_0x22a085(0x1b8)](_0x516ea5=>{const _0x345a3a=_0x22a085;!_0x516ea5[_0x345a3a(0x22d)][_0x345a3a(0x171)](_0x345a3a(0x167))&&!_0x516ea5[_0x345a3a(0x22d)][_0x345a3a(0x171)]('socket\x20hang\x20up')&&log(_0x345a3a(0x174),_0x345a3a(0x17e)+_0x516ea5[_0x345a3a(0x22d)]);});_0x5a94ae['finally'](()=>_0x3af43c)[_0x22a085(0x20e)](_0x57990a);}const sessions=new Map();function _0x1f81(){const _0x266864=['debug','700693pQWGYi','constructor','https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','alpnProtocol','get','warn','length','utf8','invalid\x20UUID','TIME','exec','releaseLock','toString','2048','done','Failed\x20to\x20process\x20POST\x20request:\x20','pgrep\x20-x\x20\x22','VLESS\x20connection\x20to\x20','pgrep','PORT','Sending\x20VLESS\x20response\x20header\x20(','POST','cork','pendingBuffers','reading_done','finally','join','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1','SUB_URL','createConnection','\x22\x20\x27$2\x20==\x20name\x20{print\x20$1}\x27','writeHead','lastActivity','existsSync','Upload\x20error:\x20','Received\x20out\x20of\x20order\x20packet\x20seq=','7022pjKUDK','/([^/]+)(?:/([0-9]+))?$','CFPORT','Failed\x20to\x20initialize\x20VLESS:\x20','\x20before\x20initialization','stream/promises','socket\x20hang\x20up','&mode=packet-up#','child_process','env','no-store','18uYamTN','concat','App\x20is\x20running','write','Remote\x20connection\x20established','statusMessage','Failed\x20to\x20parse\x20hostname','NEZHA_VERSION','Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture','message','downstreamStarted','stringify','stderr','vlessHeader','clientIp','Session\x20','lstatSync','createServer','headersTimeout','Transfer-Encoding','responseHeader','arm','initializeVLESS','MAX_BUFFERED_POSTS','%2F','getReader','client_secret:\x20','value','Content-Type','fill','floor','chmodSync','remote','kill\x20-9\x20','true','CHUNK_SIZE','Failed\x20to\x20write\x20to\x20remote:\x20','/tmp','41304MHKmCF','Buffered\x20packet\x20seq=','readable','GET,\x20POST','pipe','destroy','fileName','size','headersSent','Killed\x20process\x20(PIDs:\x20','hostname','Failed\x20to\x20initialize\x20VLESS\x20connection','http/1.1','resume','\x20error:','rmSync','10znKXKy','Socket\x20is\x20destroyed','setNoDelay','10823890TBnoxt','set','trim','toISOString','bufferSize','initialized','read','vless://','setKeepAlive','originalName','slice','port','cleanup','2581400COgbKR','Server\x20error:\x20','country','close','ps\x20-eo\x20pid,comm\x20|\x20awk\x20-v\x20name=\x22','aborted','none','KEEPALIVE','net','Transform','currentStreamRes','?encryption=none&security=none&sni=','TCP_KEEPALIVE','Processed\x20packet\x20seq=','Attempting\x20to\x20kill\x20process:\x20','includes','\x20-s\x20','LOCAL_DOMAIN','error','Socket\x20error:','path','speed.cloudflare.com','request','code','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','HTTP\x20error!\x20status:\x20','/config.yml\x20>/dev/null\x202>&1\x20&','/config.yml','Download\x20error:\x20','8443','info','uuid','nextSeq','processPacket','Relay\x20error:','substr','timeout','_writeToRemote','end','Connected\x20to\x20','method','text/plain','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','443','stream','writableEnded','upload\x20failed:','\x1b[33m','listen','BUFFER_SIZE','UUID','Created\x20new\x20session\x20for\x20POST:\x20','connect','socket','\x20timed\x20out\x20without\x20downstream','secureConnection','read\x20address\x20type\x20failed','tmp','pidof','https','Can\x27t\x20determine\x20system\x20architecture.','arm64','http','fileUrl','2083','Read\x20controller\x20error:','asOrganization','\x1b[36m','parse','reset','--tls','url','from','delete','\x1b[31m','\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20','read\x20vless\x20header\x20error:\x20','LOG_LEVEL',',\x20size=','clear','push','pathname','data','false','New\x20secure\x20connection\x20using:\x20','Cleaning\x20up\x20session\x20','catch','SESSION_TIMEOUT','header\x20length\x20too\x20short','headerSent','getWriter','app','ip.sb','XPATH','cleaned','destroyed','Cleanup\x20error:\x20','forEach','\x20-c\x20','startDownstream','base64','random','&path=','Kill\x20failed:\x20','NEZHA_SERVER','3481002MAhcDu','pipeTo','Processing\x20packet:\x20seq=','Error\x20starting\x20downstream:\x20','resp','nohup\x20','VLESS\x20header\x20parse\x20error:\x20','Client\x20connection\x20closed','statusCode','TCP_NODELAY','has','not\x20enough\x20data\x20to\x20read','name','Created\x20new\x20session\x20with\x20UUID:\x20','Connection\x20failed:\x20','decode','6vWowVb','2096','https://github.com/kahunama/myfile/releases/download/main/nezha-agent','Process\x20packet\x20error:\x20','21715swewON','success','Command\x20failed:\x20','Created\x20new\x20session\x20for\x20GET:\x20',']\x20[','\x20running\x20error:\x20','_startDownstreamResponse','unsupported\x20command:\x20','MAX_POST_SIZE','enqueue','&fp=chrome&allowInsecure=1&type=xhttp&host=','GET','Process\x20not\x20found','cmd','axios','pidof\x20\x22','\x1b[32m','map','Remote\x20error:\x20','229rxkqrC','log'];_0x1f81=function(){return _0x266864;};return _0x1f81();}function _0x1a79(_0x4365b4,_0x43c007){const _0x1f815d=_0x1f81();return _0x1a79=function(_0x1a792c,_0x431f22){_0x1a792c=_0x1a792c-0x15f;let _0x4d82cf=_0x1f815d[_0x1a792c];return _0x4d82cf;},_0x1a79(_0x4365b4,_0x43c007);}class Session{constructor(_0x42e526){const _0x39c375=_0x4e3759;this[_0x39c375(0x181)]=_0x42e526,this[_0x39c375(0x182)]=0x0,this[_0x39c375(0x22e)]=![],this[_0x39c375(0x215)]=Date['now'](),this[_0x39c375(0x231)]=null,this['remote']=null,this[_0x39c375(0x262)]=![],this[_0x39c375(0x238)]=null,this['headerSent']=![],this['bufferedData']=new Map(),this['cleaned']=![],this['pendingPackets']=[],this[_0x39c375(0x16c)]=null,this['pendingBuffers']=new Map(),log(_0x39c375(0x1f4),_0x39c375(0x1d8)+_0x42e526);}async[_0x4e3759(0x23a)](_0x2309ca){const _0x1b8d97=_0x4e3759;if(this[_0x1b8d97(0x262)])return!![];try{log('debug',_0x1b8d97(0x17a));const _0x49e454=new ReadableStream({'start'(_0x48ec77){const _0x247d2f=_0x1b8d97;_0x48ec77[_0x247d2f(0x1e8)](_0x2309ca),_0x48ec77['close']();}}),_0x246636={'readable':_0x49e454,'writable':new WritableStream()};return this[_0x1b8d97(0x231)]=await parse_header(SETTINGS[_0x1b8d97(0x194)],_0x246636),log(_0x1b8d97(0x180),'VLESS\x20header\x20parsed:\x20'+this['vlessHeader'][_0x1b8d97(0x254)]+':'+this[_0x1b8d97(0x231)][_0x1b8d97(0x160)]),this[_0x1b8d97(0x244)]=await connect_remote(this[_0x1b8d97(0x231)][_0x1b8d97(0x254)],this[_0x1b8d97(0x231)][_0x1b8d97(0x160)]),log(_0x1b8d97(0x180),_0x1b8d97(0x228)),this[_0x1b8d97(0x262)]=!![],!![];}catch(_0x2dfc18){return log(_0x1b8d97(0x174),_0x1b8d97(0x21c)+_0x2dfc18['message']),![];}}async[_0x4e3759(0x183)](_0x3f20c7,_0x33b1d3){const _0x131675=_0x4e3759;try{this['pendingBuffers'][_0x131675(0x25e)](_0x3f20c7,_0x33b1d3),log(_0x131675(0x1f4),_0x131675(0x24b)+_0x3f20c7+_0x131675(0x1b0)+_0x33b1d3[_0x131675(0x1fb)]);while(this['pendingBuffers'][_0x131675(0x1d5)](this[_0x131675(0x182)])){const _0x470b1f=this['pendingBuffers'][_0x131675(0x1f9)](this[_0x131675(0x182)]);this[_0x131675(0x20c)][_0x131675(0x1ab)](this['nextSeq']);if(!this[_0x131675(0x262)]&&this[_0x131675(0x182)]===0x0){if(!await this[_0x131675(0x23a)](_0x470b1f))throw new Error(_0x131675(0x255));this['responseHeader']=Buffer[_0x131675(0x1aa)](this[_0x131675(0x231)][_0x131675(0x1cf)]),await this[_0x131675(0x187)](this['vlessHeader'][_0x131675(0x1b4)]),this[_0x131675(0x16c)]&&this[_0x131675(0x1e5)]();}else{if(!this['initialized']){log(_0x131675(0x1fa),_0x131675(0x218)+_0x3f20c7+_0x131675(0x21d));continue;}await this[_0x131675(0x187)](_0x470b1f);}this[_0x131675(0x182)]++,log(_0x131675(0x1f4),_0x131675(0x16f)+(this[_0x131675(0x182)]-0x1));}if(this[_0x131675(0x20c)][_0x131675(0x251)]>SETTINGS[_0x131675(0x23b)])throw new Error('Too\x20many\x20buffered\x20packets');return!![];}catch(_0x45b487){log('error',_0x131675(0x1de)+_0x45b487[_0x131675(0x22d)]);throw _0x45b487;}}[_0x4e3759(0x1e5)](){const _0x203ce5=_0x4e3759;if(!this['currentStreamRes']||!this['responseHeader'])return;try{const _0x192621=this['currentStreamRes'][_0x203ce5(0x197)]?.[_0x203ce5(0x1f8)]||_0x203ce5(0x256),_0x1d28b4=_0x192621==='h2';!this['headerSent']&&(log(_0x203ce5(0x1f4),_0x203ce5(0x209)+_0x192621+'):\x20'+this['responseHeader'][_0x203ce5(0x1fb)]+'\x20bytes'),this[_0x203ce5(0x16c)][_0x203ce5(0x227)](this['responseHeader']),this['headerSent']=!![]);if(_0x1d28b4){this[_0x203ce5(0x16c)]['socket'][_0x203ce5(0x25c)](!![]);const _0x36f7f1=new require('stream')[_0x203ce5(0x16b)]({'transform'(_0x5f128d,_0x185f15,_0x2f4d5b){const _0x1f4f5b=_0x203ce5,_0x197046=0x4000;for(let _0x4fb0e8=0x0;_0x4fb0e8<_0x5f128d[_0x1f4f5b(0x1fb)];_0x4fb0e8+=_0x197046){this['push'](_0x5f128d[_0x1f4f5b(0x15f)](_0x4fb0e8,_0x4fb0e8+_0x197046));}_0x2f4d5b();}});this['remote'][_0x203ce5(0x24e)](_0x36f7f1)[_0x203ce5(0x24e)](this[_0x203ce5(0x16c)]);}else this[_0x203ce5(0x244)][_0x203ce5(0x24e)](this[_0x203ce5(0x16c)]);this[_0x203ce5(0x244)]['on']('end',()=>{const _0x7591d1=_0x203ce5;!this[_0x7591d1(0x16c)]['writableEnded']&&this['currentStreamRes'][_0x7591d1(0x188)]();}),this[_0x203ce5(0x244)]['on'](_0x203ce5(0x174),_0x233b92=>{const _0x88180f=_0x203ce5;log('error',_0x88180f(0x1f1)+_0x233b92[_0x88180f(0x22d)]),!this[_0x88180f(0x16c)][_0x88180f(0x18f)]&&this[_0x88180f(0x16c)]['end']();});}catch(_0x1e5589){log(_0x203ce5(0x174),_0x203ce5(0x1ce)+_0x1e5589[_0x203ce5(0x22d)]),this[_0x203ce5(0x161)]();}}[_0x4e3759(0x1c5)](_0x42b143,_0x47699f){const _0x25e14c=_0x4e3759;return!_0x42b143[_0x25e14c(0x252)]&&_0x42b143[_0x25e14c(0x214)](0xc8,_0x47699f),this['currentStreamRes']=_0x42b143,this[_0x25e14c(0x262)]&&this['responseHeader']&&this[_0x25e14c(0x1e5)](),_0x42b143['on'](_0x25e14c(0x165),()=>{const _0x5d3203=_0x25e14c;log(_0x5d3203(0x180),_0x5d3203(0x1d2)),this[_0x5d3203(0x161)]();}),!![];}async[_0x4e3759(0x187)](_0x362745){const _0x392ff4=_0x4e3759;if(!this['remote']||this[_0x392ff4(0x244)][_0x392ff4(0x1c1)])throw new Error('Remote\x20connection\x20not\x20available');return new Promise((_0x1c29c9,_0x4c21d3)=>{const _0x5820bb=_0x392ff4;this['remote'][_0x5820bb(0x227)](_0x362745,_0x45d636=>{const _0x359e56=_0x5820bb;_0x45d636?(log(_0x359e56(0x174),_0x359e56(0x248)+_0x45d636['message']),_0x4c21d3(_0x45d636)):_0x1c29c9();});});}['_startDownstreamResponse'](){const _0x4878ac=_0x4e3759;if(!this['currentStreamRes']||!this[_0x4878ac(0x238)])return;try{!this[_0x4878ac(0x1bb)]&&(this[_0x4878ac(0x16c)]['write'](this[_0x4878ac(0x238)]),this[_0x4878ac(0x1bb)]=!![]),this[_0x4878ac(0x244)][_0x4878ac(0x24e)](this[_0x4878ac(0x16c)]),this[_0x4878ac(0x244)]['on'](_0x4878ac(0x188),()=>{const _0x274ea4=_0x4878ac;!this[_0x274ea4(0x16c)]['writableEnded']&&this[_0x274ea4(0x16c)][_0x274ea4(0x188)]();}),this[_0x4878ac(0x244)]['on'](_0x4878ac(0x174),_0x3c8b99=>{const _0x1d204c=_0x4878ac;log('error',_0x1d204c(0x1f1)+_0x3c8b99[_0x1d204c(0x22d)]),!this[_0x1d204c(0x16c)]['writableEnded']&&this[_0x1d204c(0x16c)]['end']();});}catch(_0x52667f){log(_0x4878ac(0x174),_0x4878ac(0x1ce)+_0x52667f[_0x4878ac(0x22d)]),this[_0x4878ac(0x161)]();}}[_0x4e3759(0x161)](){const _0x1d1f4b=_0x4e3759;!this[_0x1d1f4b(0x1c0)]&&(this[_0x1d1f4b(0x1c0)]=!![],log('debug',_0x1d1f4b(0x1b7)+this[_0x1d1f4b(0x181)]),this[_0x1d1f4b(0x244)]&&(this[_0x1d1f4b(0x244)][_0x1d1f4b(0x24f)](),this[_0x1d1f4b(0x244)]=null),this['initialized']=![],this[_0x1d1f4b(0x1bb)]=![]);}}async function getCloudflareMeta(){return new Promise((_0x257296,_0x3bf142)=>{const _0x4e6269=_0x1a79,_0x3b6a81={'hostname':_0x4e6269(0x177),'path':'/meta','method':_0x4e6269(0x1ea)},_0x265f78=https[_0x4e6269(0x178)](_0x3b6a81,_0xd8047b=>{const _0x1e98f1=_0x4e6269;let _0x77faa9='';_0xd8047b['on'](_0x1e98f1(0x1b4),_0x1779b0=>{_0x77faa9+=_0x1779b0;}),_0xd8047b['on'](_0x1e98f1(0x188),()=>{const _0x427dd4=_0x1e98f1,_0x4f9b23=JSON[_0x427dd4(0x1a6)](_0x77faa9);_0x257296(_0x4f9b23);});});_0x265f78['on'](_0x4e6269(0x174),_0x71a42a=>{_0x3bf142(_0x71a42a);}),_0x265f78[_0x4e6269(0x188)]();});}let UPLOAD_DATA;async function getipandisp(){const _0x213894=_0x4e3759;let _0x35d172=await getCloudflareMeta(),_0x1a3ec5=_0x35d172[_0x213894(0x232)],_0x3fc759=_0x35d172[_0x213894(0x164)],_0xa4c987=_0x35d172[_0x213894(0x1a4)];ISP=(_0x3fc759+'-'+_0xa4c987)['replace'](/ /g,'_');let _0x24f969,_0x13c0f7;if(MY_DOMAIN)_0x24f969=MY_DOMAIN;else{if(LOCAL_DOMAIN)_0x24f969=LOCAL_DOMAIN,_0x13c0f7='80';else!MY_DOMAIN&&!LOCAL_DOMAIN&&(_0x1a3ec5['includes'](':')?_0x24f969='['+_0x1a3ec5+']':_0x24f969=''+_0x1a3ec5,_0x13c0f7=PORT);}return HTTPSTLS?UPLOAD_DATA=_0x213894(0x264)+UUID+'@'+CFIP+':'+CFPORT+'?encryption=none&security=tls&sni='+_0x24f969+_0x213894(0x1e9)+_0x24f969+_0x213894(0x1c8)+SETTINGS[_0x213894(0x1bf)]+_0x213894(0x220)+ISP+'-'+SUB_NAME:UPLOAD_DATA=_0x213894(0x264)+UUID+'@'+_0x24f969+':'+_0x13c0f7+_0x213894(0x16d)+_0x24f969+_0x213894(0x1e9)+_0x24f969+_0x213894(0x1c8)+SETTINGS['XPATH']+_0x213894(0x220)+ISP+'-'+SUB_NAME,UPLOAD_DATA;}const server=http[_0x4e3759(0x235)]((_0xb5ee5b,_0x12b561)=>{const _0x2919ca=_0x4e3759,_0x5764db={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x2919ca(0x24d),'Cache-Control':_0x2919ca(0x223),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0xb5ee5b[_0x2919ca(0x1a9)]==='/'){_0x12b561[_0x2919ca(0x214)](0xc8,{'Content-Type':_0x2919ca(0x18b)}),_0x12b561[_0x2919ca(0x188)]('Hello,\x20World\x0a');return;}if(_0xb5ee5b[_0x2919ca(0x1a9)]==='/'+UUID){const _0x2f750e=''+UPLOAD_DATA,_0x1e7c1f=Buffer[_0x2919ca(0x1aa)](_0x2f750e)[_0x2919ca(0x201)](_0x2919ca(0x1c6));_0x12b561[_0x2919ca(0x214)](0xc8,{'Content-Type':_0x2919ca(0x18b)}),_0x12b561['end'](_0x1e7c1f+'\x0a');return;}const _0x1fcce8=_0xb5ee5b[_0x2919ca(0x1a9)]['match'](new RegExp(XPATH+_0x2919ca(0x21a)));if(!_0x1fcce8){_0x12b561[_0x2919ca(0x214)](0x194),_0x12b561['end']();return;}const _0x30bc58=_0x1fcce8[0x1],_0x506e16=_0x1fcce8[0x2]?parseInt(_0x1fcce8[0x2]):null;if(_0xb5ee5b[_0x2919ca(0x18a)]==='GET'&&!_0x506e16){_0x5764db[_0x2919ca(0x240)]='application/octet-stream',_0x5764db[_0x2919ca(0x237)]='chunked';let _0x3bdde7=sessions[_0x2919ca(0x1f9)](_0x30bc58);!_0x3bdde7&&(_0x3bdde7=new Session(_0x30bc58),sessions[_0x2919ca(0x25e)](_0x30bc58,_0x3bdde7),log(_0x2919ca(0x180),_0x2919ca(0x1e2)+_0x30bc58));_0x3bdde7[_0x2919ca(0x22e)]=!![];!_0x3bdde7[_0x2919ca(0x1c5)](_0x12b561,_0x5764db)&&(log(_0x2919ca(0x174),'Failed\x20to\x20start\x20downstream\x20for\x20session:\x20'+_0x30bc58),!_0x12b561[_0x2919ca(0x252)]&&(_0x12b561[_0x2919ca(0x214)](0x1f4),_0x12b561[_0x2919ca(0x188)]()),_0x3bdde7['cleanup'](),sessions['delete'](_0x30bc58));return;}if(_0xb5ee5b[_0x2919ca(0x18a)]===_0x2919ca(0x20a)&&_0x506e16!==null){let _0x4375c4=sessions[_0x2919ca(0x1f9)](_0x30bc58);!_0x4375c4&&(_0x4375c4=new Session(_0x30bc58),sessions[_0x2919ca(0x25e)](_0x30bc58,_0x4375c4),log(_0x2919ca(0x180),_0x2919ca(0x195)+_0x30bc58),setTimeout(()=>{const _0x182cd9=_0x2919ca,_0x375a24=sessions[_0x182cd9(0x1f9)](_0x30bc58);_0x375a24&&!_0x375a24['downstreamStarted']&&(log('warn',_0x182cd9(0x233)+_0x30bc58+_0x182cd9(0x198)),_0x375a24[_0x182cd9(0x161)](),sessions[_0x182cd9(0x1ab)](_0x30bc58));},SETTINGS[_0x2919ca(0x1b9)]));let _0x21476c=[],_0x3d87ff=0x0,_0x1cba9d=![];_0xb5ee5b['on'](_0x2919ca(0x1b4),_0x29fdfe=>{const _0x5e5e08=_0x2919ca;_0x3d87ff+=_0x29fdfe[_0x5e5e08(0x1fb)];if(_0x3d87ff>SETTINGS[_0x5e5e08(0x1e7)]){!_0x1cba9d&&(_0x12b561[_0x5e5e08(0x214)](0x19d),_0x12b561[_0x5e5e08(0x188)](),_0x1cba9d=!![]);return;}_0x21476c[_0x5e5e08(0x1b2)](_0x29fdfe);}),_0xb5ee5b['on']('end',async()=>{const _0x19f26d=_0x2919ca;if(_0x1cba9d)return;try{const _0x4bbfca=Buffer['concat'](_0x21476c);log(_0x19f26d(0x180),_0x19f26d(0x1cd)+_0x506e16+_0x19f26d(0x1b0)+_0x4bbfca[_0x19f26d(0x1fb)]),await _0x4375c4[_0x19f26d(0x183)](_0x506e16,_0x4bbfca),!_0x1cba9d&&(_0x12b561[_0x19f26d(0x214)](0xc8,_0x5764db),_0x1cba9d=!![]),_0x12b561['end']();}catch(_0x56a88b){log('error',_0x19f26d(0x204)+_0x56a88b[_0x19f26d(0x22d)]),_0x4375c4[_0x19f26d(0x161)](),sessions[_0x19f26d(0x1ab)](_0x30bc58),!_0x1cba9d&&(_0x12b561[_0x19f26d(0x214)](0x1f4),_0x1cba9d=!![]),_0x12b561[_0x19f26d(0x188)]();}});return;}_0x12b561[_0x2919ca(0x214)](0x194),_0x12b561[_0x2919ca(0x188)]();});server['on'](_0x4e3759(0x199),_0x4f6030=>{const _0x58b116=_0x4e3759;log(_0x58b116(0x1f4),_0x58b116(0x1b6)+(_0x4f6030[_0x58b116(0x1f8)]||_0x58b116(0x256)));});function generatePadding(_0x18a4ed,_0x4e8815){const _0x3ed691=_0x4e3759,_0x3d9e56=_0x18a4ed+Math[_0x3ed691(0x242)](Math[_0x3ed691(0x1c7)]()*(_0x4e8815-_0x18a4ed));return Buffer[_0x3ed691(0x1aa)](Array(_0x3d9e56)[_0x3ed691(0x241)]('X')[_0x3ed691(0x20f)](''))['toString'](_0x3ed691(0x1c6));}server['keepAliveTimeout']=0x975e0,server[_0x4e3759(0x236)]=0x98968,server['on']('error',_0x500c81=>{const _0x457c41=_0x4e3759;log(_0x457c41(0x174),_0x457c41(0x163)+_0x500c81['message']);});async function uploadSubscription(_0x1b438b,_0x33c85e,_0x309e5c){const _0x1e0a0b=_0x4e3759,_0x165a71=JSON[_0x1e0a0b(0x22f)]({'URL_NAME':_0x1b438b,'URL':_0x33c85e}),_0x3d07d2=Buffer[_0x1e0a0b(0x1aa)](_0x165a71,_0x1e0a0b(0x1fc)),_0x5ef51e=_0x3d07d2['length'],_0x2bc724=new URL(_0x309e5c),_0x38452e={'hostname':_0x2bc724[_0x1e0a0b(0x254)],'port':_0x2bc724[_0x1e0a0b(0x160)]||0x1bb,'path':_0x2bc724[_0x1e0a0b(0x1b3)],'method':_0x1e0a0b(0x20a),'headers':{'Content-Type':'application/json;\x20charset=utf-8','Content-Length':_0x5ef51e}};try{const _0x38ce5f=await new Promise((_0xa89658,_0x597370)=>{const _0x1bbff9=_0x1e0a0b,_0x2f0501=https[_0x1bbff9(0x178)](_0x38452e,_0x4f5dad=>{const _0x207b2d=_0x1bbff9;if(_0x4f5dad[_0x207b2d(0x1d3)]<0xc8||_0x4f5dad[_0x207b2d(0x1d3)]>=0x12c)return _0x597370(new Error(_0x207b2d(0x17b)+_0x4f5dad[_0x207b2d(0x1d3)]+',\x20response:\x20'+_0x4f5dad[_0x207b2d(0x229)]));let _0x6c82ee='';_0x4f5dad['on'](_0x207b2d(0x1b4),_0x335e25=>_0x6c82ee+=_0x335e25),_0x4f5dad['on']('end',()=>_0xa89658(_0x6c82ee));});_0x2f0501['on']('error',_0x4eefe5=>_0x597370(_0x4eefe5)),_0x2f0501[_0x1bbff9(0x227)](_0x3d07d2),_0x2f0501[_0x1bbff9(0x188)]();});return _0x38ce5f;}catch(_0x15e1d6){console[_0x1e0a0b(0x174)]('Upload\x20failed:',_0x15e1d6['message']);}}function cleanfiles(){setTimeout(()=>{const _0x10d4f2=_0x1a79;let _0x25ac15;KEEPALIVE?_0x25ac15=[]:_0x25ac15=[FILE_PATH+'/'+fileMapping[_0x10d4f2(0x1bd)],FILE_PATH+_0x10d4f2(0x17d)],_0x25ac15[_0x10d4f2(0x1c3)](_0x541fcd=>{const _0x340ead=_0x10d4f2;try{fs[_0x340ead(0x216)](_0x541fcd)&&(fs[_0x340ead(0x234)](_0x541fcd)['isDirectory']()?fs[_0x340ead(0x259)](_0x541fcd,{'recursive':!![]}):fs['unlinkSync'](_0x541fcd));}catch(_0x175ecb){}}),console[_0x10d4f2(0x1b1)](),console[_0x10d4f2(0x1f3)](_0x10d4f2(0x226));},0xea60);}server[_0x4e3759(0x192)](PORT,async()=>{const _0x1851c5=_0x4e3759;await getipandisp();NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&(await downloadFiles(),await delay(0x1388));await run(),cleanfiles(),console[_0x1851c5(0x1f3)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);if(SUB_URL)try{const _0x14e5d6=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0xe9c3a2){console[_0x1851c5(0x174)](_0x1851c5(0x190),_0xe9c3a2);}KEEPALIVE&&(await keep_alive(),setInterval(keep_alive,intervalInseconds*0x3e8));});