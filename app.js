const _0x16635f=_0x82d5;(function(_0x27729b,_0x4f7c2d){const _0x330ebc=_0x82d5,_0x5df6b8=_0x27729b();while(!![]){try{const _0x5d015d=parseInt(_0x330ebc(0x1df))/0x1*(-parseInt(_0x330ebc(0x10b))/0x2)+parseInt(_0x330ebc(0xd7))/0x3+parseInt(_0x330ebc(0x1d4))/0x4*(-parseInt(_0x330ebc(0x1cc))/0x5)+parseInt(_0x330ebc(0x153))/0x6*(-parseInt(_0x330ebc(0x109))/0x7)+-parseInt(_0x330ebc(0x180))/0x8*(parseInt(_0x330ebc(0x121))/0x9)+-parseInt(_0x330ebc(0x123))/0xa*(-parseInt(_0x330ebc(0x17d))/0xb)+parseInt(_0x330ebc(0x11b))/0xc;if(_0x5d015d===_0x4f7c2d)break;else _0x5df6b8['push'](_0x5df6b8['shift']());}catch(_0x4c445c){_0x5df6b8['push'](_0x5df6b8['shift']());}}}(_0x1f0c,0xbfa9c));const FILE_PATH=process[_0x16635f(0x191)][_0x16635f(0xdc)]||'/tmp',intervalInseconds=process[_0x16635f(0x191)]['TIME']||0x64,PORT=process[_0x16635f(0x191)][_0x16635f(0x1ab)]||0xbb8,CFPORT=process[_0x16635f(0x191)][_0x16635f(0x176)]||0x1bb,CFIP=process[_0x16635f(0x191)][_0x16635f(0x158)]||_0x16635f(0x104),KEEPALIVE=process['env']['KEEPALIVE']===_0x16635f(0x179),SUB_URL=process['env'][_0x16635f(0xf2)]||'',UUID=process['env']['UUID']||_0x16635f(0x1d6),XPATH=process['env']['XPATH']||UUID[_0x16635f(0x1a1)](0x0,0x8),HTTPSTLS=process['env'][_0x16635f(0x155)]==='true',NEZHA_VERSION=process[_0x16635f(0x191)]['NEZHA_VERSION']||'V0',NEZHA_SERVER=process[_0x16635f(0x191)][_0x16635f(0x194)]||'',NEZHA_PORT=process[_0x16635f(0x191)][_0x16635f(0x117)]||_0x16635f(0x170),NEZHA_KEY=process['env'][_0x16635f(0x196)]||'',SUB_NAME=process['env'][_0x16635f(0x1a4)]||'',MY_DOMAIN=process[_0x16635f(0x191)][_0x16635f(0x1ca)]||'',LOCAL_DOMAIN=process[_0x16635f(0x191)][_0x16635f(0x1a6)]||'',os=require('os'),fs=require('fs'),net=require('net'),path=require(_0x16635f(0x115)),http=require(_0x16635f(0x13a)),https=require('https'),axios=require(_0x16635f(0x1a7)),{pipeline}=require(_0x16635f(0xe6)),{Buffer}=require('buffer'),exec=require(_0x16635f(0xd3))[_0x16635f(0x152)],delay=_0x4b3a76=>new Promise(_0x4c3909=>setTimeout(_0x4c3909,_0x4b3a76)),SETTINGS={['UUID']:UUID,['LOG_LEVEL']:'none',[_0x16635f(0x139)]:_0x16635f(0x131),[_0x16635f(0x15d)]:'%2F'+XPATH,[_0x16635f(0xdf)]:0x1e,[_0x16635f(0x1ce)]:0xf4240,[_0x16635f(0x11d)]:0x7530,[_0x16635f(0x1ba)]:0x400*0x400,[_0x16635f(0xdb)]:!![],[_0x16635f(0x16f)]:!![]};function validate_uuid(_0x110bb7,_0x4d3c4b){for(let _0x2edd69=0x0;_0x2edd69<0x10;_0x2edd69++){if(_0x110bb7[_0x2edd69]!==_0x4d3c4b[_0x2edd69])return![];}return!![];}function concat_typed_arrays(_0x2f37e7,..._0x45b8a6){const _0x38fea1=_0x16635f;if(!_0x45b8a6||_0x45b8a6['length']<0x1)return _0x2f37e7;let _0x15a12c=_0x2f37e7[_0x38fea1(0x144)];for(let _0x195903 of _0x45b8a6)_0x15a12c+=_0x195903['length'];const _0x1c21a1=new _0x2f37e7[(_0x38fea1(0x1a2))](_0x15a12c);_0x1c21a1[_0x38fea1(0x18c)](_0x2f37e7,0x0),_0x15a12c=_0x2f37e7['length'];for(let _0x38cdbc of _0x45b8a6){_0x1c21a1[_0x38fea1(0x18c)](_0x38cdbc,_0x15a12c),_0x15a12c+=_0x38cdbc['length'];}return _0x1c21a1;}function log(_0x2f4935,..._0x4b8d26){const _0x5b216f=_0x16635f;if(SETTINGS['LOG_LEVEL']==='none')return;const _0x1e94f4={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x376c93={'debug':_0x5b216f(0x149),'info':_0x5b216f(0x169),'warn':_0x5b216f(0x14e),'error':_0x5b216f(0xeb),'reset':'\x1b[0m'},_0x504137=_0x1e94f4[SETTINGS[_0x5b216f(0x14f)]]||0x1,_0x4d4f87=_0x1e94f4[_0x2f4935]||0x0;if(_0x4d4f87>=_0x504137){const _0x53eeac=new Date()[_0x5b216f(0x186)](),_0x16d4c8=_0x376c93[_0x2f4935]||_0x376c93[_0x5b216f(0x1b6)];console[_0x5b216f(0x134)](_0x16d4c8+'['+_0x53eeac+']\x20['+_0x2f4935+']',..._0x4b8d26,_0x376c93[_0x5b216f(0x1b6)]);}}function execPromise(_0x15f1aa,_0x3e79f0={}){return new Promise((_0x467218,_0x207cf6)=>{const _0x934ce5=exec(_0x15f1aa,_0x3e79f0,(_0x4e9e1f,_0xea5355,_0x70e934)=>{const _0x68b613=_0x82d5;if(_0x4e9e1f){const _0x3af0ab=new Error('Command\x20failed:\x20'+_0x4e9e1f[_0x68b613(0x1d3)]);_0x3af0ab[_0x68b613(0x1e0)]=_0x4e9e1f[_0x68b613(0x1e0)],_0x3af0ab[_0x68b613(0x1d7)]=_0x70e934[_0x68b613(0x185)](),_0x207cf6(_0x3af0ab);}else _0x467218(_0xea5355[_0x68b613(0x185)]());});});}async function detectProcess(_0x3ea47e){const _0x219268=_0x16635f,_0x9e9b53=[{'cmd':_0x219268(0x18e)+_0x3ea47e+'\x22','name':_0x219268(0x164)},{'cmd':_0x219268(0xff)+_0x3ea47e+'\x22','name':_0x219268(0x107)},{'cmd':'ps\x20-eo\x20pid,comm\x20|\x20awk\x20-v\x20name=\x22'+_0x3ea47e+_0x219268(0x128),'name':_0x219268(0x146)}];for(const _0x345128 of _0x9e9b53){try{const _0x276a65=await execPromise(_0x345128[_0x219268(0xd8)]);if(_0x276a65)return _0x276a65[_0x219268(0x10e)](/\n/g,'\x20')[_0x219268(0x185)]();}catch(_0x52cf20){_0x52cf20[_0x219268(0x1e0)]!==0x7f&&_0x52cf20[_0x219268(0x1e0)]!==0x1&&console[_0x219268(0x102)](_0x219268(0x197)+_0x345128[_0x219268(0x192)]+_0x219268(0x11e),_0x52cf20[_0x219268(0x1d3)]);}}return'';}async function killProcess(_0x5aa29d){const _0x262edc=_0x16635f;console[_0x262edc(0x134)]('Attempting\x20to\x20kill\x20process:\x20'+_0x5aa29d);try{const _0x1de4f7=await detectProcess(_0x5aa29d);if(!_0x1de4f7)return console['warn'](_0x262edc(0xd9)+_0x5aa29d+_0x262edc(0x1e1)),{'success':!![],'message':_0x262edc(0x103)};await execPromise(_0x262edc(0x1a3)+_0x1de4f7);const _0x3e0d43=_0x262edc(0xd0)+_0x1de4f7+')';return console['log'](_0x3e0d43),{'success':!![],'message':_0x3e0d43};}catch(_0xffeebf){const _0x37b53a=_0x262edc(0x189)+_0xffeebf[_0x262edc(0x1d3)];return console[_0x262edc(0x13e)](_0x37b53a),{'success':![],'message':_0x37b53a};}}function generateRandomString(_0x46697d){const _0x2b0649=_0x16635f,_0xf53ce2=_0x2b0649(0x126);let _0x1228c3='';for(let _0x195c68=0x0;_0x195c68<_0x46697d;_0x195c68++){_0x1228c3+=_0xf53ce2[_0x2b0649(0x1d1)](Math[_0x2b0649(0xe9)](Math[_0x2b0649(0x15c)]()*_0xf53ce2[_0x2b0649(0x144)]));}return _0x1228c3;}function getSystemArchitecture(){const _0x4a54d9=_0x16635f,_0x569e26=os['arch']();return _0x569e26===_0x4a54d9(0x100)||_0x569e26===_0x4a54d9(0x1b2)||_0x569e26===_0x4a54d9(0x1c2)?_0x4a54d9(0x100):_0x4a54d9(0x130);}function getFilesForArchitecture(_0x121376){const _0x390329=_0x16635f,_0x4ead0d={'app':{'V0':{'arm':_0x390329(0x11a),'amd':_0x390329(0x12d)},'V1':{'arm':_0x390329(0xfa),'amd':_0x390329(0x171)}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0x3b1907=[{'fileName':_0x390329(0x12e)+generateRandomString(0x5),'originalName':'app','fileUrl':_0x4ead0d[_0x390329(0x1e3)][NEZHA_VERSION][_0x121376]}];return _0x3b1907;}else return[];}async function download_function(_0x2385f0,_0x4b0be4,_0x8056f9){const _0x3f5069=_0x16635f,_0x59b7ff=path[_0x3f5069(0x1da)](FILE_PATH,_0x2385f0);let _0x5618c8=![];try{const _0xc4a418=await axios({'method':'get','url':_0x8056f9,'responseType':'stream'});await pipeline(_0xc4a418['data'],fs['createWriteStream'](_0x59b7ff)),_0x5618c8=!![];}catch(_0x1bb391){}return{'fileName':_0x2385f0,'originalName':_0x4b0be4,'filePath':_0x59b7ff,'success':_0x5618c8};}let fileMapping={};async function downloadFiles(){const _0x295987=_0x16635f;try{const _0x8dd0c5=getSystemArchitecture();if(!_0x8dd0c5)return console[_0x295987(0x134)](_0x295987(0x17e)),fileMapping;const _0x2c53f8=getFilesForArchitecture(_0x8dd0c5);if(_0x2c53f8['length']===0x0)return console[_0x295987(0x134)]('Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture'),fileMapping;const _0x47bfdb=_0x2c53f8[_0x295987(0x148)](_0x31eebd=>download_function(_0x31eebd[_0x295987(0x163)],_0x31eebd['originalName'],_0x31eebd['fileUrl'])),_0x54656d=await Promise[_0x295987(0xe2)](_0x47bfdb);return _0x54656d[_0x295987(0x183)](_0x19744f=>{const _0x551af5=_0x295987;if(_0x19744f[_0x551af5(0x162)])try{fs[_0x551af5(0x150)](_0x19744f[_0x551af5(0x1c3)],0x1ed),fileMapping[_0x19744f[_0x551af5(0xea)]]=_0x19744f[_0x551af5(0x163)];}catch(_0x556a2f){}}),fileMapping;}catch(_0x4a57c1){return console[_0x295987(0x13e)](_0x295987(0x177),_0x4a57c1),fileMapping;}}let NEZHA_TLS;function _0x1f0c(){const _0x45e6af=['http/1.1','Upload\x20failed:','downstreamStarted','read\x20address\x20type\x20failed','aarch64','filePath','speed.cloudflare.com','close','UUID','info','Session\x20','setKeepAlive','MY_DOMAIN','socket\x20hang\x20up','122665eRHsvR','invalid\x20UUID','MAX_POST_SIZE','GET,\x20POST','aborted','charAt','size','message','216gJmLEl','\x20-s\x20','7160b696-dd5e-42e3-a024-145e92cec916','stderr','Relay\x20error:','2083','join','/config.yml\x20>/dev/null\x202>&1\x20&','cleaned','connect','pathname','20081usGfqu','code','\x27\x20not\x20found','fill','app','uncork','\x20bytes','initialized','Killed\x20process\x20(PIDs:\x20','pendingPackets','value','child_process','country','base64','writeHead','3294222ZyzxNK','cmd','Process\x20\x27','Remote\x20connection\x20not\x20available','TCP_NODELAY','FILE_PATH','application/json;\x20charset=utf-8','bufferedData','MAX_BUFFERED_POSTS',',\x20size=','url','all','POST','VLESS\x20connection\x20to\x20','GET','stream/promises','&fp=chrome&allowInsecure=1&type=xhttp&host=','pipeTo','floor','originalName','\x1b[31m','?encryption=none&security=tls&sni=','vlessHeader','Process\x20packet\x20error:\x20','connect\x20timeout','setNoDelay','now','SUB_URL','decode','getReader','push','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','currentStreamRes','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','concat','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','chunked','application/octet-stream','Read\x20controller\x20close\x20error:','port','pgrep\x20-x\x20\x22','arm','writableEnded','debug','Process\x20not\x20found','ip.sb','clientIp','statusMessage','pgrep','/config.yml','50953IXkJdu','VLESS\x20header\x20parsed:\x20','58LADuri','uuid','&mode=packet-up#','replace','Connected\x20to\x20','data','writeFileSync','\x20before\x20initialization','\x20--report-delay=4\x20--skip-conn\x20--skip-procs\x20--disable-auto-update\x20>/dev/null\x202>&1\x20&','end','path','Failed\x20to\x20process\x20POST\x20request:\x20','NEZHA_PORT','statusCode','nohup\x20','https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','22464144IfIJwL','resp','SESSION_TIMEOUT','\x20error:','client_secret:\x20','timeout','3148317DCrSMG','cleanup','3930470jFZZeT','unlinkSync','HTTP\x20error!\x20status:\x20','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','\x20running\x20error:\x20','\x22\x20\x27$2\x20==\x20name\x20{print\x20$1}\x27','VLESS\x20header\x20parsed\x20successfully','/meta','write','lastActivity','https://github.com/kahunama/myfile/releases/download/main/nezha-agent','tmp','2053','amd','2048','8443','&path=','log','parse','includes','/([^/]+)(?:/([0-9]+))?$','Hello,\x20World\x0a','BUFFER_SIZE','http','read','done','startDownstream','error','app\x20file\x20not\x20found,\x20skip\x20running','has','Processed\x20packet\x20seq=','Processing\x20packet:\x20seq=','unsupported\x20command:\x20','length','enqueue','ps+awk','keepAliveTimeout','map','\x1b[36m','Node\x20variable\x20is\x20empty,\x20skip\x20running','utf8','header\x20length\x20too\x20short','replaceAll','\x1b[33m','LOG_LEVEL','chmodSync','pendingBuffers','exec','12pcDZNM','remote','HTTPSTLS','Remote\x20error:\x20','Created\x20new\x20session\x20with\x20UUID:\x20','CFIP','New\x20secure\x20connection\x20using:\x20','initializeVLESS','bufferSize','random','XPATH','nextSeq','stringify','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','toString','success','fileName','pidof','reading_done','upload\x20failed:','resume','request','\x1b[32m','Buffered\x20packet\x20seq=','Content-Type','headerSent','Socket\x20error:','Created\x20new\x20session\x20for\x20POST:\x20','TCP_KEEPALIVE','443','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1','readable','Transfer-Encoding','nextTick','VLESS\x20header\x20parse\x20error:\x20','CFPORT','Error\x20downloading\x20files:','Cleaning\x20up\x20session\x20','true','from','listen','read\x20vless\x20header\x20error:\x20','22WINgTT','Can\x27t\x20determine\x20system\x20architecture.','responseHeader','24zLfuNm','Received\x20out\x20of\x20order\x20packet\x20seq=','pipe','forEach','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','trim','toISOString','finally','Client\x20connection\x20closed','Kill\x20failed:\x20','releaseLock','hostname','set','Created\x20new\x20session\x20for\x20GET:\x20','pidof\x20\x22','processPacket','getWriter','env','name','Starting\x20to\x20parse\x20VLESS\x20header','NEZHA_SERVER','\x20-c\x20','NEZHA_KEY','[detectProcess]\x20','socket','Failed\x20to\x20write\x20to\x20remote:\x20','headersTimeout','headersSent','\x20timed\x20out\x20without\x20downstream','destroyed','Upload\x20error:\x20','vless://','get','slice','constructor','kill\x20-9\x20','SUB_NAME','lstatSync','LOCAL_DOMAIN','axios','existsSync','warn','secureConnection','PORT','Error\x20starting\x20downstream:\x20','alpnProtocol','_writeToRemote','_startDownstreamResponse','parse\x20hostname\x20failed','no-store','arm64','--tls','asOrganization','method','reset','createConnection','delete','text/plain','CHUNK_SIZE','stream','Failed\x20to\x20initialize\x20VLESS\x20connection','writable'];_0x1f0c=function(){return _0x45e6af;};return _0x1f0c();}function nezconfig(){const _0x505c52=_0x16635f,_0x531c20=[_0x505c52(0x170),_0x505c52(0x132),'2096','2087',_0x505c52(0x1d9),_0x505c52(0x12f)];if(NEZHA_VERSION==='V0')return _0x531c20[_0x505c52(0x136)](NEZHA_PORT)?NEZHA_TLS=_0x505c52(0x1b3):NEZHA_TLS='',NEZHA_TLS;else{if(NEZHA_VERSION==='V1'){_0x531c20[_0x505c52(0x136)](NEZHA_PORT)?NEZHA_TLS='true':NEZHA_TLS='false';const _0xb325db=path[_0x505c52(0x1da)](FILE_PATH,_0x505c52(0x108)),_0x379840=_0x505c52(0x11f)+NEZHA_KEY+_0x505c52(0xf8)+NEZHA_SERVER+':'+NEZHA_PORT+'\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20'+NEZHA_TLS+_0x505c52(0x184)+UUID;try{fs[_0x505c52(0x111)](_0xb325db,_0x379840);}catch(_0x5ab937){}}}}async function runapp(){const _0x36e757=_0x16635f;if(fileMapping['app']&&fs[_0x36e757(0x1a8)](path[_0x36e757(0x1da)](FILE_PATH,fileMapping['app']))){if(NEZHA_VERSION==='V0'){const _0xb47047='nohup\x20'+FILE_PATH+'/'+fileMapping[_0x36e757(0x1e3)]+_0x36e757(0x1d5)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+NEZHA_TLS+_0x36e757(0x113);try{await execPromise(_0xb47047);}catch(_0xc56e22){console[_0x36e757(0x13e)](fileMapping[_0x36e757(0x1e3)]+_0x36e757(0x127)+_0xc56e22);}}else{if(NEZHA_VERSION==='V1'){const _0x585561=_0x36e757(0x119)+FILE_PATH+'/'+fileMapping[_0x36e757(0x1e3)]+_0x36e757(0x195)+FILE_PATH+_0x36e757(0x1db);try{await execPromise(_0x585561);}catch(_0x9d526c){console[_0x36e757(0x13e)](fileMapping['app']+'\x20running\x20error:\x20'+_0x9d526c);}}}}else console[_0x36e757(0x134)](_0x36e757(0x13f));}async function run(){const _0x3dc3f6=_0x16635f;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){nezconfig();const _0x42aa53=await detectProcess(''+fileMapping[_0x3dc3f6(0x1e3)]);if(_0x42aa53){}else await runapp();await delay(0x3e8);}else console[_0x3dc3f6(0x134)](_0x3dc3f6(0x14a));}async function keep_alive(){const _0x289783=_0x16635f;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x16029b=await detectProcess(''+fileMapping[_0x289783(0x1e3)]);if(_0x16029b){}else await runapp();}}function parse_uuid(_0x1bf128){const _0x2e3de7=_0x16635f;_0x1bf128=_0x1bf128[_0x2e3de7(0x14d)]('-','');const _0x38c129=[];for(let _0x2f82c0=0x0;_0x2f82c0<0x10;_0x2f82c0++){_0x38c129[_0x2e3de7(0xf5)](parseInt(_0x1bf128['substr'](_0x2f82c0*0x2,0x2),0x10));}return _0x38c129;}async function read_vless_header(_0x369072,_0x1fa9b7){const _0x4dbee3=_0x16635f;let _0x5d46d4=0x0,_0x192629=new Uint8Array(),_0x1da7ab={'value':_0x192629,'done':![]};async function _0x5747b9(_0x1c3359){const _0x32e753=_0x82d5;if(_0x1da7ab['done'])throw new Error(_0x32e753(0x14c));const _0x206eff=_0x1c3359-_0x5d46d4;if(_0x206eff<0x1)return;_0x1da7ab=await read_atleast(_0x369072,_0x206eff),_0x5d46d4+=_0x1da7ab['value'][_0x32e753(0x144)],_0x192629=concat_typed_arrays(_0x192629,_0x1da7ab[_0x32e753(0xd2)]);}await _0x5747b9(0x1+0x10+0x1);const _0xcd0ad=_0x192629[0x0],_0x460d10=_0x192629[_0x4dbee3(0x1a1)](0x1,0x1+0x10),_0x4d2e80=parse_uuid(_0x1fa9b7);if(!validate_uuid(_0x460d10,_0x4d2e80))throw new Error(_0x4dbee3(0x1cd));const _0x2142c3=_0x192629[0x1+0x10],_0xa24253=0x1+0x10+0x1+_0x2142c3+0x1+0x2+0x1;await _0x5747b9(_0xa24253+0x1);const _0x39ef6b=_0x192629[0x1+0x10+0x1+_0x2142c3],_0x2a3ef2=0x1;if(_0x39ef6b!==_0x2a3ef2)throw new Error(_0x4dbee3(0x143)+_0x39ef6b);const _0x2e706f=(_0x192629[_0xa24253-0x1-0x2]<<0x8)+_0x192629[_0xa24253-0x1-0x1],_0x3bdc65=_0x192629[_0xa24253-0x1],_0x2638a3=0x1,_0x146434=0x2,_0x4dc5d6=0x3;let _0x37f3de=-0x1;if(_0x3bdc65===_0x2638a3)_0x37f3de=_0xa24253+0x4;else{if(_0x3bdc65===_0x4dc5d6)_0x37f3de=_0xa24253+0x10;else _0x3bdc65===_0x146434&&(_0x37f3de=_0xa24253+0x1+_0x192629[_0xa24253]);}if(_0x37f3de<0x0)throw new Error(_0x4dbee3(0x1c1));await _0x5747b9(_0x37f3de);const _0x4beab1=_0xa24253;let _0x317a85='';if(_0x3bdc65===_0x2638a3)_0x317a85=_0x192629[_0x4dbee3(0x1a1)](_0x4beab1,_0x4beab1+0x4)[_0x4dbee3(0x1da)]('.');else{if(_0x3bdc65===_0x146434)_0x317a85=new TextDecoder()[_0x4dbee3(0xf3)](_0x192629[_0x4dbee3(0x1a1)](_0x4beab1+0x1,_0x4beab1+0x1+_0x192629[_0x4beab1]));else _0x3bdc65===_0x4dc5d6&&(_0x317a85=_0x192629[_0x4dbee3(0x1a1)](_0x4beab1,_0x4beab1+0x10)['reduce']((_0x5bb75c,_0x407989,_0x248698,_0xefe586)=>_0x248698%0x2?_0x5bb75c['concat'](((_0xefe586[_0x248698-0x1]<<0x8)+_0x407989)[_0x4dbee3(0x161)](0x10)):_0x5bb75c,[])['join'](':'));}if(!_0x317a85){log(_0x4dbee3(0x13e),'Failed\x20to\x20parse\x20hostname');throw new Error(_0x4dbee3(0x1b0));}return log(_0x4dbee3(0x1c7),_0x4dbee3(0xe4)+_0x317a85+':'+_0x2e706f),{'hostname':_0x317a85,'port':_0x2e706f,'data':_0x192629[_0x4dbee3(0x1a1)](_0x37f3de),'resp':new Uint8Array([_0xcd0ad,0x0])};}async function read_atleast(_0x1ec5bd,_0x5100ce){const _0x8e824a=_0x16635f,_0x133cda=[];let _0x4f83a1=![];while(_0x5100ce>0x0&&!_0x4f83a1){const _0x3b143e=await _0x1ec5bd[_0x8e824a(0x13b)]();if(_0x3b143e[_0x8e824a(0xd2)]){const _0x5ce816=new Uint8Array(_0x3b143e[_0x8e824a(0xd2)]);_0x133cda[_0x8e824a(0xf5)](_0x5ce816),_0x5100ce-=_0x5ce816[_0x8e824a(0x144)];}_0x4f83a1=_0x3b143e[_0x8e824a(0x13c)];}if(_0x5100ce>0x0)throw new Error('not\x20enough\x20data\x20to\x20read');return{'value':concat_typed_arrays(..._0x133cda),'done':_0x4f83a1};}async function parse_header(_0x505db4,_0x473f0e){const _0xdbf108=_0x16635f;log('debug',_0xdbf108(0x193));const _0xbe6a6d=_0x473f0e[_0xdbf108(0x172)][_0xdbf108(0xf4)]();try{const _0x4174b2=await read_vless_header(_0xbe6a6d,_0x505db4);return log(_0xdbf108(0x102),_0xdbf108(0x129)),_0x4174b2;}catch(_0x328254){log(_0xdbf108(0x13e),_0xdbf108(0x175)+_0x328254['message']);throw new Error(_0xdbf108(0x17c)+_0x328254[_0xdbf108(0x1d3)]);}finally{_0xbe6a6d[_0xdbf108(0x18a)]();}}async function connect_remote(_0x2b6164,_0x408b34){const _0x4f0852=_0x16635f,_0x3d2ebd=0x1f40;try{const _0x3e07b5=await timed_connect(_0x2b6164,_0x408b34,_0x3d2ebd);return _0x3e07b5[_0x4f0852(0xf0)](!![]),_0x3e07b5[_0x4f0852(0x1c9)](!![],0x3e8),_0x3e07b5[_0x4f0852(0x15b)]=parseInt(SETTINGS[_0x4f0852(0x139)])*0x400,log(_0x4f0852(0x1c7),_0x4f0852(0x10f)+_0x2b6164+':'+_0x408b34),_0x3e07b5;}catch(_0x3f8315){log(_0x4f0852(0x13e),'Connection\x20failed:\x20'+_0x3f8315['message']);throw _0x3f8315;}}function timed_connect(_0xccfa40,_0x27f7bd,_0x4ca702){return new Promise((_0x51f802,_0x4bce2d)=>{const _0xc2c125=_0x82d5,_0x325cb9=net[_0xc2c125(0x1b7)]({'host':_0xccfa40,'port':_0x27f7bd}),_0x4678ab=setTimeout(()=>{const _0x2c9002=_0xc2c125;_0x4bce2d(new Error(_0x2c9002(0xef)));},_0x4ca702);_0x325cb9['on'](_0xc2c125(0x1dd),()=>{clearTimeout(_0x4678ab),_0x51f802(_0x325cb9);}),_0x325cb9['on'](_0xc2c125(0x13e),_0x28a41d=>{clearTimeout(_0x4678ab),_0x4bce2d(_0x28a41d);});});}function pipe_relay(){async function _0x1c0f94(_0x1c87ee,_0x8c708f,_0x5a0296){const _0x4b5a7a=_0x82d5,_0x1166a1=parseInt(SETTINGS[_0x4b5a7a(0x1ba)]);if(_0x5a0296[_0x4b5a7a(0x144)]>0x0){if(_0x8c708f['write'])_0x8c708f['cork'](),_0x8c708f[_0x4b5a7a(0x12b)](_0x5a0296),process[_0x4b5a7a(0x174)](()=>_0x8c708f[_0x4b5a7a(0x1e4)]());else{const _0x2469ae=_0x8c708f[_0x4b5a7a(0x1bd)][_0x4b5a7a(0x190)]();try{await _0x2469ae[_0x4b5a7a(0x12b)](_0x5a0296);}finally{_0x2469ae[_0x4b5a7a(0x18a)]();}}}try{_0x1c87ee[_0x4b5a7a(0x182)]?(_0x1c87ee['pause'](),_0x1c87ee[_0x4b5a7a(0x182)](_0x8c708f,{'end':!![],'highWaterMark':_0x1166a1}),_0x1c87ee[_0x4b5a7a(0x167)]()):await _0x1c87ee['readable'][_0x4b5a7a(0xe8)](_0x8c708f[_0x4b5a7a(0x1bd)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x4b5a7a(0x120)](SETTINGS[_0x4b5a7a(0x11d)])});}catch(_0xed1818){!_0xed1818['message'][_0x4b5a7a(0x136)](_0x4b5a7a(0x1d0))&&log('error',_0x4b5a7a(0x1d8),_0xed1818['message']);throw _0xed1818;}}return _0x1c0f94;}function _0x82d5(_0x5b9a61,_0x174260){const _0x1f0c41=_0x1f0c();return _0x82d5=function(_0x82d553,_0x26238a){_0x82d553=_0x82d553-0xcf;let _0x1fee50=_0x1f0c41[_0x82d553];return _0x1fee50;},_0x82d5(_0x5b9a61,_0x174260);}function socketToWebStream(_0x410772){let _0x354374,_0x252929;return _0x410772['on']('error',_0x154633=>{const _0xb3f946=_0x82d5;log(_0xb3f946(0x13e),_0xb3f946(0x16d),_0x154633[_0xb3f946(0x1d3)]),_0x354374?.['error'](_0x154633),_0x252929?.[_0xb3f946(0x13e)](_0x154633);}),{'readable':new ReadableStream({'start'(_0x4101d8){const _0x334597=_0x82d5;_0x354374=_0x4101d8,_0x410772['on'](_0x334597(0x110),_0x2e31a7=>{const _0x24319c=_0x334597;try{_0x4101d8[_0x24319c(0x145)](_0x2e31a7);}catch(_0x49aca5){log(_0x24319c(0x13e),'Read\x20controller\x20error:',_0x49aca5[_0x24319c(0x1d3)]);}}),_0x410772['on'](_0x334597(0x114),()=>{const _0x455eec=_0x334597;try{_0x4101d8[_0x455eec(0x1c5)]();}catch(_0x2355b4){log(_0x455eec(0x13e),_0x455eec(0xfd),_0x2355b4[_0x455eec(0x1d3)]);}});},'cancel'(){_0x410772['destroy']();}}),'writable':new WritableStream({'start'(_0x3a4ed4){_0x252929=_0x3a4ed4;},'write'(_0xf3225c){return new Promise((_0x162018,_0x3cb538)=>{const _0x338619=_0x82d5;if(_0x410772[_0x338619(0x19d)]){_0x3cb538(new Error('Socket\x20is\x20destroyed'));return;}_0x410772[_0x338619(0x12b)](_0xf3225c,_0x433d9f=>{if(_0x433d9f)_0x3cb538(_0x433d9f);else _0x162018();});});},'close'(){const _0x4c50d9=_0x82d5;!_0x410772[_0x4c50d9(0x19d)]&&_0x410772['end']();},'abort'(_0x337349){_0x410772['destroy'](_0x337349);}})};}function relay(_0x5b72af,_0x4d6851,_0x34da03,_0x9ba104){const _0x3846fa=_0x16635f,_0xb6c13f=pipe_relay();let _0x2c0fd0=![];const _0x5b3db0=socketToWebStream(_0x34da03);function _0x343e85(){const _0x29bc36=_0x82d5;if(!_0x2c0fd0){_0x2c0fd0=!![];try{_0x34da03['destroy']();}catch(_0x2d6407){!_0x2d6407[_0x29bc36(0x1d3)]['includes']('aborted')&&!_0x2d6407['message']['includes'](_0x29bc36(0x1cb))&&log(_0x29bc36(0x13e),'Cleanup\x20error:\x20'+_0x2d6407[_0x29bc36(0x1d3)]);}}}const _0x102701=_0xb6c13f(_0x4d6851,_0x5b3db0,_0x9ba104[_0x3846fa(0x110)])['catch'](_0x2e078c=>{const _0x543f74=_0x3846fa;!_0x2e078c['message'][_0x543f74(0x136)]('aborted')&&!_0x2e078c[_0x543f74(0x1d3)]['includes']('socket\x20hang\x20up')&&log(_0x543f74(0x13e),_0x543f74(0x19e)+_0x2e078c[_0x543f74(0x1d3)]);})[_0x3846fa(0x187)](()=>{const _0x1674ae=_0x3846fa;_0x4d6851[_0x1674ae(0x165)]&&_0x4d6851[_0x1674ae(0x165)]();}),_0x126229=_0xb6c13f(_0x5b3db0,_0x4d6851,_0x9ba104[_0x3846fa(0x11c)])['catch'](_0x1558b6=>{const _0x14d067=_0x3846fa;!_0x1558b6[_0x14d067(0x1d3)][_0x14d067(0x136)](_0x14d067(0x1d0))&&!_0x1558b6[_0x14d067(0x1d3)][_0x14d067(0x136)]('socket\x20hang\x20up')&&log(_0x14d067(0x13e),'Download\x20error:\x20'+_0x1558b6[_0x14d067(0x1d3)]);});_0x126229[_0x3846fa(0x187)](()=>_0x102701)[_0x3846fa(0x187)](_0x343e85);}const sessions=new Map();class Session{constructor(_0x3283c9){const _0x88aff=_0x16635f;this['uuid']=_0x3283c9,this['nextSeq']=0x0,this['downstreamStarted']=![],this[_0x88aff(0x12c)]=Date[_0x88aff(0xf1)](),this[_0x88aff(0xed)]=null,this['remote']=null,this[_0x88aff(0xcf)]=![],this[_0x88aff(0x17f)]=null,this[_0x88aff(0x16c)]=![],this[_0x88aff(0xde)]=new Map(),this['cleaned']=![],this[_0x88aff(0xd1)]=[],this[_0x88aff(0xf7)]=null,this[_0x88aff(0x151)]=new Map(),log(_0x88aff(0x102),_0x88aff(0x157)+_0x3283c9);}async[_0x16635f(0x15a)](_0x2af3a5){const _0x302bb3=_0x16635f;if(this[_0x302bb3(0xcf)])return!![];try{log(_0x302bb3(0x102),_0x302bb3(0x160));const _0x235ba1=new ReadableStream({'start'(_0x49d14a){const _0x561d6e=_0x302bb3;_0x49d14a[_0x561d6e(0x145)](_0x2af3a5),_0x49d14a['close']();}}),_0x25e04b={'readable':_0x235ba1,'writable':new WritableStream()};return this[_0x302bb3(0xed)]=await parse_header(SETTINGS[_0x302bb3(0x1c6)],_0x25e04b),log(_0x302bb3(0x1c7),_0x302bb3(0x10a)+this['vlessHeader'][_0x302bb3(0x18b)]+':'+this[_0x302bb3(0xed)]['port']),this[_0x302bb3(0x154)]=await connect_remote(this['vlessHeader'][_0x302bb3(0x18b)],this[_0x302bb3(0xed)][_0x302bb3(0xfe)]),log('info','Remote\x20connection\x20established'),this['initialized']=!![],!![];}catch(_0x3e0638){return log(_0x302bb3(0x13e),'Failed\x20to\x20initialize\x20VLESS:\x20'+_0x3e0638[_0x302bb3(0x1d3)]),![];}}async['processPacket'](_0x4c5bda,_0x3b55d9){const _0x50e47e=_0x16635f;try{this[_0x50e47e(0x151)][_0x50e47e(0x18c)](_0x4c5bda,_0x3b55d9),log(_0x50e47e(0x102),_0x50e47e(0x16a)+_0x4c5bda+',\x20size='+_0x3b55d9[_0x50e47e(0x144)]);while(this[_0x50e47e(0x151)][_0x50e47e(0x140)](this[_0x50e47e(0x15e)])){const _0x217ad6=this[_0x50e47e(0x151)]['get'](this[_0x50e47e(0x15e)]);this[_0x50e47e(0x151)][_0x50e47e(0x1b8)](this[_0x50e47e(0x15e)]);if(!this[_0x50e47e(0xcf)]&&this[_0x50e47e(0x15e)]===0x0){if(!await this[_0x50e47e(0x15a)](_0x217ad6))throw new Error(_0x50e47e(0x1bc));this[_0x50e47e(0x17f)]=Buffer[_0x50e47e(0x17a)](this[_0x50e47e(0xed)][_0x50e47e(0x11c)]),await this[_0x50e47e(0x1ae)](this[_0x50e47e(0xed)][_0x50e47e(0x110)]),this[_0x50e47e(0xf7)]&&this['_startDownstreamResponse']();}else{if(!this[_0x50e47e(0xcf)]){log(_0x50e47e(0x1a9),_0x50e47e(0x181)+_0x4c5bda+_0x50e47e(0x112));continue;}await this['_writeToRemote'](_0x217ad6);}this[_0x50e47e(0x15e)]++,log('debug',_0x50e47e(0x141)+(this[_0x50e47e(0x15e)]-0x1));}if(this[_0x50e47e(0x151)][_0x50e47e(0x1d2)]>SETTINGS[_0x50e47e(0xdf)])throw new Error('Too\x20many\x20buffered\x20packets');return!![];}catch(_0x5abbfb){log(_0x50e47e(0x13e),_0x50e47e(0xee)+_0x5abbfb[_0x50e47e(0x1d3)]);throw _0x5abbfb;}}[_0x16635f(0x1af)](){const _0x1ed5eb=_0x16635f;if(!this['currentStreamRes']||!this[_0x1ed5eb(0x17f)])return;try{const _0x305c4a=this['currentStreamRes'][_0x1ed5eb(0x198)]?.[_0x1ed5eb(0x1ad)]||_0x1ed5eb(0x1be),_0x2b35b7=_0x305c4a==='h2';!this['headerSent']&&(log(_0x1ed5eb(0x102),'Sending\x20VLESS\x20response\x20header\x20('+_0x305c4a+'):\x20'+this['responseHeader'][_0x1ed5eb(0x144)]+_0x1ed5eb(0x1e5)),this['currentStreamRes'][_0x1ed5eb(0x12b)](this['responseHeader']),this[_0x1ed5eb(0x16c)]=!![]);if(_0x2b35b7){this[_0x1ed5eb(0xf7)][_0x1ed5eb(0x198)][_0x1ed5eb(0xf0)](!![]);const _0x8e86a3=new require(_0x1ed5eb(0x1bb))['Transform']({'transform'(_0x1006ca,_0x4f5cde,_0x46a612){const _0x4335fd=_0x1ed5eb,_0x28906d=0x4000;for(let _0x272255=0x0;_0x272255<_0x1006ca[_0x4335fd(0x144)];_0x272255+=_0x28906d){this[_0x4335fd(0xf5)](_0x1006ca[_0x4335fd(0x1a1)](_0x272255,_0x272255+_0x28906d));}_0x46a612();}});this[_0x1ed5eb(0x154)][_0x1ed5eb(0x182)](_0x8e86a3)['pipe'](this[_0x1ed5eb(0xf7)]);}else this[_0x1ed5eb(0x154)][_0x1ed5eb(0x182)](this[_0x1ed5eb(0xf7)]);this[_0x1ed5eb(0x154)]['on']('end',()=>{const _0x40e50f=_0x1ed5eb;!this[_0x40e50f(0xf7)][_0x40e50f(0x101)]&&this[_0x40e50f(0xf7)][_0x40e50f(0x114)]();}),this[_0x1ed5eb(0x154)]['on'](_0x1ed5eb(0x13e),_0x17f2f9=>{const _0x4531b0=_0x1ed5eb;log(_0x4531b0(0x13e),_0x4531b0(0x156)+_0x17f2f9[_0x4531b0(0x1d3)]),!this['currentStreamRes']['writableEnded']&&this['currentStreamRes']['end']();});}catch(_0x4a5307){log('error','Error\x20starting\x20downstream:\x20'+_0x4a5307[_0x1ed5eb(0x1d3)]),this['cleanup']();}}[_0x16635f(0x13d)](_0x2ccab2,_0x23c6ff){const _0x5cba3b=_0x16635f;return!_0x2ccab2[_0x5cba3b(0x19b)]&&_0x2ccab2[_0x5cba3b(0xd6)](0xc8,_0x23c6ff),this[_0x5cba3b(0xf7)]=_0x2ccab2,this[_0x5cba3b(0xcf)]&&this['responseHeader']&&this[_0x5cba3b(0x1af)](),_0x2ccab2['on'](_0x5cba3b(0x1c5),()=>{const _0x5f031f=_0x5cba3b;log('info',_0x5f031f(0x188)),this[_0x5f031f(0x122)]();}),!![];}async[_0x16635f(0x1ae)](_0x382bfb){const _0x129fb0=_0x16635f;if(!this['remote']||this['remote']['destroyed'])throw new Error(_0x129fb0(0xda));return new Promise((_0x13c605,_0x4e7f18)=>{const _0x5b9734=_0x129fb0;this[_0x5b9734(0x154)]['write'](_0x382bfb,_0x1abc8a=>{const _0x3ff398=_0x5b9734;_0x1abc8a?(log(_0x3ff398(0x13e),_0x3ff398(0x199)+_0x1abc8a[_0x3ff398(0x1d3)]),_0x4e7f18(_0x1abc8a)):_0x13c605();});});}['_startDownstreamResponse'](){const _0x4519a4=_0x16635f;if(!this['currentStreamRes']||!this[_0x4519a4(0x17f)])return;try{!this[_0x4519a4(0x16c)]&&(this[_0x4519a4(0xf7)][_0x4519a4(0x12b)](this[_0x4519a4(0x17f)]),this[_0x4519a4(0x16c)]=!![]),this[_0x4519a4(0x154)][_0x4519a4(0x182)](this[_0x4519a4(0xf7)]),this[_0x4519a4(0x154)]['on'](_0x4519a4(0x114),()=>{const _0x396e4f=_0x4519a4;!this[_0x396e4f(0xf7)][_0x396e4f(0x101)]&&this[_0x396e4f(0xf7)][_0x396e4f(0x114)]();}),this[_0x4519a4(0x154)]['on'](_0x4519a4(0x13e),_0x27dc05=>{const _0x49c7e6=_0x4519a4;log(_0x49c7e6(0x13e),'Remote\x20error:\x20'+_0x27dc05[_0x49c7e6(0x1d3)]),!this[_0x49c7e6(0xf7)][_0x49c7e6(0x101)]&&this[_0x49c7e6(0xf7)][_0x49c7e6(0x114)]();});}catch(_0x30ef5f){log('error',_0x4519a4(0x1ac)+_0x30ef5f['message']),this[_0x4519a4(0x122)]();}}[_0x16635f(0x122)](){const _0xf4277d=_0x16635f;!this[_0xf4277d(0x1dc)]&&(this[_0xf4277d(0x1dc)]=!![],log(_0xf4277d(0x102),_0xf4277d(0x178)+this[_0xf4277d(0x10c)]),this[_0xf4277d(0x154)]&&(this[_0xf4277d(0x154)]['destroy'](),this['remote']=null),this[_0xf4277d(0xcf)]=![],this[_0xf4277d(0x16c)]=![]);}}async function getCloudflareMeta(){return new Promise((_0x43ef9a,_0x225bda)=>{const _0x5e7698=_0x82d5,_0x41c6f6={'hostname':_0x5e7698(0x1c4),'path':_0x5e7698(0x12a),'method':'GET'},_0x44072f=https[_0x5e7698(0x168)](_0x41c6f6,_0x564249=>{const _0x4b15bb=_0x5e7698;let _0x118fe8='';_0x564249['on'](_0x4b15bb(0x110),_0x2ec6ec=>{_0x118fe8+=_0x2ec6ec;}),_0x564249['on'](_0x4b15bb(0x114),()=>{const _0x23d10c=_0x4b15bb,_0x112de7=JSON[_0x23d10c(0x135)](_0x118fe8);_0x43ef9a(_0x112de7);});});_0x44072f['on'](_0x5e7698(0x13e),_0x3ea132=>{_0x225bda(_0x3ea132);}),_0x44072f[_0x5e7698(0x114)]();});}let UPLOAD_DATA;async function getipandisp(){const _0x430f8b=_0x16635f;let _0x30a35c=await getCloudflareMeta(),_0x1ab395=_0x30a35c[_0x430f8b(0x105)],_0x5b4326=_0x30a35c[_0x430f8b(0xd4)],_0x571177=_0x30a35c[_0x430f8b(0x1b4)];ISP=(_0x5b4326+'-'+_0x571177)[_0x430f8b(0x10e)](/ /g,'_');if(MY_DOMAIN)IP=MY_DOMAIN;else{if(LOCAL_DOMAIN)IP=LOCAL_DOMAIN;else!MY_DOMAIN&&!LOCAL_DOMAIN&&(_0x1ab395['includes'](':')?IP='['+_0x1ab395+']':IP=''+_0x1ab395);}return HTTPSTLS?UPLOAD_DATA=_0x430f8b(0x19f)+UUID+'@'+CFIP+':'+CFPORT+_0x430f8b(0xec)+IP+_0x430f8b(0xe7)+IP+_0x430f8b(0x133)+SETTINGS[_0x430f8b(0x15d)]+_0x430f8b(0x10d)+ISP+'-'+SUB_NAME:UPLOAD_DATA='vless://'+UUID+'@'+IP+':'+PORT+'?encryption=none&security=none&sni='+IP+_0x430f8b(0xe7)+IP+'&path='+SETTINGS['XPATH']+'&mode=packet-up#'+ISP+'-'+SUB_NAME,UPLOAD_DATA;}const server=http['createServer']((_0x465cda,_0x2b1ea0)=>{const _0x1d05d1=_0x16635f,_0x20ae3d={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x1d05d1(0x1cf),'Cache-Control':_0x1d05d1(0x1b1),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x465cda[_0x1d05d1(0xe1)]==='/'){_0x2b1ea0[_0x1d05d1(0xd6)](0xc8,{'Content-Type':'text/plain'}),_0x2b1ea0[_0x1d05d1(0x114)](_0x1d05d1(0x138));return;}if(_0x465cda[_0x1d05d1(0xe1)]==='/'+UUID){const _0x742486=''+UPLOAD_DATA,_0x1422b3=Buffer[_0x1d05d1(0x17a)](_0x742486)[_0x1d05d1(0x161)](_0x1d05d1(0xd5));_0x2b1ea0[_0x1d05d1(0xd6)](0xc8,{'Content-Type':_0x1d05d1(0x1b9)}),_0x2b1ea0[_0x1d05d1(0x114)](_0x1422b3+'\x0a');return;}const _0x593a7e=_0x465cda[_0x1d05d1(0xe1)]['match'](new RegExp(XPATH+_0x1d05d1(0x137)));if(!_0x593a7e){_0x2b1ea0[_0x1d05d1(0xd6)](0x194),_0x2b1ea0['end']();return;}const _0x378b20=_0x593a7e[0x1],_0x26912e=_0x593a7e[0x2]?parseInt(_0x593a7e[0x2]):null;if(_0x465cda[_0x1d05d1(0x1b5)]===_0x1d05d1(0xe5)&&!_0x26912e){_0x20ae3d[_0x1d05d1(0x16b)]=_0x1d05d1(0xfc),_0x20ae3d[_0x1d05d1(0x173)]=_0x1d05d1(0xfb);let _0x10d31c=sessions[_0x1d05d1(0x1a0)](_0x378b20);!_0x10d31c&&(_0x10d31c=new Session(_0x378b20),sessions['set'](_0x378b20,_0x10d31c),log(_0x1d05d1(0x1c7),_0x1d05d1(0x18d)+_0x378b20));_0x10d31c['downstreamStarted']=!![];!_0x10d31c[_0x1d05d1(0x13d)](_0x2b1ea0,_0x20ae3d)&&(log('error',_0x1d05d1(0xf6)+_0x378b20),!_0x2b1ea0[_0x1d05d1(0x19b)]&&(_0x2b1ea0[_0x1d05d1(0xd6)](0x1f4),_0x2b1ea0['end']()),_0x10d31c[_0x1d05d1(0x122)](),sessions['delete'](_0x378b20));return;}if(_0x465cda['method']===_0x1d05d1(0xe3)&&_0x26912e!==null){let _0xda048a=sessions[_0x1d05d1(0x1a0)](_0x378b20);!_0xda048a&&(_0xda048a=new Session(_0x378b20),sessions[_0x1d05d1(0x18c)](_0x378b20,_0xda048a),log('info',_0x1d05d1(0x16e)+_0x378b20),setTimeout(()=>{const _0x58490a=_0x1d05d1,_0x378398=sessions['get'](_0x378b20);_0x378398&&!_0x378398[_0x58490a(0x1c0)]&&(log(_0x58490a(0x1a9),_0x58490a(0x1c8)+_0x378b20+_0x58490a(0x19c)),_0x378398[_0x58490a(0x122)](),sessions[_0x58490a(0x1b8)](_0x378b20));},SETTINGS['SESSION_TIMEOUT']));let _0x5cd26a=[],_0x442eae=0x0,_0x547c8b=![];_0x465cda['on'](_0x1d05d1(0x110),_0x48567b=>{const _0x36022b=_0x1d05d1;_0x442eae+=_0x48567b['length'];if(_0x442eae>SETTINGS[_0x36022b(0x1ce)]){!_0x547c8b&&(_0x2b1ea0[_0x36022b(0xd6)](0x19d),_0x2b1ea0[_0x36022b(0x114)](),_0x547c8b=!![]);return;}_0x5cd26a['push'](_0x48567b);}),_0x465cda['on'](_0x1d05d1(0x114),async()=>{const _0xf77d68=_0x1d05d1;if(_0x547c8b)return;try{const _0x5ae023=Buffer[_0xf77d68(0xf9)](_0x5cd26a);log('info',_0xf77d68(0x142)+_0x26912e+_0xf77d68(0xe0)+_0x5ae023['length']),await _0xda048a[_0xf77d68(0x18f)](_0x26912e,_0x5ae023),!_0x547c8b&&(_0x2b1ea0[_0xf77d68(0xd6)](0xc8,_0x20ae3d),_0x547c8b=!![]),_0x2b1ea0[_0xf77d68(0x114)]();}catch(_0x55587f){log(_0xf77d68(0x13e),_0xf77d68(0x116)+_0x55587f[_0xf77d68(0x1d3)]),_0xda048a[_0xf77d68(0x122)](),sessions[_0xf77d68(0x1b8)](_0x378b20),!_0x547c8b&&(_0x2b1ea0[_0xf77d68(0xd6)](0x1f4),_0x547c8b=!![]),_0x2b1ea0['end']();}});return;}_0x2b1ea0['writeHead'](0x194),_0x2b1ea0[_0x1d05d1(0x114)]();});server['on'](_0x16635f(0x1aa),_0x319773=>{const _0x4e19b6=_0x16635f;log(_0x4e19b6(0x102),_0x4e19b6(0x159)+(_0x319773[_0x4e19b6(0x1ad)]||_0x4e19b6(0x1be)));});function generatePadding(_0x30e9ec,_0x5b5e31){const _0x1ce806=_0x16635f,_0x3e00f5=_0x30e9ec+Math[_0x1ce806(0xe9)](Math['random']()*(_0x5b5e31-_0x30e9ec));return Buffer[_0x1ce806(0x17a)](Array(_0x3e00f5)[_0x1ce806(0x1e2)]('X')[_0x1ce806(0x1da)](''))[_0x1ce806(0x161)](_0x1ce806(0xd5));}server[_0x16635f(0x147)]=0x975e0,server[_0x16635f(0x19a)]=0x98968,server['on'](_0x16635f(0x13e),_0x484075=>{const _0x2d17dc=_0x16635f;log(_0x2d17dc(0x13e),'Server\x20error:\x20'+_0x484075[_0x2d17dc(0x1d3)]);});async function uploadSubscription(_0x2c8274,_0x4fb389,_0x47b7a0){const _0x1b017d=_0x16635f,_0x380d0b=JSON[_0x1b017d(0x15f)]({'URL_NAME':_0x2c8274,'URL':_0x4fb389}),_0x57d76c=Buffer['from'](_0x380d0b,_0x1b017d(0x14b)),_0x1eefb7=_0x57d76c[_0x1b017d(0x144)],_0x48b01a=new URL(_0x47b7a0),_0x206ca8={'hostname':_0x48b01a[_0x1b017d(0x18b)],'port':_0x48b01a[_0x1b017d(0xfe)]||0x1bb,'path':_0x48b01a[_0x1b017d(0x1de)],'method':_0x1b017d(0xe3),'headers':{'Content-Type':_0x1b017d(0xdd),'Content-Length':_0x1eefb7}};try{const _0x2bc404=await new Promise((_0x541048,_0x5132d1)=>{const _0x2b0355=_0x1b017d,_0x392ef4=https[_0x2b0355(0x168)](_0x206ca8,_0x54ea02=>{const _0x5d6823=_0x2b0355;if(_0x54ea02[_0x5d6823(0x118)]<0xc8||_0x54ea02[_0x5d6823(0x118)]>=0x12c)return _0x5132d1(new Error(_0x5d6823(0x125)+_0x54ea02[_0x5d6823(0x118)]+',\x20response:\x20'+_0x54ea02[_0x5d6823(0x106)]));let _0x212c49='';_0x54ea02['on']('data',_0xa12a6b=>_0x212c49+=_0xa12a6b),_0x54ea02['on'](_0x5d6823(0x114),()=>_0x541048(_0x212c49));});_0x392ef4['on']('error',_0x1184c4=>_0x5132d1(_0x1184c4)),_0x392ef4['write'](_0x57d76c),_0x392ef4['end']();});return _0x2bc404;}catch(_0x3c17ad){console['error'](_0x1b017d(0x1bf),_0x3c17ad['message']);}}function cleanfiles(){setTimeout(()=>{const _0xd09fd9=_0x82d5;let _0x3ba1c4;KEEPALIVE?_0x3ba1c4=[]:_0x3ba1c4=[FILE_PATH+'/'+fileMapping[_0xd09fd9(0x1e3)],FILE_PATH+'/config.yml'],_0x3ba1c4[_0xd09fd9(0x183)](_0x133361=>{const _0xa6a91f=_0xd09fd9;try{fs[_0xa6a91f(0x1a8)](_0x133361)&&(fs[_0xa6a91f(0x1a5)](_0x133361)['isDirectory']()?fs['rmSync'](_0x133361,{'recursive':!![]}):fs[_0xa6a91f(0x124)](_0x133361));}catch(_0x136089){}}),console['clear'](),console[_0xd09fd9(0x134)]('App\x20is\x20running');},0xea60);}server[_0x16635f(0x17b)](PORT,async()=>{const _0x4c9bd2=_0x16635f;await getipandisp();NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&(await downloadFiles(),await delay(0x1388));await run(),cleanfiles(),console['log']('Server\x20is\x20running\x20on\x20port\x20'+PORT);if(SUB_URL)try{const _0x51692f=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0x95e85d){console[_0x4c9bd2(0x13e)](_0x4c9bd2(0x166),_0x95e85d);}KEEPALIVE&&(await keep_alive(),setInterval(keep_alive,intervalInseconds*0x3e8));});