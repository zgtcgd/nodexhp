const _0x42bcb7=_0x4fd1;(function(_0xb42e92,_0x57bc55){const _0x1853e2=_0x4fd1,_0x2d1334=_0xb42e92();while(!![]){try{const _0x5ad4e3=-parseInt(_0x1853e2(0x262))/0x1+-parseInt(_0x1853e2(0x1d8))/0x2+-parseInt(_0x1853e2(0x1c1))/0x3*(parseInt(_0x1853e2(0x29f))/0x4)+parseInt(_0x1853e2(0x1c6))/0x5+parseInt(_0x1853e2(0x21c))/0x6*(parseInt(_0x1853e2(0x1ae))/0x7)+parseInt(_0x1853e2(0x26e))/0x8*(parseInt(_0x1853e2(0x1c2))/0x9)+-parseInt(_0x1853e2(0x204))/0xa*(parseInt(_0x1853e2(0x1d7))/0xb);if(_0x5ad4e3===_0x57bc55)break;else _0x2d1334['push'](_0x2d1334['shift']());}catch(_0x57d567){_0x2d1334['push'](_0x2d1334['shift']());}}}(_0x571f,0x4c00e));const FILE_PATH=process['env'][_0x42bcb7(0x298)]||_0x42bcb7(0x229),intervalInseconds=process[_0x42bcb7(0x1ec)][_0x42bcb7(0x29c)]||0x64,PORT=process['env'][_0x42bcb7(0x27e)]||0xbb8,CFPORT=process[_0x42bcb7(0x1ec)][_0x42bcb7(0x29b)]||0x1bb,CFIP=process['env'][_0x42bcb7(0x215)]||_0x42bcb7(0x203),KEEPALIVE=(process['env']['KEEPALIVE']||_0x42bcb7(0x266))===_0x42bcb7(0x19c),SUB_URL=process[_0x42bcb7(0x1ec)]['SUB_URL']||'',UUID=process[_0x42bcb7(0x1ec)]['UUID']||_0x42bcb7(0x205),XPATH=process[_0x42bcb7(0x1ec)][_0x42bcb7(0x1eb)]||UUID[_0x42bcb7(0x2a7)](0x0,0x8),NEZHA_VERSION=process[_0x42bcb7(0x1ec)]['NEZHA_VERSION']||'V0',NEZHA_SERVER=process[_0x42bcb7(0x1ec)][_0x42bcb7(0x1c0)]||'',NEZHA_PORT=process[_0x42bcb7(0x1ec)]['NEZHA_PORT']||'443',NEZHA_KEY=process['env'][_0x42bcb7(0x284)]||'',SUB_NAME=process[_0x42bcb7(0x1ec)][_0x42bcb7(0x274)]||'',MY_DOMAIN=process[_0x42bcb7(0x1ec)][_0x42bcb7(0x200)]||'',LOCAL_DOMAIN=process[_0x42bcb7(0x1ec)][_0x42bcb7(0x1b3)]||'',os=require('os'),fs=require('fs'),net=require(_0x42bcb7(0x1db)),path=require(_0x42bcb7(0x287)),http=require(_0x42bcb7(0x2a4)),https=require(_0x42bcb7(0x1d1)),axios=require(_0x42bcb7(0x2a9)),{pipeline}=require('stream/promises'),{Buffer}=require(_0x42bcb7(0x1d2)),exec=require(_0x42bcb7(0x279))[_0x42bcb7(0x1ab)],delay=_0x4416bb=>new Promise(_0x486b4a=>setTimeout(_0x486b4a,_0x4416bb)),SETTINGS={[_0x42bcb7(0x256)]:UUID,[_0x42bcb7(0x1b6)]:'none',[_0x42bcb7(0x19a)]:_0x42bcb7(0x213),[_0x42bcb7(0x1eb)]:_0x42bcb7(0x1fd)+XPATH,['MAX_BUFFERED_POSTS']:0x1e,[_0x42bcb7(0x1bf)]:0xf4240,[_0x42bcb7(0x25e)]:0x7530,[_0x42bcb7(0x288)]:0x400*0x400,[_0x42bcb7(0x211)]:!![],[_0x42bcb7(0x1ba)]:!![]};function _0x571f(){const _0x1f12e1=['?encryption=none&security=tls&sni=','\x20-s\x20','Failed\x20to\x20parse\x20hostname','writeHead','nextSeq','Upload\x20failed:','pipeTo','http/1.1','HTTP\x20error!\x20status:\x20','Server\x20error:\x20','getWriter','value','\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20','now','reset','pause','UUID','upload\x20failed:','\x20before\x20initialization','fileName','GET','client_secret:\x20','push','text/plain','SESSION_TIMEOUT','Cleanup\x20error:\x20','info','Too\x20many\x20buffered\x20packets','77269aonXKR','port','existsSync','setKeepAlive','false','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1','cmd','Created\x20new\x20session\x20for\x20GET:\x20','code','VLESS\x20header\x20parsed\x20successfully','clear','releaseLock','2304rvwbhr','originalName','Connection\x20failed:\x20','uncork','success','\x20--report-delay=4\x20--skip-conn\x20--skip-procs\x20--disable-auto-update\x20>/dev/null\x202>&1\x20&','SUB_NAME','rmSync','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','&mode=packet-up#','hostname','child_process','delete','mkdirSync','app','pipe','PORT','set','enqueue','createServer','amd','debug','NEZHA_KEY','Remote\x20connection\x20established','utf8','path','CHUNK_SIZE','ps\x20-eo\x20pid,comm\x20|\x20awk\x20-v\x20name=\x22','downstreamStarted','vless://','pendingBuffers','finally','arm','toString','pidof\x20\x22','unsupported\x20command:\x20','trim','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','aborted','pendingPackets','stringify','pgrep\x20-x\x20\x22','FILE_PATH','asOrganization','/meta','CFPORT','TIME','decode','\x1b[32m','15448aVSFBf','resp','readable','setNoDelay','socket\x20hang\x20up','http','floor','Remote\x20error:\x20','slice','arm64','axios','2053','Created\x20new\x20session\x20for\x20POST:\x20','BUFFER_SIZE','8443','true','read\x20address\x20type\x20failed','_startDownstreamResponse','arch','Process\x20not\x20found','listen','isDirectory','Connected\x20to\x20','&fp=chrome&allowInsecure=1&type=xhttp&host=','Read\x20controller\x20error:','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','\x1b[0m','POST','warn','kill\x20-9\x20','exec','lastActivity','application/json;\x20charset=utf-8','1076103OjzMuC','data','constructor','size','remote','LOCAL_DOMAIN','unlinkSync','currentStreamRes','LOG_LEVEL','length','all','Remote\x20connection\x20not\x20available','TCP_KEEPALIVE','tmp','headersTimeout','secureConnection','https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','MAX_POST_SIZE','NEZHA_SERVER','363sdHHbc','8640aeeLxz','statusCode','includes','nextTick','2816985bbAynl','Download\x20error:\x20','reduce','timeout','VLESS\x20header\x20parse\x20error:\x20','has','name','concat','log','Command\x20failed:\x20','Starting\x20to\x20parse\x20VLESS\x20header','https','buffer','random','/([^/]+)(?:/([0-9]+))?$','VLESS\x20header\x20parsed:\x20',',\x20size=','33VfVVmI','40052SqdmrT','match','\x1b[31m','net','ps+awk','invalid\x20UUID','):\x20','\x1b[33m','Socket\x20error:','request','header\x20length\x20too\x20short','/config.yml','pidof','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','\x20bytes','writableEnded','Socket\x20is\x20destroyed','?encryption=none&security=none&sni=','XPATH','env','Failed\x20to\x20process\x20POST\x20request:\x20','Failed\x20to\x20initialize\x20VLESS:\x20','fill','keepAliveTimeout','toISOString','charAt','Created\x20new\x20session\x20with\x20UUID:\x20','Killed\x20process\x20(PIDs:\x20','application/octet-stream','Error\x20starting\x20downstream:\x20','join','writable','reading_done','New\x20secure\x20connection\x20using:\x20','Error\x20downloading\x20files:','done','%2F','get','Upload\x20error:\x20','MY_DOMAIN','speed.cloudflare.com','Session\x20','ip.sb','392330xsvqfm','7160b696-dd5e-42e3-a024-145e92cec916','filePath','Hello,\x20World\x0a','map','end','from','createConnection','uuid','connect\x20timeout','Server\x20is\x20running\x20on\x20port\x20','chmodSync','\x20running\x20error:\x20','TCP_NODELAY','Cleaning\x20up\x20session\x20','2048','MAX_BUFFERED_POSTS','CFIP','forEach','vlessHeader','chunked','responseHeader','write','not\x20enough\x20data\x20to\x20read','6UZGXdN','443','destroyed','Received\x20out\x20of\x20order\x20packet\x20seq=','socket',']\x20[','nohup\x20','app\x20file\x20not\x20found,\x20skip\x20running','2087','https://github.com/kahunama/myfile/releases/download/main/nezha-agent','base64','2083','writeFileSync','/tmp',',\x20response:\x20','error','processPacket','aarch64','close','stream','cleaned','pathname','/config.yml\x20>/dev/null\x202>&1\x20&','url','method','no-store','startDownstream','\x22\x20\x27$2\x20==\x20name\x20{print\x20$1}\x27','parse\x20hostname\x20failed','fileUrl','destroy','initializeVLESS','Processing\x20packet:\x20seq=','_writeToRemote','VLESS\x20connection\x20to\x20','initialized','Relay\x20error:','Process\x20\x27','&path=','cleanup','headerSent','message'];_0x571f=function(){return _0x1f12e1;};return _0x571f();}function validate_uuid(_0x138fb5,_0x39b821){for(let _0x135aec=0x0;_0x135aec<0x10;_0x135aec++){if(_0x138fb5[_0x135aec]!==_0x39b821[_0x135aec])return![];}return!![];}function concat_typed_arrays(_0x4394fa,..._0x10f796){const _0x11ade6=_0x42bcb7;if(!_0x10f796||_0x10f796[_0x11ade6(0x1b7)]<0x1)return _0x4394fa;let _0x328b7d=_0x4394fa[_0x11ade6(0x1b7)];for(let _0x3c7054 of _0x10f796)_0x328b7d+=_0x3c7054['length'];const _0x3eb729=new _0x4394fa[(_0x11ade6(0x1b0))](_0x328b7d);_0x3eb729[_0x11ade6(0x27f)](_0x4394fa,0x0),_0x328b7d=_0x4394fa['length'];for(let _0x1e8469 of _0x10f796){_0x3eb729[_0x11ade6(0x27f)](_0x1e8469,_0x328b7d),_0x328b7d+=_0x1e8469[_0x11ade6(0x1b7)];}return _0x3eb729;}function log(_0x75b797,..._0x539575){const _0x533951=_0x42bcb7;if(SETTINGS[_0x533951(0x1b6)]==='none')return;const _0x733d90={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x188751={'debug':'\x1b[36m','info':_0x533951(0x29e),'warn':_0x533951(0x1df),'error':_0x533951(0x1da),'reset':_0x533951(0x1a7)},_0x2bd984=_0x733d90[SETTINGS[_0x533951(0x1b6)]]||0x1,_0x1d6406=_0x733d90[_0x75b797]||0x0;if(_0x1d6406>=_0x2bd984){const _0x1847a8=new Date()[_0x533951(0x1f1)](),_0x144dd4=_0x188751[_0x75b797]||_0x188751[_0x533951(0x254)];console['log'](_0x144dd4+'['+_0x1847a8+_0x533951(0x221)+_0x75b797+']',..._0x539575,_0x188751['reset']);}}function createFolder(_0x194785){const _0x5b4cd5=_0x42bcb7;if(!fs['existsSync'](_0x194785))fs[_0x5b4cd5(0x27b)](_0x194785);else{}}function execPromise(_0x36ab08,_0x21845b={}){return new Promise((_0x3f46f8,_0x124cbf)=>{const _0x37f4f2=exec(_0x36ab08,_0x21845b,(_0x137d2a,_0x38fd66,_0x46006f)=>{const _0x385753=_0x4fd1;if(_0x137d2a){const _0x16a2ab=new Error(_0x385753(0x1cf)+_0x137d2a['message']);_0x16a2ab[_0x385753(0x26a)]=_0x137d2a['code'],_0x16a2ab['stderr']=_0x46006f['trim'](),_0x124cbf(_0x16a2ab);}else _0x3f46f8(_0x38fd66[_0x385753(0x292)]());});});}async function detectProcess(_0xa8c31d){const _0x11f836=_0x42bcb7,_0x803b54=[{'cmd':_0x11f836(0x290)+_0xa8c31d+'\x22','name':_0x11f836(0x1e4)},{'cmd':_0x11f836(0x297)+_0xa8c31d+'\x22','name':'pgrep'},{'cmd':_0x11f836(0x289)+_0xa8c31d+_0x11f836(0x237),'name':_0x11f836(0x1dc)}];for(const _0x240804 of _0x803b54){try{const _0x5d67a4=await execPromise(_0x240804[_0x11f836(0x268)]);if(_0x5d67a4)return _0x5d67a4['replace'](/\n/g,'\x20')[_0x11f836(0x292)]();}catch(_0x1e3f7e){_0x1e3f7e[_0x11f836(0x26a)]!==0x7f&&_0x1e3f7e[_0x11f836(0x26a)]!==0x1&&console[_0x11f836(0x283)]('[detectProcess]\x20'+_0x240804[_0x11f836(0x1cc)]+'\x20error:',_0x1e3f7e[_0x11f836(0x245)]);}}return'';}async function killProcess(_0x3647ab){const _0x7aa653=_0x42bcb7;console['log']('Attempting\x20to\x20kill\x20process:\x20'+_0x3647ab);try{const _0x53b3a1=await detectProcess(_0x3647ab);if(!_0x53b3a1)return console['warn'](_0x7aa653(0x241)+_0x3647ab+'\x27\x20not\x20found'),{'success':!![],'message':_0x7aa653(0x1a0)};await execPromise(_0x7aa653(0x1aa)+_0x53b3a1);const _0x570c81=_0x7aa653(0x1f4)+_0x53b3a1+')';return console[_0x7aa653(0x1ce)](_0x570c81),{'success':!![],'message':_0x570c81};}catch(_0xdccb73){const _0x5800df='Kill\x20failed:\x20'+_0xdccb73[_0x7aa653(0x245)];return console[_0x7aa653(0x22b)](_0x5800df),{'success':![],'message':_0x5800df};}}function generateRandomString(_0x257b48){const _0x1c04bd=_0x42bcb7,_0x26c960=_0x1c04bd(0x1a6);let _0xe9cc39='';for(let _0x34416a=0x0;_0x34416a<_0x257b48;_0x34416a++){_0xe9cc39+=_0x26c960[_0x1c04bd(0x1f2)](Math[_0x1c04bd(0x2a5)](Math[_0x1c04bd(0x1d3)]()*_0x26c960[_0x1c04bd(0x1b7)]));}return _0xe9cc39;}function getSystemArchitecture(){const _0x3b60d6=_0x42bcb7,_0x3f7b6a=os[_0x3b60d6(0x19f)]();return _0x3f7b6a==='arm'||_0x3f7b6a===_0x3b60d6(0x2a8)||_0x3f7b6a===_0x3b60d6(0x22d)?_0x3b60d6(0x28e):_0x3b60d6(0x282);}function getFilesForArchitecture(_0x2ad697){const _0x557d9a=_0x42bcb7,_0x1bce0f={'app':{'V0':{'arm':_0x557d9a(0x1be),'amd':_0x557d9a(0x225)},'V1':{'arm':_0x557d9a(0x276),'amd':_0x557d9a(0x267)}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0x4d8d89=[{'fileName':_0x557d9a(0x1bb)+generateRandomString(0x5),'originalName':_0x557d9a(0x27c),'fileUrl':_0x1bce0f[_0x557d9a(0x27c)][NEZHA_VERSION][_0x2ad697]}];return _0x4d8d89;}else return[];}async function download_function(_0x53b046,_0x1e4492,_0x11be7a){const _0x3a65bc=_0x42bcb7,_0x40dae6=path[_0x3a65bc(0x1f7)](FILE_PATH,_0x53b046);let _0x5325c1=![];try{const _0x15795e=await axios({'method':_0x3a65bc(0x1fe),'url':_0x11be7a,'responseType':'stream'});await pipeline(_0x15795e[_0x3a65bc(0x1af)],fs['createWriteStream'](_0x40dae6)),_0x5325c1=!![];}catch(_0x205689){}return{'fileName':_0x53b046,'originalName':_0x1e4492,'filePath':_0x40dae6,'success':_0x5325c1};}let fileMapping={};async function downloadFiles(){const _0xc6a2ab=_0x42bcb7;try{const _0x2e7832=getSystemArchitecture();if(!_0x2e7832)return console[_0xc6a2ab(0x1ce)]('Can\x27t\x20determine\x20system\x20architecture.'),fileMapping;const _0x175325=getFilesForArchitecture(_0x2e7832);if(_0x175325[_0xc6a2ab(0x1b7)]===0x0)return console[_0xc6a2ab(0x1ce)]('Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture'),fileMapping;const _0x282c0d=_0x175325[_0xc6a2ab(0x208)](_0x54f24d=>download_function(_0x54f24d[_0xc6a2ab(0x259)],_0x54f24d[_0xc6a2ab(0x26f)],_0x54f24d[_0xc6a2ab(0x239)])),_0x20ea73=await Promise[_0xc6a2ab(0x1b8)](_0x282c0d);return _0x20ea73[_0xc6a2ab(0x216)](_0x27b39f=>{const _0x42e8f3=_0xc6a2ab;if(_0x27b39f[_0x42e8f3(0x272)])try{fs[_0x42e8f3(0x20f)](_0x27b39f[_0x42e8f3(0x206)],0x1ed),fileMapping[_0x27b39f[_0x42e8f3(0x26f)]]=_0x27b39f[_0x42e8f3(0x259)];}catch(_0xeba739){}}),fileMapping;}catch(_0x19a681){return console[_0xc6a2ab(0x22b)](_0xc6a2ab(0x1fb),_0x19a681),fileMapping;}}let NEZHA_TLS;function nezconfig(){const _0xae70a5=_0x42bcb7,_0x38e946=[_0xae70a5(0x21d),_0xae70a5(0x19b),'2096',_0xae70a5(0x224),_0xae70a5(0x227),_0xae70a5(0x198)];if(NEZHA_VERSION==='V0')return _0x38e946[_0xae70a5(0x1c4)](NEZHA_PORT)?NEZHA_TLS='--tls':NEZHA_TLS='',NEZHA_TLS;else{if(NEZHA_VERSION==='V1'){_0x38e946[_0xae70a5(0x1c4)](NEZHA_PORT)?NEZHA_TLS='true':NEZHA_TLS=_0xae70a5(0x266);const _0x442c9e=path[_0xae70a5(0x1f7)](FILE_PATH,_0xae70a5(0x1e3)),_0x4932ed=_0xae70a5(0x25b)+NEZHA_KEY+_0xae70a5(0x1e6)+NEZHA_SERVER+':'+NEZHA_PORT+_0xae70a5(0x252)+NEZHA_TLS+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;try{fs[_0xae70a5(0x228)](_0x442c9e,_0x4932ed);}catch(_0x373375){}}}}async function runapp(){const _0x399407=_0x42bcb7;if(fileMapping[_0x399407(0x27c)]&&fs[_0x399407(0x264)](path[_0x399407(0x1f7)](FILE_PATH,fileMapping['app']))){if(NEZHA_VERSION==='V0'){const _0x317329='nohup\x20'+FILE_PATH+'/'+fileMapping[_0x399407(0x27c)]+_0x399407(0x247)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+NEZHA_TLS+_0x399407(0x273);try{await execPromise(_0x317329);}catch(_0x4d44ca){console['error'](fileMapping[_0x399407(0x27c)]+_0x399407(0x210)+_0x4d44ca);}}else{if(NEZHA_VERSION==='V1'){const _0x21e74e=_0x399407(0x222)+FILE_PATH+'/'+fileMapping[_0x399407(0x27c)]+'\x20-c\x20'+FILE_PATH+_0x399407(0x232);try{await execPromise(_0x21e74e);}catch(_0x10454d){console[_0x399407(0x22b)](fileMapping[_0x399407(0x27c)]+_0x399407(0x210)+_0x10454d);}}}}else console['log'](_0x399407(0x223));}async function run(){const _0x13a01b=_0x42bcb7;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){nezconfig();const _0x172c93=await detectProcess(''+fileMapping['app']);if(_0x172c93){}else await runapp();await delay(0x3e8);}else console[_0x13a01b(0x1ce)]('Node\x20variable\x20is\x20empty,\x20skip\x20running');}async function keep_alive(){const _0x4c6c48=_0x42bcb7;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x9ca4ab=await detectProcess(''+fileMapping[_0x4c6c48(0x27c)]);if(_0x9ca4ab){}else await runapp();}}function parse_uuid(_0x29e1b1){const _0x10a3bc=_0x42bcb7;_0x29e1b1=_0x29e1b1['replaceAll']('-','');const _0x18907a=[];for(let _0x12db4d=0x0;_0x12db4d<0x10;_0x12db4d++){_0x18907a[_0x10a3bc(0x25c)](parseInt(_0x29e1b1['substr'](_0x12db4d*0x2,0x2),0x10));}return _0x18907a;}async function read_vless_header(_0x35c123,_0x1017be){const _0x59646e=_0x42bcb7;let _0x524ff9=0x0,_0x336b00=new Uint8Array(),_0x4eacb8={'value':_0x336b00,'done':![]};async function _0x1e15d3(_0x5c92c5){const _0x1ba7db=_0x4fd1;if(_0x4eacb8[_0x1ba7db(0x1fc)])throw new Error(_0x1ba7db(0x1e2));const _0x311956=_0x5c92c5-_0x524ff9;if(_0x311956<0x1)return;_0x4eacb8=await read_atleast(_0x35c123,_0x311956),_0x524ff9+=_0x4eacb8[_0x1ba7db(0x251)][_0x1ba7db(0x1b7)],_0x336b00=concat_typed_arrays(_0x336b00,_0x4eacb8[_0x1ba7db(0x251)]);}await _0x1e15d3(0x1+0x10+0x1);const _0x1cdedf=_0x336b00[0x0],_0x4821f1=_0x336b00[_0x59646e(0x2a7)](0x1,0x1+0x10),_0xe3ce85=parse_uuid(_0x1017be);if(!validate_uuid(_0x4821f1,_0xe3ce85))throw new Error(_0x59646e(0x1dd));const _0x1e3f0b=_0x336b00[0x1+0x10],_0x2de992=0x1+0x10+0x1+_0x1e3f0b+0x1+0x2+0x1;await _0x1e15d3(_0x2de992+0x1);const _0x2d8968=_0x336b00[0x1+0x10+0x1+_0x1e3f0b],_0x219b84=0x1;if(_0x2d8968!==_0x219b84)throw new Error(_0x59646e(0x291)+_0x2d8968);const _0x43a6c7=(_0x336b00[_0x2de992-0x1-0x2]<<0x8)+_0x336b00[_0x2de992-0x1-0x1],_0x5954e1=_0x336b00[_0x2de992-0x1],_0x2aa74e=0x1,_0x1ef81e=0x2,_0x95eabb=0x3;let _0x19e3b6=-0x1;if(_0x5954e1===_0x2aa74e)_0x19e3b6=_0x2de992+0x4;else{if(_0x5954e1===_0x95eabb)_0x19e3b6=_0x2de992+0x10;else _0x5954e1===_0x1ef81e&&(_0x19e3b6=_0x2de992+0x1+_0x336b00[_0x2de992]);}if(_0x19e3b6<0x0)throw new Error(_0x59646e(0x19d));await _0x1e15d3(_0x19e3b6);const _0x20d97a=_0x2de992;let _0x55fa43='';if(_0x5954e1===_0x2aa74e)_0x55fa43=_0x336b00[_0x59646e(0x2a7)](_0x20d97a,_0x20d97a+0x4)[_0x59646e(0x1f7)]('.');else{if(_0x5954e1===_0x1ef81e)_0x55fa43=new TextDecoder()[_0x59646e(0x29d)](_0x336b00[_0x59646e(0x2a7)](_0x20d97a+0x1,_0x20d97a+0x1+_0x336b00[_0x20d97a]));else _0x5954e1===_0x95eabb&&(_0x55fa43=_0x336b00[_0x59646e(0x2a7)](_0x20d97a,_0x20d97a+0x10)[_0x59646e(0x1c8)]((_0x277c3a,_0x4d7e8e,_0x7b40f2,_0x380b42)=>_0x7b40f2%0x2?_0x277c3a[_0x59646e(0x1cd)](((_0x380b42[_0x7b40f2-0x1]<<0x8)+_0x4d7e8e)[_0x59646e(0x28f)](0x10)):_0x277c3a,[])[_0x59646e(0x1f7)](':'));}if(!_0x55fa43){log('error',_0x59646e(0x248));throw new Error(_0x59646e(0x238));}return log(_0x59646e(0x260),_0x59646e(0x23e)+_0x55fa43+':'+_0x43a6c7),{'hostname':_0x55fa43,'port':_0x43a6c7,'data':_0x336b00['slice'](_0x19e3b6),'resp':new Uint8Array([_0x1cdedf,0x0])};}async function read_atleast(_0x216651,_0x11c83d){const _0x39870f=_0x42bcb7,_0x434771=[];let _0x6d4507=![];while(_0x11c83d>0x0&&!_0x6d4507){const _0x2eb038=await _0x216651['read']();if(_0x2eb038[_0x39870f(0x251)]){const _0x4d9d72=new Uint8Array(_0x2eb038['value']);_0x434771[_0x39870f(0x25c)](_0x4d9d72),_0x11c83d-=_0x4d9d72[_0x39870f(0x1b7)];}_0x6d4507=_0x2eb038['done'];}if(_0x11c83d>0x0)throw new Error(_0x39870f(0x21b));return{'value':concat_typed_arrays(..._0x434771),'done':_0x6d4507};}async function parse_header(_0x4f3365,_0x27686a){const _0x7c7a9c=_0x42bcb7;log('debug',_0x7c7a9c(0x1d0));const _0x1db930=_0x27686a[_0x7c7a9c(0x2a1)]['getReader']();try{const _0x457e6b=await read_vless_header(_0x1db930,_0x4f3365);return log(_0x7c7a9c(0x283),_0x7c7a9c(0x26b)),_0x457e6b;}catch(_0x12fdec){log(_0x7c7a9c(0x22b),_0x7c7a9c(0x1ca)+_0x12fdec[_0x7c7a9c(0x245)]);throw new Error('read\x20vless\x20header\x20error:\x20'+_0x12fdec[_0x7c7a9c(0x245)]);}finally{_0x1db930[_0x7c7a9c(0x26d)]();}}async function connect_remote(_0x167ddf,_0x4535e7){const _0x1be216=_0x42bcb7,_0x56848f=0x1f40;try{const _0x51a2a2=await timed_connect(_0x167ddf,_0x4535e7,_0x56848f);return _0x51a2a2[_0x1be216(0x2a2)](!![]),_0x51a2a2[_0x1be216(0x265)](!![],0x3e8),_0x51a2a2['bufferSize']=parseInt(SETTINGS[_0x1be216(0x19a)])*0x400,log(_0x1be216(0x260),_0x1be216(0x1a3)+_0x167ddf+':'+_0x4535e7),_0x51a2a2;}catch(_0x13a4a7){log(_0x1be216(0x22b),_0x1be216(0x270)+_0x13a4a7[_0x1be216(0x245)]);throw _0x13a4a7;}}function timed_connect(_0x14fa74,_0x10ccd9,_0x3f8caf){return new Promise((_0x533b80,_0x1d248d)=>{const _0x532039=_0x4fd1,_0x1a3df2=net[_0x532039(0x20b)]({'host':_0x14fa74,'port':_0x10ccd9}),_0x5a6ed9=setTimeout(()=>{const _0x43da18=_0x532039;_0x1d248d(new Error(_0x43da18(0x20d)));},_0x3f8caf);_0x1a3df2['on']('connect',()=>{clearTimeout(_0x5a6ed9),_0x533b80(_0x1a3df2);}),_0x1a3df2['on']('error',_0xd6bf56=>{clearTimeout(_0x5a6ed9),_0x1d248d(_0xd6bf56);});});}function pipe_relay(){async function _0xfb0812(_0x436a12,_0x200367,_0x3774e5){const _0x4589bc=_0x4fd1,_0x4fc41c=parseInt(SETTINGS[_0x4589bc(0x288)]);if(_0x3774e5[_0x4589bc(0x1b7)]>0x0){if(_0x200367[_0x4589bc(0x21a)])_0x200367['cork'](),_0x200367[_0x4589bc(0x21a)](_0x3774e5),process[_0x4589bc(0x1c5)](()=>_0x200367[_0x4589bc(0x271)]());else{const _0x58ffbd=_0x200367[_0x4589bc(0x1f8)][_0x4589bc(0x250)]();try{await _0x58ffbd[_0x4589bc(0x21a)](_0x3774e5);}finally{_0x58ffbd['releaseLock']();}}}try{_0x436a12[_0x4589bc(0x27d)]?(_0x436a12[_0x4589bc(0x255)](),_0x436a12[_0x4589bc(0x27d)](_0x200367,{'end':!![],'highWaterMark':_0x4fc41c}),_0x436a12['resume']()):await _0x436a12['readable'][_0x4589bc(0x24c)](_0x200367[_0x4589bc(0x1f8)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x4589bc(0x1c9)](SETTINGS['SESSION_TIMEOUT'])});}catch(_0x20c959){!_0x20c959['message']['includes'](_0x4589bc(0x294))&&log(_0x4589bc(0x22b),_0x4589bc(0x240),_0x20c959[_0x4589bc(0x245)]);throw _0x20c959;}}return _0xfb0812;}function socketToWebStream(_0x421e5d){const _0xede57=_0x42bcb7;let _0x180c13,_0x50d653;return _0x421e5d['on'](_0xede57(0x22b),_0x145093=>{const _0x4da06e=_0xede57;log(_0x4da06e(0x22b),_0x4da06e(0x1e0),_0x145093[_0x4da06e(0x245)]),_0x180c13?.['error'](_0x145093),_0x50d653?.[_0x4da06e(0x22b)](_0x145093);}),{'readable':new ReadableStream({'start'(_0x38b158){const _0x24f4ea=_0xede57;_0x180c13=_0x38b158,_0x421e5d['on'](_0x24f4ea(0x1af),_0x5e5c53=>{const _0x5273d6=_0x24f4ea;try{_0x38b158[_0x5273d6(0x280)](_0x5e5c53);}catch(_0x5790d8){log(_0x5273d6(0x22b),_0x5273d6(0x1a5),_0x5790d8['message']);}}),_0x421e5d['on']('end',()=>{const _0xfda3b4=_0x24f4ea;try{_0x38b158[_0xfda3b4(0x22e)]();}catch(_0x2a6bd7){log(_0xfda3b4(0x22b),'Read\x20controller\x20close\x20error:',_0x2a6bd7['message']);}});},'cancel'(){const _0x592748=_0xede57;_0x421e5d[_0x592748(0x23a)]();}}),'writable':new WritableStream({'start'(_0x5bc0b7){_0x50d653=_0x5bc0b7;},'write'(_0x276efd){return new Promise((_0x31e5e9,_0x16c03d)=>{const _0x15d35c=_0x4fd1;if(_0x421e5d[_0x15d35c(0x21e)]){_0x16c03d(new Error(_0x15d35c(0x1e9)));return;}_0x421e5d[_0x15d35c(0x21a)](_0x276efd,_0x5ddb39=>{if(_0x5ddb39)_0x16c03d(_0x5ddb39);else _0x31e5e9();});});},'close'(){const _0x5043bc=_0xede57;!_0x421e5d[_0x5043bc(0x21e)]&&_0x421e5d[_0x5043bc(0x209)]();},'abort'(_0x64a3d){const _0x119cdd=_0xede57;_0x421e5d[_0x119cdd(0x23a)](_0x64a3d);}})};}function relay(_0x5aa99e,_0x120b1c,_0x4059cf,_0x32a85a){const _0x88211d=_0x42bcb7,_0x107959=pipe_relay();let _0x210d59=![];const _0x1f3ec2=socketToWebStream(_0x4059cf);function _0x59aa68(){const _0x15947c=_0x4fd1;if(!_0x210d59){_0x210d59=!![];try{_0x4059cf['destroy']();}catch(_0x3b20b1){!_0x3b20b1[_0x15947c(0x245)][_0x15947c(0x1c4)](_0x15947c(0x294))&&!_0x3b20b1[_0x15947c(0x245)][_0x15947c(0x1c4)](_0x15947c(0x2a3))&&log(_0x15947c(0x22b),_0x15947c(0x25f)+_0x3b20b1[_0x15947c(0x245)]);}}}const _0x48f973=_0x107959(_0x120b1c,_0x1f3ec2,_0x32a85a[_0x88211d(0x1af)])['catch'](_0x49de11=>{const _0x4cc0b4=_0x88211d;!_0x49de11[_0x4cc0b4(0x245)][_0x4cc0b4(0x1c4)](_0x4cc0b4(0x294))&&!_0x49de11[_0x4cc0b4(0x245)][_0x4cc0b4(0x1c4)](_0x4cc0b4(0x2a3))&&log('error',_0x4cc0b4(0x1ff)+_0x49de11[_0x4cc0b4(0x245)]);})[_0x88211d(0x28d)](()=>{const _0x301df0=_0x88211d;_0x120b1c[_0x301df0(0x1f9)]&&_0x120b1c[_0x301df0(0x1f9)]();}),_0x49c08f=_0x107959(_0x1f3ec2,_0x120b1c,_0x32a85a[_0x88211d(0x2a0)])['catch'](_0x2911ce=>{const _0x9401b2=_0x88211d;!_0x2911ce[_0x9401b2(0x245)]['includes'](_0x9401b2(0x294))&&!_0x2911ce[_0x9401b2(0x245)][_0x9401b2(0x1c4)](_0x9401b2(0x2a3))&&log(_0x9401b2(0x22b),_0x9401b2(0x1c7)+_0x2911ce[_0x9401b2(0x245)]);});_0x49c08f[_0x88211d(0x28d)](()=>_0x48f973)['finally'](_0x59aa68);}const sessions=new Map();class Session{constructor(_0x123d75){const _0x52beb0=_0x42bcb7;this['uuid']=_0x123d75,this[_0x52beb0(0x24a)]=0x0,this[_0x52beb0(0x28a)]=![],this[_0x52beb0(0x1ac)]=Date[_0x52beb0(0x253)](),this['vlessHeader']=null,this['remote']=null,this[_0x52beb0(0x23f)]=![],this[_0x52beb0(0x219)]=null,this[_0x52beb0(0x244)]=![],this['bufferedData']=new Map(),this[_0x52beb0(0x230)]=![],this[_0x52beb0(0x295)]=[],this[_0x52beb0(0x1b5)]=null,this[_0x52beb0(0x28c)]=new Map(),log(_0x52beb0(0x283),_0x52beb0(0x1f3)+_0x123d75);}async[_0x42bcb7(0x23b)](_0x2cc4aa){const _0xad98d1=_0x42bcb7;if(this['initialized'])return!![];try{log('debug',_0xad98d1(0x1e5));const _0x51949f=new ReadableStream({'start'(_0x5d5b2a){const _0x5f5b84=_0xad98d1;_0x5d5b2a[_0x5f5b84(0x280)](_0x2cc4aa),_0x5d5b2a[_0x5f5b84(0x22e)]();}}),_0x2eef7d={'readable':_0x51949f,'writable':new WritableStream()};return this[_0xad98d1(0x217)]=await parse_header(SETTINGS['UUID'],_0x2eef7d),log(_0xad98d1(0x260),_0xad98d1(0x1d5)+this['vlessHeader'][_0xad98d1(0x278)]+':'+this[_0xad98d1(0x217)]['port']),this['remote']=await connect_remote(this[_0xad98d1(0x217)][_0xad98d1(0x278)],this['vlessHeader'][_0xad98d1(0x263)]),log('info',_0xad98d1(0x285)),this['initialized']=!![],!![];}catch(_0x9c1368){return log(_0xad98d1(0x22b),_0xad98d1(0x1ee)+_0x9c1368['message']),![];}}async['processPacket'](_0x507343,_0x317e36){const _0x42af75=_0x42bcb7;try{this[_0x42af75(0x28c)][_0x42af75(0x27f)](_0x507343,_0x317e36),log(_0x42af75(0x283),'Buffered\x20packet\x20seq='+_0x507343+_0x42af75(0x1d6)+_0x317e36['length']);while(this[_0x42af75(0x28c)][_0x42af75(0x1cb)](this[_0x42af75(0x24a)])){const _0x419b90=this[_0x42af75(0x28c)]['get'](this['nextSeq']);this['pendingBuffers']['delete'](this[_0x42af75(0x24a)]);if(!this['initialized']&&this[_0x42af75(0x24a)]===0x0){if(!await this['initializeVLESS'](_0x419b90))throw new Error('Failed\x20to\x20initialize\x20VLESS\x20connection');this[_0x42af75(0x219)]=Buffer[_0x42af75(0x20a)](this['vlessHeader'][_0x42af75(0x2a0)]),await this['_writeToRemote'](this[_0x42af75(0x217)]['data']),this[_0x42af75(0x1b5)]&&this['_startDownstreamResponse']();}else{if(!this[_0x42af75(0x23f)]){log(_0x42af75(0x1a9),_0x42af75(0x21f)+_0x507343+_0x42af75(0x258));continue;}await this[_0x42af75(0x23d)](_0x419b90);}this[_0x42af75(0x24a)]++,log('debug','Processed\x20packet\x20seq='+(this[_0x42af75(0x24a)]-0x1));}if(this['pendingBuffers'][_0x42af75(0x1b1)]>SETTINGS[_0x42af75(0x214)])throw new Error(_0x42af75(0x261));return!![];}catch(_0xa69c4d){log(_0x42af75(0x22b),'Process\x20packet\x20error:\x20'+_0xa69c4d['message']);throw _0xa69c4d;}}['_startDownstreamResponse'](){const _0x63e8f9=_0x42bcb7;if(!this[_0x63e8f9(0x1b5)]||!this['responseHeader'])return;try{const _0x38d5d1=this['currentStreamRes'][_0x63e8f9(0x220)]?.['alpnProtocol']||_0x63e8f9(0x24d),_0x337709=_0x38d5d1==='h2';!this['headerSent']&&(log('debug','Sending\x20VLESS\x20response\x20header\x20('+_0x38d5d1+_0x63e8f9(0x1de)+this[_0x63e8f9(0x219)][_0x63e8f9(0x1b7)]+_0x63e8f9(0x1e7)),this[_0x63e8f9(0x1b5)][_0x63e8f9(0x21a)](this[_0x63e8f9(0x219)]),this[_0x63e8f9(0x244)]=!![]);if(_0x337709){this[_0x63e8f9(0x1b5)][_0x63e8f9(0x220)][_0x63e8f9(0x2a2)](!![]);const _0x4c26f3=new require(_0x63e8f9(0x22f))['Transform']({'transform'(_0x515be2,_0x1f0873,_0x1a43d0){const _0x42eb6b=_0x63e8f9,_0xf5cef8=0x4000;for(let _0x2d54fd=0x0;_0x2d54fd<_0x515be2[_0x42eb6b(0x1b7)];_0x2d54fd+=_0xf5cef8){this[_0x42eb6b(0x25c)](_0x515be2[_0x42eb6b(0x2a7)](_0x2d54fd,_0x2d54fd+_0xf5cef8));}_0x1a43d0();}});this[_0x63e8f9(0x1b2)][_0x63e8f9(0x27d)](_0x4c26f3)[_0x63e8f9(0x27d)](this[_0x63e8f9(0x1b5)]);}else this[_0x63e8f9(0x1b2)][_0x63e8f9(0x27d)](this['currentStreamRes']);this[_0x63e8f9(0x1b2)]['on']('end',()=>{const _0x43a618=_0x63e8f9;!this[_0x43a618(0x1b5)][_0x43a618(0x1e8)]&&this[_0x43a618(0x1b5)][_0x43a618(0x209)]();}),this[_0x63e8f9(0x1b2)]['on'](_0x63e8f9(0x22b),_0x301683=>{const _0x2acf2b=_0x63e8f9;log(_0x2acf2b(0x22b),_0x2acf2b(0x2a6)+_0x301683[_0x2acf2b(0x245)]),!this[_0x2acf2b(0x1b5)][_0x2acf2b(0x1e8)]&&this[_0x2acf2b(0x1b5)]['end']();});}catch(_0x9aa565){log(_0x63e8f9(0x22b),_0x63e8f9(0x1f6)+_0x9aa565[_0x63e8f9(0x245)]),this[_0x63e8f9(0x243)]();}}[_0x42bcb7(0x236)](_0x53284b,_0x272759){const _0x23d79e=_0x42bcb7;return!_0x53284b['headersSent']&&_0x53284b['writeHead'](0xc8,_0x272759),this[_0x23d79e(0x1b5)]=_0x53284b,this[_0x23d79e(0x23f)]&&this[_0x23d79e(0x219)]&&this[_0x23d79e(0x19e)](),_0x53284b['on'](_0x23d79e(0x22e),()=>{const _0x2731cf=_0x23d79e;log(_0x2731cf(0x260),'Client\x20connection\x20closed'),this[_0x2731cf(0x243)]();}),!![];}async['_writeToRemote'](_0x23f0a3){const _0x41df9d=_0x42bcb7;if(!this[_0x41df9d(0x1b2)]||this[_0x41df9d(0x1b2)][_0x41df9d(0x21e)])throw new Error(_0x41df9d(0x1b9));return new Promise((_0x28bc04,_0x5c903f)=>{const _0x2d1ff5=_0x41df9d;this[_0x2d1ff5(0x1b2)]['write'](_0x23f0a3,_0x16b09f=>{const _0x49346e=_0x2d1ff5;_0x16b09f?(log(_0x49346e(0x22b),'Failed\x20to\x20write\x20to\x20remote:\x20'+_0x16b09f[_0x49346e(0x245)]),_0x5c903f(_0x16b09f)):_0x28bc04();});});}['_startDownstreamResponse'](){const _0x21e995=_0x42bcb7;if(!this[_0x21e995(0x1b5)]||!this[_0x21e995(0x219)])return;try{!this[_0x21e995(0x244)]&&(this[_0x21e995(0x1b5)][_0x21e995(0x21a)](this[_0x21e995(0x219)]),this[_0x21e995(0x244)]=!![]),this[_0x21e995(0x1b2)][_0x21e995(0x27d)](this[_0x21e995(0x1b5)]),this[_0x21e995(0x1b2)]['on'](_0x21e995(0x209),()=>{const _0x1d0aec=_0x21e995;!this[_0x1d0aec(0x1b5)]['writableEnded']&&this['currentStreamRes'][_0x1d0aec(0x209)]();}),this[_0x21e995(0x1b2)]['on'](_0x21e995(0x22b),_0x37944a=>{const _0x98a989=_0x21e995;log(_0x98a989(0x22b),_0x98a989(0x2a6)+_0x37944a[_0x98a989(0x245)]),!this[_0x98a989(0x1b5)]['writableEnded']&&this[_0x98a989(0x1b5)][_0x98a989(0x209)]();});}catch(_0x1a1e88){log(_0x21e995(0x22b),_0x21e995(0x1f6)+_0x1a1e88['message']),this['cleanup']();}}[_0x42bcb7(0x243)](){const _0x295ce8=_0x42bcb7;!this[_0x295ce8(0x230)]&&(this[_0x295ce8(0x230)]=!![],log(_0x295ce8(0x283),_0x295ce8(0x212)+this[_0x295ce8(0x20c)]),this[_0x295ce8(0x1b2)]&&(this[_0x295ce8(0x1b2)][_0x295ce8(0x23a)](),this[_0x295ce8(0x1b2)]=null),this[_0x295ce8(0x23f)]=![],this[_0x295ce8(0x244)]=![]);}}async function getCloudflareMeta(){return new Promise((_0x4704dc,_0x1de2ed)=>{const _0x159d53=_0x4fd1,_0x56ddf4={'hostname':_0x159d53(0x201),'path':_0x159d53(0x29a),'method':_0x159d53(0x25a)},_0x5b6f8b=https['request'](_0x56ddf4,_0x884069=>{const _0x24a0b6=_0x159d53;let _0x30fb58='';_0x884069['on'](_0x24a0b6(0x1af),_0x18a768=>{_0x30fb58+=_0x18a768;}),_0x884069['on'](_0x24a0b6(0x209),()=>{const _0x16d95a=JSON['parse'](_0x30fb58);_0x4704dc(_0x16d95a);});});_0x5b6f8b['on'](_0x159d53(0x22b),_0x11fe87=>{_0x1de2ed(_0x11fe87);}),_0x5b6f8b[_0x159d53(0x209)]();});}function _0x4fd1(_0x1ade66,_0x44a4c4){const _0x571f8b=_0x571f();return _0x4fd1=function(_0x4fd1f9,_0x40783c){_0x4fd1f9=_0x4fd1f9-0x198;let _0x28dad7=_0x571f8b[_0x4fd1f9];return _0x28dad7;},_0x4fd1(_0x1ade66,_0x44a4c4);}let UPLOAD_DATA;async function generateLinks(){const _0xa3b2a7=_0x42bcb7;let _0x5b47b0=await getCloudflareMeta(),_0x3f07f6=_0x5b47b0['clientIp'],_0x2012da=_0x5b47b0['country'],_0x251b18=_0x5b47b0[_0xa3b2a7(0x299)];ISP=(_0x2012da+'-'+_0x251b18)['replace'](/ /g,'_');let _0x302a4b,_0x49f933;if(MY_DOMAIN&&!LOCAL_DOMAIN)UPLOAD_DATA=_0xa3b2a7(0x28b)+UUID+'@'+CFIP+':'+CFPORT+_0xa3b2a7(0x246)+MY_DOMAIN+'&fp=chrome&allowInsecure=1&type=xhttp&host='+MY_DOMAIN+_0xa3b2a7(0x242)+SETTINGS[_0xa3b2a7(0x1eb)]+_0xa3b2a7(0x277)+ISP+'-'+SUB_NAME;else{if(LOCAL_DOMAIN&&!MY_DOMAIN)UPLOAD_DATA=_0xa3b2a7(0x28b)+UUID+'@'+LOCAL_DOMAIN+':80?encryption=none&security=none&sni='+LOCAL_DOMAIN+_0xa3b2a7(0x1a4)+LOCAL_DOMAIN+_0xa3b2a7(0x242)+SETTINGS[_0xa3b2a7(0x1eb)]+_0xa3b2a7(0x277)+ISP+'-'+SUB_NAME;else!MY_DOMAIN&&!LOCAL_DOMAIN&&(_0x3f07f6[_0xa3b2a7(0x1c4)](':')?_0x302a4b='['+_0x3f07f6+']':_0x302a4b=''+_0x3f07f6,UPLOAD_DATA=_0xa3b2a7(0x28b)+UUID+'@'+_0x302a4b+':'+PORT+_0xa3b2a7(0x1ea)+_0x302a4b+_0xa3b2a7(0x1a4)+_0x302a4b+_0xa3b2a7(0x242)+SETTINGS['XPATH']+'&mode=packet-up#'+ISP+'-'+SUB_NAME);}return UPLOAD_DATA;}const server=http[_0x42bcb7(0x281)]((_0x3341bc,_0x4a1fd4)=>{const _0x5bf6d1=_0x42bcb7,_0x2c1642={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':'GET,\x20POST','Cache-Control':_0x5bf6d1(0x235),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x3341bc[_0x5bf6d1(0x233)]==='/'){_0x4a1fd4[_0x5bf6d1(0x249)](0xc8,{'Content-Type':_0x5bf6d1(0x25d)}),_0x4a1fd4[_0x5bf6d1(0x209)](_0x5bf6d1(0x207));return;}if(_0x3341bc[_0x5bf6d1(0x233)]==='/'+UUID){const _0x4fe61a=''+UPLOAD_DATA,_0xf249fe=Buffer[_0x5bf6d1(0x20a)](_0x4fe61a)[_0x5bf6d1(0x28f)](_0x5bf6d1(0x226));_0x4a1fd4['writeHead'](0xc8,{'Content-Type':_0x5bf6d1(0x25d)}),_0x4a1fd4[_0x5bf6d1(0x209)](_0xf249fe+'\x0a');return;}const _0x5aec0f=_0x3341bc[_0x5bf6d1(0x233)][_0x5bf6d1(0x1d9)](new RegExp(XPATH+_0x5bf6d1(0x1d4)));if(!_0x5aec0f){_0x4a1fd4['writeHead'](0x194),_0x4a1fd4[_0x5bf6d1(0x209)]();return;}const _0x33d534=_0x5aec0f[0x1],_0x5e84da=_0x5aec0f[0x2]?parseInt(_0x5aec0f[0x2]):null;if(_0x3341bc[_0x5bf6d1(0x234)]==='GET'&&!_0x5e84da){_0x2c1642['Content-Type']=_0x5bf6d1(0x1f5),_0x2c1642['Transfer-Encoding']=_0x5bf6d1(0x218);let _0x295270=sessions['get'](_0x33d534);!_0x295270&&(_0x295270=new Session(_0x33d534),sessions[_0x5bf6d1(0x27f)](_0x33d534,_0x295270),log(_0x5bf6d1(0x260),_0x5bf6d1(0x269)+_0x33d534));_0x295270[_0x5bf6d1(0x28a)]=!![];!_0x295270[_0x5bf6d1(0x236)](_0x4a1fd4,_0x2c1642)&&(log(_0x5bf6d1(0x22b),_0x5bf6d1(0x293)+_0x33d534),!_0x4a1fd4['headersSent']&&(_0x4a1fd4[_0x5bf6d1(0x249)](0x1f4),_0x4a1fd4[_0x5bf6d1(0x209)]()),_0x295270[_0x5bf6d1(0x243)](),sessions[_0x5bf6d1(0x27a)](_0x33d534));return;}if(_0x3341bc[_0x5bf6d1(0x234)]===_0x5bf6d1(0x1a8)&&_0x5e84da!==null){let _0x485ebf=sessions['get'](_0x33d534);!_0x485ebf&&(_0x485ebf=new Session(_0x33d534),sessions['set'](_0x33d534,_0x485ebf),log(_0x5bf6d1(0x260),_0x5bf6d1(0x199)+_0x33d534),setTimeout(()=>{const _0x109be8=_0x5bf6d1,_0x43c321=sessions[_0x109be8(0x1fe)](_0x33d534);_0x43c321&&!_0x43c321[_0x109be8(0x28a)]&&(log(_0x109be8(0x1a9),_0x109be8(0x202)+_0x33d534+'\x20timed\x20out\x20without\x20downstream'),_0x43c321[_0x109be8(0x243)](),sessions[_0x109be8(0x27a)](_0x33d534));},SETTINGS['SESSION_TIMEOUT']));let _0x396bb1=[],_0x3a1ae3=0x0,_0x558e22=![];_0x3341bc['on'](_0x5bf6d1(0x1af),_0x8014c3=>{const _0x415629=_0x5bf6d1;_0x3a1ae3+=_0x8014c3['length'];if(_0x3a1ae3>SETTINGS['MAX_POST_SIZE']){!_0x558e22&&(_0x4a1fd4['writeHead'](0x19d),_0x4a1fd4[_0x415629(0x209)](),_0x558e22=!![]);return;}_0x396bb1[_0x415629(0x25c)](_0x8014c3);}),_0x3341bc['on']('end',async()=>{const _0x5c97ee=_0x5bf6d1;if(_0x558e22)return;try{const _0x11e601=Buffer[_0x5c97ee(0x1cd)](_0x396bb1);log(_0x5c97ee(0x260),_0x5c97ee(0x23c)+_0x5e84da+_0x5c97ee(0x1d6)+_0x11e601[_0x5c97ee(0x1b7)]),await _0x485ebf[_0x5c97ee(0x22c)](_0x5e84da,_0x11e601),!_0x558e22&&(_0x4a1fd4[_0x5c97ee(0x249)](0xc8,_0x2c1642),_0x558e22=!![]),_0x4a1fd4[_0x5c97ee(0x209)]();}catch(_0x398f08){log(_0x5c97ee(0x22b),_0x5c97ee(0x1ed)+_0x398f08['message']),_0x485ebf[_0x5c97ee(0x243)](),sessions[_0x5c97ee(0x27a)](_0x33d534),!_0x558e22&&(_0x4a1fd4[_0x5c97ee(0x249)](0x1f4),_0x558e22=!![]),_0x4a1fd4[_0x5c97ee(0x209)]();}});return;}_0x4a1fd4[_0x5bf6d1(0x249)](0x194),_0x4a1fd4['end']();});server['on'](_0x42bcb7(0x1bd),_0x2249b7=>{const _0x5ce999=_0x42bcb7;log(_0x5ce999(0x283),_0x5ce999(0x1fa)+(_0x2249b7['alpnProtocol']||_0x5ce999(0x24d)));});function generatePadding(_0x54b5e5,_0x3c3b43){const _0x4e44cf=_0x42bcb7,_0x592298=_0x54b5e5+Math[_0x4e44cf(0x2a5)](Math[_0x4e44cf(0x1d3)]()*(_0x3c3b43-_0x54b5e5));return Buffer[_0x4e44cf(0x20a)](Array(_0x592298)[_0x4e44cf(0x1ef)]('X')[_0x4e44cf(0x1f7)](''))[_0x4e44cf(0x28f)]('base64');}server[_0x42bcb7(0x1f0)]=0x975e0,server[_0x42bcb7(0x1bc)]=0x98968,server['on'](_0x42bcb7(0x22b),_0x1d9d8a=>{const _0x534eef=_0x42bcb7;log('error',_0x534eef(0x24f)+_0x1d9d8a['message']);});async function uploadSubscription(_0x19e7da,_0x368076,_0x42e299){const _0x12392b=_0x42bcb7,_0x2d11a0=JSON[_0x12392b(0x296)]({'URL_NAME':_0x19e7da,'URL':_0x368076}),_0x342b9d=Buffer['from'](_0x2d11a0,_0x12392b(0x286)),_0xb3d748=_0x342b9d[_0x12392b(0x1b7)],_0x38ac2e=new URL(_0x42e299),_0x38eaf6={'hostname':_0x38ac2e['hostname'],'port':_0x38ac2e[_0x12392b(0x263)]||0x1bb,'path':_0x38ac2e[_0x12392b(0x231)],'method':_0x12392b(0x1a8),'headers':{'Content-Type':_0x12392b(0x1ad),'Content-Length':_0xb3d748}};try{const _0x5139d3=await new Promise((_0x1f1c54,_0x75e8f4)=>{const _0x45fc7c=_0x12392b,_0x27cbac=https[_0x45fc7c(0x1e1)](_0x38eaf6,_0x3213ac=>{const _0x21cd96=_0x45fc7c;if(_0x3213ac[_0x21cd96(0x1c3)]<0xc8||_0x3213ac[_0x21cd96(0x1c3)]>=0x12c)return _0x75e8f4(new Error(_0x21cd96(0x24e)+_0x3213ac[_0x21cd96(0x1c3)]+_0x21cd96(0x22a)+_0x3213ac['statusMessage']));let _0x1af0fa='';_0x3213ac['on'](_0x21cd96(0x1af),_0x13bc51=>_0x1af0fa+=_0x13bc51),_0x3213ac['on'](_0x21cd96(0x209),()=>_0x1f1c54(_0x1af0fa));});_0x27cbac['on'](_0x45fc7c(0x22b),_0x33c2b8=>_0x75e8f4(_0x33c2b8)),_0x27cbac[_0x45fc7c(0x21a)](_0x342b9d),_0x27cbac['end']();});return _0x5139d3;}catch(_0x5aa9c7){console[_0x12392b(0x22b)](_0x12392b(0x24b),_0x5aa9c7[_0x12392b(0x245)]);}}function cleanfiles(){setTimeout(()=>{const _0x5a972d=_0x4fd1;let _0x1098be;KEEPALIVE?_0x1098be=[]:_0x1098be=[FILE_PATH+'/'+fileMapping[_0x5a972d(0x27c)],FILE_PATH+_0x5a972d(0x1e3)],_0x1098be[_0x5a972d(0x216)](_0x58f5ac=>{const _0x4e2f70=_0x5a972d;try{fs['existsSync'](_0x58f5ac)&&(fs['lstatSync'](_0x58f5ac)[_0x4e2f70(0x1a2)]()?fs[_0x4e2f70(0x275)](_0x58f5ac,{'recursive':!![]}):fs[_0x4e2f70(0x1b4)](_0x58f5ac));}catch(_0x24c9b6){}}),console[_0x5a972d(0x26c)](),console['log']('App\x20is\x20running');},0xea60);}server[_0x42bcb7(0x1a1)](PORT,async()=>{const _0x2044f5=_0x42bcb7;await generateLinks(),createFolder(FILE_PATH);NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&(await downloadFiles(),await delay(0x1388));await run(),cleanfiles(),console['log'](_0x2044f5(0x20e)+PORT);if(SUB_URL)try{const _0x65277=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0x5e5c19){console['error'](_0x2044f5(0x257),_0x5e5c19);}KEEPALIVE&&(await keep_alive(),setInterval(keep_alive,intervalInseconds*0x3e8));});