const _0x1d0809=_0x535e;(function(_0x518e8a,_0x3944e9){const _0x252088=_0x535e,_0x5c4d3f=_0x518e8a();while(!![]){try{const _0x12d590=-parseInt(_0x252088(0xb3))/0x1*(-parseInt(_0x252088(0xe1))/0x2)+parseInt(_0x252088(0x11c))/0x3*(-parseInt(_0x252088(0x1a1))/0x4)+-parseInt(_0x252088(0xa3))/0x5*(-parseInt(_0x252088(0xf4))/0x6)+parseInt(_0x252088(0x17f))/0x7+-parseInt(_0x252088(0xd9))/0x8*(-parseInt(_0x252088(0xc9))/0x9)+-parseInt(_0x252088(0x9e))/0xa+parseInt(_0x252088(0x123))/0xb;if(_0x12d590===_0x3944e9)break;else _0x5c4d3f['push'](_0x5c4d3f['shift']());}catch(_0x1d7c7e){_0x5c4d3f['push'](_0x5c4d3f['shift']());}}}(_0x349f,0x2919a));const os=require('os'),fs=require('fs'),net=require(_0x1d0809(0x192)),path=require('path'),http=require(_0x1d0809(0x97)),https=require('https'),axios=require('axios'),{Buffer}=require(_0x1d0809(0x152)),{exec,execSync}=require(_0x1d0809(0x1a7)),FILE_PATH=process['env'][_0x1d0809(0xec)]||_0x1d0809(0x108),AUTO_ACCESS=process[_0x1d0809(0x180)]['AUTO_ACCESS']||![],DOMAIN=process[_0x1d0809(0x180)][_0x1d0809(0x8f)]||'',BAOHUO_URL=process[_0x1d0809(0x180)][_0x1d0809(0xcd)]||'',SUB_PATH=process[_0x1d0809(0x180)][_0x1d0809(0x118)]||_0x1d0809(0xe4),PORT=process[_0x1d0809(0x180)][_0x1d0809(0x132)]||0xbb8,CFPORT=process['env'][_0x1d0809(0xa1)]||0x1bb,SUB_URL=process[_0x1d0809(0x180)][_0x1d0809(0xe6)]||'',KEEPALIVE=process[_0x1d0809(0x180)]['KEEPALIVE']||![],delay=_0x36839e=>new Promise(_0x17bb63=>setTimeout(_0x17bb63,_0x36839e)),UUID=process[_0x1d0809(0x180)][_0x1d0809(0xbc)]||'',XPATH=process[_0x1d0809(0x180)][_0x1d0809(0x167)]||UUID[_0x1d0809(0x161)](0x0,0x8),HTTPSTLS=process['env'][_0x1d0809(0xcf)]||!![],NEZHA_VERSION=process[_0x1d0809(0x180)][_0x1d0809(0x164)]||'V0',NEZHA_SERVER=process[_0x1d0809(0x180)][_0x1d0809(0xfa)]||'',NEZHA_PORT=process[_0x1d0809(0x180)][_0x1d0809(0xd4)]||'443',NEZHA_KEY=process[_0x1d0809(0x180)]['NEZHA_KEY']||'',SUB_NAME=process['env'][_0x1d0809(0x10d)]||'',MY_DOMAIN=process[_0x1d0809(0x180)]['MY_DOMAIN']||'',SETTINGS={[_0x1d0809(0xbc)]:UUID,[_0x1d0809(0x130)]:_0x1d0809(0x18a),[_0x1d0809(0x1ab)]:_0x1d0809(0xa4),[_0x1d0809(0x167)]:'%2F'+XPATH,[_0x1d0809(0x124)]:0x1e,['MAX_POST_SIZE']:0xf4240,[_0x1d0809(0xb1)]:0x7530,['CHUNK_SIZE']:0x400*0x400,[_0x1d0809(0x105)]:!![],['TCP_KEEPALIVE']:!![]};function validate_uuid(_0x388dca,_0x42064c){for(let _0x50abdf=0x0;_0x50abdf<0x10;_0x50abdf++){if(_0x388dca[_0x50abdf]!==_0x42064c[_0x50abdf])return![];}return!![];}function concat_typed_arrays(_0x3de6c9,..._0x545ec6){const _0x2824af=_0x1d0809;if(!_0x545ec6||_0x545ec6[_0x2824af(0x163)]<0x1)return _0x3de6c9;let _0x12eca8=_0x3de6c9[_0x2824af(0x163)];for(let _0x594dc6 of _0x545ec6)_0x12eca8+=_0x594dc6[_0x2824af(0x163)];const _0x3c3625=new _0x3de6c9[(_0x2824af(0xe8))](_0x12eca8);_0x3c3625[_0x2824af(0xe3)](_0x3de6c9,0x0),_0x12eca8=_0x3de6c9[_0x2824af(0x163)];for(let _0x16342c of _0x545ec6){_0x3c3625[_0x2824af(0xe3)](_0x16342c,_0x12eca8),_0x12eca8+=_0x16342c[_0x2824af(0x163)];}return _0x3c3625;}function log(_0x12d28c,..._0xe69df2){const _0x23ed6d=_0x1d0809;if(SETTINGS[_0x23ed6d(0x130)]===_0x23ed6d(0x18a))return;const _0x579ac9={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0xb122e6={'debug':_0x23ed6d(0x197),'info':_0x23ed6d(0x102),'warn':_0x23ed6d(0x144),'error':_0x23ed6d(0x10b),'reset':_0x23ed6d(0xde)},_0x560a2f=_0x579ac9[SETTINGS[_0x23ed6d(0x130)]]||0x1,_0x2ae896=_0x579ac9[_0x12d28c]||0x0;if(_0x2ae896>=_0x560a2f){const _0x2afa6b=new Date()[_0x23ed6d(0xf8)](),_0x6970ad=_0xb122e6[_0x12d28c]||_0xb122e6[_0x23ed6d(0x12d)];console[_0x23ed6d(0xce)](_0x6970ad+'['+_0x2afa6b+_0x23ed6d(0x100)+_0x12d28c+']',..._0xe69df2,_0xb122e6[_0x23ed6d(0x12d)]);}}function cleanupOldFiles(){const _0x36f3d5=_0x1d0809;if(fs[_0x36f3d5(0xad)](path[_0x36f3d5(0x12e)](FILE_PATH)))fs[_0x36f3d5(0x134)](path[_0x36f3d5(0x12e)](FILE_PATH),{'recursive':!![]});else{}}function createFolder(_0x2a1cb1){const _0x1486dd=_0x1d0809;if(!fs[_0x1486dd(0xad)](_0x2a1cb1))fs['mkdirSync'](_0x2a1cb1);else{}}function execPromise(_0x25930c,_0x238e18={}){return new Promise((_0x2e41c5,_0x475c91)=>{const _0x5aed1f=exec(_0x25930c,_0x238e18,(_0x58a215,_0x3990b2,_0x210984)=>{const _0x5f6aae=_0x535e;if(_0x58a215){const _0x1f392b=new Error('Command\x20failed:\x20'+_0x58a215[_0x5f6aae(0xcc)]);_0x1f392b['code']=_0x58a215[_0x5f6aae(0xcb)],_0x1f392b[_0x5f6aae(0x141)]=_0x210984['trim'](),_0x475c91(_0x1f392b);}else _0x2e41c5(_0x3990b2['trim']());});});}async function addAccessTask(){const _0x18d360=_0x1d0809;if(AUTO_ACCESS!==!![])return;if(!DOMAIN)return;try{const _0x2788d=_0x18d360(0xab)+DOMAIN,_0x2e39bc=_0x18d360(0xc6)+BAOHUO_URL+_0x18d360(0xdd)+_0x2788d+_0x18d360(0x146),_0x35f9f3=await execPromise(_0x2e39bc);console[_0x18d360(0xce)]('Automatic\x20Access\x20Task\x20added\x20successfully:',_0x35f9f3);}catch(_0x5aa8dd){console['error'](_0x18d360(0x13f),_0x5aa8dd[_0x18d360(0xcc)]);}}async function detectProcess(_0x2ea32d){const _0x276c72=_0x1d0809,_0x45d455=[{'cmd':_0x276c72(0x182)+_0x2ea32d+'\x22','name':'pidof'},{'cmd':_0x276c72(0x1a5)+_0x2ea32d+'\x22','name':_0x276c72(0x184)},{'cmd':_0x276c72(0xd6)+_0x2ea32d+'\x22\x20\x27$2\x20==\x20name\x20{print\x20$1}\x27','name':'ps+awk'}];for(const _0x382b31 of _0x45d455){try{const _0x2140e4=await execPromise(_0x382b31[_0x276c72(0xb8)]);if(_0x2140e4)return _0x2140e4['replace'](/\n/g,'\x20')[_0x276c72(0xd5)]();}catch(_0x40a228){_0x40a228[_0x276c72(0xcb)]!==0x7f&&_0x40a228['code']!==0x1&&console['debug'](_0x276c72(0xc0)+_0x382b31['name']+_0x276c72(0x156),_0x40a228[_0x276c72(0xcc)]);}}return'';}function _0x535e(_0x1efa8b,_0x5ad66d){const _0x349fba=_0x349f();return _0x535e=function(_0x535e35,_0x1f555e){_0x535e35=_0x535e35-0x8e;let _0x51b33c=_0x349fba[_0x535e35];return _0x51b33c;},_0x535e(_0x1efa8b,_0x5ad66d);}function generateRandomString(_0x36a3c2){const _0x16452b=_0x1d0809,_0x3530cf=_0x16452b(0xef);let _0x2ea877='';for(let _0x7fca60=0x0;_0x7fca60<_0x36a3c2;_0x7fca60++){_0x2ea877+=_0x3530cf[_0x16452b(0x126)](Math['floor'](Math[_0x16452b(0xdb)]()*_0x3530cf[_0x16452b(0x163)]));}return _0x2ea877;}function getSystemArchitecture(){const _0x40c939=_0x1d0809,_0x9e9e33=os[_0x40c939(0x171)]();return _0x9e9e33===_0x40c939(0x137)||_0x9e9e33===_0x40c939(0xdf)||_0x9e9e33===_0x40c939(0xb6)?_0x40c939(0x137):_0x40c939(0xe5);}function getFilesForArchitecture(_0x50178b){const _0x84834a=_0x1d0809,_0x29381b={'app':{'V0':{'arm':_0x84834a(0x168),'amd':_0x84834a(0x162)},'V1':{'arm':_0x84834a(0xfb),'amd':_0x84834a(0xb0)}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0x4ba72d=[{'fileName':generateRandomString(0x5),'originalName':'app','fileUrl':_0x29381b['app'][NEZHA_VERSION][_0x50178b]}];return _0x4ba72d;}else return[];}function authorizeFiles(_0x1811de){const _0x3a1e75=_0x1d0809,_0x2f3995=0x1fd;_0x1811de[_0x3a1e75(0x10f)](_0x33aee4=>{const _0x49a429=_0x3a1e75,_0x3f6870=path[_0x49a429(0x12e)](FILE_PATH,_0x33aee4[_0x49a429(0x13d)]);fs[_0x49a429(0x166)](_0x3f6870,_0x2f3995,_0x53cc1c=>{const _0x27b864=_0x49a429;_0x53cc1c?console[_0x27b864(0x116)](_0x27b864(0x185)+_0x3f6870+'\x20('+_0x33aee4[_0x27b864(0xfe)]+_0x27b864(0x98)+_0x53cc1c):console[_0x27b864(0xce)](_0x27b864(0x159)+_0x3f6870+'\x20('+_0x33aee4[_0x27b864(0xfe)]+_0x27b864(0x98)+_0x2f3995['toString'](0x8));});});}function download_function(_0x45681c,_0x5ef3dc,_0x238201,_0x1df9a9){const _0x3ce075=_0x1d0809,_0xe1d159=path[_0x3ce075(0x12e)](FILE_PATH,_0x45681c);if(fs['existsSync'](_0xe1d159)){console[_0x3ce075(0xce)](_0x3ce075(0x10e)+_0x5ef3dc+_0x3ce075(0xb7)+_0x45681c+')\x20already\x20exists,\x20skipping\x20download.'),_0x1df9a9(null,{'fileName':_0x45681c,'originalName':_0x5ef3dc});return;}const _0xfa3fa4=fs['createWriteStream'](_0xe1d159);axios({'method':_0x3ce075(0xbd),'url':_0x238201,'responseType':'stream'})['then'](_0x4900b9=>{const _0x6fe0c1=_0x3ce075;_0x4900b9['data'][_0x6fe0c1(0x121)](_0xfa3fa4),_0xfa3fa4['on'](_0x6fe0c1(0xff),()=>{const _0x293df6=_0x6fe0c1;_0xfa3fa4[_0x293df6(0x16a)](),console[_0x293df6(0xce)](_0x293df6(0x14b)+_0x5ef3dc+_0x293df6(0xb7)+_0x45681c+_0x293df6(0x19c)),_0x1df9a9(null,{'fileName':_0x45681c,'originalName':_0x5ef3dc});}),_0xfa3fa4['on'](_0x6fe0c1(0x116),_0xb2d619=>{const _0x3736a5=_0x6fe0c1;fs[_0x3736a5(0x92)](_0xe1d159,()=>{});const _0x7c8ef='Download\x20'+_0x5ef3dc+_0x3736a5(0xb7)+_0x45681c+_0x3736a5(0x199)+_0xb2d619[_0x3736a5(0xcc)];console[_0x3736a5(0x116)](_0x7c8ef),_0x1df9a9(_0x7c8ef);});})[_0x3ce075(0x14d)](_0x4b2a7c=>{const _0x488bda=_0x3ce075,_0x4df320='Download\x20'+_0x5ef3dc+_0x488bda(0xb7)+_0x45681c+')\x20failed:\x20'+_0x4b2a7c[_0x488bda(0xcc)];console[_0x488bda(0x116)](_0x4df320),_0x1df9a9(_0x4df320);});}let fileMapping={};async function downloadFiles(){const _0x194968=_0x1d0809;try{const _0xe42bd6=getSystemArchitecture(),_0x2d9411=getFilesForArchitecture(_0xe42bd6);if(_0x2d9411[_0x194968(0x163)]===0x0){console['log']('Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture');return;}const _0x91ed0a=_0x2d9411[_0x194968(0x188)](_0x31a04e=>new Promise((_0x22510c,_0x4328ff)=>{const _0x187aa0=_0x194968;download_function(_0x31a04e[_0x187aa0(0x13d)],_0x31a04e[_0x187aa0(0xfe)],_0x31a04e[_0x187aa0(0x1a3)],(_0xabf456,_0x1a9dab)=>{if(_0xabf456)_0x4328ff(_0xabf456);else _0x22510c(_0x1a9dab);});})),_0x3568cb=await Promise[_0x194968(0xc8)](_0x91ed0a);return await authorizeFiles(_0x3568cb),_0x3568cb['forEach'](_0x27c406=>{const _0xbfffe2=_0x194968;fileMapping[_0x27c406[_0xbfffe2(0xfe)]]=_0x27c406[_0xbfffe2(0x13d)];}),fileMapping;}catch(_0x3e1fd9){return console[_0x194968(0x116)]('Error\x20downloading\x20files:',_0x3e1fd9),fileMapping;}}let NEZHA_TLS;function nezconfig(){const _0x5eed0d=_0x1d0809,_0xd9310e=['443',_0x5eed0d(0x19e),'2096',_0x5eed0d(0x17d),_0x5eed0d(0x112),_0x5eed0d(0x172)];if(NEZHA_VERSION==='V0')return _0xd9310e['includes'](NEZHA_PORT)?NEZHA_TLS=_0x5eed0d(0x17a):NEZHA_TLS='',NEZHA_TLS;else{if(NEZHA_VERSION==='V1'){_0xd9310e[_0x5eed0d(0xf7)](NEZHA_PORT)?NEZHA_TLS=_0x5eed0d(0xc7):NEZHA_TLS=_0x5eed0d(0x122);const _0xe4e39c=path[_0x5eed0d(0x12e)](FILE_PATH,_0x5eed0d(0x11e)),_0x16a67f=_0x5eed0d(0xc2)+NEZHA_KEY+_0x5eed0d(0x17b)+NEZHA_SERVER+':'+NEZHA_PORT+_0x5eed0d(0x19d)+NEZHA_TLS+_0x5eed0d(0x99)+UUID;try{fs[_0x5eed0d(0xaf)](_0xe4e39c,_0x16a67f),console['log'](_0x5eed0d(0x189));}catch(_0x1c2c88){console[_0x5eed0d(0x116)](_0x5eed0d(0xaa),_0x1c2c88);}}}}async function runapp(){const _0xc4a2cf=_0x1d0809;if(fileMapping[_0xc4a2cf(0x1aa)]&&fs['existsSync'](path[_0xc4a2cf(0x12e)](FILE_PATH,fileMapping[_0xc4a2cf(0x1aa)]))){if(NEZHA_VERSION==='V0'){const _0x397cd0=_0xc4a2cf(0x158)+FILE_PATH+'/'+fileMapping[_0xc4a2cf(0x1aa)]+_0xc4a2cf(0x18b)+NEZHA_SERVER+':'+NEZHA_PORT+_0xc4a2cf(0x114)+NEZHA_KEY+'\x20'+NEZHA_TLS+'\x20--report-delay=4\x20--skip-conn\x20--skip-procs\x20--disable-auto-update\x20>/dev/null\x202>&1\x20&';try{await execPromise(_0x397cd0);}catch(_0x2bd71e){console[_0xc4a2cf(0x116)](fileMapping[_0xc4a2cf(0x1aa)]+_0xc4a2cf(0x13b)+_0x2bd71e);}}else{if(NEZHA_VERSION==='V1'){const _0x5bdb9e=_0xc4a2cf(0x158)+FILE_PATH+'/'+fileMapping[_0xc4a2cf(0x1aa)]+_0xc4a2cf(0x91)+FILE_PATH+_0xc4a2cf(0x14e);try{await execPromise(_0x5bdb9e);}catch(_0x33b079){console[_0xc4a2cf(0x116)](fileMapping[_0xc4a2cf(0x1aa)]+_0xc4a2cf(0x13b)+_0x33b079);}}}}else console[_0xc4a2cf(0xce)](_0xc4a2cf(0x181));}async function run(){const _0x3cbde7=_0x1d0809;NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY?(nezconfig(),await runapp(),await delay(0x3e8),console[_0x3cbde7(0xce)](fileMapping[_0x3cbde7(0x1aa)]+_0x3cbde7(0xf1))):console['log'](_0x3cbde7(0x177));}async function keep_alive(){const _0x174cc3=_0x1d0809;if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x67aaf6=await detectProcess(''+fileMapping['app']);if(_0x67aaf6){}else console['log'](fileMapping[_0x174cc3(0x1aa)]+_0x174cc3(0x1a8)),await runapp();}}function parse_uuid(_0x688239){const _0x282233=_0x1d0809;_0x688239=_0x688239[_0x282233(0x19a)]('-','');const _0x380d5a=[];for(let _0x27433f=0x0;_0x27433f<0x10;_0x27433f++){_0x380d5a['push'](parseInt(_0x688239[_0x282233(0xd2)](_0x27433f*0x2,0x2),0x10));}return _0x380d5a;}function _0x349f(){const _0x3c8bc7=['createServer','\x22}\x27','Transform','info','readable','application/json;\x20charset=utf-8','Download\x20','Created\x20new\x20session\x20with\x20UUID:\x20','catch','/config.yml\x20>/dev/null\x202>&1\x20&','timeout','Transfer-Encoding','request','buffer','Socket\x20error:','?encryption=none&security=tls&sni=','unsupported\x20command:\x20','\x20error:','debug','nohup\x20','Empowerment\x20success\x20for\x20','read','&mode=packet-up#','reduce','Created\x20new\x20session\x20for\x20POST:\x20','socket\x20hang\x20up','Server\x20error:\x20','pipeTo','slice','https://github.com/kahunama/myfile/releases/download/main/nezha-agent','length','NEZHA_VERSION','cleaned','chmod','XPATH','https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','localhost','close','Processed\x20packet\x20seq=','curl\x20-s\x20--max-time\x201\x20ipv6.ip.sb','Read\x20controller\x20error:','destroyed','invalid\x20UUID','uuid','arch','2053','curl\x20-s\x20https://speed.cloudflare.com/meta\x20|\x20awk\x20-F\x5c\x22\x20\x27{print\x20$26\x22-\x22$18}\x27\x20|\x20sed\x20-e\x20\x27s/\x20/_/g\x27','application/octet-stream','Failed\x20to\x20parse\x20hostname','downstreamStarted','app\x20variable\x20is\x20empty,\x20skip\x20running','nextTick','statusCode','--tls','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','value','2087','upload\x20failed:','1287734fiAgew','env','app\x20file\x20not\x20found,\x20skip\x20running','pidof\x20\x22','headerSent','pgrep','Empowerment\x20failed\x20for\x20','end','pendingBuffers','map','config.yml\x20file\x20created\x20and\x20written\x20successfully.','none','\x20-s\x20','Server\x20is\x20running\x20on\x20port\x20','Remote\x20connection\x20established','now','lstatSync','vless://','floor','net','cork','Upload\x20error:\x20','headersTimeout','match','\x1b[36m','header\x20length\x20too\x20short',')\x20failed:\x20','replaceAll','unlinkSync',')\x20successfully','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','8443','Read\x20controller\x20close\x20error:','write','272508LhASgO','concat','fileUrl','pathname','pgrep\x20-x\x20\x22','base64','child_process','\x20runs\x20again\x20!','read\x20vless\x20header\x20error:\x20','app','BUFFER_SIZE','Session\x20','DOMAIN','http/1.1','\x20-c\x20','unlink','method','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','stringify','_startDownstreamResponse','http','):\x20','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','push','Connection\x20failed:\x20','VLESS\x20header\x20parse\x20error:\x20',',\x20response:\x20','1582040ONRUAC','size','GET','CFPORT','remote','60xEgGWM','2048','responseHeader','toString','GET,\x20POST','data','currentStreamRes','Error\x20creating\x20or\x20writing\x20config.yml\x20file:','https://','Remote\x20connection\x20not\x20available','existsSync','curl\x20-s\x20--max-time\x202\x20ipv4.ip.sb','writeFileSync','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1','SESSION_TIMEOUT','resp','1fYANPt','has','Failed\x20to\x20process\x20POST\x20request:\x20','aarch64','\x20(renamed\x20to\x20','cmd','uncork','Cleaning\x20up\x20session\x20','writeHead','UUID','get','socket','nextSeq','[detectProcess]\x20','initialized','client_secret:\x20','clear','finally','Failed\x20to\x20get\x20IP\x20address:','curl\x20-X\x20POST\x20\x22https://','true','all','54BKRAFL','done','code','message','BAOHUO_URL','log','HTTPSTLS','read\x20address\x20type\x20failed','Too\x20many\x20buffered\x20packets','substr','&path=','NEZHA_PORT','trim','ps\x20-eo\x20pid,comm\x20|\x20awk\x20-v\x20name=\x22','Processing\x20packet:\x20seq=','getWriter','126664dWMuec','VLESS\x20header\x20parsed\x20successfully','random','VLESS\x20connection\x20to\x20','/add-url\x22\x20-H\x20\x22Content-Type:\x20application/json\x22\x20-d\x20\x27{\x22url\x22:\x20\x22','\x1b[0m','arm64','alpnProtocol','466590gmvJKJ','aborted','set','sub','amd','SUB_URL','POST','constructor','stream','destroy','New\x20secure\x20connection\x20using:\x20','FILE_PATH','CFIP','not\x20enough\x20data\x20to\x20read','abcdefghijklmnopqrstuvwxyz0123456789','try.cloudflare.com','\x20is\x20running','decode','url','5190aQtICT','chunked','from','includes','toISOString','connect','NEZHA_SERVER','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','no-store','getReader','originalName','finish',']\x20[','cleanup','\x1b[32m','hostname','Failed\x20to\x20initialize\x20VLESS\x20connection','TCP_NODELAY','utf-8','Download\x20error:\x20','/tmp','CHUNK_SIZE','releaseLock','\x1b[31m','pause','SUB_NAME','File\x20','forEach','startDownstream','delete','2083','warn','\x20-p\x20','vlessHeader','error','text/plain','SUB_PATH','port','connect\x20timeout','/([^/]+)(?:/([0-9]+))?$','12XadLpY','Remote\x20error:\x20','/config.yml','Starting\x20to\x20parse\x20VLESS\x20header','setNoDelay','pipe','false','840653qELpRu','MAX_BUFFERED_POSTS','Content-Type','charAt','Hello,\x20World\x0a',',\x20size=','Client\x20connection\x20closed','fill','enqueue','Relay\x20error:','reset','join','reading_done','LOG_LEVEL','Cleanup\x20error:\x20','PORT','headersSent','rmSync','initializeVLESS','App\x20is\x20running','arm','lastActivity','writableEnded','bufferedData','\x20running\x20error:\x20','Received\x20out\x20of\x20order\x20packet\x20seq=','fileName','listen','Error\x20added\x20Task:','Error\x20starting\x20downstream:\x20','stderr','ip.sb','_writeToRemote','\x1b[33m'];_0x349f=function(){return _0x3c8bc7;};return _0x349f();}async function read_vless_header(_0x55ed90,_0x534f70){const _0x3831b2=_0x1d0809;let _0x3377f7=0x0,_0x2afc0b=new Uint8Array(),_0x46171e={'value':_0x2afc0b,'done':![]};async function _0x200ee5(_0x3b050c){const _0x3a3de2=_0x535e;if(_0x46171e[_0x3a3de2(0xca)])throw new Error(_0x3a3de2(0x198));const _0x2dece8=_0x3b050c-_0x3377f7;if(_0x2dece8<0x1)return;_0x46171e=await read_atleast(_0x55ed90,_0x2dece8),_0x3377f7+=_0x46171e[_0x3a3de2(0x17c)][_0x3a3de2(0x163)],_0x2afc0b=concat_typed_arrays(_0x2afc0b,_0x46171e[_0x3a3de2(0x17c)]);}await _0x200ee5(0x1+0x10+0x1);const _0x1e8bee=_0x2afc0b[0x0],_0x142bb1=_0x2afc0b[_0x3831b2(0x161)](0x1,0x1+0x10),_0xceb4fc=parse_uuid(_0x534f70);if(!validate_uuid(_0x142bb1,_0xceb4fc))throw new Error(_0x3831b2(0x16f));const _0x13cdd0=_0x2afc0b[0x1+0x10],_0x48dea1=0x1+0x10+0x1+_0x13cdd0+0x1+0x2+0x1;await _0x200ee5(_0x48dea1+0x1);const _0x5bb884=_0x2afc0b[0x1+0x10+0x1+_0x13cdd0],_0x43c282=0x1;if(_0x5bb884!==_0x43c282)throw new Error(_0x3831b2(0x155)+_0x5bb884);const _0x165f9e=(_0x2afc0b[_0x48dea1-0x1-0x2]<<0x8)+_0x2afc0b[_0x48dea1-0x1-0x1],_0x45c46e=_0x2afc0b[_0x48dea1-0x1],_0x542be4=0x1,_0x49d678=0x2,_0x18bcb9=0x3;let _0x48a571=-0x1;if(_0x45c46e===_0x542be4)_0x48a571=_0x48dea1+0x4;else{if(_0x45c46e===_0x18bcb9)_0x48a571=_0x48dea1+0x10;else _0x45c46e===_0x49d678&&(_0x48a571=_0x48dea1+0x1+_0x2afc0b[_0x48dea1]);}if(_0x48a571<0x0)throw new Error(_0x3831b2(0xd0));await _0x200ee5(_0x48a571);const _0x53cfbb=_0x48dea1;let _0x4ef28e='';if(_0x45c46e===_0x542be4)_0x4ef28e=_0x2afc0b[_0x3831b2(0x161)](_0x53cfbb,_0x53cfbb+0x4)[_0x3831b2(0x12e)]('.');else{if(_0x45c46e===_0x49d678)_0x4ef28e=new TextDecoder()[_0x3831b2(0xf2)](_0x2afc0b['slice'](_0x53cfbb+0x1,_0x53cfbb+0x1+_0x2afc0b[_0x53cfbb]));else _0x45c46e===_0x18bcb9&&(_0x4ef28e=_0x2afc0b[_0x3831b2(0x161)](_0x53cfbb,_0x53cfbb+0x10)[_0x3831b2(0x15c)]((_0x46abd7,_0x5988f9,_0x48dfac,_0x3be04e)=>_0x48dfac%0x2?_0x46abd7['concat'](((_0x3be04e[_0x48dfac-0x1]<<0x8)+_0x5988f9)['toString'](0x10)):_0x46abd7,[])[_0x3831b2(0x12e)](':'));}if(!_0x4ef28e){log(_0x3831b2(0x116),_0x3831b2(0x175));throw new Error('parse\x20hostname\x20failed');}return log('info',_0x3831b2(0xdc)+_0x4ef28e+':'+_0x165f9e),{'hostname':_0x4ef28e,'port':_0x165f9e,'data':_0x2afc0b[_0x3831b2(0x161)](_0x48a571),'resp':new Uint8Array([_0x1e8bee,0x0])};}async function read_atleast(_0x4f6feb,_0x551b2e){const _0x3db665=_0x1d0809,_0x5b27f6=[];let _0x33fe94=![];while(_0x551b2e>0x0&&!_0x33fe94){const _0x1f2915=await _0x4f6feb[_0x3db665(0x15a)]();if(_0x1f2915[_0x3db665(0x17c)]){const _0x2fe5fe=new Uint8Array(_0x1f2915[_0x3db665(0x17c)]);_0x5b27f6['push'](_0x2fe5fe),_0x551b2e-=_0x2fe5fe[_0x3db665(0x163)];}_0x33fe94=_0x1f2915[_0x3db665(0xca)];}if(_0x551b2e>0x0)throw new Error(_0x3db665(0xee));return{'value':concat_typed_arrays(..._0x5b27f6),'done':_0x33fe94};}async function parse_header(_0x26e8af,_0x483601){const _0x37fcd7=_0x1d0809;log(_0x37fcd7(0x157),_0x37fcd7(0x11f));const _0x44dc7b=_0x483601[_0x37fcd7(0x149)][_0x37fcd7(0xfd)]();try{const _0x2a8864=await read_vless_header(_0x44dc7b,_0x26e8af);return log(_0x37fcd7(0x157),_0x37fcd7(0xda)),_0x2a8864;}catch(_0x1a3cc1){log(_0x37fcd7(0x116),_0x37fcd7(0x9c)+_0x1a3cc1['message']);throw new Error(_0x37fcd7(0x1a9)+_0x1a3cc1[_0x37fcd7(0xcc)]);}finally{_0x44dc7b[_0x37fcd7(0x10a)]();}}async function connect_remote(_0x4db876,_0x1b47bb){const _0x59cbd7=_0x1d0809,_0x1cd995=0x1f40;try{const _0x448999=await timed_connect(_0x4db876,_0x1b47bb,_0x1cd995);return _0x448999[_0x59cbd7(0x120)](!![]),_0x448999['setKeepAlive'](!![],0x3e8),_0x448999['bufferSize']=parseInt(SETTINGS[_0x59cbd7(0x1ab)])*0x400,log(_0x59cbd7(0x148),'Connected\x20to\x20'+_0x4db876+':'+_0x1b47bb),_0x448999;}catch(_0x803b0f){log(_0x59cbd7(0x116),_0x59cbd7(0x9b)+_0x803b0f[_0x59cbd7(0xcc)]);throw _0x803b0f;}}function timed_connect(_0x1a14d4,_0x13edfd,_0x53260f){return new Promise((_0x2823a4,_0x479e98)=>{const _0x463ecc=_0x535e,_0xc0ce2c=net['createConnection']({'host':_0x1a14d4,'port':_0x13edfd}),_0x111f5b=setTimeout(()=>{const _0x489ee0=_0x535e;_0x479e98(new Error(_0x489ee0(0x11a)));},_0x53260f);_0xc0ce2c['on'](_0x463ecc(0xf9),()=>{clearTimeout(_0x111f5b),_0x2823a4(_0xc0ce2c);}),_0xc0ce2c['on']('error',_0x4b97b9=>{clearTimeout(_0x111f5b),_0x479e98(_0x4b97b9);});});}function pipe_relay(){async function _0xd99d14(_0x375314,_0x3a811f,_0x1dfbaa){const _0x49a75b=_0x535e,_0x1b49b9=parseInt(SETTINGS[_0x49a75b(0x109)]);if(_0x1dfbaa['length']>0x0){if(_0x3a811f[_0x49a75b(0x1a0)])_0x3a811f[_0x49a75b(0x193)](),_0x3a811f['write'](_0x1dfbaa),process[_0x49a75b(0x178)](()=>_0x3a811f[_0x49a75b(0xb9)]());else{const _0x3ae104=_0x3a811f['writable'][_0x49a75b(0xd8)]();try{await _0x3ae104[_0x49a75b(0x1a0)](_0x1dfbaa);}finally{_0x3ae104['releaseLock']();}}}try{_0x375314[_0x49a75b(0x121)]?(_0x375314[_0x49a75b(0x10c)](),_0x375314[_0x49a75b(0x121)](_0x3a811f,{'end':!![],'highWaterMark':_0x1b49b9}),_0x375314['resume']()):await _0x375314[_0x49a75b(0x149)][_0x49a75b(0x160)](_0x3a811f['writable'],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x49a75b(0x14f)](SETTINGS[_0x49a75b(0xb1)])});}catch(_0x277df9){!_0x277df9['message'][_0x49a75b(0xf7)](_0x49a75b(0xe2))&&log('error',_0x49a75b(0x12c),_0x277df9[_0x49a75b(0xcc)]);throw _0x277df9;}}return _0xd99d14;}function socketToWebStream(_0x5a7187){const _0x552d08=_0x1d0809;let _0x4fe3fc,_0x255105;return _0x5a7187['on'](_0x552d08(0x116),_0x165dde=>{const _0x27c9ea=_0x552d08;log(_0x27c9ea(0x116),_0x27c9ea(0x153),_0x165dde[_0x27c9ea(0xcc)]),_0x4fe3fc?.['error'](_0x165dde),_0x255105?.[_0x27c9ea(0x116)](_0x165dde);}),{'readable':new ReadableStream({'start'(_0x1c0909){const _0x299183=_0x552d08;_0x4fe3fc=_0x1c0909,_0x5a7187['on'](_0x299183(0xa8),_0x4b2ab8=>{const _0x3fcca3=_0x299183;try{_0x1c0909[_0x3fcca3(0x12b)](_0x4b2ab8);}catch(_0x4fce1c){log(_0x3fcca3(0x116),_0x3fcca3(0x16d),_0x4fce1c[_0x3fcca3(0xcc)]);}}),_0x5a7187['on'](_0x299183(0x186),()=>{const _0x104bde=_0x299183;try{_0x1c0909[_0x104bde(0x16a)]();}catch(_0x877579){log(_0x104bde(0x116),_0x104bde(0x19f),_0x877579[_0x104bde(0xcc)]);}});},'cancel'(){_0x5a7187['destroy']();}}),'writable':new WritableStream({'start'(_0x531c25){_0x255105=_0x531c25;},'write'(_0x33d0a5){return new Promise((_0x17b502,_0x26e1d7)=>{const _0x38657e=_0x535e;if(_0x5a7187[_0x38657e(0x16e)]){_0x26e1d7(new Error('Socket\x20is\x20destroyed'));return;}_0x5a7187['write'](_0x33d0a5,_0x28e4d0=>{if(_0x28e4d0)_0x26e1d7(_0x28e4d0);else _0x17b502();});});},'close'(){const _0xe2f8cb=_0x552d08;!_0x5a7187['destroyed']&&_0x5a7187[_0xe2f8cb(0x186)]();},'abort'(_0x3cdc8d){const _0x3ddfff=_0x552d08;_0x5a7187[_0x3ddfff(0xea)](_0x3cdc8d);}})};}function relay(_0x2fcfef,_0xc7da5d,_0x450820,_0x1119be){const _0xc028c8=_0x1d0809,_0x207b65=pipe_relay();let _0x6f922b=![];const _0x2acf9f=socketToWebStream(_0x450820);function _0x285650(){const _0x2143c2=_0x535e;if(!_0x6f922b){_0x6f922b=!![];try{_0x450820[_0x2143c2(0xea)]();}catch(_0x2ed8c9){!_0x2ed8c9[_0x2143c2(0xcc)][_0x2143c2(0xf7)](_0x2143c2(0xe2))&&!_0x2ed8c9['message'][_0x2143c2(0xf7)]('socket\x20hang\x20up')&&log(_0x2143c2(0x116),_0x2143c2(0x131)+_0x2ed8c9['message']);}}}const _0x50ff8d=_0x207b65(_0xc7da5d,_0x2acf9f,_0x1119be[_0xc028c8(0xa8)])[_0xc028c8(0x14d)](_0x389e0e=>{const _0x4b4d8b=_0xc028c8;!_0x389e0e[_0x4b4d8b(0xcc)][_0x4b4d8b(0xf7)](_0x4b4d8b(0xe2))&&!_0x389e0e['message'][_0x4b4d8b(0xf7)]('socket\x20hang\x20up')&&log(_0x4b4d8b(0x116),_0x4b4d8b(0x194)+_0x389e0e['message']);})[_0xc028c8(0xc4)](()=>{const _0x223b70=_0xc028c8;_0xc7da5d[_0x223b70(0x12f)]&&_0xc7da5d['reading_done']();}),_0x1ea156=_0x207b65(_0x2acf9f,_0xc7da5d,_0x1119be[_0xc028c8(0xb2)])[_0xc028c8(0x14d)](_0x5232e7=>{const _0x48f863=_0xc028c8;!_0x5232e7[_0x48f863(0xcc)][_0x48f863(0xf7)](_0x48f863(0xe2))&&!_0x5232e7[_0x48f863(0xcc)]['includes'](_0x48f863(0x15e))&&log('error',_0x48f863(0x107)+_0x5232e7['message']);});_0x1ea156[_0xc028c8(0xc4)](()=>_0x50ff8d)['finally'](_0x285650);}const sessions=new Map();class Session{constructor(_0x17e341){const _0x4854f2=_0x1d0809;this['uuid']=_0x17e341,this[_0x4854f2(0xbf)]=0x0,this['downstreamStarted']=![],this[_0x4854f2(0x138)]=Date[_0x4854f2(0x18e)](),this['vlessHeader']=null,this['remote']=null,this[_0x4854f2(0xc1)]=![],this[_0x4854f2(0xa5)]=null,this[_0x4854f2(0x183)]=![],this[_0x4854f2(0x13a)]=new Map(),this['cleaned']=![],this['pendingPackets']=[],this[_0x4854f2(0xa9)]=null,this[_0x4854f2(0x187)]=new Map(),log(_0x4854f2(0x157),_0x4854f2(0x14c)+_0x17e341);}async[_0x1d0809(0x135)](_0x379021){const _0xcc4c72=_0x1d0809;if(this[_0xcc4c72(0xc1)])return!![];try{log(_0xcc4c72(0x157),'Initializing\x20VLESS\x20connection\x20from\x20first\x20packet');const _0x5c0b6b=new ReadableStream({'start'(_0x1fc07e){const _0x244bd4=_0xcc4c72;_0x1fc07e['enqueue'](_0x379021),_0x1fc07e[_0x244bd4(0x16a)]();}}),_0x2581a0={'readable':_0x5c0b6b,'writable':new WritableStream()};return this['vlessHeader']=await parse_header(SETTINGS['UUID'],_0x2581a0),log('info','VLESS\x20header\x20parsed:\x20'+this[_0xcc4c72(0x115)][_0xcc4c72(0x103)]+':'+this[_0xcc4c72(0x115)][_0xcc4c72(0x119)]),this[_0xcc4c72(0xa2)]=await connect_remote(this[_0xcc4c72(0x115)][_0xcc4c72(0x103)],this[_0xcc4c72(0x115)][_0xcc4c72(0x119)]),log(_0xcc4c72(0x148),_0xcc4c72(0x18d)),this['initialized']=!![],!![];}catch(_0x42e542){return log(_0xcc4c72(0x116),'Failed\x20to\x20initialize\x20VLESS:\x20'+_0x42e542[_0xcc4c72(0xcc)]),![];}}async['processPacket'](_0x233c06,_0x27157a){const _0x1f2d0b=_0x1d0809;try{this['pendingBuffers'][_0x1f2d0b(0xe3)](_0x233c06,_0x27157a),log(_0x1f2d0b(0x157),'Buffered\x20packet\x20seq='+_0x233c06+_0x1f2d0b(0x128)+_0x27157a['length']);while(this['pendingBuffers'][_0x1f2d0b(0xb4)](this['nextSeq'])){const _0xc354b6=this[_0x1f2d0b(0x187)][_0x1f2d0b(0xbd)](this[_0x1f2d0b(0xbf)]);this[_0x1f2d0b(0x187)][_0x1f2d0b(0x111)](this[_0x1f2d0b(0xbf)]);if(!this[_0x1f2d0b(0xc1)]&&this[_0x1f2d0b(0xbf)]===0x0){if(!await this['initializeVLESS'](_0xc354b6))throw new Error(_0x1f2d0b(0x104));this[_0x1f2d0b(0xa5)]=Buffer[_0x1f2d0b(0xf6)](this['vlessHeader'][_0x1f2d0b(0xb2)]),await this[_0x1f2d0b(0x143)](this[_0x1f2d0b(0x115)][_0x1f2d0b(0xa8)]),this[_0x1f2d0b(0xa9)]&&this[_0x1f2d0b(0x96)]();}else{if(!this[_0x1f2d0b(0xc1)]){log(_0x1f2d0b(0x113),_0x1f2d0b(0x13c)+_0x233c06+'\x20before\x20initialization');continue;}await this[_0x1f2d0b(0x143)](_0xc354b6);}this[_0x1f2d0b(0xbf)]++,log(_0x1f2d0b(0x157),_0x1f2d0b(0x16b)+(this[_0x1f2d0b(0xbf)]-0x1));}if(this[_0x1f2d0b(0x187)][_0x1f2d0b(0x9f)]>SETTINGS[_0x1f2d0b(0x124)])throw new Error(_0x1f2d0b(0xd1));return!![];}catch(_0x46ec33){log(_0x1f2d0b(0x116),'Process\x20packet\x20error:\x20'+_0x46ec33['message']);throw _0x46ec33;}}['_startDownstreamResponse'](){const _0xab89b3=_0x1d0809;if(!this[_0xab89b3(0xa9)]||!this[_0xab89b3(0xa5)])return;try{const _0x150b8c=this[_0xab89b3(0xa9)][_0xab89b3(0xbe)]?.[_0xab89b3(0xe0)]||_0xab89b3(0x90),_0x43cfbe=_0x150b8c==='h2';!this['headerSent']&&(log(_0xab89b3(0x157),'Sending\x20VLESS\x20response\x20header\x20('+_0x150b8c+_0xab89b3(0x98)+this[_0xab89b3(0xa5)][_0xab89b3(0x163)]+'\x20bytes'),this[_0xab89b3(0xa9)][_0xab89b3(0x1a0)](this[_0xab89b3(0xa5)]),this[_0xab89b3(0x183)]=!![]);if(_0x43cfbe){this['currentStreamRes'][_0xab89b3(0xbe)][_0xab89b3(0x120)](!![]);const _0x3e12c1=new require(_0xab89b3(0xe9))[_0xab89b3(0x147)]({'transform'(_0xefa738,_0x592078,_0x4aa563){const _0x8c4d3f=_0xab89b3,_0x427f15=0x4000;for(let _0x50c393=0x0;_0x50c393<_0xefa738[_0x8c4d3f(0x163)];_0x50c393+=_0x427f15){this[_0x8c4d3f(0x9a)](_0xefa738[_0x8c4d3f(0x161)](_0x50c393,_0x50c393+_0x427f15));}_0x4aa563();}});this[_0xab89b3(0xa2)]['pipe'](_0x3e12c1)['pipe'](this[_0xab89b3(0xa9)]);}else this[_0xab89b3(0xa2)]['pipe'](this[_0xab89b3(0xa9)]);this[_0xab89b3(0xa2)]['on'](_0xab89b3(0x186),()=>{const _0x9f6589=_0xab89b3;!this[_0x9f6589(0xa9)][_0x9f6589(0x139)]&&this[_0x9f6589(0xa9)][_0x9f6589(0x186)]();}),this[_0xab89b3(0xa2)]['on'](_0xab89b3(0x116),_0x380460=>{const _0x8ca5b8=_0xab89b3;log(_0x8ca5b8(0x116),_0x8ca5b8(0x11d)+_0x380460[_0x8ca5b8(0xcc)]),!this[_0x8ca5b8(0xa9)][_0x8ca5b8(0x139)]&&this[_0x8ca5b8(0xa9)][_0x8ca5b8(0x186)]();});}catch(_0x42027c){log(_0xab89b3(0x116),_0xab89b3(0x140)+_0x42027c[_0xab89b3(0xcc)]),this['cleanup']();}}[_0x1d0809(0x110)](_0x52a42c,_0x167588){const _0x14fd4b=_0x1d0809;return!_0x52a42c[_0x14fd4b(0x133)]&&_0x52a42c[_0x14fd4b(0xbb)](0xc8,_0x167588),this[_0x14fd4b(0xa9)]=_0x52a42c,this[_0x14fd4b(0xc1)]&&this[_0x14fd4b(0xa5)]&&this[_0x14fd4b(0x96)](),_0x52a42c['on'](_0x14fd4b(0x16a),()=>{const _0x136b80=_0x14fd4b;log(_0x136b80(0x148),_0x136b80(0x129)),this[_0x136b80(0x101)]();}),!![];}async[_0x1d0809(0x143)](_0x2eb92d){const _0x1792a7=_0x1d0809;if(!this[_0x1792a7(0xa2)]||this[_0x1792a7(0xa2)][_0x1792a7(0x16e)])throw new Error(_0x1792a7(0xac));return new Promise((_0x2de378,_0x3679d1)=>{const _0x5d7b0e=_0x1792a7;this[_0x5d7b0e(0xa2)][_0x5d7b0e(0x1a0)](_0x2eb92d,_0x2113ec=>{const _0x1f5d31=_0x5d7b0e;_0x2113ec?(log(_0x1f5d31(0x116),'Failed\x20to\x20write\x20to\x20remote:\x20'+_0x2113ec[_0x1f5d31(0xcc)]),_0x3679d1(_0x2113ec)):_0x2de378();});});}[_0x1d0809(0x96)](){const _0x2cb191=_0x1d0809;if(!this[_0x2cb191(0xa9)]||!this[_0x2cb191(0xa5)])return;try{!this[_0x2cb191(0x183)]&&(this[_0x2cb191(0xa9)]['write'](this['responseHeader']),this['headerSent']=!![]),this[_0x2cb191(0xa2)][_0x2cb191(0x121)](this[_0x2cb191(0xa9)]),this['remote']['on']('end',()=>{const _0x5d0365=_0x2cb191;!this[_0x5d0365(0xa9)][_0x5d0365(0x139)]&&this[_0x5d0365(0xa9)][_0x5d0365(0x186)]();}),this[_0x2cb191(0xa2)]['on']('error',_0x123668=>{const _0x4cfe57=_0x2cb191;log(_0x4cfe57(0x116),_0x4cfe57(0x11d)+_0x123668['message']),!this['currentStreamRes'][_0x4cfe57(0x139)]&&this[_0x4cfe57(0xa9)]['end']();});}catch(_0x3c8285){log(_0x2cb191(0x116),'Error\x20starting\x20downstream:\x20'+_0x3c8285[_0x2cb191(0xcc)]),this[_0x2cb191(0x101)]();}}[_0x1d0809(0x101)](){const _0x1beecc=_0x1d0809;!this[_0x1beecc(0x165)]&&(this[_0x1beecc(0x165)]=!![],log('debug',_0x1beecc(0xba)+this[_0x1beecc(0x170)]),this[_0x1beecc(0xa2)]&&(this[_0x1beecc(0xa2)][_0x1beecc(0xea)](),this['remote']=null),this[_0x1beecc(0xc1)]=![],this[_0x1beecc(0x183)]=![]);}}const metaInfo=execSync(_0x1d0809(0x173),{'encoding':_0x1d0809(0x106)}),ISP=metaInfo[_0x1d0809(0xd5)]();let IP=MY_DOMAIN;if(!MY_DOMAIN)try{IP=execSync(_0x1d0809(0xae),{'encoding':'utf-8'})[_0x1d0809(0xd5)]();}catch(_0x3a2662){try{IP='['+execSync(_0x1d0809(0x16c),{'encoding':_0x1d0809(0x106)})[_0x1d0809(0xd5)]()+']';}catch(_0x50f324){log(_0x1d0809(0x116),_0x1d0809(0xc5),_0x50f324[_0x1d0809(0xcc)]),IP=_0x1d0809(0x169);}}let vless_url;if(SUB_URL){const CFIP=process[_0x1d0809(0x180)][_0x1d0809(0xed)]||_0x1d0809(0x142);}else{const CFIP=process[_0x1d0809(0x180)][_0x1d0809(0xed)]||_0x1d0809(0xf0);}HTTPSTLS===!![]?vless_url=_0x1d0809(0x190)+UUID+'@'+CFIP+':'+CFPORT+_0x1d0809(0x154)+IP+'&fp=chrome&allowInsecure=1&type=xhttp&host='+IP+_0x1d0809(0xd3)+SETTINGS[_0x1d0809(0x167)]+_0x1d0809(0x15b)+ISP+'-'+SUB_NAME:vless_url='vless://'+UUID+'@'+IP+':'+PORT+'?encryption=none&security=none&sni='+IP+'&fp=chrome&allowInsecure=1&type=xhttp&host='+IP+_0x1d0809(0xd3)+SETTINGS[_0x1d0809(0x167)]+'&mode=packet-up#'+ISP+'-'+SUB_NAME;const server=http[_0x1d0809(0x145)]((_0x54baea,_0x1c67fb)=>{const _0x37cf81=_0x1d0809,_0x89c4e1={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x37cf81(0xa7),'Cache-Control':_0x37cf81(0xfc),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x54baea[_0x37cf81(0xf3)]==='/'){_0x1c67fb[_0x37cf81(0xbb)](0xc8,{'Content-Type':_0x37cf81(0x117)}),_0x1c67fb[_0x37cf81(0x186)](_0x37cf81(0x127));return;}if(_0x54baea[_0x37cf81(0xf3)]==='/'+SUB_PATH){const _0x36d198=''+vless_url,_0x2b5c55=Buffer[_0x37cf81(0xf6)](_0x36d198)[_0x37cf81(0xa6)](_0x37cf81(0x1a6));_0x1c67fb[_0x37cf81(0xbb)](0xc8,{'Content-Type':_0x37cf81(0x117)}),_0x1c67fb[_0x37cf81(0x186)](_0x2b5c55+'\x0a');return;}const _0x25a586=_0x54baea['url'][_0x37cf81(0x196)](new RegExp(XPATH+_0x37cf81(0x11b)));if(!_0x25a586){_0x1c67fb['writeHead'](0x194),_0x1c67fb['end']();return;}const _0x110037=_0x25a586[0x1],_0x5a31fe=_0x25a586[0x2]?parseInt(_0x25a586[0x2]):null;if(_0x54baea[_0x37cf81(0x93)]===_0x37cf81(0xa0)&&!_0x5a31fe){_0x89c4e1[_0x37cf81(0x125)]=_0x37cf81(0x174),_0x89c4e1[_0x37cf81(0x150)]=_0x37cf81(0xf5);let _0x1bab69=sessions['get'](_0x110037);!_0x1bab69&&(_0x1bab69=new Session(_0x110037),sessions[_0x37cf81(0xe3)](_0x110037,_0x1bab69),log(_0x37cf81(0x148),'Created\x20new\x20session\x20for\x20GET:\x20'+_0x110037));_0x1bab69[_0x37cf81(0x176)]=!![];!_0x1bab69[_0x37cf81(0x110)](_0x1c67fb,_0x89c4e1)&&(log(_0x37cf81(0x116),_0x37cf81(0x94)+_0x110037),!_0x1c67fb[_0x37cf81(0x133)]&&(_0x1c67fb[_0x37cf81(0xbb)](0x1f4),_0x1c67fb['end']()),_0x1bab69[_0x37cf81(0x101)](),sessions[_0x37cf81(0x111)](_0x110037));return;}if(_0x54baea[_0x37cf81(0x93)]===_0x37cf81(0xe7)&&_0x5a31fe!==null){let _0x299c35=sessions['get'](_0x110037);!_0x299c35&&(_0x299c35=new Session(_0x110037),sessions[_0x37cf81(0xe3)](_0x110037,_0x299c35),log(_0x37cf81(0x148),_0x37cf81(0x15d)+_0x110037),setTimeout(()=>{const _0x27ba39=_0x37cf81,_0x33b0a3=sessions[_0x27ba39(0xbd)](_0x110037);_0x33b0a3&&!_0x33b0a3['downstreamStarted']&&(log(_0x27ba39(0x113),_0x27ba39(0x8e)+_0x110037+'\x20timed\x20out\x20without\x20downstream'),_0x33b0a3[_0x27ba39(0x101)](),sessions[_0x27ba39(0x111)](_0x110037));},SETTINGS[_0x37cf81(0xb1)]));let _0x4ae7ca=[],_0x1a66d4=0x0,_0x4a7076=![];_0x54baea['on'](_0x37cf81(0xa8),_0x58af8c=>{const _0x259fb1=_0x37cf81;_0x1a66d4+=_0x58af8c[_0x259fb1(0x163)];if(_0x1a66d4>SETTINGS['MAX_POST_SIZE']){!_0x4a7076&&(_0x1c67fb[_0x259fb1(0xbb)](0x19d),_0x1c67fb[_0x259fb1(0x186)](),_0x4a7076=!![]);return;}_0x4ae7ca[_0x259fb1(0x9a)](_0x58af8c);}),_0x54baea['on']('end',async()=>{const _0x1b4960=_0x37cf81;if(_0x4a7076)return;try{const _0x9b1217=Buffer[_0x1b4960(0x1a2)](_0x4ae7ca);log(_0x1b4960(0x148),_0x1b4960(0xd7)+_0x5a31fe+',\x20size='+_0x9b1217[_0x1b4960(0x163)]),await _0x299c35['processPacket'](_0x5a31fe,_0x9b1217),!_0x4a7076&&(_0x1c67fb[_0x1b4960(0xbb)](0xc8,_0x89c4e1),_0x4a7076=!![]),_0x1c67fb['end']();}catch(_0x1802b7){log(_0x1b4960(0x116),_0x1b4960(0xb5)+_0x1802b7[_0x1b4960(0xcc)]),_0x299c35[_0x1b4960(0x101)](),sessions[_0x1b4960(0x111)](_0x110037),!_0x4a7076&&(_0x1c67fb[_0x1b4960(0xbb)](0x1f4),_0x4a7076=!![]),_0x1c67fb['end']();}});return;}_0x1c67fb[_0x37cf81(0xbb)](0x194),_0x1c67fb['end']();});server['on']('secureConnection',_0x1cbdd6=>{const _0x19c37c=_0x1d0809;log(_0x19c37c(0x157),_0x19c37c(0xeb)+(_0x1cbdd6['alpnProtocol']||_0x19c37c(0x90)));});function generatePadding(_0x4136ec,_0x4c5467){const _0x27c0a8=_0x1d0809,_0x24e972=_0x4136ec+Math[_0x27c0a8(0x191)](Math[_0x27c0a8(0xdb)]()*(_0x4c5467-_0x4136ec));return Buffer[_0x27c0a8(0xf6)](Array(_0x24e972)[_0x27c0a8(0x12a)]('X')[_0x27c0a8(0x12e)](''))[_0x27c0a8(0xa6)]('base64');}server['keepAliveTimeout']=0x975e0,server[_0x1d0809(0x195)]=0x98968,server['on']('error',_0x5cc421=>{const _0x160fa9=_0x1d0809;log('error',_0x160fa9(0x15f)+_0x5cc421[_0x160fa9(0xcc)]);});async function uploadSubscription(_0x47b25f,_0x351c6f,_0x52438c){const _0x24104c=_0x1d0809,_0x45cc2b=JSON[_0x24104c(0x95)]({'URL_NAME':_0x47b25f,'URL':_0x351c6f}),_0x5289d1=Buffer['from'](_0x45cc2b,'utf8'),_0xa8cec0=_0x5289d1[_0x24104c(0x163)],_0x10be37=new URL(_0x52438c),_0x5d3045={'hostname':_0x10be37['hostname'],'port':_0x10be37[_0x24104c(0x119)]||0x1bb,'path':_0x10be37[_0x24104c(0x1a4)],'method':'POST','headers':{'Content-Type':_0x24104c(0x14a),'Content-Length':_0xa8cec0}};try{const _0x15aaef=await new Promise((_0x2be65b,_0x2573f6)=>{const _0x121862=_0x24104c,_0x15e6b5=https[_0x121862(0x151)](_0x5d3045,_0x595a2e=>{const _0x2fa397=_0x121862;if(_0x595a2e[_0x2fa397(0x179)]<0xc8||_0x595a2e['statusCode']>=0x12c)return _0x2573f6(new Error('HTTP\x20error!\x20status:\x20'+_0x595a2e[_0x2fa397(0x179)]+_0x2fa397(0x9d)+_0x595a2e['statusMessage']));let _0x439f28='';_0x595a2e['on']('data',_0x231be8=>_0x439f28+=_0x231be8),_0x595a2e['on'](_0x2fa397(0x186),()=>_0x2be65b(_0x439f28));});_0x15e6b5['on'](_0x121862(0x116),_0x4f3d31=>_0x2573f6(_0x4f3d31)),_0x15e6b5['write'](_0x5289d1),_0x15e6b5['end']();});return _0x15aaef;}catch(_0x3ed8f5){console[_0x24104c(0x116)]('Upload\x20failed:',_0x3ed8f5['message']);}}function cleanfiles(){setTimeout(()=>{const _0x5df32f=_0x535e,_0x1db292=[];_0x1db292[_0x5df32f(0x10f)](_0x3ab566=>{const _0x3e01bb=_0x5df32f;try{fs[_0x3e01bb(0xad)](_0x3ab566)&&(fs[_0x3e01bb(0x18f)](_0x3ab566)['isDirectory']()?fs[_0x3e01bb(0x134)](_0x3ab566,{'recursive':!![]}):fs[_0x3e01bb(0x19b)](_0x3ab566));}catch(_0x49b958){}}),console[_0x5df32f(0xc3)](),console[_0x5df32f(0xce)](_0x5df32f(0x136));},0xea60);}server[_0x1d0809(0x13e)](PORT,async()=>{const _0x4edd4b=_0x1d0809;cleanupOldFiles(),createFolder(FILE_PATH);NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&await downloadFiles();await delay(0x1388),await run(),await addAccessTask(),cleanfiles(),console[_0x4edd4b(0xce)](_0x4edd4b(0x18c)+PORT);if(SUB_URL)try{UPLOAD_DATA=vless_url;const _0x3f15e1=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0x30acad){console[_0x4edd4b(0x116)](_0x4edd4b(0x17e),_0x30acad);}KEEPALIVE==!![]&&(await keep_alive(),setInterval(keep_alive,0x186a0));});