const _0x5ecddf=_0x5931;(function(_0x597b25,_0x2d7e90){const _0x2f1964=_0x5931,_0x2ea453=_0x597b25();while(!![]){try{const _0x38a233=parseInt(_0x2f1964(0x234))/0x1*(parseInt(_0x2f1964(0x243))/0x2)+parseInt(_0x2f1964(0x1d4))/0x3*(parseInt(_0x2f1964(0x1c3))/0x4)+parseInt(_0x2f1964(0x236))/0x5+-parseInt(_0x2f1964(0x242))/0x6+parseInt(_0x2f1964(0x214))/0x7+-parseInt(_0x2f1964(0x23a))/0x8+parseInt(_0x2f1964(0x1a4))/0x9*(-parseInt(_0x2f1964(0x1ef))/0xa);if(_0x38a233===_0x2d7e90)break;else _0x2ea453['push'](_0x2ea453['shift']());}catch(_0x12dbbf){_0x2ea453['push'](_0x2ea453['shift']());}}}(_0x3fdd,0x38281));const FILE_PATH=process[_0x5ecddf(0x1c7)]['FILE_PATH']||_0x5ecddf(0x27d),intervalInseconds=process[_0x5ecddf(0x1c7)]['TIME']||0x64,PORT=process['env']['PORT']||0xbb8,CFPORT=process[_0x5ecddf(0x1c7)]['CFPORT']||0x1bb,CFIP=process['env'][_0x5ecddf(0x224)]||_0x5ecddf(0x228),KEEPALIVE=(process[_0x5ecddf(0x1c7)]['KEEPALIVE']||_0x5ecddf(0x1bf))===_0x5ecddf(0x227),SUB_URL=process[_0x5ecddf(0x1c7)][_0x5ecddf(0x1c6)]||'',UUID=process[_0x5ecddf(0x1c7)][_0x5ecddf(0x247)]||_0x5ecddf(0x25c),XPATH=process[_0x5ecddf(0x1c7)][_0x5ecddf(0x22c)]||UUID['slice'](0x0,0x8),NEZHA_VERSION=process[_0x5ecddf(0x1c7)][_0x5ecddf(0x27c)]||'V0',NEZHA_SERVER=process['env'][_0x5ecddf(0x198)]||'',NEZHA_PORT=process[_0x5ecddf(0x1c7)][_0x5ecddf(0x2a2)]||_0x5ecddf(0x21b),NEZHA_KEY=process[_0x5ecddf(0x1c7)][_0x5ecddf(0x205)]||'',SUB_NAME=process['env'][_0x5ecddf(0x1d6)]||'',MY_DOMAIN=process[_0x5ecddf(0x1c7)][_0x5ecddf(0x29d)]||'',LOCAL_DOMAIN=process['env'][_0x5ecddf(0x269)]||'',os=require('os'),fs=require('fs'),net=require('net'),path=require(_0x5ecddf(0x211)),http=require(_0x5ecddf(0x248)),https=require(_0x5ecddf(0x283)),axios=require(_0x5ecddf(0x1b3)),{pipeline}=require(_0x5ecddf(0x270)),{Buffer}=require(_0x5ecddf(0x1d2)),exec=require(_0x5ecddf(0x1dd))[_0x5ecddf(0x25f)],delay=_0x49b859=>new Promise(_0x3f9b2e=>setTimeout(_0x3f9b2e,_0x49b859)),SETTINGS={[_0x5ecddf(0x247)]:UUID,['LOG_LEVEL']:_0x5ecddf(0x274),[_0x5ecddf(0x1d5)]:_0x5ecddf(0x241),[_0x5ecddf(0x22c)]:_0x5ecddf(0x213)+XPATH,['MAX_BUFFERED_POSTS']:0x1e,[_0x5ecddf(0x1ff)]:0xf4240,[_0x5ecddf(0x277)]:0x7530,[_0x5ecddf(0x299)]:0x400*0x400,['TCP_NODELAY']:!![],['TCP_KEEPALIVE']:!![]};function validate_uuid(_0x44bfa8,_0x55b7dc){for(let _0x4483f1=0x0;_0x4483f1<0x10;_0x4483f1++){if(_0x44bfa8[_0x4483f1]!==_0x55b7dc[_0x4483f1])return![];}return!![];}function concat_typed_arrays(_0x177558,..._0x126bb0){const _0x358d72=_0x5ecddf;if(!_0x126bb0||_0x126bb0['length']<0x1)return _0x177558;let _0x485a7d=_0x177558[_0x358d72(0x279)];for(let _0x5199da of _0x126bb0)_0x485a7d+=_0x5199da['length'];const _0x2bfc2c=new _0x177558[(_0x358d72(0x289))](_0x485a7d);_0x2bfc2c['set'](_0x177558,0x0),_0x485a7d=_0x177558[_0x358d72(0x279)];for(let _0x39e726 of _0x126bb0){_0x2bfc2c[_0x358d72(0x291)](_0x39e726,_0x485a7d),_0x485a7d+=_0x39e726[_0x358d72(0x279)];}return _0x2bfc2c;}function log(_0x362d2d,..._0x534823){const _0x54e6fb=_0x5ecddf;if(SETTINGS[_0x54e6fb(0x255)]===_0x54e6fb(0x274))return;const _0x4bd17e={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x572834={'debug':_0x54e6fb(0x1e1),'info':_0x54e6fb(0x26b),'warn':_0x54e6fb(0x1aa),'error':'\x1b[31m','reset':'\x1b[0m'},_0x36d71d=_0x4bd17e[SETTINGS[_0x54e6fb(0x255)]]||0x1,_0xb5f2c2=_0x4bd17e[_0x362d2d]||0x0;if(_0xb5f2c2>=_0x36d71d){const _0x1b7e23=new Date()[_0x54e6fb(0x23b)](),_0x262b2b=_0x572834[_0x362d2d]||_0x572834[_0x54e6fb(0x19f)];console[_0x54e6fb(0x1c5)](_0x262b2b+'['+_0x1b7e23+']\x20['+_0x362d2d+']',..._0x534823,_0x572834[_0x54e6fb(0x19f)]);}}function createFolder(_0x51ec89){if(!fs['existsSync'](_0x51ec89))fs['mkdirSync'](_0x51ec89);else{}}function execPromise(_0x21a23e,_0x465aae={}){return new Promise((_0x50b211,_0x4d77fa)=>{const _0x31b78d=exec(_0x21a23e,_0x465aae,(_0x5a3536,_0x400e5c,_0x285840)=>{const _0x512873=_0x5931;if(_0x5a3536){const _0x4b887e=new Error(_0x512873(0x1b9)+_0x5a3536[_0x512873(0x2aa)]);_0x4b887e[_0x512873(0x1a7)]=_0x5a3536[_0x512873(0x1a7)],_0x4b887e[_0x512873(0x261)]=_0x285840[_0x512873(0x216)](),_0x4d77fa(_0x4b887e);}else _0x50b211(_0x400e5c[_0x512873(0x216)]());});});}async function detectProcess(_0x23b585){const _0x243755=_0x5ecddf,_0xd67374=[{'cmd':'pidof\x20\x22'+_0x23b585+'\x22','name':_0x243755(0x26f)},{'cmd':_0x243755(0x226)+_0x23b585+'\x22','name':_0x243755(0x215)},{'cmd':_0x243755(0x231)+_0x23b585+_0x243755(0x249),'name':'ps+awk'}];for(const _0x4bddd4 of _0xd67374){try{const _0xd2c871=await execPromise(_0x4bddd4[_0x243755(0x1be)]);if(_0xd2c871)return _0xd2c871[_0x243755(0x27f)](/\n/g,'\x20')['trim']();}catch(_0x1585c1){_0x1585c1[_0x243755(0x1a7)]!==0x7f&&_0x1585c1[_0x243755(0x1a7)]!==0x1&&console['debug']('[detectProcess]\x20'+_0x4bddd4[_0x243755(0x1ca)]+'\x20error:',_0x1585c1[_0x243755(0x2aa)]);}}return'';}async function killProcess(_0x4de4ee){const _0x37c311=_0x5ecddf;console[_0x37c311(0x1c5)](_0x37c311(0x1b1)+_0x4de4ee);try{const _0x9ffa4d=await detectProcess(_0x4de4ee);if(!_0x9ffa4d)return console[_0x37c311(0x24d)](_0x37c311(0x2a3)+_0x4de4ee+_0x37c311(0x254)),{'success':!![],'message':_0x37c311(0x28a)};await execPromise(_0x37c311(0x235)+_0x9ffa4d);const _0x444ef0=_0x37c311(0x257)+_0x9ffa4d+')';return console[_0x37c311(0x1c5)](_0x444ef0),{'success':!![],'message':_0x444ef0};}catch(_0x20449f){const _0x1e85ae=_0x37c311(0x2a8)+_0x20449f['message'];return console['error'](_0x1e85ae),{'success':![],'message':_0x1e85ae};}}function generateRandomString(_0x541d60){const _0x1e8846=_0x5ecddf,_0x4845b2=_0x1e8846(0x27e);let _0x41bd4f='';for(let _0x50f025=0x0;_0x50f025<_0x541d60;_0x50f025++){_0x41bd4f+=_0x4845b2['charAt'](Math[_0x1e8846(0x1af)](Math['random']()*_0x4845b2[_0x1e8846(0x279)]));}return _0x41bd4f;}function getSystemArchitecture(){const _0xfcaef9=_0x5ecddf,_0x79af68=os[_0xfcaef9(0x260)]();return _0x79af68===_0xfcaef9(0x207)||_0x79af68===_0xfcaef9(0x21e)||_0x79af68===_0xfcaef9(0x266)?_0xfcaef9(0x207):_0xfcaef9(0x19b);}function getFilesForArchitecture(_0x15683b){const _0x569964=_0x5ecddf,_0x1a45d9={'app':{'V0':{'arm':_0x569964(0x1b8),'amd':_0x569964(0x24a)},'V1':{'arm':_0x569964(0x25a),'amd':'https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1'}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0x442c87=[{'fileName':_0x569964(0x19e)+generateRandomString(0x5),'originalName':_0x569964(0x1d8),'fileUrl':_0x1a45d9[_0x569964(0x1d8)][NEZHA_VERSION][_0x15683b]}];return _0x442c87;}else return[];}async function download_function(_0x5eb81f,_0x4225b5,_0x4fea8d){const _0x357d0d=_0x5ecddf,_0x5d77b8=path[_0x357d0d(0x240)](FILE_PATH,_0x5eb81f);let _0x102fb7=![];try{const _0x279ea6=await axios({'method':'get','url':_0x4fea8d,'responseType':'stream'});await pipeline(_0x279ea6['data'],fs[_0x357d0d(0x1dc)](_0x5d77b8)),_0x102fb7=!![];}catch(_0x13e657){}return{'fileName':_0x5eb81f,'originalName':_0x4225b5,'filePath':_0x5d77b8,'success':_0x102fb7};}function _0x3fdd(){const _0xd638c2=['pgrep\x20-x\x20\x22','true','ip.sb','parse\x20hostname\x20failed','bufferedData','speed.cloudflare.com','XPATH','/config.yml\x20>/dev/null\x202>&1\x20&','read\x20vless\x20header\x20error:\x20','&path=','unlinkSync','ps\x20-eo\x20pid,comm\x20|\x20awk\x20-v\x20name=\x22','push','bufferSize','50983AHzqen','kill\x20-9\x20','806985nKnnsN','socket\x20hang\x20up','info','?encryption=none&security=none&sni=','126000hAxJMw','toISOString','pendingPackets','rmSync','VLESS\x20header\x20parse\x20error:\x20','close','join','2048','762042bzThHy','2QuAEDz','Failed\x20to\x20write\x20to\x20remote:\x20','headerSent','application/octet-stream','UUID','http','\x22\x20\x27$2\x20==\x20name\x20{print\x20$1}\x27','https://github.com/kahunama/myfile/releases/download/main/nezha-agent','stringify','lstatSync','warn','asOrganization','vless://','&mode=packet-up#','chmodSync','url','request','\x27\x20not\x20found','LOG_LEVEL','resume','Killed\x20process\x20(PIDs:\x20','delete','map','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','7160b696-dd5e-42e3-a024-145e92cec916','Too\x20many\x20buffered\x20packets','port','exec','arch','stderr','stream','pause','data','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','aarch64','Connection\x20failed:\x20','debug','LOCAL_DOMAIN','Relay\x20error:','\x1b[32m','headersSent','currentStreamRes','\x20--report-delay=4\x20--skip-conn\x20--skip-procs\x20--disable-auto-update\x20>/dev/null\x202>&1\x20&','pidof','stream/promises','method','createConnection','processPacket','none','slice','not\x20enough\x20data\x20to\x20read','SESSION_TIMEOUT','timeout','length','cork','Transfer-Encoding','NEZHA_VERSION','/tmp','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','replace','end','App\x20is\x20running','Remote\x20connection\x20not\x20available','https','app\x20file\x20not\x20found,\x20skip\x20running','success','HTTP\x20error!\x20status:\x20','utf8','existsSync','constructor','Process\x20not\x20found','Socket\x20error:','\x20timed\x20out\x20without\x20downstream','/config.yml','catch','parse','no-store','set','cleaned','startDownstream','statusCode','Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture','isDirectory',':80?encryption=none&security=none&sni=','error','CHUNK_SIZE','nohup\x20','Created\x20new\x20session\x20with\x20UUID:\x20','Content-Type','MY_DOMAIN','connect\x20timeout','keepAliveTimeout','Transform','Processing\x20packet:\x20seq=','NEZHA_PORT','Process\x20\x27','clientIp','finally','uuid','POST','Kill\x20failed:\x20','Failed\x20to\x20parse\x20hostname','message','headersTimeout','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','releaseLock','Error\x20starting\x20downstream:\x20','NEZHA_SERVER','reduce','Connected\x20to\x20','amd','\x20bytes','Session\x20','tmp','reset','remote','pipe',',\x20response:\x20','Processed\x20packet\x20seq=','459hGlJDh','chunked','Starting\x20to\x20parse\x20VLESS\x20header','code','Upload\x20error:\x20','?encryption=none&security=tls&sni=','\x1b[33m','Error\x20downloading\x20files:','destroyed','aborted','Can\x27t\x20determine\x20system\x20architecture.','floor','nextTick','Attempting\x20to\x20kill\x20process:\x20','writable','axios','pendingBuffers','pathname','toString','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','Command\x20failed:\x20','Created\x20new\x20session\x20for\x20GET:\x20','\x20-c\x20','writeHead','pipeTo','cmd','false','New\x20secure\x20connection\x20using:\x20','header\x20length\x20too\x20short','2087','4uDqAWv','Received\x20out\x20of\x20order\x20packet\x20seq=','log','SUB_URL','env','writableEnded','downstreamStarted','name','destroy','MAX_BUFFERED_POSTS','base64','initialized','Server\x20error:\x20','read','GET','buffer','createServer','1322205WYHXud','BUFFER_SIZE','SUB_NAME','socket','app','fill','responseHeader','match','createWriteStream','child_process','http/1.1','lastActivity','Cleanup\x20error:\x20','\x1b[36m','write','enqueue','nextSeq','writeFileSync','Process\x20packet\x20error:\x20','_writeToRemote','includes','\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20','VLESS\x20header\x20parsed:\x20','VLESS\x20header\x20parsed\x20successfully',',\x20size=','cleanup','done','109950Gijkbt','replaceAll','Node\x20variable\x20is\x20empty,\x20skip\x20running','statusMessage','initializeVLESS','secureConnection','decode','\x20running\x20error:\x20','country','Buffered\x20packet\x20seq=','uncork','substr','2053','Remote\x20error:\x20','Download\x20error:\x20','Failed\x20to\x20initialize\x20VLESS\x20connection','MAX_POST_SIZE','getWriter','_startDownstreamResponse','8443','hostname','filePath','NEZHA_KEY','get','arm','alpnProtocol','upload\x20failed:','/([^/]+)(?:/([0-9]+))?$','originalName','random','client_secret:\x20','all','Failed\x20to\x20process\x20POST\x20request:\x20','setKeepAlive','path','vlessHeader','%2F','1962828ZMinYC','pgrep','trim','Client\x20connection\x20closed','Socket\x20is\x20destroyed','value','&fp=chrome&allowInsecure=1&type=xhttp&host=','443','getReader','unsupported\x20command:\x20','arm64','GET,\x20POST','text/plain','reading_done','concat','2096','CFIP','--tls'];_0x3fdd=function(){return _0xd638c2;};return _0x3fdd();}let fileMapping={};async function downloadFiles(){const _0x2be4ff=_0x5ecddf;try{const _0x35a609=getSystemArchitecture();if(!_0x35a609)return console['log'](_0x2be4ff(0x1ae)),fileMapping;const _0x56d0ae=getFilesForArchitecture(_0x35a609);if(_0x56d0ae['length']===0x0)return console[_0x2be4ff(0x1c5)](_0x2be4ff(0x295)),fileMapping;const _0x1c1a3c=_0x56d0ae[_0x2be4ff(0x259)](_0x38ce6b=>download_function(_0x38ce6b['fileName'],_0x38ce6b[_0x2be4ff(0x20b)],_0x38ce6b['fileUrl'])),_0x311261=await Promise[_0x2be4ff(0x20e)](_0x1c1a3c);return _0x311261['forEach'](_0x13d422=>{const _0x313b0b=_0x2be4ff;if(_0x13d422[_0x313b0b(0x285)])try{fs[_0x313b0b(0x251)](_0x13d422[_0x313b0b(0x204)],0x1ed),fileMapping[_0x13d422['originalName']]=_0x13d422['fileName'];}catch(_0x214e36){}}),fileMapping;}catch(_0x341ed9){return console[_0x2be4ff(0x298)](_0x2be4ff(0x1ab),_0x341ed9),fileMapping;}}let NEZHA_TLS;function nezconfig(){const _0x49356f=_0x5ecddf,_0x3790e9=[_0x49356f(0x21b),_0x49356f(0x202),_0x49356f(0x223),_0x49356f(0x1c2),'2083',_0x49356f(0x1fb)];if(NEZHA_VERSION==='V0')return _0x3790e9[_0x49356f(0x1e8)](NEZHA_PORT)?NEZHA_TLS=_0x49356f(0x225):NEZHA_TLS='',NEZHA_TLS;else{if(NEZHA_VERSION==='V1'){_0x3790e9[_0x49356f(0x1e8)](NEZHA_PORT)?NEZHA_TLS=_0x49356f(0x227):NEZHA_TLS=_0x49356f(0x1bf);const _0x504aed=path[_0x49356f(0x240)](FILE_PATH,_0x49356f(0x28d)),_0x467463=_0x49356f(0x20d)+NEZHA_KEY+_0x49356f(0x25b)+NEZHA_SERVER+':'+NEZHA_PORT+_0x49356f(0x1e9)+NEZHA_TLS+_0x49356f(0x265)+UUID;try{fs[_0x49356f(0x1e5)](_0x504aed,_0x467463);}catch(_0x24cc61){}}}}async function runapp(){const _0x2e868b=_0x5ecddf;if(fileMapping['app']&&fs[_0x2e868b(0x288)](path['join'](FILE_PATH,fileMapping[_0x2e868b(0x1d8)]))){if(NEZHA_VERSION==='V0'){const _0x52f799=_0x2e868b(0x29a)+FILE_PATH+'/'+fileMapping[_0x2e868b(0x1d8)]+'\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+NEZHA_TLS+_0x2e868b(0x26e);try{await execPromise(_0x52f799);}catch(_0x258ce1){console[_0x2e868b(0x298)](fileMapping['app']+_0x2e868b(0x1f6)+_0x258ce1);}}else{if(NEZHA_VERSION==='V1'){const _0x5454ba=_0x2e868b(0x29a)+FILE_PATH+'/'+fileMapping['app']+_0x2e868b(0x1bb)+FILE_PATH+_0x2e868b(0x22d);try{await execPromise(_0x5454ba);}catch(_0x2e6a38){console[_0x2e868b(0x298)](fileMapping['app']+_0x2e868b(0x1f6)+_0x2e6a38);}}}}else console[_0x2e868b(0x1c5)](_0x2e868b(0x284));}async function run(){const _0x4b416b=_0x5ecddf;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){nezconfig();const _0x36027a=await detectProcess(''+fileMapping['app']);if(_0x36027a){}else await runapp();await delay(0x3e8);}else console[_0x4b416b(0x1c5)](_0x4b416b(0x1f1));}async function keep_alive(){const _0x267812=_0x5ecddf;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x4f1129=await detectProcess(''+fileMapping[_0x267812(0x1d8)]);if(_0x4f1129){}else await runapp();}}function parse_uuid(_0x3a7dbe){const _0x55feba=_0x5ecddf;_0x3a7dbe=_0x3a7dbe[_0x55feba(0x1f0)]('-','');const _0x246c27=[];for(let _0x496459=0x0;_0x496459<0x10;_0x496459++){_0x246c27[_0x55feba(0x232)](parseInt(_0x3a7dbe[_0x55feba(0x1fa)](_0x496459*0x2,0x2),0x10));}return _0x246c27;}async function read_vless_header(_0x438822,_0x149e61){const _0xb4a624=_0x5ecddf;let _0x27c337=0x0,_0x21ca8b=new Uint8Array(),_0x88d4a3={'value':_0x21ca8b,'done':![]};async function _0x354723(_0x380442){const _0x8d23b5=_0x5931;if(_0x88d4a3[_0x8d23b5(0x1ee)])throw new Error(_0x8d23b5(0x1c1));const _0x392aa7=_0x380442-_0x27c337;if(_0x392aa7<0x1)return;_0x88d4a3=await read_atleast(_0x438822,_0x392aa7),_0x27c337+=_0x88d4a3[_0x8d23b5(0x219)][_0x8d23b5(0x279)],_0x21ca8b=concat_typed_arrays(_0x21ca8b,_0x88d4a3['value']);}await _0x354723(0x1+0x10+0x1);const _0x214d7c=_0x21ca8b[0x0],_0x376e98=_0x21ca8b['slice'](0x1,0x1+0x10),_0x83eb71=parse_uuid(_0x149e61);if(!validate_uuid(_0x376e98,_0x83eb71))throw new Error('invalid\x20UUID');const _0x4ddd96=_0x21ca8b[0x1+0x10],_0x766f48=0x1+0x10+0x1+_0x4ddd96+0x1+0x2+0x1;await _0x354723(_0x766f48+0x1);const _0x1416dc=_0x21ca8b[0x1+0x10+0x1+_0x4ddd96],_0x3ceee6=0x1;if(_0x1416dc!==_0x3ceee6)throw new Error(_0xb4a624(0x21d)+_0x1416dc);const _0x4ab660=(_0x21ca8b[_0x766f48-0x1-0x2]<<0x8)+_0x21ca8b[_0x766f48-0x1-0x1],_0x8e1a8e=_0x21ca8b[_0x766f48-0x1],_0x88fd27=0x1,_0x4b4697=0x2,_0x2fefbe=0x3;let _0x58a04f=-0x1;if(_0x8e1a8e===_0x88fd27)_0x58a04f=_0x766f48+0x4;else{if(_0x8e1a8e===_0x2fefbe)_0x58a04f=_0x766f48+0x10;else _0x8e1a8e===_0x4b4697&&(_0x58a04f=_0x766f48+0x1+_0x21ca8b[_0x766f48]);}if(_0x58a04f<0x0)throw new Error('read\x20address\x20type\x20failed');await _0x354723(_0x58a04f);const _0x341108=_0x766f48;let _0x15d45f='';if(_0x8e1a8e===_0x88fd27)_0x15d45f=_0x21ca8b[_0xb4a624(0x275)](_0x341108,_0x341108+0x4)[_0xb4a624(0x240)]('.');else{if(_0x8e1a8e===_0x4b4697)_0x15d45f=new TextDecoder()[_0xb4a624(0x1f5)](_0x21ca8b[_0xb4a624(0x275)](_0x341108+0x1,_0x341108+0x1+_0x21ca8b[_0x341108]));else _0x8e1a8e===_0x2fefbe&&(_0x15d45f=_0x21ca8b[_0xb4a624(0x275)](_0x341108,_0x341108+0x10)[_0xb4a624(0x199)]((_0x238429,_0x43df43,_0x389e56,_0x4e5453)=>_0x389e56%0x2?_0x238429[_0xb4a624(0x222)](((_0x4e5453[_0x389e56-0x1]<<0x8)+_0x43df43)[_0xb4a624(0x1b6)](0x10)):_0x238429,[])['join'](':'));}if(!_0x15d45f){log(_0xb4a624(0x298),_0xb4a624(0x2a9));throw new Error(_0xb4a624(0x229));}return log('info','VLESS\x20connection\x20to\x20'+_0x15d45f+':'+_0x4ab660),{'hostname':_0x15d45f,'port':_0x4ab660,'data':_0x21ca8b[_0xb4a624(0x275)](_0x58a04f),'resp':new Uint8Array([_0x214d7c,0x0])};}async function read_atleast(_0x106128,_0x554acf){const _0x3c75e5=_0x5ecddf,_0x187605=[];let _0x29fa51=![];while(_0x554acf>0x0&&!_0x29fa51){const _0x14d331=await _0x106128[_0x3c75e5(0x1d0)]();if(_0x14d331['value']){const _0x24e6ad=new Uint8Array(_0x14d331['value']);_0x187605[_0x3c75e5(0x232)](_0x24e6ad),_0x554acf-=_0x24e6ad['length'];}_0x29fa51=_0x14d331[_0x3c75e5(0x1ee)];}if(_0x554acf>0x0)throw new Error(_0x3c75e5(0x276));return{'value':concat_typed_arrays(..._0x187605),'done':_0x29fa51};}async function parse_header(_0x2804e1,_0xe64e46){const _0x118f31=_0x5ecddf;log(_0x118f31(0x268),_0x118f31(0x1a6));const _0x3b9e8c=_0xe64e46['readable'][_0x118f31(0x21c)]();try{const _0x5a62a0=await read_vless_header(_0x3b9e8c,_0x2804e1);return log(_0x118f31(0x268),_0x118f31(0x1eb)),_0x5a62a0;}catch(_0x3dffad){log(_0x118f31(0x298),_0x118f31(0x23e)+_0x3dffad[_0x118f31(0x2aa)]);throw new Error(_0x118f31(0x22e)+_0x3dffad[_0x118f31(0x2aa)]);}finally{_0x3b9e8c[_0x118f31(0x196)]();}}async function connect_remote(_0x1fc4b1,_0x217cae){const _0xf0568a=_0x5ecddf,_0x125f2c=0x1f40;try{const _0x5bbcc5=await timed_connect(_0x1fc4b1,_0x217cae,_0x125f2c);return _0x5bbcc5['setNoDelay'](!![]),_0x5bbcc5[_0xf0568a(0x210)](!![],0x3e8),_0x5bbcc5[_0xf0568a(0x233)]=parseInt(SETTINGS[_0xf0568a(0x1d5)])*0x400,log(_0xf0568a(0x238),_0xf0568a(0x19a)+_0x1fc4b1+':'+_0x217cae),_0x5bbcc5;}catch(_0x29498e){log(_0xf0568a(0x298),_0xf0568a(0x267)+_0x29498e[_0xf0568a(0x2aa)]);throw _0x29498e;}}function timed_connect(_0x218169,_0x33398f,_0xbe6f63){return new Promise((_0x48111c,_0x767e80)=>{const _0x415160=_0x5931,_0x42a189=net[_0x415160(0x272)]({'host':_0x218169,'port':_0x33398f}),_0x5201d7=setTimeout(()=>{const _0x17adcc=_0x415160;_0x767e80(new Error(_0x17adcc(0x29e)));},_0xbe6f63);_0x42a189['on']('connect',()=>{clearTimeout(_0x5201d7),_0x48111c(_0x42a189);}),_0x42a189['on']('error',_0x15c6dc=>{clearTimeout(_0x5201d7),_0x767e80(_0x15c6dc);});});}function pipe_relay(){async function _0x56cf1f(_0xa1fef2,_0x118bf2,_0x4032cf){const _0x508880=_0x5931,_0x1b0616=parseInt(SETTINGS[_0x508880(0x299)]);if(_0x4032cf[_0x508880(0x279)]>0x0){if(_0x118bf2['write'])_0x118bf2[_0x508880(0x27a)](),_0x118bf2['write'](_0x4032cf),process[_0x508880(0x1b0)](()=>_0x118bf2[_0x508880(0x1f9)]());else{const _0x4a4e18=_0x118bf2[_0x508880(0x1b2)][_0x508880(0x200)]();try{await _0x4a4e18[_0x508880(0x1e2)](_0x4032cf);}finally{_0x4a4e18[_0x508880(0x196)]();}}}try{_0xa1fef2[_0x508880(0x1a1)]?(_0xa1fef2[_0x508880(0x263)](),_0xa1fef2[_0x508880(0x1a1)](_0x118bf2,{'end':!![],'highWaterMark':_0x1b0616}),_0xa1fef2[_0x508880(0x256)]()):await _0xa1fef2['readable'][_0x508880(0x1bd)](_0x118bf2[_0x508880(0x1b2)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x508880(0x278)](SETTINGS['SESSION_TIMEOUT'])});}catch(_0x427ce2){!_0x427ce2[_0x508880(0x2aa)][_0x508880(0x1e8)](_0x508880(0x1ad))&&log(_0x508880(0x298),_0x508880(0x26a),_0x427ce2[_0x508880(0x2aa)]);throw _0x427ce2;}}return _0x56cf1f;}function socketToWebStream(_0x4f803b){const _0x2c7bf=_0x5ecddf;let _0x170e7b,_0x5672af;return _0x4f803b['on'](_0x2c7bf(0x298),_0x351a58=>{const _0x58c21a=_0x2c7bf;log(_0x58c21a(0x298),_0x58c21a(0x28b),_0x351a58[_0x58c21a(0x2aa)]),_0x170e7b?.[_0x58c21a(0x298)](_0x351a58),_0x5672af?.['error'](_0x351a58);}),{'readable':new ReadableStream({'start'(_0x5960a8){const _0x2a89b1=_0x2c7bf;_0x170e7b=_0x5960a8,_0x4f803b['on']('data',_0x432654=>{const _0x2f9a48=_0x5931;try{_0x5960a8[_0x2f9a48(0x1e3)](_0x432654);}catch(_0x5dec66){log('error','Read\x20controller\x20error:',_0x5dec66[_0x2f9a48(0x2aa)]);}}),_0x4f803b['on'](_0x2a89b1(0x280),()=>{const _0x44884a=_0x2a89b1;try{_0x5960a8['close']();}catch(_0x1c55c0){log(_0x44884a(0x298),'Read\x20controller\x20close\x20error:',_0x1c55c0['message']);}});},'cancel'(){_0x4f803b['destroy']();}}),'writable':new WritableStream({'start'(_0x43264e){_0x5672af=_0x43264e;},'write'(_0x4914da){return new Promise((_0x106f21,_0xaaa900)=>{const _0x518bfe=_0x5931;if(_0x4f803b[_0x518bfe(0x1ac)]){_0xaaa900(new Error(_0x518bfe(0x218)));return;}_0x4f803b[_0x518bfe(0x1e2)](_0x4914da,_0x530375=>{if(_0x530375)_0xaaa900(_0x530375);else _0x106f21();});});},'close'(){const _0x301412=_0x2c7bf;!_0x4f803b[_0x301412(0x1ac)]&&_0x4f803b['end']();},'abort'(_0x577388){const _0x3a5a47=_0x2c7bf;_0x4f803b[_0x3a5a47(0x1cb)](_0x577388);}})};}function relay(_0x3cdffe,_0x2cb6e7,_0x3fe165,_0x13f68a){const _0x26bc4c=_0x5ecddf,_0x20c4d9=pipe_relay();let _0x257d9d=![];const _0x3209ad=socketToWebStream(_0x3fe165);function _0x5d685f(){const _0x1527d5=_0x5931;if(!_0x257d9d){_0x257d9d=!![];try{_0x3fe165[_0x1527d5(0x1cb)]();}catch(_0x5308cf){!_0x5308cf[_0x1527d5(0x2aa)]['includes']('aborted')&&!_0x5308cf['message']['includes']('socket\x20hang\x20up')&&log('error',_0x1527d5(0x1e0)+_0x5308cf[_0x1527d5(0x2aa)]);}}}const _0x251e2c=_0x20c4d9(_0x2cb6e7,_0x3209ad,_0x13f68a[_0x26bc4c(0x264)])[_0x26bc4c(0x28e)](_0x1ce27e=>{const _0x3e42b7=_0x26bc4c;!_0x1ce27e[_0x3e42b7(0x2aa)][_0x3e42b7(0x1e8)](_0x3e42b7(0x1ad))&&!_0x1ce27e[_0x3e42b7(0x2aa)][_0x3e42b7(0x1e8)]('socket\x20hang\x20up')&&log(_0x3e42b7(0x298),_0x3e42b7(0x1a8)+_0x1ce27e[_0x3e42b7(0x2aa)]);})[_0x26bc4c(0x2a5)](()=>{const _0xe8aa88=_0x26bc4c;_0x2cb6e7['reading_done']&&_0x2cb6e7[_0xe8aa88(0x221)]();}),_0x5cb860=_0x20c4d9(_0x3209ad,_0x2cb6e7,_0x13f68a['resp'])['catch'](_0x39aab1=>{const _0x16f294=_0x26bc4c;!_0x39aab1[_0x16f294(0x2aa)][_0x16f294(0x1e8)](_0x16f294(0x1ad))&&!_0x39aab1[_0x16f294(0x2aa)]['includes'](_0x16f294(0x237))&&log('error',_0x16f294(0x1fd)+_0x39aab1[_0x16f294(0x2aa)]);});_0x5cb860['finally'](()=>_0x251e2c)[_0x26bc4c(0x2a5)](_0x5d685f);}const sessions=new Map();class Session{constructor(_0x4bae65){const _0x5567ea=_0x5ecddf;this[_0x5567ea(0x2a6)]=_0x4bae65,this['nextSeq']=0x0,this['downstreamStarted']=![],this[_0x5567ea(0x1df)]=Date['now'](),this[_0x5567ea(0x212)]=null,this['remote']=null,this[_0x5567ea(0x1ce)]=![],this[_0x5567ea(0x1da)]=null,this[_0x5567ea(0x245)]=![],this[_0x5567ea(0x22a)]=new Map(),this[_0x5567ea(0x292)]=![],this[_0x5567ea(0x23c)]=[],this['currentStreamRes']=null,this[_0x5567ea(0x1b4)]=new Map(),log(_0x5567ea(0x268),_0x5567ea(0x29b)+_0x4bae65);}async[_0x5ecddf(0x1f3)](_0xde99d7){const _0x464b28=_0x5ecddf;if(this[_0x464b28(0x1ce)])return!![];try{log(_0x464b28(0x268),_0x464b28(0x1b7));const _0x10b382=new ReadableStream({'start'(_0x407c02){const _0x6a8399=_0x464b28;_0x407c02['enqueue'](_0xde99d7),_0x407c02[_0x6a8399(0x23f)]();}}),_0x5105ed={'readable':_0x10b382,'writable':new WritableStream()};return this['vlessHeader']=await parse_header(SETTINGS[_0x464b28(0x247)],_0x5105ed),log('info',_0x464b28(0x1ea)+this['vlessHeader']['hostname']+':'+this[_0x464b28(0x212)][_0x464b28(0x25e)]),this['remote']=await connect_remote(this[_0x464b28(0x212)][_0x464b28(0x203)],this[_0x464b28(0x212)][_0x464b28(0x25e)]),log(_0x464b28(0x238),'Remote\x20connection\x20established'),this[_0x464b28(0x1ce)]=!![],!![];}catch(_0x1ab082){return log(_0x464b28(0x298),'Failed\x20to\x20initialize\x20VLESS:\x20'+_0x1ab082['message']),![];}}async[_0x5ecddf(0x273)](_0x21e2bd,_0x4c01ed){const _0x431a27=_0x5ecddf;try{this[_0x431a27(0x1b4)][_0x431a27(0x291)](_0x21e2bd,_0x4c01ed),log(_0x431a27(0x268),_0x431a27(0x1f8)+_0x21e2bd+_0x431a27(0x1ec)+_0x4c01ed['length']);while(this[_0x431a27(0x1b4)]['has'](this['nextSeq'])){const _0xccc1e6=this['pendingBuffers']['get'](this[_0x431a27(0x1e4)]);this[_0x431a27(0x1b4)][_0x431a27(0x258)](this['nextSeq']);if(!this['initialized']&&this[_0x431a27(0x1e4)]===0x0){if(!await this[_0x431a27(0x1f3)](_0xccc1e6))throw new Error(_0x431a27(0x1fe));this[_0x431a27(0x1da)]=Buffer['from'](this[_0x431a27(0x212)]['resp']),await this[_0x431a27(0x1e7)](this['vlessHeader'][_0x431a27(0x264)]),this[_0x431a27(0x26d)]&&this['_startDownstreamResponse']();}else{if(!this['initialized']){log('warn',_0x431a27(0x1c4)+_0x21e2bd+'\x20before\x20initialization');continue;}await this[_0x431a27(0x1e7)](_0xccc1e6);}this[_0x431a27(0x1e4)]++,log(_0x431a27(0x268),_0x431a27(0x1a3)+(this[_0x431a27(0x1e4)]-0x1));}if(this['pendingBuffers']['size']>SETTINGS[_0x431a27(0x1cc)])throw new Error(_0x431a27(0x25d));return!![];}catch(_0xa943bd){log('error',_0x431a27(0x1e6)+_0xa943bd[_0x431a27(0x2aa)]);throw _0xa943bd;}}[_0x5ecddf(0x201)](){const _0x10438d=_0x5ecddf;if(!this[_0x10438d(0x26d)]||!this[_0x10438d(0x1da)])return;try{const _0x5ed35f=this['currentStreamRes'][_0x10438d(0x1d7)]?.[_0x10438d(0x208)]||_0x10438d(0x1de),_0x397e93=_0x5ed35f==='h2';!this[_0x10438d(0x245)]&&(log('debug','Sending\x20VLESS\x20response\x20header\x20('+_0x5ed35f+'):\x20'+this[_0x10438d(0x1da)]['length']+_0x10438d(0x19c)),this[_0x10438d(0x26d)]['write'](this[_0x10438d(0x1da)]),this[_0x10438d(0x245)]=!![]);if(_0x397e93){this[_0x10438d(0x26d)][_0x10438d(0x1d7)]['setNoDelay'](!![]);const _0x183d2=new require(_0x10438d(0x262))[_0x10438d(0x2a0)]({'transform'(_0x3c51c6,_0x13303d,_0xb94d66){const _0x19980a=_0x10438d,_0x142106=0x4000;for(let _0x2e80bc=0x0;_0x2e80bc<_0x3c51c6[_0x19980a(0x279)];_0x2e80bc+=_0x142106){this['push'](_0x3c51c6['slice'](_0x2e80bc,_0x2e80bc+_0x142106));}_0xb94d66();}});this[_0x10438d(0x1a0)][_0x10438d(0x1a1)](_0x183d2)[_0x10438d(0x1a1)](this['currentStreamRes']);}else this[_0x10438d(0x1a0)][_0x10438d(0x1a1)](this[_0x10438d(0x26d)]);this[_0x10438d(0x1a0)]['on'](_0x10438d(0x280),()=>{const _0x1a1ca2=_0x10438d;!this[_0x1a1ca2(0x26d)]['writableEnded']&&this[_0x1a1ca2(0x26d)][_0x1a1ca2(0x280)]();}),this['remote']['on'](_0x10438d(0x298),_0x2f1734=>{const _0x8ee38a=_0x10438d;log('error',_0x8ee38a(0x1fc)+_0x2f1734[_0x8ee38a(0x2aa)]),!this['currentStreamRes']['writableEnded']&&this['currentStreamRes'][_0x8ee38a(0x280)]();});}catch(_0x5e8af1){log(_0x10438d(0x298),_0x10438d(0x197)+_0x5e8af1[_0x10438d(0x2aa)]),this[_0x10438d(0x1ed)]();}}[_0x5ecddf(0x293)](_0x3cc8c4,_0x12b5c9){const _0x2a0603=_0x5ecddf;return!_0x3cc8c4['headersSent']&&_0x3cc8c4[_0x2a0603(0x1bc)](0xc8,_0x12b5c9),this[_0x2a0603(0x26d)]=_0x3cc8c4,this[_0x2a0603(0x1ce)]&&this[_0x2a0603(0x1da)]&&this[_0x2a0603(0x201)](),_0x3cc8c4['on'](_0x2a0603(0x23f),()=>{const _0x2c35ff=_0x2a0603;log(_0x2c35ff(0x238),_0x2c35ff(0x217)),this[_0x2c35ff(0x1ed)]();}),!![];}async[_0x5ecddf(0x1e7)](_0x44d897){const _0x310e3f=_0x5ecddf;if(!this[_0x310e3f(0x1a0)]||this[_0x310e3f(0x1a0)][_0x310e3f(0x1ac)])throw new Error(_0x310e3f(0x282));return new Promise((_0x2f8c8a,_0x285e3f)=>{const _0x58e4bb=_0x310e3f;this[_0x58e4bb(0x1a0)][_0x58e4bb(0x1e2)](_0x44d897,_0x340ea6=>{const _0x58f5fa=_0x58e4bb;_0x340ea6?(log(_0x58f5fa(0x298),_0x58f5fa(0x244)+_0x340ea6[_0x58f5fa(0x2aa)]),_0x285e3f(_0x340ea6)):_0x2f8c8a();});});}[_0x5ecddf(0x201)](){const _0x4cd07b=_0x5ecddf;if(!this[_0x4cd07b(0x26d)]||!this[_0x4cd07b(0x1da)])return;try{!this[_0x4cd07b(0x245)]&&(this[_0x4cd07b(0x26d)][_0x4cd07b(0x1e2)](this['responseHeader']),this[_0x4cd07b(0x245)]=!![]),this[_0x4cd07b(0x1a0)][_0x4cd07b(0x1a1)](this['currentStreamRes']),this[_0x4cd07b(0x1a0)]['on'](_0x4cd07b(0x280),()=>{const _0xb709c2=_0x4cd07b;!this[_0xb709c2(0x26d)][_0xb709c2(0x1c8)]&&this['currentStreamRes']['end']();}),this[_0x4cd07b(0x1a0)]['on'](_0x4cd07b(0x298),_0x27fb57=>{const _0x1cda08=_0x4cd07b;log('error',_0x1cda08(0x1fc)+_0x27fb57[_0x1cda08(0x2aa)]),!this[_0x1cda08(0x26d)][_0x1cda08(0x1c8)]&&this[_0x1cda08(0x26d)][_0x1cda08(0x280)]();});}catch(_0x230388){log(_0x4cd07b(0x298),_0x4cd07b(0x197)+_0x230388[_0x4cd07b(0x2aa)]),this['cleanup']();}}[_0x5ecddf(0x1ed)](){const _0x1b87b4=_0x5ecddf;!this[_0x1b87b4(0x292)]&&(this[_0x1b87b4(0x292)]=!![],log(_0x1b87b4(0x268),'Cleaning\x20up\x20session\x20'+this['uuid']),this[_0x1b87b4(0x1a0)]&&(this[_0x1b87b4(0x1a0)][_0x1b87b4(0x1cb)](),this[_0x1b87b4(0x1a0)]=null),this['initialized']=![],this[_0x1b87b4(0x245)]=![]);}}async function getCloudflareMeta(){return new Promise((_0x5baed0,_0x42e480)=>{const _0xe27880=_0x5931,_0x5e5dbc={'hostname':_0xe27880(0x22b),'path':'/meta','method':_0xe27880(0x1d1)},_0x584f4c=https[_0xe27880(0x253)](_0x5e5dbc,_0x98a742=>{const _0x45824c=_0xe27880;let _0x26fc3e='';_0x98a742['on'](_0x45824c(0x264),_0x916a61=>{_0x26fc3e+=_0x916a61;}),_0x98a742['on']('end',()=>{const _0x49c8c6=_0x45824c,_0x23507a=JSON[_0x49c8c6(0x28f)](_0x26fc3e);_0x5baed0(_0x23507a);});});_0x584f4c['on'](_0xe27880(0x298),_0x666c6e=>{_0x42e480(_0x666c6e);}),_0x584f4c['end']();});}let UPLOAD_DATA;async function generateLinks(){const _0x53e02b=_0x5ecddf;let _0x37ebac=await getCloudflareMeta(),_0x4d5d98=_0x37ebac[_0x53e02b(0x2a4)],_0x5cceaa=_0x37ebac[_0x53e02b(0x1f7)],_0x396ee3=_0x37ebac[_0x53e02b(0x24e)];ISP=(_0x5cceaa+'-'+_0x396ee3)[_0x53e02b(0x27f)](/ /g,'_');let _0x190b82,_0x27b6aa;if(MY_DOMAIN&&!LOCAL_DOMAIN)UPLOAD_DATA=_0x53e02b(0x24f)+UUID+'@'+CFIP+':'+CFPORT+_0x53e02b(0x1a9)+MY_DOMAIN+_0x53e02b(0x21a)+MY_DOMAIN+_0x53e02b(0x22f)+SETTINGS['XPATH']+_0x53e02b(0x250)+ISP+'-'+SUB_NAME;else{if(LOCAL_DOMAIN&&!MY_DOMAIN)UPLOAD_DATA=_0x53e02b(0x24f)+UUID+'@'+_0x190b82+_0x53e02b(0x297)+_0x190b82+_0x53e02b(0x21a)+_0x190b82+_0x53e02b(0x22f)+SETTINGS[_0x53e02b(0x22c)]+_0x53e02b(0x250)+ISP+'-'+SUB_NAME;else!MY_DOMAIN&&!LOCAL_DOMAIN&&(_0x4d5d98[_0x53e02b(0x1e8)](':')?_0x190b82='['+_0x4d5d98+']':_0x190b82=''+_0x4d5d98,UPLOAD_DATA='vless://'+UUID+'@'+_0x190b82+':'+PORT+_0x53e02b(0x239)+_0x190b82+_0x53e02b(0x21a)+_0x190b82+'&path='+SETTINGS[_0x53e02b(0x22c)]+_0x53e02b(0x250)+ISP+'-'+SUB_NAME);}return UPLOAD_DATA;}const server=http[_0x5ecddf(0x1d3)]((_0x294106,_0x4ab2c3)=>{const _0x524a84=_0x5ecddf,_0x272fd9={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x524a84(0x21f),'Cache-Control':_0x524a84(0x290),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x294106[_0x524a84(0x252)]==='/'){_0x4ab2c3[_0x524a84(0x1bc)](0xc8,{'Content-Type':_0x524a84(0x220)}),_0x4ab2c3[_0x524a84(0x280)]('Hello,\x20World\x0a');return;}if(_0x294106[_0x524a84(0x252)]==='/'+UUID){const _0x5aa5a3=''+UPLOAD_DATA,_0x14b43f=Buffer['from'](_0x5aa5a3)[_0x524a84(0x1b6)](_0x524a84(0x1cd));_0x4ab2c3[_0x524a84(0x1bc)](0xc8,{'Content-Type':_0x524a84(0x220)}),_0x4ab2c3[_0x524a84(0x280)](_0x14b43f+'\x0a');return;}const _0x255afd=_0x294106[_0x524a84(0x252)][_0x524a84(0x1db)](new RegExp(XPATH+_0x524a84(0x20a)));if(!_0x255afd){_0x4ab2c3['writeHead'](0x194),_0x4ab2c3[_0x524a84(0x280)]();return;}const _0xb27bc1=_0x255afd[0x1],_0x17d174=_0x255afd[0x2]?parseInt(_0x255afd[0x2]):null;if(_0x294106[_0x524a84(0x271)]===_0x524a84(0x1d1)&&!_0x17d174){_0x272fd9[_0x524a84(0x29c)]=_0x524a84(0x246),_0x272fd9[_0x524a84(0x27b)]=_0x524a84(0x1a5);let _0x3082f8=sessions[_0x524a84(0x206)](_0xb27bc1);!_0x3082f8&&(_0x3082f8=new Session(_0xb27bc1),sessions[_0x524a84(0x291)](_0xb27bc1,_0x3082f8),log(_0x524a84(0x238),_0x524a84(0x1ba)+_0xb27bc1));_0x3082f8[_0x524a84(0x1c9)]=!![];!_0x3082f8['startDownstream'](_0x4ab2c3,_0x272fd9)&&(log(_0x524a84(0x298),_0x524a84(0x195)+_0xb27bc1),!_0x4ab2c3[_0x524a84(0x26c)]&&(_0x4ab2c3[_0x524a84(0x1bc)](0x1f4),_0x4ab2c3[_0x524a84(0x280)]()),_0x3082f8[_0x524a84(0x1ed)](),sessions[_0x524a84(0x258)](_0xb27bc1));return;}if(_0x294106[_0x524a84(0x271)]==='POST'&&_0x17d174!==null){let _0x1b8b08=sessions[_0x524a84(0x206)](_0xb27bc1);!_0x1b8b08&&(_0x1b8b08=new Session(_0xb27bc1),sessions[_0x524a84(0x291)](_0xb27bc1,_0x1b8b08),log('info','Created\x20new\x20session\x20for\x20POST:\x20'+_0xb27bc1),setTimeout(()=>{const _0x59e272=_0x524a84,_0x587ce2=sessions[_0x59e272(0x206)](_0xb27bc1);_0x587ce2&&!_0x587ce2[_0x59e272(0x1c9)]&&(log(_0x59e272(0x24d),_0x59e272(0x19d)+_0xb27bc1+_0x59e272(0x28c)),_0x587ce2[_0x59e272(0x1ed)](),sessions[_0x59e272(0x258)](_0xb27bc1));},SETTINGS[_0x524a84(0x277)]));let _0x437128=[],_0x18b594=0x0,_0x396027=![];_0x294106['on']('data',_0x5b25a5=>{const _0x15e9d7=_0x524a84;_0x18b594+=_0x5b25a5[_0x15e9d7(0x279)];if(_0x18b594>SETTINGS['MAX_POST_SIZE']){!_0x396027&&(_0x4ab2c3['writeHead'](0x19d),_0x4ab2c3['end'](),_0x396027=!![]);return;}_0x437128['push'](_0x5b25a5);}),_0x294106['on'](_0x524a84(0x280),async()=>{const _0x3e0f77=_0x524a84;if(_0x396027)return;try{const _0x4b3819=Buffer[_0x3e0f77(0x222)](_0x437128);log('info',_0x3e0f77(0x2a1)+_0x17d174+_0x3e0f77(0x1ec)+_0x4b3819[_0x3e0f77(0x279)]),await _0x1b8b08[_0x3e0f77(0x273)](_0x17d174,_0x4b3819),!_0x396027&&(_0x4ab2c3[_0x3e0f77(0x1bc)](0xc8,_0x272fd9),_0x396027=!![]),_0x4ab2c3[_0x3e0f77(0x280)]();}catch(_0x222799){log('error',_0x3e0f77(0x20f)+_0x222799['message']),_0x1b8b08['cleanup'](),sessions['delete'](_0xb27bc1),!_0x396027&&(_0x4ab2c3[_0x3e0f77(0x1bc)](0x1f4),_0x396027=!![]),_0x4ab2c3['end']();}});return;}_0x4ab2c3[_0x524a84(0x1bc)](0x194),_0x4ab2c3[_0x524a84(0x280)]();});server['on'](_0x5ecddf(0x1f4),_0x4606ca=>{const _0x5aa185=_0x5ecddf;log(_0x5aa185(0x268),_0x5aa185(0x1c0)+(_0x4606ca[_0x5aa185(0x208)]||_0x5aa185(0x1de)));});function _0x5931(_0xfb4b79,_0x4d4278){const _0x3fdda5=_0x3fdd();return _0x5931=function(_0x593182,_0x2d4f63){_0x593182=_0x593182-0x194;let _0x299f10=_0x3fdda5[_0x593182];return _0x299f10;},_0x5931(_0xfb4b79,_0x4d4278);}function generatePadding(_0x32babc,_0x8b8221){const _0x313afe=_0x5ecddf,_0x27e1a8=_0x32babc+Math[_0x313afe(0x1af)](Math[_0x313afe(0x20c)]()*(_0x8b8221-_0x32babc));return Buffer['from'](Array(_0x27e1a8)[_0x313afe(0x1d9)]('X')['join'](''))[_0x313afe(0x1b6)](_0x313afe(0x1cd));}server[_0x5ecddf(0x29f)]=0x975e0,server[_0x5ecddf(0x194)]=0x98968,server['on'](_0x5ecddf(0x298),_0x3de856=>{const _0x1cf344=_0x5ecddf;log(_0x1cf344(0x298),_0x1cf344(0x1cf)+_0x3de856['message']);});async function uploadSubscription(_0x1b9a3f,_0xd968e1,_0x301916){const _0x4ec6cb=_0x5ecddf,_0x43bd38=JSON[_0x4ec6cb(0x24b)]({'URL_NAME':_0x1b9a3f,'URL':_0xd968e1}),_0x4ac656=Buffer['from'](_0x43bd38,_0x4ec6cb(0x287)),_0x5a0b16=_0x4ac656['length'],_0x25b086=new URL(_0x301916),_0x18c4cd={'hostname':_0x25b086['hostname'],'port':_0x25b086[_0x4ec6cb(0x25e)]||0x1bb,'path':_0x25b086[_0x4ec6cb(0x1b5)],'method':_0x4ec6cb(0x2a7),'headers':{'Content-Type':'application/json;\x20charset=utf-8','Content-Length':_0x5a0b16}};try{const _0x32f731=await new Promise((_0x2dfb8b,_0x25dd1d)=>{const _0x16eca8=_0x4ec6cb,_0x5661d8=https[_0x16eca8(0x253)](_0x18c4cd,_0xac3170=>{const _0x361502=_0x16eca8;if(_0xac3170[_0x361502(0x294)]<0xc8||_0xac3170[_0x361502(0x294)]>=0x12c)return _0x25dd1d(new Error(_0x361502(0x286)+_0xac3170[_0x361502(0x294)]+_0x361502(0x1a2)+_0xac3170[_0x361502(0x1f2)]));let _0x4b5bd6='';_0xac3170['on'](_0x361502(0x264),_0x37681e=>_0x4b5bd6+=_0x37681e),_0xac3170['on'](_0x361502(0x280),()=>_0x2dfb8b(_0x4b5bd6));});_0x5661d8['on'](_0x16eca8(0x298),_0x24c14d=>_0x25dd1d(_0x24c14d)),_0x5661d8[_0x16eca8(0x1e2)](_0x4ac656),_0x5661d8[_0x16eca8(0x280)]();});return _0x32f731;}catch(_0x1b9955){console[_0x4ec6cb(0x298)]('Upload\x20failed:',_0x1b9955[_0x4ec6cb(0x2aa)]);}}function cleanfiles(){setTimeout(()=>{const _0x523c37=_0x5931;let _0x55a019;KEEPALIVE?_0x55a019=[]:_0x55a019=[FILE_PATH+'/'+fileMapping['app'],FILE_PATH+_0x523c37(0x28d)],_0x55a019['forEach'](_0x28b370=>{const _0x48f9e1=_0x523c37;try{fs[_0x48f9e1(0x288)](_0x28b370)&&(fs[_0x48f9e1(0x24c)](_0x28b370)[_0x48f9e1(0x296)]()?fs[_0x48f9e1(0x23d)](_0x28b370,{'recursive':!![]}):fs[_0x48f9e1(0x230)](_0x28b370));}catch(_0x1eb8d6){}}),console['clear'](),console[_0x523c37(0x1c5)](_0x523c37(0x281));},0xea60);}server['listen'](PORT,async()=>{const _0x141adf=_0x5ecddf;await generateLinks(),createFolder(FILE_PATH);NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&(await downloadFiles(),await delay(0x1388));await run(),cleanfiles(),console[_0x141adf(0x1c5)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);if(SUB_URL)try{const _0x549938=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0x2b8821){console[_0x141adf(0x298)](_0x141adf(0x209),_0x2b8821);}KEEPALIVE&&(await keep_alive(),setInterval(keep_alive,intervalInseconds*0x3e8));});