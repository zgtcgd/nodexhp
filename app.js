function _0x574c(){const _0x3de7f7=['[detectProcess]\x20','fileUrl','end','substr',']\x20[','chmodSync','message','\x20-s\x20','38123664wyqYVT','\x22\x20\x27$2\x20==\x20name\x20{print\x20$1}\x27','set','pgrep\x20-x\x20\x22','currentStreamRes','amd','Failed\x20to\x20write\x20to\x20remote:\x20','183386akGUvy','Transform','clear',',\x20size=','\x20-p\x20','Processed\x20packet\x20seq=','\x20error:','getReader','pgrep','Sending\x20VLESS\x20response\x20header\x20(','Cleanup\x20error:\x20','arm','writable','404619JlTaDm','pidof\x20\x22','cleaned','asOrganization','pipeTo','Remote\x20connection\x20established','alpnProtocol','createWriteStream','method','none','filePath','toString','toISOString','Failed\x20to\x20process\x20POST\x20request:\x20',',\x20response:\x20','MY_DOMAIN','slice','from','pause','\x20timed\x20out\x20without\x20downstream','/meta','nohup\x20','TIME','Connected\x20to\x20','Remote\x20connection\x20not\x20available','pidof','name','destroy','read\x20vless\x20header\x20error:\x20','exec','6XIRrQo','setNoDelay','28QMwatR','GET,\x20POST','lastActivity','app\x20file\x20not\x20found,\x20skip\x20running','net','aarch64','UUID','getWriter','random','uuid','BUFFER_SIZE','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','rmSync','pendingBuffers','Processing\x20packet:\x20seq=','Relay\x20error:','replace','CFPORT','Created\x20new\x20session\x20for\x20GET:\x20','Too\x20many\x20buffered\x20packets','\x1b[33m','Server\x20error:\x20','forEach','HTTP\x20error!\x20status:\x20','CHUNK_SIZE','Failed\x20to\x20initialize\x20VLESS\x20connection','delete','NEZHA_KEY','reset','https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','releaseLock','utf8','true','uncork','Server\x20is\x20running\x20on\x20port\x20','keepAliveTimeout','writeFileSync','Upload\x20error:\x20','CFIP','765nJWLDV','104584ZRRzhG','fill','\x1b[31m','close','Kill\x20failed:\x20','VLESS\x20header\x20parsed\x20successfully','HTTPSTLS','&path=','Hello,\x20World\x0a','resume','decode','includes','FILE_PATH','timeout','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','ip.sb','SESSION_TIMEOUT','resp','join','http','originalName','size','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','Failed\x20to\x20initialize\x20VLESS:\x20','--tls','/tmp','Remote\x20error:\x20','TCP_KEEPALIVE','Error\x20downloading\x20files:','NEZHA_SERVER','all','\x1b[32m','Download\x20error:\x20','\x20bytes','base64','socket','\x20-c\x20','finally','createConnection','Created\x20new\x20session\x20with\x20UUID:\x20','push','Transfer-Encoding','hostname','Process\x20not\x20found','New\x20secure\x20connection\x20using:\x20','http/1.1','bufferedData','writeHead','NEZHA_PORT','KEEPALIVE','Process\x20\x27','stderr','isDirectory','code','done','responseHeader','POST','MAX_BUFFERED_POSTS','header\x20length\x20too\x20short','fileName','/config.yml\x20>/dev/null\x202>&1\x20&','/config.yml','\x20running\x20error:\x20','catch','listen','headerSent','remote','263460eycWkj','Connection\x20failed:\x20','socket\x20hang\x20up','env','cork','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','Buffered\x20packet\x20seq=','connect\x20timeout','Client\x20connection\x20closed','Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture','charAt','headersTimeout','Upload\x20failed:','application/json;\x20charset=utf-8','get','unlinkSync','not\x20enough\x20data\x20to\x20read','1662018gRhTwF','pipe','3861224geTmuX','\x20--report-delay=4\x20--skip-conn\x20--skip-procs\x20--disable-auto-update\x20>/dev/null\x202>&1\x20&','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','2096','data','vlessHeader','lstatSync','_writeToRemote','log','error','kill\x20-9\x20','SUB_NAME','Process\x20packet\x20error:\x20','\x1b[36m','Node\x20variable\x20is\x20empty,\x20skip\x20running','country','stream','reading_done','Error\x20starting\x20downstream:\x20','https://github.com/kahunama/myfile/releases/download/main/nezha-agent','cleanup','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1','replaceAll','downstreamStarted','writableEnded','initializeVLESS','info','success','374CPgNkx','concat','&fp=chrome&allowInsecure=1&type=xhttp&host=','Failed\x20to\x20parse\x20hostname','Received\x20out\x20of\x20order\x20packet\x20seq=','trim','write','2087','app','match','aborted','MAX_POST_SIZE','443','map','headersSent','&mode=packet-up#','nextSeq','TCP_NODELAY','8443','readable','port','tmp','application/octet-stream','7160b696-dd5e-42e3-a024-145e92cec916','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','child_process','GET','Socket\x20is\x20destroyed','Attempting\x20to\x20kill\x20process:\x20','request','path','statusMessage','initialized','destroyed','speed.cloudflare.com','warn','XPATH','VLESS\x20header\x20parse\x20error:\x20','setKeepAlive','2083','upload\x20failed:','nextTick','https','Killed\x20process\x20(PIDs:\x20','Session\x20','enqueue','_startDownstreamResponse','statusCode','\x27\x20not\x20found','\x1b[0m','length','debug','no-store','5ZgftJp','text/plain','\x20before\x20initialization','LOG_LEVEL','startDownstream','buffer','now','Socket\x20error:','value','secureConnection','?encryption=none&security=tls&sni=','floor'];_0x574c=function(){return _0x3de7f7;};return _0x574c();}const _0x49dc87=_0x46f4;(function(_0x5621df,_0xb51818){const _0x5addb0=_0x46f4,_0x991aaf=_0x5621df();while(!![]){try{const _0x3393ec=parseInt(_0x5addb0(0x1b7))/0x1+-parseInt(_0x5addb0(0xcb))/0x2*(parseInt(_0x5addb0(0x1c4))/0x3)+parseInt(_0x5addb0(0x14b))/0x4*(-parseInt(_0x5addb0(0x19c))/0x5)+parseInt(_0x5addb0(0x149))/0x6*(-parseInt(_0x5addb0(0xcd))/0x7)+-parseInt(_0x5addb0(0xf5))/0x8*(parseInt(_0x5addb0(0xf4))/0x9)+parseInt(_0x5addb0(0x138))/0xa*(parseInt(_0x5addb0(0x167))/0xb)+parseInt(_0x5addb0(0x1b0))/0xc;if(_0x3393ec===_0xb51818)break;else _0x991aaf['push'](_0x991aaf['shift']());}catch(_0x166bcb){_0x991aaf['push'](_0x991aaf['shift']());}}}(_0x574c,0xa2d64));const FILE_PATH=process[_0x49dc87(0x13b)][_0x49dc87(0x101)]||_0x49dc87(0x10e),intervalInseconds=process[_0x49dc87(0x13b)][_0x49dc87(0xc3)]||0x64,PORT=process[_0x49dc87(0x13b)]['PORT']||0xbb8,CFPORT=process['env'][_0x49dc87(0xde)]||0x1bb,CFIP=process[_0x49dc87(0x13b)][_0x49dc87(0xf3)]||_0x49dc87(0x104),KEEPALIVE=process[_0x49dc87(0x13b)][_0x49dc87(0x126)]==='true',SUB_URL=process['env']['SUB_URL']||'',UUID=process[_0x49dc87(0x13b)][_0x49dc87(0xd3)]||_0x49dc87(0x17e),XPATH=process[_0x49dc87(0x13b)]['XPATH']||UUID['slice'](0x0,0x8),HTTPSTLS=process['env'][_0x49dc87(0xfb)]===_0x49dc87(0xed),NEZHA_VERSION=process['env']['NEZHA_VERSION']||'V0',NEZHA_SERVER=process[_0x49dc87(0x13b)][_0x49dc87(0x112)]||'',NEZHA_PORT=process['env'][_0x49dc87(0x125)]||'443',NEZHA_KEY=process[_0x49dc87(0x13b)][_0x49dc87(0xe8)]||'',SUB_NAME=process['env'][_0x49dc87(0x156)]||'',MY_DOMAIN=process[_0x49dc87(0x13b)][_0x49dc87(0x1d3)]||'',LOCAL_DOMAIN=process['env']['LOCAL_DOMAIN']||'',os=require('os'),fs=require('fs'),net=require(_0x49dc87(0xd1)),path=require(_0x49dc87(0x185)),http=require(_0x49dc87(0x108)),https=require(_0x49dc87(0x191)),axios=require('axios'),{pipeline}=require('stream/promises'),{Buffer}=require(_0x49dc87(0x1a1)),exec=require(_0x49dc87(0x180))[_0x49dc87(0xca)],delay=_0x59209c=>new Promise(_0x42009e=>setTimeout(_0x42009e,_0x59209c)),SETTINGS={[_0x49dc87(0xd3)]:UUID,[_0x49dc87(0x19f)]:_0x49dc87(0x1cd),[_0x49dc87(0xd7)]:'2048',[_0x49dc87(0x18b)]:'%2F'+XPATH,[_0x49dc87(0x12e)]:0x1e,[_0x49dc87(0x172)]:0xf4240,[_0x49dc87(0x105)]:0x7530,['CHUNK_SIZE']:0x400*0x400,[_0x49dc87(0x178)]:!![],[_0x49dc87(0x110)]:!![]};function validate_uuid(_0x27f0af,_0x4cf1b0){for(let _0xe684bc=0x0;_0xe684bc<0x10;_0xe684bc++){if(_0x27f0af[_0xe684bc]!==_0x4cf1b0[_0xe684bc])return![];}return!![];}function concat_typed_arrays(_0xdc7c44,..._0x67f535){const _0x209259=_0x49dc87;if(!_0x67f535||_0x67f535['length']<0x1)return _0xdc7c44;let _0x4da108=_0xdc7c44[_0x209259(0x199)];for(let _0x22178e of _0x67f535)_0x4da108+=_0x22178e[_0x209259(0x199)];const _0x52d251=new _0xdc7c44['constructor'](_0x4da108);_0x52d251[_0x209259(0x1b2)](_0xdc7c44,0x0),_0x4da108=_0xdc7c44[_0x209259(0x199)];for(let _0x2732d1 of _0x67f535){_0x52d251[_0x209259(0x1b2)](_0x2732d1,_0x4da108),_0x4da108+=_0x2732d1[_0x209259(0x199)];}return _0x52d251;}function log(_0x294b3c,..._0x49e3cb){const _0x43e6c3=_0x49dc87;if(SETTINGS['LOG_LEVEL']==='none')return;const _0x1815f1={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x3f9107={'debug':_0x43e6c3(0x158),'info':_0x43e6c3(0x114),'warn':_0x43e6c3(0xe1),'error':_0x43e6c3(0xf7),'reset':_0x43e6c3(0x198)},_0x317983=_0x1815f1[SETTINGS[_0x43e6c3(0x19f)]]||0x1,_0x2b5888=_0x1815f1[_0x294b3c]||0x0;if(_0x2b5888>=_0x317983){const _0x294941=new Date()[_0x43e6c3(0x1d0)](),_0x322eba=_0x3f9107[_0x294b3c]||_0x3f9107[_0x43e6c3(0xe9)];console[_0x43e6c3(0x153)](_0x322eba+'['+_0x294941+_0x43e6c3(0x1ac)+_0x294b3c+']',..._0x49e3cb,_0x3f9107['reset']);}}function execPromise(_0x53ec39,_0x3d87d0={}){return new Promise((_0x3b1e89,_0x4c89e8)=>{const _0x3db3cf=exec(_0x53ec39,_0x3d87d0,(_0x4cd3d0,_0x2be8cc,_0x125252)=>{const _0x37d17a=_0x46f4;if(_0x4cd3d0){const _0x587128=new Error('Command\x20failed:\x20'+_0x4cd3d0[_0x37d17a(0x1ae)]);_0x587128['code']=_0x4cd3d0['code'],_0x587128[_0x37d17a(0x128)]=_0x125252[_0x37d17a(0x16c)](),_0x4c89e8(_0x587128);}else _0x3b1e89(_0x2be8cc[_0x37d17a(0x16c)]());});});}async function detectProcess(_0x1f7585){const _0x5c27ed=_0x49dc87,_0x4fc753=[{'cmd':_0x5c27ed(0x1c5)+_0x1f7585+'\x22','name':_0x5c27ed(0xc6)},{'cmd':_0x5c27ed(0x1b3)+_0x1f7585+'\x22','name':_0x5c27ed(0x1bf)},{'cmd':'ps\x20-eo\x20pid,comm\x20|\x20awk\x20-v\x20name=\x22'+_0x1f7585+_0x5c27ed(0x1b1),'name':'ps+awk'}];for(const _0x2cfa9c of _0x4fc753){try{const _0x47004b=await execPromise(_0x2cfa9c['cmd']);if(_0x47004b)return _0x47004b[_0x5c27ed(0xdd)](/\n/g,'\x20')[_0x5c27ed(0x16c)]();}catch(_0x24ef95){_0x24ef95[_0x5c27ed(0x12a)]!==0x7f&&_0x24ef95[_0x5c27ed(0x12a)]!==0x1&&console['debug'](_0x5c27ed(0x1a8)+_0x2cfa9c[_0x5c27ed(0xc7)]+_0x5c27ed(0x1bd),_0x24ef95[_0x5c27ed(0x1ae)]);}}return'';}async function killProcess(_0x2a2d24){const _0x258b8e=_0x49dc87;console[_0x258b8e(0x153)](_0x258b8e(0x183)+_0x2a2d24);try{const _0x24184a=await detectProcess(_0x2a2d24);if(!_0x24184a)return console[_0x258b8e(0x18a)](_0x258b8e(0x127)+_0x2a2d24+_0x258b8e(0x197)),{'success':!![],'message':_0x258b8e(0x120)};await execPromise(_0x258b8e(0x155)+_0x24184a);const _0x37ada8=_0x258b8e(0x192)+_0x24184a+')';return console[_0x258b8e(0x153)](_0x37ada8),{'success':!![],'message':_0x37ada8};}catch(_0x10dbe4){const _0x2b12ae=_0x258b8e(0xf9)+_0x10dbe4['message'];return console[_0x258b8e(0x154)](_0x2b12ae),{'success':![],'message':_0x2b12ae};}}function generateRandomString(_0x237db1){const _0x385401=_0x49dc87,_0x25fc71=_0x385401(0x13d);let _0x300bea='';for(let _0x305959=0x0;_0x305959<_0x237db1;_0x305959++){_0x300bea+=_0x25fc71[_0x385401(0x142)](Math[_0x385401(0x1a7)](Math[_0x385401(0xd5)]()*_0x25fc71[_0x385401(0x199)]));}return _0x300bea;}function getSystemArchitecture(){const _0x874e07=_0x49dc87,_0x18ddfa=os['arch']();return _0x18ddfa===_0x874e07(0x1c2)||_0x18ddfa==='arm64'||_0x18ddfa===_0x874e07(0xd2)?_0x874e07(0x1c2):_0x874e07(0x1b5);}function getFilesForArchitecture(_0x566708){const _0xeddb2b=_0x49dc87,_0x470a2f={'app':{'V0':{'arm':_0xeddb2b(0xea),'amd':_0xeddb2b(0x15e)},'V1':{'arm':_0xeddb2b(0x17f),'amd':_0xeddb2b(0x160)}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0x47a749=[{'fileName':_0xeddb2b(0x17c)+generateRandomString(0x5),'originalName':_0xeddb2b(0x16f),'fileUrl':_0x470a2f[_0xeddb2b(0x16f)][NEZHA_VERSION][_0x566708]}];return _0x47a749;}else return[];}async function download_function(_0x35be6c,_0x583ace,_0x33df0e){const _0x12b0b2=_0x49dc87,_0x2a5215=path[_0x12b0b2(0x107)](FILE_PATH,_0x35be6c);let _0x3fd456=![];try{const _0x1b1ad7=await axios({'method':_0x12b0b2(0x146),'url':_0x33df0e,'responseType':'stream'});await pipeline(_0x1b1ad7[_0x12b0b2(0x14f)],fs[_0x12b0b2(0x1cb)](_0x2a5215)),_0x3fd456=!![];}catch(_0x111eba){}return{'fileName':_0x35be6c,'originalName':_0x583ace,'filePath':_0x2a5215,'success':_0x3fd456};}let fileMapping={};async function downloadFiles(){const _0x20e2d3=_0x49dc87;try{const _0x1fbf73=getSystemArchitecture();if(!_0x1fbf73)return console[_0x20e2d3(0x153)]('Can\x27t\x20determine\x20system\x20architecture.'),fileMapping;const _0x244e91=getFilesForArchitecture(_0x1fbf73);if(_0x244e91[_0x20e2d3(0x199)]===0x0)return console[_0x20e2d3(0x153)](_0x20e2d3(0x141)),fileMapping;const _0x3dc365=_0x244e91[_0x20e2d3(0x174)](_0x47cc64=>download_function(_0x47cc64['fileName'],_0x47cc64['originalName'],_0x47cc64[_0x20e2d3(0x1a9)])),_0x16ec44=await Promise[_0x20e2d3(0x113)](_0x3dc365);return _0x16ec44[_0x20e2d3(0xe3)](_0x2f1a22=>{const _0x88dec2=_0x20e2d3;if(_0x2f1a22[_0x88dec2(0x166)])try{fs[_0x88dec2(0x1ad)](_0x2f1a22[_0x88dec2(0x1ce)],0x1ed),fileMapping[_0x2f1a22[_0x88dec2(0x109)]]=_0x2f1a22[_0x88dec2(0x130)];}catch(_0x481a9f){}}),fileMapping;}catch(_0x4f4f86){return console[_0x20e2d3(0x154)](_0x20e2d3(0x111),_0x4f4f86),fileMapping;}}let NEZHA_TLS;function nezconfig(){const _0x2b9c55=_0x49dc87,_0x2e58d1=[_0x2b9c55(0x173),_0x2b9c55(0x179),_0x2b9c55(0x14e),_0x2b9c55(0x16e),_0x2b9c55(0x18e),'2053'];if(NEZHA_VERSION==='V0')return _0x2e58d1[_0x2b9c55(0x100)](NEZHA_PORT)?NEZHA_TLS=_0x2b9c55(0x10d):NEZHA_TLS='',NEZHA_TLS;else{if(NEZHA_VERSION==='V1'){_0x2e58d1[_0x2b9c55(0x100)](NEZHA_PORT)?NEZHA_TLS=_0x2b9c55(0xed):NEZHA_TLS='false';const _0x5a1882=path['join'](FILE_PATH,_0x2b9c55(0x132)),_0x42550c='client_secret:\x20'+NEZHA_KEY+_0x2b9c55(0xd8)+NEZHA_SERVER+':'+NEZHA_PORT+'\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20'+NEZHA_TLS+_0x2b9c55(0x10b)+UUID;try{fs[_0x2b9c55(0xf1)](_0x5a1882,_0x42550c);}catch(_0x3de934){}}}}function _0x46f4(_0x2c0d19,_0x206869){const _0x574c62=_0x574c();return _0x46f4=function(_0x46f4c9,_0x1946f3){_0x46f4c9=_0x46f4c9-0xbd;let _0x2547c0=_0x574c62[_0x46f4c9];return _0x2547c0;},_0x46f4(_0x2c0d19,_0x206869);}async function runapp(){const _0x4aef33=_0x49dc87;if(fileMapping['app']&&fs['existsSync'](path[_0x4aef33(0x107)](FILE_PATH,fileMapping[_0x4aef33(0x16f)]))){if(NEZHA_VERSION==='V0'){const _0x1608e9='nohup\x20'+FILE_PATH+'/'+fileMapping[_0x4aef33(0x16f)]+_0x4aef33(0x1af)+NEZHA_SERVER+':'+NEZHA_PORT+_0x4aef33(0x1bb)+NEZHA_KEY+'\x20'+NEZHA_TLS+_0x4aef33(0x14c);try{await execPromise(_0x1608e9);}catch(_0x39cc94){console['error'](fileMapping[_0x4aef33(0x16f)]+_0x4aef33(0x133)+_0x39cc94);}}else{if(NEZHA_VERSION==='V1'){const _0x80cf3f=_0x4aef33(0xc2)+FILE_PATH+'/'+fileMapping['app']+_0x4aef33(0x119)+FILE_PATH+_0x4aef33(0x131);try{await execPromise(_0x80cf3f);}catch(_0xd09255){console[_0x4aef33(0x154)](fileMapping[_0x4aef33(0x16f)]+_0x4aef33(0x133)+_0xd09255);}}}}else console[_0x4aef33(0x153)](_0x4aef33(0xd0));}async function run(){const _0x54be80=_0x49dc87;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){nezconfig();const _0x30c613=await detectProcess(''+fileMapping[_0x54be80(0x16f)]);if(_0x30c613){}else await runapp();await delay(0x3e8);}else console[_0x54be80(0x153)](_0x54be80(0x159));}async function keep_alive(){const _0x2dc5a2=_0x49dc87;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x1203d1=await detectProcess(''+fileMapping[_0x2dc5a2(0x16f)]);if(_0x1203d1){}else await runapp();}}function parse_uuid(_0x533b47){const _0x581130=_0x49dc87;_0x533b47=_0x533b47[_0x581130(0x161)]('-','');const _0x26df0c=[];for(let _0x249b18=0x0;_0x249b18<0x10;_0x249b18++){_0x26df0c[_0x581130(0x11d)](parseInt(_0x533b47[_0x581130(0x1ab)](_0x249b18*0x2,0x2),0x10));}return _0x26df0c;}async function read_vless_header(_0x2d90ad,_0x33e981){const _0x1b0796=_0x49dc87;let _0x317969=0x0,_0x138f19=new Uint8Array(),_0x2674a4={'value':_0x138f19,'done':![]};async function _0x5cdcc1(_0x13852f){const _0x22db5c=_0x46f4;if(_0x2674a4[_0x22db5c(0x12b)])throw new Error(_0x22db5c(0x12f));const _0x5720f1=_0x13852f-_0x317969;if(_0x5720f1<0x1)return;_0x2674a4=await read_atleast(_0x2d90ad,_0x5720f1),_0x317969+=_0x2674a4[_0x22db5c(0x1a4)][_0x22db5c(0x199)],_0x138f19=concat_typed_arrays(_0x138f19,_0x2674a4[_0x22db5c(0x1a4)]);}await _0x5cdcc1(0x1+0x10+0x1);const _0x5026cb=_0x138f19[0x0],_0xef2dc=_0x138f19[_0x1b0796(0xbd)](0x1,0x1+0x10),_0x1a8f8e=parse_uuid(_0x33e981);if(!validate_uuid(_0xef2dc,_0x1a8f8e))throw new Error('invalid\x20UUID');const _0xc89af6=_0x138f19[0x1+0x10],_0x18406e=0x1+0x10+0x1+_0xc89af6+0x1+0x2+0x1;await _0x5cdcc1(_0x18406e+0x1);const _0x10ad8d=_0x138f19[0x1+0x10+0x1+_0xc89af6],_0x3ce11e=0x1;if(_0x10ad8d!==_0x3ce11e)throw new Error('unsupported\x20command:\x20'+_0x10ad8d);const _0x2888e7=(_0x138f19[_0x18406e-0x1-0x2]<<0x8)+_0x138f19[_0x18406e-0x1-0x1],_0x240533=_0x138f19[_0x18406e-0x1],_0x5f2c22=0x1,_0x273263=0x2,_0x5c39b6=0x3;let _0x3f0352=-0x1;if(_0x240533===_0x5f2c22)_0x3f0352=_0x18406e+0x4;else{if(_0x240533===_0x5c39b6)_0x3f0352=_0x18406e+0x10;else _0x240533===_0x273263&&(_0x3f0352=_0x18406e+0x1+_0x138f19[_0x18406e]);}if(_0x3f0352<0x0)throw new Error('read\x20address\x20type\x20failed');await _0x5cdcc1(_0x3f0352);const _0x1fc850=_0x18406e;let _0x2031c1='';if(_0x240533===_0x5f2c22)_0x2031c1=_0x138f19[_0x1b0796(0xbd)](_0x1fc850,_0x1fc850+0x4)[_0x1b0796(0x107)]('.');else{if(_0x240533===_0x273263)_0x2031c1=new TextDecoder()[_0x1b0796(0xff)](_0x138f19[_0x1b0796(0xbd)](_0x1fc850+0x1,_0x1fc850+0x1+_0x138f19[_0x1fc850]));else _0x240533===_0x5c39b6&&(_0x2031c1=_0x138f19['slice'](_0x1fc850,_0x1fc850+0x10)['reduce']((_0x4e25d2,_0x5897be,_0x21394a,_0x1fb75a)=>_0x21394a%0x2?_0x4e25d2[_0x1b0796(0x168)](((_0x1fb75a[_0x21394a-0x1]<<0x8)+_0x5897be)[_0x1b0796(0x1cf)](0x10)):_0x4e25d2,[])['join'](':'));}if(!_0x2031c1){log('error',_0x1b0796(0x16a));throw new Error('parse\x20hostname\x20failed');}return log('info','VLESS\x20connection\x20to\x20'+_0x2031c1+':'+_0x2888e7),{'hostname':_0x2031c1,'port':_0x2888e7,'data':_0x138f19[_0x1b0796(0xbd)](_0x3f0352),'resp':new Uint8Array([_0x5026cb,0x0])};}async function read_atleast(_0x830536,_0x28492a){const _0x50f486=_0x49dc87,_0x598713=[];let _0xb1e0d8=![];while(_0x28492a>0x0&&!_0xb1e0d8){const _0x48b312=await _0x830536['read']();if(_0x48b312[_0x50f486(0x1a4)]){const _0x2a1205=new Uint8Array(_0x48b312[_0x50f486(0x1a4)]);_0x598713[_0x50f486(0x11d)](_0x2a1205),_0x28492a-=_0x2a1205['length'];}_0xb1e0d8=_0x48b312[_0x50f486(0x12b)];}if(_0x28492a>0x0)throw new Error(_0x50f486(0x148));return{'value':concat_typed_arrays(..._0x598713),'done':_0xb1e0d8};}async function parse_header(_0x200dfd,_0x47a9b7){const _0x4ce38c=_0x49dc87;log(_0x4ce38c(0x19a),'Starting\x20to\x20parse\x20VLESS\x20header');const _0x4e0cae=_0x47a9b7[_0x4ce38c(0x17a)][_0x4ce38c(0x1be)]();try{const _0x3d8a03=await read_vless_header(_0x4e0cae,_0x200dfd);return log(_0x4ce38c(0x19a),_0x4ce38c(0xfa)),_0x3d8a03;}catch(_0x3f4ffa){log(_0x4ce38c(0x154),_0x4ce38c(0x18c)+_0x3f4ffa['message']);throw new Error(_0x4ce38c(0xc9)+_0x3f4ffa['message']);}finally{_0x4e0cae[_0x4ce38c(0xeb)]();}}async function connect_remote(_0x134bf2,_0x402ab0){const _0x112e74=_0x49dc87,_0x1a7791=0x1f40;try{const _0x363d74=await timed_connect(_0x134bf2,_0x402ab0,_0x1a7791);return _0x363d74[_0x112e74(0xcc)](!![]),_0x363d74[_0x112e74(0x18d)](!![],0x3e8),_0x363d74['bufferSize']=parseInt(SETTINGS['BUFFER_SIZE'])*0x400,log('info',_0x112e74(0xc4)+_0x134bf2+':'+_0x402ab0),_0x363d74;}catch(_0x454320){log(_0x112e74(0x154),_0x112e74(0x139)+_0x454320[_0x112e74(0x1ae)]);throw _0x454320;}}function timed_connect(_0x52a8f0,_0x539bf7,_0x135e53){return new Promise((_0x47b3c6,_0x521df1)=>{const _0x118d17=_0x46f4,_0x1b8972=net[_0x118d17(0x11b)]({'host':_0x52a8f0,'port':_0x539bf7}),_0x4c1016=setTimeout(()=>{const _0x43c86e=_0x118d17;_0x521df1(new Error(_0x43c86e(0x13f)));},_0x135e53);_0x1b8972['on']('connect',()=>{clearTimeout(_0x4c1016),_0x47b3c6(_0x1b8972);}),_0x1b8972['on'](_0x118d17(0x154),_0x4be0ff=>{clearTimeout(_0x4c1016),_0x521df1(_0x4be0ff);});});}function pipe_relay(){async function _0x13bcb0(_0x2adec8,_0x4ff03a,_0x3c7743){const _0x566f7e=_0x46f4,_0x47d319=parseInt(SETTINGS[_0x566f7e(0xe5)]);if(_0x3c7743[_0x566f7e(0x199)]>0x0){if(_0x4ff03a[_0x566f7e(0x16d)])_0x4ff03a[_0x566f7e(0x13c)](),_0x4ff03a[_0x566f7e(0x16d)](_0x3c7743),process[_0x566f7e(0x190)](()=>_0x4ff03a[_0x566f7e(0xee)]());else{const _0x3f40d0=_0x4ff03a[_0x566f7e(0x1c3)][_0x566f7e(0xd4)]();try{await _0x3f40d0[_0x566f7e(0x16d)](_0x3c7743);}finally{_0x3f40d0[_0x566f7e(0xeb)]();}}}try{_0x2adec8['pipe']?(_0x2adec8[_0x566f7e(0xbf)](),_0x2adec8['pipe'](_0x4ff03a,{'end':!![],'highWaterMark':_0x47d319}),_0x2adec8[_0x566f7e(0xfe)]()):await _0x2adec8[_0x566f7e(0x17a)][_0x566f7e(0x1c8)](_0x4ff03a[_0x566f7e(0x1c3)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x566f7e(0x102)](SETTINGS[_0x566f7e(0x105)])});}catch(_0x4effdc){!_0x4effdc[_0x566f7e(0x1ae)][_0x566f7e(0x100)]('aborted')&&log(_0x566f7e(0x154),_0x566f7e(0xdc),_0x4effdc[_0x566f7e(0x1ae)]);throw _0x4effdc;}}return _0x13bcb0;}function socketToWebStream(_0x29432f){const _0x3e6bb0=_0x49dc87;let _0x46ac81,_0x58dba6;return _0x29432f['on'](_0x3e6bb0(0x154),_0x2ff929=>{const _0x5d008b=_0x3e6bb0;log(_0x5d008b(0x154),_0x5d008b(0x1a3),_0x2ff929['message']),_0x46ac81?.[_0x5d008b(0x154)](_0x2ff929),_0x58dba6?.[_0x5d008b(0x154)](_0x2ff929);}),{'readable':new ReadableStream({'start'(_0x4bdd7d){const _0x53fb8e=_0x3e6bb0;_0x46ac81=_0x4bdd7d,_0x29432f['on'](_0x53fb8e(0x14f),_0x5db682=>{const _0x42dec3=_0x53fb8e;try{_0x4bdd7d[_0x42dec3(0x194)](_0x5db682);}catch(_0x41a14a){log('error','Read\x20controller\x20error:',_0x41a14a[_0x42dec3(0x1ae)]);}}),_0x29432f['on'](_0x53fb8e(0x1aa),()=>{const _0x243ca9=_0x53fb8e;try{_0x4bdd7d[_0x243ca9(0xf8)]();}catch(_0x454755){log(_0x243ca9(0x154),'Read\x20controller\x20close\x20error:',_0x454755[_0x243ca9(0x1ae)]);}});},'cancel'(){const _0x6d7b3b=_0x3e6bb0;_0x29432f[_0x6d7b3b(0xc8)]();}}),'writable':new WritableStream({'start'(_0x57874e){_0x58dba6=_0x57874e;},'write'(_0x475663){return new Promise((_0x5dcf8f,_0xa01937)=>{const _0x1fd53b=_0x46f4;if(_0x29432f[_0x1fd53b(0x188)]){_0xa01937(new Error(_0x1fd53b(0x182)));return;}_0x29432f[_0x1fd53b(0x16d)](_0x475663,_0x37d67f=>{if(_0x37d67f)_0xa01937(_0x37d67f);else _0x5dcf8f();});});},'close'(){const _0x553bca=_0x3e6bb0;!_0x29432f[_0x553bca(0x188)]&&_0x29432f[_0x553bca(0x1aa)]();},'abort'(_0x153501){const _0x56aa22=_0x3e6bb0;_0x29432f[_0x56aa22(0xc8)](_0x153501);}})};}function relay(_0x16539c,_0x17ce86,_0x48bf5d,_0x702f3f){const _0x2233a6=_0x49dc87,_0x5759bb=pipe_relay();let _0x4ad1ea=![];const _0x5bb90d=socketToWebStream(_0x48bf5d);function _0x54c957(){const _0x406324=_0x46f4;if(!_0x4ad1ea){_0x4ad1ea=!![];try{_0x48bf5d[_0x406324(0xc8)]();}catch(_0x22d7cc){!_0x22d7cc[_0x406324(0x1ae)][_0x406324(0x100)](_0x406324(0x171))&&!_0x22d7cc[_0x406324(0x1ae)][_0x406324(0x100)](_0x406324(0x13a))&&log(_0x406324(0x154),_0x406324(0x1c1)+_0x22d7cc[_0x406324(0x1ae)]);}}}const _0x3be6e9=_0x5759bb(_0x17ce86,_0x5bb90d,_0x702f3f[_0x2233a6(0x14f)])[_0x2233a6(0x134)](_0x11c535=>{const _0x2d3467=_0x2233a6;!_0x11c535[_0x2d3467(0x1ae)][_0x2d3467(0x100)]('aborted')&&!_0x11c535[_0x2d3467(0x1ae)][_0x2d3467(0x100)](_0x2d3467(0x13a))&&log(_0x2d3467(0x154),_0x2d3467(0xf2)+_0x11c535[_0x2d3467(0x1ae)]);})['finally'](()=>{const _0x2fab67=_0x2233a6;_0x17ce86[_0x2fab67(0x15c)]&&_0x17ce86[_0x2fab67(0x15c)]();}),_0x4b47ae=_0x5759bb(_0x5bb90d,_0x17ce86,_0x702f3f['resp'])[_0x2233a6(0x134)](_0x577503=>{const _0x22d321=_0x2233a6;!_0x577503[_0x22d321(0x1ae)][_0x22d321(0x100)](_0x22d321(0x171))&&!_0x577503['message'][_0x22d321(0x100)](_0x22d321(0x13a))&&log(_0x22d321(0x154),_0x22d321(0x115)+_0x577503[_0x22d321(0x1ae)]);});_0x4b47ae['finally'](()=>_0x3be6e9)[_0x2233a6(0x11a)](_0x54c957);}const sessions=new Map();class Session{constructor(_0x13dda7){const _0x51e4ed=_0x49dc87;this[_0x51e4ed(0xd6)]=_0x13dda7,this[_0x51e4ed(0x177)]=0x0,this[_0x51e4ed(0x162)]=![],this[_0x51e4ed(0xcf)]=Date[_0x51e4ed(0x1a2)](),this[_0x51e4ed(0x150)]=null,this['remote']=null,this[_0x51e4ed(0x187)]=![],this[_0x51e4ed(0x12c)]=null,this[_0x51e4ed(0x136)]=![],this[_0x51e4ed(0x123)]=new Map(),this[_0x51e4ed(0x1c6)]=![],this['pendingPackets']=[],this[_0x51e4ed(0x1b4)]=null,this[_0x51e4ed(0xda)]=new Map(),log(_0x51e4ed(0x19a),_0x51e4ed(0x11c)+_0x13dda7);}async[_0x49dc87(0x164)](_0xdaa20d){const _0x506b25=_0x49dc87;if(this[_0x506b25(0x187)])return!![];try{log(_0x506b25(0x19a),_0x506b25(0x103));const _0x439468=new ReadableStream({'start'(_0x5ac259){const _0x2a86b4=_0x506b25;_0x5ac259[_0x2a86b4(0x194)](_0xdaa20d),_0x5ac259[_0x2a86b4(0xf8)]();}}),_0x5c7413={'readable':_0x439468,'writable':new WritableStream()};return this[_0x506b25(0x150)]=await parse_header(SETTINGS['UUID'],_0x5c7413),log(_0x506b25(0x165),'VLESS\x20header\x20parsed:\x20'+this[_0x506b25(0x150)][_0x506b25(0x11f)]+':'+this[_0x506b25(0x150)][_0x506b25(0x17b)]),this['remote']=await connect_remote(this['vlessHeader']['hostname'],this[_0x506b25(0x150)][_0x506b25(0x17b)]),log(_0x506b25(0x165),_0x506b25(0x1c9)),this['initialized']=!![],!![];}catch(_0x2da1b0){return log(_0x506b25(0x154),_0x506b25(0x10c)+_0x2da1b0['message']),![];}}async['processPacket'](_0x4cc356,_0x260387){const _0x1ee446=_0x49dc87;try{this[_0x1ee446(0xda)][_0x1ee446(0x1b2)](_0x4cc356,_0x260387),log(_0x1ee446(0x19a),_0x1ee446(0x13e)+_0x4cc356+_0x1ee446(0x1ba)+_0x260387[_0x1ee446(0x199)]);while(this[_0x1ee446(0xda)]['has'](this[_0x1ee446(0x177)])){const _0x59dbc2=this[_0x1ee446(0xda)][_0x1ee446(0x146)](this[_0x1ee446(0x177)]);this[_0x1ee446(0xda)][_0x1ee446(0xe7)](this[_0x1ee446(0x177)]);if(!this[_0x1ee446(0x187)]&&this[_0x1ee446(0x177)]===0x0){if(!await this[_0x1ee446(0x164)](_0x59dbc2))throw new Error(_0x1ee446(0xe6));this[_0x1ee446(0x12c)]=Buffer[_0x1ee446(0xbe)](this['vlessHeader'][_0x1ee446(0x106)]),await this['_writeToRemote'](this['vlessHeader'][_0x1ee446(0x14f)]),this[_0x1ee446(0x1b4)]&&this['_startDownstreamResponse']();}else{if(!this['initialized']){log('warn',_0x1ee446(0x16b)+_0x4cc356+_0x1ee446(0x19e));continue;}await this[_0x1ee446(0x152)](_0x59dbc2);}this['nextSeq']++,log('debug',_0x1ee446(0x1bc)+(this[_0x1ee446(0x177)]-0x1));}if(this[_0x1ee446(0xda)][_0x1ee446(0x10a)]>SETTINGS[_0x1ee446(0x12e)])throw new Error(_0x1ee446(0xe0));return!![];}catch(_0x571d2c){log(_0x1ee446(0x154),_0x1ee446(0x157)+_0x571d2c['message']);throw _0x571d2c;}}[_0x49dc87(0x195)](){const _0x6dac4b=_0x49dc87;if(!this[_0x6dac4b(0x1b4)]||!this[_0x6dac4b(0x12c)])return;try{const _0x56678b=this[_0x6dac4b(0x1b4)]['socket']?.['alpnProtocol']||'http/1.1',_0x1cdc78=_0x56678b==='h2';!this[_0x6dac4b(0x136)]&&(log('debug',_0x6dac4b(0x1c0)+_0x56678b+'):\x20'+this[_0x6dac4b(0x12c)]['length']+_0x6dac4b(0x116)),this[_0x6dac4b(0x1b4)][_0x6dac4b(0x16d)](this[_0x6dac4b(0x12c)]),this['headerSent']=!![]);if(_0x1cdc78){this[_0x6dac4b(0x1b4)][_0x6dac4b(0x118)][_0x6dac4b(0xcc)](!![]);const _0x11ab34=new require(_0x6dac4b(0x15b))[_0x6dac4b(0x1b8)]({'transform'(_0x10c56d,_0x23530d,_0x35a4ea){const _0x3cd0bb=_0x6dac4b,_0x1b4e85=0x4000;for(let _0x2ee3d8=0x0;_0x2ee3d8<_0x10c56d['length'];_0x2ee3d8+=_0x1b4e85){this[_0x3cd0bb(0x11d)](_0x10c56d[_0x3cd0bb(0xbd)](_0x2ee3d8,_0x2ee3d8+_0x1b4e85));}_0x35a4ea();}});this[_0x6dac4b(0x137)][_0x6dac4b(0x14a)](_0x11ab34)['pipe'](this[_0x6dac4b(0x1b4)]);}else this[_0x6dac4b(0x137)][_0x6dac4b(0x14a)](this['currentStreamRes']);this['remote']['on']('end',()=>{const _0x5eb446=_0x6dac4b;!this[_0x5eb446(0x1b4)][_0x5eb446(0x163)]&&this[_0x5eb446(0x1b4)]['end']();}),this[_0x6dac4b(0x137)]['on'](_0x6dac4b(0x154),_0x54c752=>{const _0x3c5e0c=_0x6dac4b;log('error',_0x3c5e0c(0x10f)+_0x54c752[_0x3c5e0c(0x1ae)]),!this[_0x3c5e0c(0x1b4)]['writableEnded']&&this[_0x3c5e0c(0x1b4)][_0x3c5e0c(0x1aa)]();});}catch(_0x527041){log(_0x6dac4b(0x154),_0x6dac4b(0x15d)+_0x527041['message']),this[_0x6dac4b(0x15f)]();}}[_0x49dc87(0x1a0)](_0x5d680c,_0x3087de){const _0x13b695=_0x49dc87;return!_0x5d680c[_0x13b695(0x175)]&&_0x5d680c[_0x13b695(0x124)](0xc8,_0x3087de),this[_0x13b695(0x1b4)]=_0x5d680c,this[_0x13b695(0x187)]&&this[_0x13b695(0x12c)]&&this[_0x13b695(0x195)](),_0x5d680c['on'](_0x13b695(0xf8),()=>{const _0x470fde=_0x13b695;log(_0x470fde(0x165),_0x470fde(0x140)),this[_0x470fde(0x15f)]();}),!![];}async['_writeToRemote'](_0x1dd5ef){const _0x46506e=_0x49dc87;if(!this[_0x46506e(0x137)]||this[_0x46506e(0x137)]['destroyed'])throw new Error(_0x46506e(0xc5));return new Promise((_0x5ec3eb,_0x388039)=>{const _0x5c7a5d=_0x46506e;this[_0x5c7a5d(0x137)][_0x5c7a5d(0x16d)](_0x1dd5ef,_0x214ea1=>{const _0x4177b7=_0x5c7a5d;_0x214ea1?(log(_0x4177b7(0x154),_0x4177b7(0x1b6)+_0x214ea1[_0x4177b7(0x1ae)]),_0x388039(_0x214ea1)):_0x5ec3eb();});});}[_0x49dc87(0x195)](){const _0x300177=_0x49dc87;if(!this[_0x300177(0x1b4)]||!this[_0x300177(0x12c)])return;try{!this[_0x300177(0x136)]&&(this[_0x300177(0x1b4)][_0x300177(0x16d)](this[_0x300177(0x12c)]),this[_0x300177(0x136)]=!![]),this[_0x300177(0x137)][_0x300177(0x14a)](this[_0x300177(0x1b4)]),this['remote']['on'](_0x300177(0x1aa),()=>{const _0x183cc4=_0x300177;!this[_0x183cc4(0x1b4)][_0x183cc4(0x163)]&&this[_0x183cc4(0x1b4)][_0x183cc4(0x1aa)]();}),this[_0x300177(0x137)]['on'](_0x300177(0x154),_0x1a8cee=>{const _0x284632=_0x300177;log('error',_0x284632(0x10f)+_0x1a8cee[_0x284632(0x1ae)]),!this[_0x284632(0x1b4)][_0x284632(0x163)]&&this['currentStreamRes']['end']();});}catch(_0x396890){log(_0x300177(0x154),_0x300177(0x15d)+_0x396890['message']),this[_0x300177(0x15f)]();}}[_0x49dc87(0x15f)](){const _0x2b33c4=_0x49dc87;!this[_0x2b33c4(0x1c6)]&&(this[_0x2b33c4(0x1c6)]=!![],log('debug','Cleaning\x20up\x20session\x20'+this['uuid']),this[_0x2b33c4(0x137)]&&(this[_0x2b33c4(0x137)][_0x2b33c4(0xc8)](),this['remote']=null),this[_0x2b33c4(0x187)]=![],this['headerSent']=![]);}}async function getCloudflareMeta(){return new Promise((_0xb88c71,_0x46cfab)=>{const _0xda4f98=_0x46f4,_0x341174={'hostname':_0xda4f98(0x189),'path':_0xda4f98(0xc1),'method':_0xda4f98(0x181)},_0x29f329=https[_0xda4f98(0x184)](_0x341174,_0x539ac0=>{const _0x196ccc=_0xda4f98;let _0x353bfb='';_0x539ac0['on']('data',_0x540289=>{_0x353bfb+=_0x540289;}),_0x539ac0['on'](_0x196ccc(0x1aa),()=>{const _0x10efe2=JSON['parse'](_0x353bfb);_0xb88c71(_0x10efe2);});});_0x29f329['on']('error',_0xa18fc9=>{_0x46cfab(_0xa18fc9);}),_0x29f329[_0xda4f98(0x1aa)]();});}let UPLOAD_DATA;async function getipandisp(){const _0x3f17df=_0x49dc87;let _0x588ec2=await getCloudflareMeta(),_0x2cefa9=_0x588ec2['clientIp'],_0x1d56d5=_0x588ec2[_0x3f17df(0x15a)],_0x1beb24=_0x588ec2[_0x3f17df(0x1c7)];ISP=(_0x1d56d5+'-'+_0x1beb24)['replace'](/ /g,'_');let _0x373b05,_0xe23c3d;if(MY_DOMAIN)_0x373b05=MY_DOMAIN;else{if(LOCAL_DOMAIN)_0x373b05=LOCAL_DOMAIN,_0xe23c3d='80';else!MY_DOMAIN&&!LOCAL_DOMAIN&&(_0x2cefa9[_0x3f17df(0x100)](':')?_0x373b05='['+_0x2cefa9+']':_0x373b05=''+_0x2cefa9,_0xe23c3d=PORT);}return HTTPSTLS?UPLOAD_DATA='vless://'+UUID+'@'+CFIP+':'+CFPORT+_0x3f17df(0x1a6)+_0x373b05+_0x3f17df(0x169)+_0x373b05+_0x3f17df(0xfc)+SETTINGS[_0x3f17df(0x18b)]+'&mode=packet-up#'+ISP+'-'+SUB_NAME:UPLOAD_DATA='vless://'+UUID+'@'+_0x373b05+':'+_0xe23c3d+'?encryption=none&security=none&sni='+_0x373b05+_0x3f17df(0x169)+_0x373b05+'&path='+SETTINGS[_0x3f17df(0x18b)]+_0x3f17df(0x176)+ISP+'-'+SUB_NAME,UPLOAD_DATA;}const server=http['createServer']((_0x4dcc1a,_0x3fd12a)=>{const _0x4c48d8=_0x49dc87,_0x317872={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x4c48d8(0xce),'Cache-Control':_0x4c48d8(0x19b),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x4dcc1a['url']==='/'){_0x3fd12a[_0x4c48d8(0x124)](0xc8,{'Content-Type':_0x4c48d8(0x19d)}),_0x3fd12a[_0x4c48d8(0x1aa)](_0x4c48d8(0xfd));return;}if(_0x4dcc1a['url']==='/'+UUID){const _0x33db56=''+UPLOAD_DATA,_0x5c66f9=Buffer[_0x4c48d8(0xbe)](_0x33db56)[_0x4c48d8(0x1cf)](_0x4c48d8(0x117));_0x3fd12a[_0x4c48d8(0x124)](0xc8,{'Content-Type':_0x4c48d8(0x19d)}),_0x3fd12a[_0x4c48d8(0x1aa)](_0x5c66f9+'\x0a');return;}const _0x22e6a4=_0x4dcc1a['url'][_0x4c48d8(0x170)](new RegExp(XPATH+'/([^/]+)(?:/([0-9]+))?$'));if(!_0x22e6a4){_0x3fd12a[_0x4c48d8(0x124)](0x194),_0x3fd12a['end']();return;}const _0x28f2c3=_0x22e6a4[0x1],_0x2af750=_0x22e6a4[0x2]?parseInt(_0x22e6a4[0x2]):null;if(_0x4dcc1a[_0x4c48d8(0x1cc)]==='GET'&&!_0x2af750){_0x317872['Content-Type']=_0x4c48d8(0x17d),_0x317872[_0x4c48d8(0x11e)]='chunked';let _0x597c94=sessions[_0x4c48d8(0x146)](_0x28f2c3);!_0x597c94&&(_0x597c94=new Session(_0x28f2c3),sessions['set'](_0x28f2c3,_0x597c94),log(_0x4c48d8(0x165),_0x4c48d8(0xdf)+_0x28f2c3));_0x597c94[_0x4c48d8(0x162)]=!![];!_0x597c94['startDownstream'](_0x3fd12a,_0x317872)&&(log(_0x4c48d8(0x154),_0x4c48d8(0x14d)+_0x28f2c3),!_0x3fd12a['headersSent']&&(_0x3fd12a[_0x4c48d8(0x124)](0x1f4),_0x3fd12a[_0x4c48d8(0x1aa)]()),_0x597c94[_0x4c48d8(0x15f)](),sessions[_0x4c48d8(0xe7)](_0x28f2c3));return;}if(_0x4dcc1a[_0x4c48d8(0x1cc)]===_0x4c48d8(0x12d)&&_0x2af750!==null){let _0x5da469=sessions[_0x4c48d8(0x146)](_0x28f2c3);!_0x5da469&&(_0x5da469=new Session(_0x28f2c3),sessions[_0x4c48d8(0x1b2)](_0x28f2c3,_0x5da469),log(_0x4c48d8(0x165),'Created\x20new\x20session\x20for\x20POST:\x20'+_0x28f2c3),setTimeout(()=>{const _0x5a67c4=_0x4c48d8,_0x2f08bb=sessions[_0x5a67c4(0x146)](_0x28f2c3);_0x2f08bb&&!_0x2f08bb[_0x5a67c4(0x162)]&&(log(_0x5a67c4(0x18a),_0x5a67c4(0x193)+_0x28f2c3+_0x5a67c4(0xc0)),_0x2f08bb[_0x5a67c4(0x15f)](),sessions['delete'](_0x28f2c3));},SETTINGS[_0x4c48d8(0x105)]));let _0x481ce7=[],_0xff3c85=0x0,_0xc09dd2=![];_0x4dcc1a['on']('data',_0x56ad86=>{const _0x5e5768=_0x4c48d8;_0xff3c85+=_0x56ad86[_0x5e5768(0x199)];if(_0xff3c85>SETTINGS['MAX_POST_SIZE']){!_0xc09dd2&&(_0x3fd12a[_0x5e5768(0x124)](0x19d),_0x3fd12a['end'](),_0xc09dd2=!![]);return;}_0x481ce7[_0x5e5768(0x11d)](_0x56ad86);}),_0x4dcc1a['on'](_0x4c48d8(0x1aa),async()=>{const _0x157999=_0x4c48d8;if(_0xc09dd2)return;try{const _0x4bd7f5=Buffer[_0x157999(0x168)](_0x481ce7);log('info',_0x157999(0xdb)+_0x2af750+_0x157999(0x1ba)+_0x4bd7f5[_0x157999(0x199)]),await _0x5da469['processPacket'](_0x2af750,_0x4bd7f5),!_0xc09dd2&&(_0x3fd12a['writeHead'](0xc8,_0x317872),_0xc09dd2=!![]),_0x3fd12a['end']();}catch(_0x159af8){log(_0x157999(0x154),_0x157999(0x1d1)+_0x159af8['message']),_0x5da469['cleanup'](),sessions[_0x157999(0xe7)](_0x28f2c3),!_0xc09dd2&&(_0x3fd12a['writeHead'](0x1f4),_0xc09dd2=!![]),_0x3fd12a[_0x157999(0x1aa)]();}});return;}_0x3fd12a[_0x4c48d8(0x124)](0x194),_0x3fd12a[_0x4c48d8(0x1aa)]();});server['on'](_0x49dc87(0x1a5),_0x463076=>{const _0x3ab322=_0x49dc87;log(_0x3ab322(0x19a),_0x3ab322(0x121)+(_0x463076[_0x3ab322(0x1ca)]||_0x3ab322(0x122)));});function generatePadding(_0x5c4b0c,_0x50cbe0){const _0x146746=_0x49dc87,_0x3e6fd6=_0x5c4b0c+Math[_0x146746(0x1a7)](Math[_0x146746(0xd5)]()*(_0x50cbe0-_0x5c4b0c));return Buffer[_0x146746(0xbe)](Array(_0x3e6fd6)[_0x146746(0xf6)]('X')[_0x146746(0x107)](''))['toString'](_0x146746(0x117));}server[_0x49dc87(0xf0)]=0x975e0,server[_0x49dc87(0x143)]=0x98968,server['on'](_0x49dc87(0x154),_0x4815f3=>{const _0xf53390=_0x49dc87;log('error',_0xf53390(0xe2)+_0x4815f3[_0xf53390(0x1ae)]);});async function uploadSubscription(_0x281d26,_0x393a7f,_0x16ad3a){const _0x2a3f0f=_0x49dc87,_0x3b6573=JSON['stringify']({'URL_NAME':_0x281d26,'URL':_0x393a7f}),_0x211f20=Buffer[_0x2a3f0f(0xbe)](_0x3b6573,_0x2a3f0f(0xec)),_0x5e2185=_0x211f20[_0x2a3f0f(0x199)],_0x30c9a2=new URL(_0x16ad3a),_0x155f19={'hostname':_0x30c9a2[_0x2a3f0f(0x11f)],'port':_0x30c9a2[_0x2a3f0f(0x17b)]||0x1bb,'path':_0x30c9a2['pathname'],'method':_0x2a3f0f(0x12d),'headers':{'Content-Type':_0x2a3f0f(0x145),'Content-Length':_0x5e2185}};try{const _0x3d3f67=await new Promise((_0xa323fc,_0x49d29a)=>{const _0xc2aaca=_0x2a3f0f,_0x19081e=https[_0xc2aaca(0x184)](_0x155f19,_0x44c677=>{const _0x49dc8e=_0xc2aaca;if(_0x44c677[_0x49dc8e(0x196)]<0xc8||_0x44c677[_0x49dc8e(0x196)]>=0x12c)return _0x49d29a(new Error(_0x49dc8e(0xe4)+_0x44c677[_0x49dc8e(0x196)]+_0x49dc8e(0x1d2)+_0x44c677[_0x49dc8e(0x186)]));let _0x573015='';_0x44c677['on'](_0x49dc8e(0x14f),_0x3e8838=>_0x573015+=_0x3e8838),_0x44c677['on'](_0x49dc8e(0x1aa),()=>_0xa323fc(_0x573015));});_0x19081e['on'](_0xc2aaca(0x154),_0x13cf51=>_0x49d29a(_0x13cf51)),_0x19081e['write'](_0x211f20),_0x19081e[_0xc2aaca(0x1aa)]();});return _0x3d3f67;}catch(_0x1f9e5a){console[_0x2a3f0f(0x154)](_0x2a3f0f(0x144),_0x1f9e5a[_0x2a3f0f(0x1ae)]);}}function cleanfiles(){setTimeout(()=>{const _0x3beef0=_0x46f4;let _0x37c4b4;KEEPALIVE?_0x37c4b4=[]:_0x37c4b4=[FILE_PATH+'/'+fileMapping[_0x3beef0(0x16f)],FILE_PATH+'/config.yml'],_0x37c4b4['forEach'](_0x409699=>{const _0x4c8b0b=_0x3beef0;try{fs['existsSync'](_0x409699)&&(fs[_0x4c8b0b(0x151)](_0x409699)[_0x4c8b0b(0x129)]()?fs[_0x4c8b0b(0xd9)](_0x409699,{'recursive':!![]}):fs[_0x4c8b0b(0x147)](_0x409699));}catch(_0x2c570f){}}),console[_0x3beef0(0x1b9)](),console[_0x3beef0(0x153)]('App\x20is\x20running');},0xea60);}server[_0x49dc87(0x135)](PORT,async()=>{const _0xcf8807=_0x49dc87;await getipandisp();NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&(await downloadFiles(),await delay(0x1388));await run(),cleanfiles(),console[_0xcf8807(0x153)](_0xcf8807(0xef)+PORT);if(SUB_URL)try{const _0x3e4620=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0xeb050f){console[_0xcf8807(0x154)](_0xcf8807(0x18f),_0xeb050f);}KEEPALIVE&&(await keep_alive(),setInterval(keep_alive,intervalInseconds*0x3e8));});