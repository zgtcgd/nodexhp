const _0x46ce60=_0x360d;(function(_0x51b8f8,_0x18d5f8){const _0x5c137f=_0x360d,_0x587871=_0x51b8f8();while(!![]){try{const _0x3f5d57=-parseInt(_0x5c137f(0x234))/0x1*(parseInt(_0x5c137f(0x1ef))/0x2)+parseInt(_0x5c137f(0x22f))/0x3+-parseInt(_0x5c137f(0x198))/0x4+parseInt(_0x5c137f(0x240))/0x5+parseInt(_0x5c137f(0x24d))/0x6*(parseInt(_0x5c137f(0x1f2))/0x7)+-parseInt(_0x5c137f(0x25b))/0x8+parseInt(_0x5c137f(0x19a))/0x9;if(_0x3f5d57===_0x18d5f8)break;else _0x587871['push'](_0x587871['shift']());}catch(_0x5f4663){_0x587871['push'](_0x587871['shift']());}}}(_0x1395,0xa5f80));const FILE_PATH=process['env'][_0x46ce60(0x276)]||_0x46ce60(0x261),intervalInseconds=process[_0x46ce60(0x20f)]['TIME']||0x64,PORT=process['env'][_0x46ce60(0x260)]||0xbb8,CFPORT=process[_0x46ce60(0x20f)][_0x46ce60(0x1a6)]||0x1bb,CFIP=process[_0x46ce60(0x20f)]['CFIP']||'ip.sb',KEEPALIVE=(process[_0x46ce60(0x20f)]['KEEPALIVE']||_0x46ce60(0x210))===_0x46ce60(0x265),SUB_URL=process[_0x46ce60(0x20f)]['SUB_URL']||'',UUID=process[_0x46ce60(0x20f)][_0x46ce60(0x1da)]||_0x46ce60(0x1ff),XPATH=process[_0x46ce60(0x20f)][_0x46ce60(0x20d)]||UUID[_0x46ce60(0x278)](0x0,0x8),HTTPSTLS=(process[_0x46ce60(0x20f)][_0x46ce60(0x272)]||_0x46ce60(0x265))==='true',NEZHA_VERSION=process[_0x46ce60(0x20f)][_0x46ce60(0x1c7)]||'V0',NEZHA_SERVER=process[_0x46ce60(0x20f)]['NEZHA_SERVER']||'',NEZHA_PORT=process[_0x46ce60(0x20f)][_0x46ce60(0x1f0)]||_0x46ce60(0x19c),NEZHA_KEY=process['env'][_0x46ce60(0x1bd)]||'',SUB_NAME=process[_0x46ce60(0x20f)]['SUB_NAME']||'',MY_DOMAIN=process[_0x46ce60(0x20f)][_0x46ce60(0x195)]||'',LOCAL_DOMAIN=process['env']['LOCAL_DOMAIN']||'',os=require('os'),fs=require('fs'),net=require(_0x46ce60(0x1ec)),path=require('path'),http=require(_0x46ce60(0x1a2)),https=require(_0x46ce60(0x204)),axios=require(_0x46ce60(0x190)),{pipeline}=require(_0x46ce60(0x1d1)),{Buffer}=require(_0x46ce60(0x1d3)),exec=require('child_process')[_0x46ce60(0x1db)],delay=_0x5f205a=>new Promise(_0x210c65=>setTimeout(_0x210c65,_0x5f205a)),SETTINGS={['UUID']:UUID,['LOG_LEVEL']:'none',['BUFFER_SIZE']:_0x46ce60(0x21d),['XPATH']:'%2F'+XPATH,['MAX_BUFFERED_POSTS']:0x1e,[_0x46ce60(0x27b)]:0xf4240,[_0x46ce60(0x1a1)]:0x7530,['CHUNK_SIZE']:0x400*0x400,['TCP_NODELAY']:!![],[_0x46ce60(0x202)]:!![]};function validate_uuid(_0x4f8ed5,_0x485547){for(let _0x4a6684=0x0;_0x4a6684<0x10;_0x4a6684++){if(_0x4f8ed5[_0x4a6684]!==_0x485547[_0x4a6684])return![];}return!![];}function concat_typed_arrays(_0xdfd849,..._0x5e3d6f){const _0x49a233=_0x46ce60;if(!_0x5e3d6f||_0x5e3d6f[_0x49a233(0x241)]<0x1)return _0xdfd849;let _0x405876=_0xdfd849[_0x49a233(0x241)];for(let _0x303642 of _0x5e3d6f)_0x405876+=_0x303642['length'];const _0x354680=new _0xdfd849['constructor'](_0x405876);_0x354680[_0x49a233(0x24b)](_0xdfd849,0x0),_0x405876=_0xdfd849[_0x49a233(0x241)];for(let _0x3b79e9 of _0x5e3d6f){_0x354680['set'](_0x3b79e9,_0x405876),_0x405876+=_0x3b79e9['length'];}return _0x354680;}function log(_0x1217aa,..._0x52ddc0){const _0x2b6c9e=_0x46ce60;if(SETTINGS[_0x2b6c9e(0x183)]===_0x2b6c9e(0x1fd))return;const _0x3cab34={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x246fc2={'debug':_0x2b6c9e(0x1e2),'info':_0x2b6c9e(0x274),'warn':_0x2b6c9e(0x1a3),'error':'\x1b[31m','reset':_0x2b6c9e(0x256)},_0x450a29=_0x3cab34[SETTINGS[_0x2b6c9e(0x183)]]||0x1,_0xc67586=_0x3cab34[_0x1217aa]||0x0;if(_0xc67586>=_0x450a29){const _0x460a75=new Date()['toISOString'](),_0x17a396=_0x246fc2[_0x1217aa]||_0x246fc2[_0x2b6c9e(0x219)];console[_0x2b6c9e(0x20a)](_0x17a396+'['+_0x460a75+_0x2b6c9e(0x1a7)+_0x1217aa+']',..._0x52ddc0,_0x246fc2['reset']);}}function execPromise(_0x57098f,_0x342bc5={}){return new Promise((_0x46c111,_0x974d7e)=>{const _0x3f05b1=exec(_0x57098f,_0x342bc5,(_0x14c1c2,_0x5d9775,_0x4cbdb4)=>{const _0x594714=_0x360d;if(_0x14c1c2){const _0x33c750=new Error(_0x594714(0x191)+_0x14c1c2['message']);_0x33c750[_0x594714(0x1cf)]=_0x14c1c2[_0x594714(0x1cf)],_0x33c750['stderr']=_0x4cbdb4['trim'](),_0x974d7e(_0x33c750);}else _0x46c111(_0x5d9775[_0x594714(0x257)]());});});}async function detectProcess(_0x199e76){const _0xce55ba=_0x46ce60,_0x5b5719=[{'cmd':_0xce55ba(0x1c0)+_0x199e76+'\x22','name':_0xce55ba(0x1ba)},{'cmd':_0xce55ba(0x1eb)+_0x199e76+'\x22','name':_0xce55ba(0x23b)},{'cmd':'ps\x20-eo\x20pid,comm\x20|\x20awk\x20-v\x20name=\x22'+_0x199e76+'\x22\x20\x27$2\x20==\x20name\x20{print\x20$1}\x27','name':'ps+awk'}];for(const _0x4d3fa8 of _0x5b5719){try{const _0x2f8103=await execPromise(_0x4d3fa8['cmd']);if(_0x2f8103)return _0x2f8103[_0xce55ba(0x22d)](/\n/g,'\x20')[_0xce55ba(0x257)]();}catch(_0x476d00){_0x476d00['code']!==0x7f&&_0x476d00['code']!==0x1&&console['debug'](_0xce55ba(0x1d4)+_0x4d3fa8['name']+_0xce55ba(0x245),_0x476d00[_0xce55ba(0x1cd)]);}}return'';}async function killProcess(_0xc5e5e1){const _0x49a969=_0x46ce60;console[_0x49a969(0x20a)](_0x49a969(0x249)+_0xc5e5e1);try{const _0x138b88=await detectProcess(_0xc5e5e1);if(!_0x138b88)return console[_0x49a969(0x27e)](_0x49a969(0x226)+_0xc5e5e1+'\x27\x20not\x20found'),{'success':!![],'message':_0x49a969(0x1cc)};await execPromise('kill\x20-9\x20'+_0x138b88);const _0x4a30a2=_0x49a969(0x26e)+_0x138b88+')';return console[_0x49a969(0x20a)](_0x4a30a2),{'success':!![],'message':_0x4a30a2};}catch(_0x598d4a){const _0x257b8b=_0x49a969(0x246)+_0x598d4a[_0x49a969(0x1cd)];return console[_0x49a969(0x218)](_0x257b8b),{'success':![],'message':_0x257b8b};}}function generateRandomString(_0x12d474){const _0x203a6e=_0x46ce60,_0x31b2e3='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';let _0x334a14='';for(let _0x5946e7=0x0;_0x5946e7<_0x12d474;_0x5946e7++){_0x334a14+=_0x31b2e3[_0x203a6e(0x1c8)](Math[_0x203a6e(0x1d9)](Math[_0x203a6e(0x203)]()*_0x31b2e3['length']));}return _0x334a14;}function getSystemArchitecture(){const _0x414a16=_0x46ce60,_0x215a67=os[_0x414a16(0x25a)]();return _0x215a67===_0x414a16(0x229)||_0x215a67==='arm64'||_0x215a67==='aarch64'?'arm':_0x414a16(0x22c);}function getFilesForArchitecture(_0x146c14){const _0x7a18f6=_0x46ce60,_0xad341f={'app':{'V0':{'arm':_0x7a18f6(0x18c),'amd':_0x7a18f6(0x19b)},'V1':{'arm':_0x7a18f6(0x21b),'amd':_0x7a18f6(0x23a)}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0x43c3ea=[{'fileName':'tmp'+generateRandomString(0x5),'originalName':'app','fileUrl':_0xad341f['app'][NEZHA_VERSION][_0x146c14]}];return _0x43c3ea;}else return[];}async function download_function(_0x1e2550,_0x5f3a43,_0x197031){const _0x16cccf=_0x46ce60,_0x2bddb2=path[_0x16cccf(0x277)](FILE_PATH,_0x1e2550);let _0x5011f2=![];try{const _0x185d00=await axios({'method':'get','url':_0x197031,'responseType':_0x16cccf(0x268)});await pipeline(_0x185d00[_0x16cccf(0x27a)],fs[_0x16cccf(0x1b1)](_0x2bddb2)),_0x5011f2=!![];}catch(_0x10c3a5){}return{'fileName':_0x1e2550,'originalName':_0x5f3a43,'filePath':_0x2bddb2,'success':_0x5011f2};}let fileMapping={};async function downloadFiles(){const _0x2da213=_0x46ce60;try{const _0x123401=getSystemArchitecture();if(!_0x123401)return console[_0x2da213(0x20a)](_0x2da213(0x189)),fileMapping;const _0x5378a0=getFilesForArchitecture(_0x123401);if(_0x5378a0[_0x2da213(0x241)]===0x0)return console['log']('Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture'),fileMapping;const _0x47df40=_0x5378a0['map'](_0x3345a9=>download_function(_0x3345a9[_0x2da213(0x1f3)],_0x3345a9[_0x2da213(0x1de)],_0x3345a9['fileUrl'])),_0x272621=await Promise[_0x2da213(0x18b)](_0x47df40);return _0x272621[_0x2da213(0x22e)](_0x1bbb6c=>{const _0x42e471=_0x2da213;if(_0x1bbb6c[_0x42e471(0x1d6)])try{fs[_0x42e471(0x24c)](_0x1bbb6c[_0x42e471(0x221)],0x1ed),fileMapping[_0x1bbb6c[_0x42e471(0x1de)]]=_0x1bbb6c[_0x42e471(0x1f3)];}catch(_0x50851b){}}),fileMapping;}catch(_0x23a6c8){return console[_0x2da213(0x218)](_0x2da213(0x20c),_0x23a6c8),fileMapping;}}let NEZHA_TLS;function nezconfig(){const _0x2663cb=_0x46ce60,_0x1d0388=[_0x2663cb(0x19c),_0x2663cb(0x280),'2096','2087','2083','2053'];if(NEZHA_VERSION==='V0')return _0x1d0388[_0x2663cb(0x1f1)](NEZHA_PORT)?NEZHA_TLS=_0x2663cb(0x224):NEZHA_TLS='',NEZHA_TLS;else{if(NEZHA_VERSION==='V1'){_0x1d0388[_0x2663cb(0x1f1)](NEZHA_PORT)?NEZHA_TLS=_0x2663cb(0x265):NEZHA_TLS=_0x2663cb(0x210);const _0x1c292e=path['join'](FILE_PATH,'/config.yml'),_0x559e79=_0x2663cb(0x223)+NEZHA_KEY+_0x2663cb(0x1b0)+NEZHA_SERVER+':'+NEZHA_PORT+_0x2663cb(0x19f)+NEZHA_TLS+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;try{fs['writeFileSync'](_0x1c292e,_0x559e79);}catch(_0x5ae070){}}}}async function runapp(){const _0x38d813=_0x46ce60;if(fileMapping['app']&&fs[_0x38d813(0x1c6)](path[_0x38d813(0x277)](FILE_PATH,fileMapping[_0x38d813(0x1ee)]))){if(NEZHA_VERSION==='V0'){const _0x1ede2c=_0x38d813(0x24f)+FILE_PATH+'/'+fileMapping[_0x38d813(0x1ee)]+_0x38d813(0x196)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+NEZHA_TLS+_0x38d813(0x188);try{await execPromise(_0x1ede2c);}catch(_0xdf7054){console[_0x38d813(0x218)](fileMapping[_0x38d813(0x1ee)]+_0x38d813(0x1df)+_0xdf7054);}}else{if(NEZHA_VERSION==='V1'){const _0x2561b9=_0x38d813(0x24f)+FILE_PATH+'/'+fileMapping[_0x38d813(0x1ee)]+'\x20-c\x20'+FILE_PATH+_0x38d813(0x1c1);try{await execPromise(_0x2561b9);}catch(_0x4a237e){console[_0x38d813(0x218)](fileMapping[_0x38d813(0x1ee)]+_0x38d813(0x1df)+_0x4a237e);}}}}else console['log'](_0x38d813(0x25f));}async function run(){const _0x249254=_0x46ce60;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){nezconfig();const _0x32f288=await detectProcess(''+fileMapping[_0x249254(0x1ee)]);if(_0x32f288){}else await runapp();await delay(0x3e8);}else console['log'](_0x249254(0x1a9));}async function keep_alive(){if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x4e1b2b=await detectProcess(''+fileMapping['app']);if(_0x4e1b2b){}else await runapp();}}function parse_uuid(_0x1b65c1){const _0x413af4=_0x46ce60;_0x1b65c1=_0x1b65c1[_0x413af4(0x201)]('-','');const _0x5dea2=[];for(let _0x2e5d02=0x0;_0x2e5d02<0x10;_0x2e5d02++){_0x5dea2[_0x413af4(0x1b3)](parseInt(_0x1b65c1[_0x413af4(0x243)](_0x2e5d02*0x2,0x2),0x10));}return _0x5dea2;}async function read_vless_header(_0x52d28a,_0x44ef8e){const _0x90bd87=_0x46ce60;let _0x45ebfd=0x0,_0xc82bc1=new Uint8Array(),_0x541fea={'value':_0xc82bc1,'done':![]};async function _0x2c26ae(_0x446f2b){const _0x2d4531=_0x360d;if(_0x541fea[_0x2d4531(0x1b5)])throw new Error(_0x2d4531(0x1cb));const _0x1f7496=_0x446f2b-_0x45ebfd;if(_0x1f7496<0x1)return;_0x541fea=await read_atleast(_0x52d28a,_0x1f7496),_0x45ebfd+=_0x541fea[_0x2d4531(0x231)][_0x2d4531(0x241)],_0xc82bc1=concat_typed_arrays(_0xc82bc1,_0x541fea[_0x2d4531(0x231)]);}await _0x2c26ae(0x1+0x10+0x1);const _0x40607d=_0xc82bc1[0x0],_0x101dd2=_0xc82bc1[_0x90bd87(0x278)](0x1,0x1+0x10),_0xde1e21=parse_uuid(_0x44ef8e);if(!validate_uuid(_0x101dd2,_0xde1e21))throw new Error(_0x90bd87(0x266));const _0x40665c=_0xc82bc1[0x1+0x10],_0x1539f3=0x1+0x10+0x1+_0x40665c+0x1+0x2+0x1;await _0x2c26ae(_0x1539f3+0x1);const _0x347885=_0xc82bc1[0x1+0x10+0x1+_0x40665c],_0x1f4172=0x1;if(_0x347885!==_0x1f4172)throw new Error(_0x90bd87(0x25e)+_0x347885);const _0x240856=(_0xc82bc1[_0x1539f3-0x1-0x2]<<0x8)+_0xc82bc1[_0x1539f3-0x1-0x1],_0x253c06=_0xc82bc1[_0x1539f3-0x1],_0x221d69=0x1,_0x297437=0x2,_0x5754d5=0x3;let _0x590f87=-0x1;if(_0x253c06===_0x221d69)_0x590f87=_0x1539f3+0x4;else{if(_0x253c06===_0x5754d5)_0x590f87=_0x1539f3+0x10;else _0x253c06===_0x297437&&(_0x590f87=_0x1539f3+0x1+_0xc82bc1[_0x1539f3]);}if(_0x590f87<0x0)throw new Error('read\x20address\x20type\x20failed');await _0x2c26ae(_0x590f87);const _0x3b0882=_0x1539f3;let _0x3958d0='';if(_0x253c06===_0x221d69)_0x3958d0=_0xc82bc1[_0x90bd87(0x278)](_0x3b0882,_0x3b0882+0x4)[_0x90bd87(0x277)]('.');else{if(_0x253c06===_0x297437)_0x3958d0=new TextDecoder()[_0x90bd87(0x1ad)](_0xc82bc1['slice'](_0x3b0882+0x1,_0x3b0882+0x1+_0xc82bc1[_0x3b0882]));else _0x253c06===_0x5754d5&&(_0x3958d0=_0xc82bc1[_0x90bd87(0x278)](_0x3b0882,_0x3b0882+0x10)[_0x90bd87(0x21f)]((_0x21b635,_0x5b1ae0,_0x324ecc,_0xebf747)=>_0x324ecc%0x2?_0x21b635[_0x90bd87(0x1e5)](((_0xebf747[_0x324ecc-0x1]<<0x8)+_0x5b1ae0)[_0x90bd87(0x271)](0x10)):_0x21b635,[])[_0x90bd87(0x277)](':'));}if(!_0x3958d0){log(_0x90bd87(0x218),_0x90bd87(0x19d));throw new Error(_0x90bd87(0x220));}return log(_0x90bd87(0x18f),'VLESS\x20connection\x20to\x20'+_0x3958d0+':'+_0x240856),{'hostname':_0x3958d0,'port':_0x240856,'data':_0xc82bc1[_0x90bd87(0x278)](_0x590f87),'resp':new Uint8Array([_0x40607d,0x0])};}async function read_atleast(_0x31daa1,_0x4a04e6){const _0x43ca08=_0x46ce60,_0x4bb9cb=[];let _0x4a8b98=![];while(_0x4a04e6>0x0&&!_0x4a8b98){const _0x39f891=await _0x31daa1[_0x43ca08(0x239)]();if(_0x39f891[_0x43ca08(0x231)]){const _0x31f0d5=new Uint8Array(_0x39f891[_0x43ca08(0x231)]);_0x4bb9cb['push'](_0x31f0d5),_0x4a04e6-=_0x31f0d5[_0x43ca08(0x241)];}_0x4a8b98=_0x39f891['done'];}if(_0x4a04e6>0x0)throw new Error(_0x43ca08(0x215));return{'value':concat_typed_arrays(..._0x4bb9cb),'done':_0x4a8b98};}function _0x1395(){const _0x5b3ece=['url','log','pendingBuffers','Error\x20downloading\x20files:','XPATH','close','env','false','\x20timed\x20out\x20without\x20downstream','Server\x20error:\x20','connect','port','not\x20enough\x20data\x20to\x20read','pipe','processPacket','error','reset','base64','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','end','2048','clear','reduce','parse\x20hostname\x20failed','filePath','/([^/]+)(?:/([0-9]+))?$','client_secret:\x20','--tls','&fp=chrome&allowInsecure=1&type=xhttp&host=','Process\x20\x27','initialized','currentStreamRes','arm','Download\x20error:\x20','secureConnection','amd','replace','forEach','2666412FrZbGm','Client\x20connection\x20closed','value','catch','readable','300803NXYdRi','Sending\x20VLESS\x20response\x20header\x20(','destroy','enqueue','statusMessage','read','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1','pgrep','stringify','unlinkSync','headersTimeout','releaseLock','4034325MCUJiO','length','delete','substr','hostname','\x20error:','Kill\x20failed:\x20','writable','/meta','Attempting\x20to\x20kill\x20process:\x20','method','set','chmodSync','19806RzvrpM','getReader','nohup\x20','Processed\x20packet\x20seq=','from','alpnProtocol','headersSent','cleanup','Received\x20out\x20of\x20order\x20packet\x20seq=','\x1b[0m','trim','?encryption=none&security=none&sni=','New\x20secure\x20connection\x20using:\x20','arch','9758504cFZGiM','Socket\x20is\x20destroyed','cleaned','unsupported\x20command:\x20','app\x20file\x20not\x20found,\x20skip\x20running','PORT','/tmp','destroyed','writableEnded','request','true','invalid\x20UUID','Socket\x20error:','stream','get','Cleanup\x20error:\x20',',\x20size=','socket\x20hang\x20up','startDownstream','Killed\x20process\x20(PIDs:\x20','Session\x20','responseHeader','toString','HTTPSTLS','Upload\x20error:\x20','\x1b[32m','):\x20','FILE_PATH','join','slice','&path=','data','MAX_POST_SIZE','Failed\x20to\x20write\x20to\x20remote:\x20','Relay\x20error:','warn','speed.cloudflare.com','8443','LOG_LEVEL','Upload\x20failed:','chunked','http/1.1','Created\x20new\x20session\x20for\x20POST:\x20','\x20--report-delay=4\x20--skip-conn\x20--skip-procs\x20--disable-auto-update\x20>/dev/null\x202>&1\x20&','Can\x27t\x20determine\x20system\x20architecture.','Read\x20controller\x20close\x20error:','all','https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','Remote\x20connection\x20established','bufferSize','info','axios','Command\x20failed:\x20','pipeTo','lstatSync','remote','MY_DOMAIN','\x20-s\x20','VLESS\x20header\x20parse\x20error:\x20','1384480jCPXvN','MAX_BUFFERED_POSTS','1329858JNFDfd','https://github.com/kahunama/myfile/releases/download/main/nezha-agent','443','Failed\x20to\x20parse\x20hostname','pause','\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20','vlessHeader','SESSION_TIMEOUT','http','\x1b[33m','aborted','parse','CFPORT',']\x20[','Error\x20starting\x20downstream:\x20','Node\x20variable\x20is\x20empty,\x20skip\x20running','debug','createConnection','nextSeq','decode','initializeVLESS','has','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','createWriteStream','Cleaning\x20up\x20session\x20','push','upload\x20failed:','done','Remote\x20error:\x20','Created\x20new\x20session\x20for\x20GET:\x20','pathname','text/plain','pidof','_startDownstreamResponse','resp','NEZHA_KEY','getWriter','POST','pidof\x20\x22','/config.yml\x20>/dev/null\x202>&1\x20&','cork','vless://','Created\x20new\x20session\x20with\x20UUID:\x20','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','existsSync','NEZHA_VERSION','charAt','isDirectory','now','header\x20length\x20too\x20short','Process\x20not\x20found','message','writeHead','code','timeout','stream/promises','Failed\x20to\x20process\x20POST\x20request:\x20','buffer','[detectProcess]\x20','fill','success','finally','Too\x20many\x20buffered\x20packets','floor','UUID','exec','uncork','reading_done','originalName','\x20running\x20error:\x20','Server\x20is\x20running\x20on\x20port\x20','socket','\x1b[36m',',\x20response:\x20','listen','concat','&mode=packet-up#','write','Connected\x20to\x20','lastActivity','setNoDelay','pgrep\x20-x\x20\x22','net','downstreamStarted','app','2fUFnpK','NEZHA_PORT','includes','1491grQCqP','fileName','application/json;\x20charset=utf-8','App\x20is\x20running','_writeToRemote','CHUNK_SIZE','statusCode','asOrganization','BUFFER_SIZE','headerSent','VLESS\x20header\x20parsed\x20successfully','none','/config.yml','7160b696-dd5e-42e3-a024-145e92cec916','connect\x20timeout','replaceAll','TCP_KEEPALIVE','random','https','utf8','match','GET','application/octet-stream'];_0x1395=function(){return _0x5b3ece;};return _0x1395();}async function parse_header(_0xbdb5ca,_0x960fe4){const _0x399640=_0x46ce60;log(_0x399640(0x1aa),'Starting\x20to\x20parse\x20VLESS\x20header');const _0x57cd36=_0x960fe4[_0x399640(0x233)][_0x399640(0x24e)]();try{const _0x563296=await read_vless_header(_0x57cd36,_0xbdb5ca);return log('debug',_0x399640(0x1fc)),_0x563296;}catch(_0x10cf5a){log(_0x399640(0x218),_0x399640(0x197)+_0x10cf5a['message']);throw new Error('read\x20vless\x20header\x20error:\x20'+_0x10cf5a[_0x399640(0x1cd)]);}finally{_0x57cd36[_0x399640(0x23f)]();}}async function connect_remote(_0x4f0bf0,_0x51b7c4){const _0x5e67ab=_0x46ce60,_0x3186cb=0x1f40;try{const _0x3cc8d4=await timed_connect(_0x4f0bf0,_0x51b7c4,_0x3186cb);return _0x3cc8d4[_0x5e67ab(0x1ea)](!![]),_0x3cc8d4['setKeepAlive'](!![],0x3e8),_0x3cc8d4[_0x5e67ab(0x18e)]=parseInt(SETTINGS[_0x5e67ab(0x1fa)])*0x400,log(_0x5e67ab(0x18f),_0x5e67ab(0x1e8)+_0x4f0bf0+':'+_0x51b7c4),_0x3cc8d4;}catch(_0xe665c8){log(_0x5e67ab(0x218),'Connection\x20failed:\x20'+_0xe665c8[_0x5e67ab(0x1cd)]);throw _0xe665c8;}}function timed_connect(_0x2e4bd8,_0x297996,_0x140223){return new Promise((_0x29d3fd,_0x464c0a)=>{const _0xd057bd=_0x360d,_0x521d38=net[_0xd057bd(0x1ab)]({'host':_0x2e4bd8,'port':_0x297996}),_0x2bffcd=setTimeout(()=>{const _0x2bf746=_0xd057bd;_0x464c0a(new Error(_0x2bf746(0x200)));},_0x140223);_0x521d38['on'](_0xd057bd(0x213),()=>{clearTimeout(_0x2bffcd),_0x29d3fd(_0x521d38);}),_0x521d38['on'](_0xd057bd(0x218),_0x7f712a=>{clearTimeout(_0x2bffcd),_0x464c0a(_0x7f712a);});});}function pipe_relay(){async function _0x4e4433(_0x4a4309,_0x38acf1,_0x142171){const _0x1740cf=_0x360d,_0x3e65d5=parseInt(SETTINGS[_0x1740cf(0x1f7)]);if(_0x142171[_0x1740cf(0x241)]>0x0){if(_0x38acf1[_0x1740cf(0x1e7)])_0x38acf1[_0x1740cf(0x1c2)](),_0x38acf1[_0x1740cf(0x1e7)](_0x142171),process['nextTick'](()=>_0x38acf1[_0x1740cf(0x1dc)]());else{const _0x5bbf5e=_0x38acf1[_0x1740cf(0x247)][_0x1740cf(0x1be)]();try{await _0x5bbf5e[_0x1740cf(0x1e7)](_0x142171);}finally{_0x5bbf5e[_0x1740cf(0x23f)]();}}}try{_0x4a4309[_0x1740cf(0x216)]?(_0x4a4309[_0x1740cf(0x19e)](),_0x4a4309[_0x1740cf(0x216)](_0x38acf1,{'end':!![],'highWaterMark':_0x3e65d5}),_0x4a4309['resume']()):await _0x4a4309[_0x1740cf(0x233)][_0x1740cf(0x192)](_0x38acf1[_0x1740cf(0x247)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x1740cf(0x1d0)](SETTINGS['SESSION_TIMEOUT'])});}catch(_0x2e9a1b){!_0x2e9a1b[_0x1740cf(0x1cd)]['includes'](_0x1740cf(0x1a4))&&log('error',_0x1740cf(0x27d),_0x2e9a1b[_0x1740cf(0x1cd)]);throw _0x2e9a1b;}}return _0x4e4433;}function socketToWebStream(_0x4775c9){let _0x16869b,_0x472b50;return _0x4775c9['on']('error',_0x5b11de=>{const _0x4249c9=_0x360d;log(_0x4249c9(0x218),_0x4249c9(0x267),_0x5b11de[_0x4249c9(0x1cd)]),_0x16869b?.[_0x4249c9(0x218)](_0x5b11de),_0x472b50?.['error'](_0x5b11de);}),{'readable':new ReadableStream({'start'(_0xe4a308){const _0x23a283=_0x360d;_0x16869b=_0xe4a308,_0x4775c9['on']('data',_0x55ced4=>{const _0xfcfe9f=_0x360d;try{_0xe4a308[_0xfcfe9f(0x237)](_0x55ced4);}catch(_0x3a5086){log(_0xfcfe9f(0x218),'Read\x20controller\x20error:',_0x3a5086[_0xfcfe9f(0x1cd)]);}}),_0x4775c9['on'](_0x23a283(0x21c),()=>{const _0x313f97=_0x23a283;try{_0xe4a308[_0x313f97(0x20e)]();}catch(_0x1d4ff0){log(_0x313f97(0x218),_0x313f97(0x18a),_0x1d4ff0[_0x313f97(0x1cd)]);}});},'cancel'(){const _0x1c971e=_0x360d;_0x4775c9[_0x1c971e(0x236)]();}}),'writable':new WritableStream({'start'(_0x2d14b3){_0x472b50=_0x2d14b3;},'write'(_0x342fcf){return new Promise((_0x4f7d10,_0xb27c4e)=>{const _0xb0f542=_0x360d;if(_0x4775c9['destroyed']){_0xb27c4e(new Error(_0xb0f542(0x25c)));return;}_0x4775c9[_0xb0f542(0x1e7)](_0x342fcf,_0x4ceca2=>{if(_0x4ceca2)_0xb27c4e(_0x4ceca2);else _0x4f7d10();});});},'close'(){const _0x941f3e=_0x360d;!_0x4775c9[_0x941f3e(0x262)]&&_0x4775c9[_0x941f3e(0x21c)]();},'abort'(_0x5c48ed){const _0x257444=_0x360d;_0x4775c9[_0x257444(0x236)](_0x5c48ed);}})};}function relay(_0x1a26b7,_0x23a0d4,_0x199c4d,_0x187293){const _0xf509a2=_0x46ce60,_0x487f00=pipe_relay();let _0x189a10=![];const _0x5a82e8=socketToWebStream(_0x199c4d);function _0x1413cb(){const _0x1b44d2=_0x360d;if(!_0x189a10){_0x189a10=!![];try{_0x199c4d['destroy']();}catch(_0x2a771e){!_0x2a771e[_0x1b44d2(0x1cd)][_0x1b44d2(0x1f1)](_0x1b44d2(0x1a4))&&!_0x2a771e[_0x1b44d2(0x1cd)]['includes'](_0x1b44d2(0x26c))&&log('error',_0x1b44d2(0x26a)+_0x2a771e[_0x1b44d2(0x1cd)]);}}}const _0x27c2ca=_0x487f00(_0x23a0d4,_0x5a82e8,_0x187293[_0xf509a2(0x27a)])[_0xf509a2(0x232)](_0x42bc78=>{const _0x162649=_0xf509a2;!_0x42bc78['message']['includes'](_0x162649(0x1a4))&&!_0x42bc78['message'][_0x162649(0x1f1)](_0x162649(0x26c))&&log(_0x162649(0x218),_0x162649(0x273)+_0x42bc78[_0x162649(0x1cd)]);})[_0xf509a2(0x1d7)](()=>{const _0x82a38d=_0xf509a2;_0x23a0d4[_0x82a38d(0x1dd)]&&_0x23a0d4[_0x82a38d(0x1dd)]();}),_0x3a9130=_0x487f00(_0x5a82e8,_0x23a0d4,_0x187293[_0xf509a2(0x1bc)])[_0xf509a2(0x232)](_0x5c7b28=>{const _0x11ee55=_0xf509a2;!_0x5c7b28[_0x11ee55(0x1cd)][_0x11ee55(0x1f1)](_0x11ee55(0x1a4))&&!_0x5c7b28[_0x11ee55(0x1cd)][_0x11ee55(0x1f1)](_0x11ee55(0x26c))&&log('error',_0x11ee55(0x22a)+_0x5c7b28[_0x11ee55(0x1cd)]);});_0x3a9130[_0xf509a2(0x1d7)](()=>_0x27c2ca)[_0xf509a2(0x1d7)](_0x1413cb);}const sessions=new Map();class Session{constructor(_0x5929bf){const _0x532661=_0x46ce60;this['uuid']=_0x5929bf,this['nextSeq']=0x0,this[_0x532661(0x1ed)]=![],this[_0x532661(0x1e9)]=Date[_0x532661(0x1ca)](),this['vlessHeader']=null,this[_0x532661(0x194)]=null,this['initialized']=![],this[_0x532661(0x270)]=null,this[_0x532661(0x1fb)]=![],this['bufferedData']=new Map(),this[_0x532661(0x25d)]=![],this['pendingPackets']=[],this[_0x532661(0x228)]=null,this[_0x532661(0x20b)]=new Map(),log(_0x532661(0x1aa),_0x532661(0x1c4)+_0x5929bf);}async['initializeVLESS'](_0x1fe55b){const _0x38b0d3=_0x46ce60;if(this['initialized'])return!![];try{log(_0x38b0d3(0x1aa),_0x38b0d3(0x1c5));const _0x4feda7=new ReadableStream({'start'(_0x5af914){const _0x34f2d4=_0x38b0d3;_0x5af914[_0x34f2d4(0x237)](_0x1fe55b),_0x5af914[_0x34f2d4(0x20e)]();}}),_0x4e1497={'readable':_0x4feda7,'writable':new WritableStream()};return this[_0x38b0d3(0x1a0)]=await parse_header(SETTINGS[_0x38b0d3(0x1da)],_0x4e1497),log(_0x38b0d3(0x18f),'VLESS\x20header\x20parsed:\x20'+this[_0x38b0d3(0x1a0)]['hostname']+':'+this[_0x38b0d3(0x1a0)][_0x38b0d3(0x214)]),this['remote']=await connect_remote(this[_0x38b0d3(0x1a0)][_0x38b0d3(0x244)],this[_0x38b0d3(0x1a0)][_0x38b0d3(0x214)]),log(_0x38b0d3(0x18f),_0x38b0d3(0x18d)),this[_0x38b0d3(0x227)]=!![],!![];}catch(_0x4445f8){return log(_0x38b0d3(0x218),'Failed\x20to\x20initialize\x20VLESS:\x20'+_0x4445f8[_0x38b0d3(0x1cd)]),![];}}async[_0x46ce60(0x217)](_0x13f2e5,_0x196217){const _0x21676c=_0x46ce60;try{this[_0x21676c(0x20b)][_0x21676c(0x24b)](_0x13f2e5,_0x196217),log(_0x21676c(0x1aa),'Buffered\x20packet\x20seq='+_0x13f2e5+',\x20size='+_0x196217['length']);while(this[_0x21676c(0x20b)][_0x21676c(0x1af)](this['nextSeq'])){const _0x3df7ca=this[_0x21676c(0x20b)]['get'](this[_0x21676c(0x1ac)]);this[_0x21676c(0x20b)]['delete'](this['nextSeq']);if(!this[_0x21676c(0x227)]&&this[_0x21676c(0x1ac)]===0x0){if(!await this[_0x21676c(0x1ae)](_0x3df7ca))throw new Error('Failed\x20to\x20initialize\x20VLESS\x20connection');this[_0x21676c(0x270)]=Buffer[_0x21676c(0x251)](this[_0x21676c(0x1a0)][_0x21676c(0x1bc)]),await this[_0x21676c(0x1f6)](this['vlessHeader'][_0x21676c(0x27a)]),this[_0x21676c(0x228)]&&this[_0x21676c(0x1bb)]();}else{if(!this[_0x21676c(0x227)]){log(_0x21676c(0x27e),_0x21676c(0x255)+_0x13f2e5+'\x20before\x20initialization');continue;}await this[_0x21676c(0x1f6)](_0x3df7ca);}this[_0x21676c(0x1ac)]++,log(_0x21676c(0x1aa),_0x21676c(0x250)+(this['nextSeq']-0x1));}if(this[_0x21676c(0x20b)]['size']>SETTINGS[_0x21676c(0x199)])throw new Error(_0x21676c(0x1d8));return!![];}catch(_0x301e3e){log('error','Process\x20packet\x20error:\x20'+_0x301e3e['message']);throw _0x301e3e;}}[_0x46ce60(0x1bb)](){const _0x18459d=_0x46ce60;if(!this[_0x18459d(0x228)]||!this['responseHeader'])return;try{const _0x2de581=this[_0x18459d(0x228)][_0x18459d(0x1e1)]?.[_0x18459d(0x252)]||_0x18459d(0x186),_0x3d467d=_0x2de581==='h2';!this['headerSent']&&(log(_0x18459d(0x1aa),_0x18459d(0x235)+_0x2de581+_0x18459d(0x275)+this[_0x18459d(0x270)][_0x18459d(0x241)]+'\x20bytes'),this[_0x18459d(0x228)][_0x18459d(0x1e7)](this[_0x18459d(0x270)]),this[_0x18459d(0x1fb)]=!![]);if(_0x3d467d){this['currentStreamRes'][_0x18459d(0x1e1)]['setNoDelay'](!![]);const _0x1b06b3=new require(_0x18459d(0x268))['Transform']({'transform'(_0x12db67,_0x38b74e,_0x19a302){const _0x2906a0=_0x18459d,_0xbf54ed=0x4000;for(let _0x423ecd=0x0;_0x423ecd<_0x12db67[_0x2906a0(0x241)];_0x423ecd+=_0xbf54ed){this[_0x2906a0(0x1b3)](_0x12db67['slice'](_0x423ecd,_0x423ecd+_0xbf54ed));}_0x19a302();}});this[_0x18459d(0x194)]['pipe'](_0x1b06b3)[_0x18459d(0x216)](this['currentStreamRes']);}else this['remote'][_0x18459d(0x216)](this['currentStreamRes']);this['remote']['on'](_0x18459d(0x21c),()=>{const _0x387e71=_0x18459d;!this[_0x387e71(0x228)][_0x387e71(0x263)]&&this[_0x387e71(0x228)][_0x387e71(0x21c)]();}),this[_0x18459d(0x194)]['on'](_0x18459d(0x218),_0x5e54ca=>{const _0x1a8de1=_0x18459d;log('error',_0x1a8de1(0x1b6)+_0x5e54ca[_0x1a8de1(0x1cd)]),!this[_0x1a8de1(0x228)][_0x1a8de1(0x263)]&&this[_0x1a8de1(0x228)][_0x1a8de1(0x21c)]();});}catch(_0x38095b){log(_0x18459d(0x218),_0x18459d(0x1a8)+_0x38095b[_0x18459d(0x1cd)]),this[_0x18459d(0x254)]();}}[_0x46ce60(0x26d)](_0x4f0901,_0x32f1ad){const _0x3a9240=_0x46ce60;return!_0x4f0901[_0x3a9240(0x253)]&&_0x4f0901[_0x3a9240(0x1ce)](0xc8,_0x32f1ad),this[_0x3a9240(0x228)]=_0x4f0901,this['initialized']&&this[_0x3a9240(0x270)]&&this[_0x3a9240(0x1bb)](),_0x4f0901['on'](_0x3a9240(0x20e),()=>{const _0x4cd5a4=_0x3a9240;log(_0x4cd5a4(0x18f),_0x4cd5a4(0x230)),this[_0x4cd5a4(0x254)]();}),!![];}async[_0x46ce60(0x1f6)](_0x474336){const _0x54cbd6=_0x46ce60;if(!this[_0x54cbd6(0x194)]||this[_0x54cbd6(0x194)][_0x54cbd6(0x262)])throw new Error('Remote\x20connection\x20not\x20available');return new Promise((_0x4f5f63,_0x1aaa9a)=>{const _0x2b66fe=_0x54cbd6;this[_0x2b66fe(0x194)][_0x2b66fe(0x1e7)](_0x474336,_0x566e11=>{const _0x320fdd=_0x2b66fe;_0x566e11?(log(_0x320fdd(0x218),_0x320fdd(0x27c)+_0x566e11['message']),_0x1aaa9a(_0x566e11)):_0x4f5f63();});});}['_startDownstreamResponse'](){const _0x2e1fb9=_0x46ce60;if(!this[_0x2e1fb9(0x228)]||!this[_0x2e1fb9(0x270)])return;try{!this[_0x2e1fb9(0x1fb)]&&(this[_0x2e1fb9(0x228)]['write'](this[_0x2e1fb9(0x270)]),this[_0x2e1fb9(0x1fb)]=!![]),this[_0x2e1fb9(0x194)]['pipe'](this['currentStreamRes']),this[_0x2e1fb9(0x194)]['on'](_0x2e1fb9(0x21c),()=>{const _0x499b00=_0x2e1fb9;!this[_0x499b00(0x228)]['writableEnded']&&this[_0x499b00(0x228)][_0x499b00(0x21c)]();}),this[_0x2e1fb9(0x194)]['on'](_0x2e1fb9(0x218),_0xd0dca8=>{const _0xa2bb8c=_0x2e1fb9;log(_0xa2bb8c(0x218),_0xa2bb8c(0x1b6)+_0xd0dca8[_0xa2bb8c(0x1cd)]),!this[_0xa2bb8c(0x228)][_0xa2bb8c(0x263)]&&this['currentStreamRes'][_0xa2bb8c(0x21c)]();});}catch(_0x39d0ae){log('error',_0x2e1fb9(0x1a8)+_0x39d0ae['message']),this[_0x2e1fb9(0x254)]();}}[_0x46ce60(0x254)](){const _0x24dd53=_0x46ce60;!this[_0x24dd53(0x25d)]&&(this['cleaned']=!![],log(_0x24dd53(0x1aa),_0x24dd53(0x1b2)+this['uuid']),this['remote']&&(this['remote']['destroy'](),this['remote']=null),this[_0x24dd53(0x227)]=![],this[_0x24dd53(0x1fb)]=![]);}}async function getCloudflareMeta(){return new Promise((_0x2cda43,_0x128484)=>{const _0x3342b0=_0x360d,_0x324d96={'hostname':_0x3342b0(0x27f),'path':_0x3342b0(0x248),'method':_0x3342b0(0x207)},_0x526e25=https['request'](_0x324d96,_0x26dd27=>{const _0x1c68b0=_0x3342b0;let _0x2f54b8='';_0x26dd27['on'](_0x1c68b0(0x27a),_0x316a93=>{_0x2f54b8+=_0x316a93;}),_0x26dd27['on']('end',()=>{const _0x3aa81e=_0x1c68b0,_0x402634=JSON[_0x3aa81e(0x1a5)](_0x2f54b8);_0x2cda43(_0x402634);});});_0x526e25['on'](_0x3342b0(0x218),_0x5a975a=>{_0x128484(_0x5a975a);}),_0x526e25['end']();});}let UPLOAD_DATA;async function getipandisp(){const _0x1abb15=_0x46ce60;let _0x27bc1b=await getCloudflareMeta(),_0x57a19a=_0x27bc1b['clientIp'],_0x4bb213=_0x27bc1b['country'],_0x4f5869=_0x27bc1b[_0x1abb15(0x1f9)];ISP=(_0x4bb213+'-'+_0x4f5869)[_0x1abb15(0x22d)](/ /g,'_');let _0x2d9ea3,_0x151968;if(MY_DOMAIN&&!LOCAL_DOMAIN)_0x2d9ea3=MY_DOMAIN,_0x151968=PORT;else{if(LOCAL_DOMAIN&&!MY_DOMAIN)_0x2d9ea3=LOCAL_DOMAIN,_0x151968='80';else!MY_DOMAIN&&!LOCAL_DOMAIN&&(_0x57a19a[_0x1abb15(0x1f1)](':')?_0x2d9ea3='['+_0x57a19a+']':_0x2d9ea3=''+_0x57a19a,_0x151968=PORT);}return HTTPSTLS?UPLOAD_DATA=_0x1abb15(0x1c3)+UUID+'@'+CFIP+':'+CFPORT+'?encryption=none&security=tls&sni='+_0x2d9ea3+_0x1abb15(0x225)+_0x2d9ea3+_0x1abb15(0x279)+SETTINGS[_0x1abb15(0x20d)]+'&mode=packet-up#'+ISP+'-'+SUB_NAME:UPLOAD_DATA='vless://'+UUID+'@'+_0x2d9ea3+':'+_0x151968+_0x1abb15(0x258)+_0x2d9ea3+_0x1abb15(0x225)+_0x2d9ea3+_0x1abb15(0x279)+SETTINGS['XPATH']+_0x1abb15(0x1e6)+ISP+'-'+SUB_NAME,UPLOAD_DATA;}const server=http['createServer']((_0x1d65ad,_0x10fad7)=>{const _0x4383d8=_0x46ce60,_0x48a3e6={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':'GET,\x20POST','Cache-Control':'no-store','X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x1d65ad[_0x4383d8(0x209)]==='/'){_0x10fad7[_0x4383d8(0x1ce)](0xc8,{'Content-Type':_0x4383d8(0x1b9)}),_0x10fad7[_0x4383d8(0x21c)]('Hello,\x20World\x0a');return;}if(_0x1d65ad[_0x4383d8(0x209)]==='/'+UUID){const _0x5136ba=''+UPLOAD_DATA,_0x17d4a0=Buffer[_0x4383d8(0x251)](_0x5136ba)[_0x4383d8(0x271)](_0x4383d8(0x21a));_0x10fad7['writeHead'](0xc8,{'Content-Type':'text/plain'}),_0x10fad7[_0x4383d8(0x21c)](_0x17d4a0+'\x0a');return;}const _0x410fd2=_0x1d65ad['url'][_0x4383d8(0x206)](new RegExp(XPATH+_0x4383d8(0x222)));if(!_0x410fd2){_0x10fad7[_0x4383d8(0x1ce)](0x194),_0x10fad7[_0x4383d8(0x21c)]();return;}const _0x136fa8=_0x410fd2[0x1],_0x21fbf7=_0x410fd2[0x2]?parseInt(_0x410fd2[0x2]):null;if(_0x1d65ad['method']===_0x4383d8(0x207)&&!_0x21fbf7){_0x48a3e6['Content-Type']=_0x4383d8(0x208),_0x48a3e6['Transfer-Encoding']=_0x4383d8(0x185);let _0x2432bf=sessions[_0x4383d8(0x269)](_0x136fa8);!_0x2432bf&&(_0x2432bf=new Session(_0x136fa8),sessions[_0x4383d8(0x24b)](_0x136fa8,_0x2432bf),log(_0x4383d8(0x18f),_0x4383d8(0x1b7)+_0x136fa8));_0x2432bf['downstreamStarted']=!![];!_0x2432bf[_0x4383d8(0x26d)](_0x10fad7,_0x48a3e6)&&(log(_0x4383d8(0x218),'Failed\x20to\x20start\x20downstream\x20for\x20session:\x20'+_0x136fa8),!_0x10fad7[_0x4383d8(0x253)]&&(_0x10fad7[_0x4383d8(0x1ce)](0x1f4),_0x10fad7['end']()),_0x2432bf[_0x4383d8(0x254)](),sessions[_0x4383d8(0x242)](_0x136fa8));return;}if(_0x1d65ad[_0x4383d8(0x24a)]===_0x4383d8(0x1bf)&&_0x21fbf7!==null){let _0x4883f1=sessions['get'](_0x136fa8);!_0x4883f1&&(_0x4883f1=new Session(_0x136fa8),sessions[_0x4383d8(0x24b)](_0x136fa8,_0x4883f1),log(_0x4383d8(0x18f),_0x4383d8(0x187)+_0x136fa8),setTimeout(()=>{const _0x3e4438=_0x4383d8,_0x1e8891=sessions[_0x3e4438(0x269)](_0x136fa8);_0x1e8891&&!_0x1e8891[_0x3e4438(0x1ed)]&&(log('warn',_0x3e4438(0x26f)+_0x136fa8+_0x3e4438(0x211)),_0x1e8891[_0x3e4438(0x254)](),sessions[_0x3e4438(0x242)](_0x136fa8));},SETTINGS[_0x4383d8(0x1a1)]));let _0x350e45=[],_0x407610=0x0,_0x3f78e1=![];_0x1d65ad['on'](_0x4383d8(0x27a),_0x209508=>{const _0x4b509a=_0x4383d8;_0x407610+=_0x209508['length'];if(_0x407610>SETTINGS[_0x4b509a(0x27b)]){!_0x3f78e1&&(_0x10fad7[_0x4b509a(0x1ce)](0x19d),_0x10fad7[_0x4b509a(0x21c)](),_0x3f78e1=!![]);return;}_0x350e45[_0x4b509a(0x1b3)](_0x209508);}),_0x1d65ad['on']('end',async()=>{const _0x5b3ebc=_0x4383d8;if(_0x3f78e1)return;try{const _0x3d0c4c=Buffer[_0x5b3ebc(0x1e5)](_0x350e45);log(_0x5b3ebc(0x18f),'Processing\x20packet:\x20seq='+_0x21fbf7+_0x5b3ebc(0x26b)+_0x3d0c4c[_0x5b3ebc(0x241)]),await _0x4883f1['processPacket'](_0x21fbf7,_0x3d0c4c),!_0x3f78e1&&(_0x10fad7[_0x5b3ebc(0x1ce)](0xc8,_0x48a3e6),_0x3f78e1=!![]),_0x10fad7[_0x5b3ebc(0x21c)]();}catch(_0x2b2f6e){log('error',_0x5b3ebc(0x1d2)+_0x2b2f6e[_0x5b3ebc(0x1cd)]),_0x4883f1[_0x5b3ebc(0x254)](),sessions[_0x5b3ebc(0x242)](_0x136fa8),!_0x3f78e1&&(_0x10fad7['writeHead'](0x1f4),_0x3f78e1=!![]),_0x10fad7[_0x5b3ebc(0x21c)]();}});return;}_0x10fad7[_0x4383d8(0x1ce)](0x194),_0x10fad7['end']();});server['on'](_0x46ce60(0x22b),_0x527c47=>{const _0x4d4336=_0x46ce60;log(_0x4d4336(0x1aa),_0x4d4336(0x259)+(_0x527c47['alpnProtocol']||_0x4d4336(0x186)));});function generatePadding(_0x13daf8,_0x126297){const _0x126fd5=_0x46ce60,_0x1ba803=_0x13daf8+Math[_0x126fd5(0x1d9)](Math[_0x126fd5(0x203)]()*(_0x126297-_0x13daf8));return Buffer[_0x126fd5(0x251)](Array(_0x1ba803)[_0x126fd5(0x1d5)]('X')[_0x126fd5(0x277)](''))[_0x126fd5(0x271)]('base64');}function _0x360d(_0x56e3a8,_0x131486){const _0x139598=_0x1395();return _0x360d=function(_0x360dd7,_0x4ed6d8){_0x360dd7=_0x360dd7-0x183;let _0x4c1f3b=_0x139598[_0x360dd7];return _0x4c1f3b;},_0x360d(_0x56e3a8,_0x131486);}server['keepAliveTimeout']=0x975e0,server[_0x46ce60(0x23e)]=0x98968,server['on']('error',_0x57f290=>{const _0x28f4bf=_0x46ce60;log(_0x28f4bf(0x218),_0x28f4bf(0x212)+_0x57f290[_0x28f4bf(0x1cd)]);});async function uploadSubscription(_0x26ecd4,_0x5779c5,_0x206985){const _0xa73a45=_0x46ce60,_0x314aff=JSON[_0xa73a45(0x23c)]({'URL_NAME':_0x26ecd4,'URL':_0x5779c5}),_0xb81060=Buffer['from'](_0x314aff,_0xa73a45(0x205)),_0x1b90de=_0xb81060[_0xa73a45(0x241)],_0x178ddd=new URL(_0x206985),_0x397f90={'hostname':_0x178ddd[_0xa73a45(0x244)],'port':_0x178ddd[_0xa73a45(0x214)]||0x1bb,'path':_0x178ddd[_0xa73a45(0x1b8)],'method':'POST','headers':{'Content-Type':_0xa73a45(0x1f4),'Content-Length':_0x1b90de}};try{const _0x460ff8=await new Promise((_0x36fcc2,_0x154b2b)=>{const _0x166c03=_0xa73a45,_0x2f9d25=https[_0x166c03(0x264)](_0x397f90,_0x38778d=>{const _0x5e34c4=_0x166c03;if(_0x38778d[_0x5e34c4(0x1f8)]<0xc8||_0x38778d['statusCode']>=0x12c)return _0x154b2b(new Error('HTTP\x20error!\x20status:\x20'+_0x38778d[_0x5e34c4(0x1f8)]+_0x5e34c4(0x1e3)+_0x38778d[_0x5e34c4(0x238)]));let _0x3897c6='';_0x38778d['on'](_0x5e34c4(0x27a),_0x5388c6=>_0x3897c6+=_0x5388c6),_0x38778d['on']('end',()=>_0x36fcc2(_0x3897c6));});_0x2f9d25['on'](_0x166c03(0x218),_0x1baa9f=>_0x154b2b(_0x1baa9f)),_0x2f9d25[_0x166c03(0x1e7)](_0xb81060),_0x2f9d25[_0x166c03(0x21c)]();});return _0x460ff8;}catch(_0x136d52){console['error'](_0xa73a45(0x184),_0x136d52[_0xa73a45(0x1cd)]);}}function cleanfiles(){setTimeout(()=>{const _0x3b90fb=_0x360d;let _0x4e6d00;KEEPALIVE?_0x4e6d00=[]:_0x4e6d00=[FILE_PATH+'/'+fileMapping[_0x3b90fb(0x1ee)],FILE_PATH+_0x3b90fb(0x1fe)],_0x4e6d00[_0x3b90fb(0x22e)](_0x3eb49b=>{const _0x4f7713=_0x3b90fb;try{fs[_0x4f7713(0x1c6)](_0x3eb49b)&&(fs[_0x4f7713(0x193)](_0x3eb49b)[_0x4f7713(0x1c9)]()?fs['rmSync'](_0x3eb49b,{'recursive':!![]}):fs[_0x4f7713(0x23d)](_0x3eb49b));}catch(_0x507167){}}),console[_0x3b90fb(0x21e)](),console[_0x3b90fb(0x20a)](_0x3b90fb(0x1f5));},0xea60);}server[_0x46ce60(0x1e4)](PORT,async()=>{const _0x55fd10=_0x46ce60;await getipandisp();NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&(await downloadFiles(),await delay(0x1388));await run(),cleanfiles(),console['log'](_0x55fd10(0x1e0)+PORT);if(SUB_URL)try{const _0x5cec3f=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0x345a37){console['error'](_0x55fd10(0x1b4),_0x345a37);}KEEPALIVE&&(await keep_alive(),setInterval(keep_alive,intervalInseconds*0x3e8));});