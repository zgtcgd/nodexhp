const _0x46e744=_0x54e9;(function(_0x30ac62,_0x47d519){const _0x3acb1f=_0x54e9,_0xc60f8d=_0x30ac62();while(!![]){try{const _0x51284e=-parseInt(_0x3acb1f(0x254))/0x1*(parseInt(_0x3acb1f(0x211))/0x2)+parseInt(_0x3acb1f(0x24c))/0x3+-parseInt(_0x3acb1f(0x242))/0x4+-parseInt(_0x3acb1f(0x1f6))/0x5+-parseInt(_0x3acb1f(0x1bc))/0x6*(parseInt(_0x3acb1f(0x2a0))/0x7)+parseInt(_0x3acb1f(0x24d))/0x8+parseInt(_0x3acb1f(0x285))/0x9;if(_0x51284e===_0x47d519)break;else _0xc60f8d['push'](_0xc60f8d['shift']());}catch(_0x48a064){_0xc60f8d['push'](_0xc60f8d['shift']());}}}(_0x2daa,0x5740c));const os=require('os'),fs=require('fs'),net=require(_0x46e744(0x298)),path=require(_0x46e744(0x1b6)),http=require(_0x46e744(0x1b5)),https=require(_0x46e744(0x294)),axios=require('axios'),{Buffer}=require(_0x46e744(0x2ac)),{exec,execSync}=require(_0x46e744(0x26c)),FILE_PATH=process[_0x46e744(0x29a)]['FILE_PATH']||'/tmp',SUB_PATH=process['env']['SUB_PATH']||_0x46e744(0x231),PORT=process[_0x46e744(0x29a)][_0x46e744(0x1ce)]||0xbb8,CFPORT=process[_0x46e744(0x29a)]['CFPORT']||0x1bb,delay=_0x4f4172=>new Promise(_0x5d0461=>setTimeout(_0x5d0461,_0x4f4172)),SUB_URL=process[_0x46e744(0x29a)]['SUB_URL']||'',UUID=process[_0x46e744(0x29a)][_0x46e744(0x1e2)]||'',XPATH=process[_0x46e744(0x29a)][_0x46e744(0x1f2)]||UUID[_0x46e744(0x2a4)](0x0,0x8),HTTPSTLS=process['env'][_0x46e744(0x2a9)]||_0x46e744(0x20c),NEZHA_VERSION=process['env'][_0x46e744(0x217)]||'V0',NEZHA_SERVER=process[_0x46e744(0x29a)]['NEZHA_SERVER']||'',NEZHA_PORT=process[_0x46e744(0x29a)][_0x46e744(0x1f7)]||_0x46e744(0x256),NEZHA_KEY=process[_0x46e744(0x29a)][_0x46e744(0x1b7)]||'',SUB_NAME=process[_0x46e744(0x29a)][_0x46e744(0x282)]||'',MY_DOMAIN=process['env'][_0x46e744(0x1c7)]||'',SETTINGS={[_0x46e744(0x1e2)]:UUID,[_0x46e744(0x270)]:_0x46e744(0x1de),[_0x46e744(0x24b)]:_0x46e744(0x216),[_0x46e744(0x1f2)]:_0x46e744(0x1d6)+XPATH,[_0x46e744(0x251)]:0x1e,[_0x46e744(0x268)]:0xf4240,['SESSION_TIMEOUT']:0x7530,[_0x46e744(0x25a)]:0x400*0x400,[_0x46e744(0x284)]:!![],[_0x46e744(0x209)]:!![]};function validate_uuid(_0x54d5e0,_0x5a7c66){for(let _0x143ab6=0x0;_0x143ab6<0x10;_0x143ab6++){if(_0x54d5e0[_0x143ab6]!==_0x5a7c66[_0x143ab6])return![];}return!![];}function concat_typed_arrays(_0x383e59,..._0x598ef0){const _0x253734=_0x46e744;if(!_0x598ef0||_0x598ef0['length']<0x1)return _0x383e59;let _0x42ebef=_0x383e59[_0x253734(0x234)];for(let _0x40114e of _0x598ef0)_0x42ebef+=_0x40114e[_0x253734(0x234)];const _0x352a42=new _0x383e59['constructor'](_0x42ebef);_0x352a42[_0x253734(0x25f)](_0x383e59,0x0),_0x42ebef=_0x383e59[_0x253734(0x234)];for(let _0x67e03e of _0x598ef0){_0x352a42[_0x253734(0x25f)](_0x67e03e,_0x42ebef),_0x42ebef+=_0x67e03e[_0x253734(0x234)];}return _0x352a42;}function log(_0x3aad9e,..._0xcc5d6){const _0x2899db=_0x46e744;if(SETTINGS['LOG_LEVEL']===_0x2899db(0x1de))return;const _0x2b3786={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x2ee731={'debug':_0x2899db(0x23f),'info':_0x2899db(0x25b),'warn':_0x2899db(0x222),'error':_0x2899db(0x22f),'reset':_0x2899db(0x265)},_0x12532c=_0x2b3786[SETTINGS['LOG_LEVEL']]||0x1,_0x1d1a16=_0x2b3786[_0x3aad9e]||0x0;if(_0x1d1a16>=_0x12532c){const _0x1c9327=new Date()[_0x2899db(0x1ef)](),_0x198e82=_0x2ee731[_0x3aad9e]||_0x2ee731[_0x2899db(0x248)];console['log'](_0x198e82+'['+_0x1c9327+_0x2899db(0x2af)+_0x3aad9e+']',..._0xcc5d6,_0x2ee731[_0x2899db(0x248)]);}}function createFolder(_0x1e9ccc){const _0x148548=_0x46e744;if(!fs[_0x148548(0x1fc)](_0x1e9ccc))fs[_0x148548(0x258)](_0x1e9ccc);else{}}function generateRandomString(_0xfa4942){const _0x5cfc52=_0x46e744,_0x535285=_0x5cfc52(0x1d0);let _0x3e7e55='';for(let _0x5b581a=0x0;_0x5b581a<_0xfa4942;_0x5b581a++){_0x3e7e55+=_0x535285['charAt'](Math['floor'](Math[_0x5cfc52(0x1bb)]()*_0x535285[_0x5cfc52(0x234)]));}return _0x3e7e55;}function getSystemArchitecture(){const _0x2682be=_0x46e744,_0x586012=os[_0x2682be(0x259)]();return _0x586012===_0x2682be(0x283)||_0x586012===_0x2682be(0x1cd)||_0x586012==='aarch64'?_0x2682be(0x283):_0x2682be(0x1ed);}function getFilesForArchitecture(_0x37c070){const _0x3e448c=_0x46e744,_0x5193f6={'npm':{'V0':{'arm':_0x3e448c(0x23c),'amd':_0x3e448c(0x1cf)},'V1':{'arm':_0x3e448c(0x287),'amd':_0x3e448c(0x28b)}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0x293e97=[{'fileName':generateRandomString(0x5),'originalName':_0x3e448c(0x29f),'fileUrl':_0x5193f6[_0x3e448c(0x29f)][NEZHA_VERSION][_0x37c070]}];return _0x293e97;}else return[];}function authorizeFiles(_0x4c5e40){const _0x40aa94=_0x46e744,_0x4c7a64=0x1fd;_0x4c5e40[_0x40aa94(0x1db)](_0x2f53db=>{const _0x52ec9f=_0x40aa94,_0x5c21e7=path[_0x52ec9f(0x1eb)](FILE_PATH,_0x2f53db[_0x52ec9f(0x1f3)]);fs['chmod'](_0x5c21e7,_0x4c7a64,_0x41a5f0=>{const _0x347145=_0x52ec9f;_0x41a5f0?console[_0x347145(0x224)]('Empowerment\x20failed\x20for\x20'+_0x5c21e7+'\x20('+_0x2f53db[_0x347145(0x275)]+_0x347145(0x221)+_0x41a5f0):console[_0x347145(0x279)](_0x347145(0x28e)+_0x5c21e7+'\x20('+_0x2f53db[_0x347145(0x275)]+_0x347145(0x221)+_0x4c7a64[_0x347145(0x288)](0x8));});});}function download_function(_0x1bd5a8,_0x3c63a3,_0x22235a,_0x2164b2){const _0x4c0df9=_0x46e744,_0x51cb66=path[_0x4c0df9(0x1eb)](FILE_PATH,_0x1bd5a8);if(fs['existsSync'](_0x51cb66)){console[_0x4c0df9(0x279)](_0x4c0df9(0x1f1)+_0x3c63a3+_0x4c0df9(0x299)+_0x1bd5a8+')\x20already\x20exists,\x20skipping\x20download.'),_0x2164b2(null,{'fileName':_0x1bd5a8,'originalName':_0x3c63a3});return;}const _0x3af898=fs[_0x4c0df9(0x290)](_0x51cb66);axios({'method':_0x4c0df9(0x27c),'url':_0x22235a,'responseType':_0x4c0df9(0x240)})[_0x4c0df9(0x292)](_0x57a01a=>{const _0x2d9dcb=_0x4c0df9;_0x57a01a[_0x2d9dcb(0x25c)][_0x2d9dcb(0x22c)](_0x3af898),_0x3af898['on'](_0x2d9dcb(0x23b),()=>{const _0x424b37=_0x2d9dcb;_0x3af898[_0x424b37(0x23a)](),console[_0x424b37(0x279)]('Download\x20'+_0x3c63a3+_0x424b37(0x299)+_0x1bd5a8+_0x424b37(0x1c5)),_0x2164b2(null,{'fileName':_0x1bd5a8,'originalName':_0x3c63a3});}),_0x3af898['on']('error',_0x6437bd=>{const _0x57cb62=_0x2d9dcb;fs['unlink'](_0x51cb66,()=>{});const _0x1ec66b=_0x57cb62(0x25e)+_0x3c63a3+_0x57cb62(0x299)+_0x1bd5a8+')\x20failed:\x20'+_0x6437bd['message'];console['error'](_0x1ec66b),_0x2164b2(_0x1ec66b);});})[_0x4c0df9(0x2a1)](_0x57fb22=>{const _0x2ad8bb=_0x4c0df9,_0x1ae0af=_0x2ad8bb(0x25e)+_0x3c63a3+'\x20(renamed\x20to\x20'+_0x1bd5a8+')\x20failed:\x20'+_0x57fb22['message'];console['error'](_0x1ae0af),_0x2164b2(_0x1ae0af);});}let fileMapping={};async function downloadFiles(){const _0x5599e1=_0x46e744;try{const _0x42a052=getSystemArchitecture(),_0x1434d3=getFilesForArchitecture(_0x42a052);if(_0x1434d3['length']===0x0){console[_0x5599e1(0x279)](_0x5599e1(0x21c));return;}const _0x225044=_0x1434d3[_0x5599e1(0x277)](_0x8422af=>new Promise((_0x73d319,_0x36fd7b)=>{const _0x448af7=_0x5599e1;download_function(_0x8422af['fileName'],_0x8422af['originalName'],_0x8422af[_0x448af7(0x27a)],(_0x5aede1,_0x139215)=>{if(_0x5aede1)_0x36fd7b(_0x5aede1);else _0x73d319(_0x139215);});})),_0x4e50f0=await Promise[_0x5599e1(0x25d)](_0x225044);return await authorizeFiles(_0x4e50f0),_0x4e50f0['forEach'](_0x441545=>{fileMapping[_0x441545['originalName']]=_0x441545['fileName'];}),fileMapping;}catch(_0xb3e8c3){return console[_0x5599e1(0x224)](_0x5599e1(0x241),_0xb3e8c3),fileMapping;}}let NEZHA_TLS='';function nezv1config(){const _0x253ee6=_0x46e744,_0x415593=_0x253ee6(0x2aa)+NEZHA_KEY+'\x0a\x20\x20\x20\x20debug:\x20false\x0a\x20\x20\x20\x20disable_auto_update:\x20true\x0a\x20\x20\x20\x20disable_command_execute:\x20false\x0a\x20\x20\x20\x20disable_force_update:\x20true\x0a\x20\x20\x20\x20disable_nat:\x20false\x0a\x20\x20\x20\x20disable_send_query:\x20false\x0a\x20\x20\x20\x20gpu:\x20false\x0a\x20\x20\x20\x20insecure_tls:\x20false\x0a\x20\x20\x20\x20ip_report_period:\x201800\x0a\x20\x20\x20\x20report_delay:\x204\x0a\x20\x20\x20\x20server:\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x253ee6(0x26e)+NEZHA_TLS+_0x253ee6(0x212)+UUID+_0x253ee6(0x280),_0x102bb5=path[_0x253ee6(0x1eb)](FILE_PATH,_0x253ee6(0x276));try{fs['writeFileSync'](_0x102bb5,_0x415593),console[_0x253ee6(0x279)](_0x253ee6(0x204));}catch(_0x202d25){console[_0x253ee6(0x224)]('Error\x20creating\x20or\x20writing\x20config.yml\x20file:',_0x202d25);}}function _0x2daa(){const _0x44ca63=['abcdefghijklmnopqrstuvwxyz0123456789','finally','read\x20address\x20type\x20failed','Server\x20is\x20running\x20on\x20port\x20','Failed\x20to\x20process\x20POST\x20request:\x20','2053','%2F','&mode=packet-up#','&fp=chrome&allowInsecure=1&type=xhttp&host=','lstatSync','Processing\x20packet:\x20seq=','forEach','_startDownstreamResponse','?encryption=none&security=tls&sni=','none','debug','SESSION_TIMEOUT','Remote\x20connection\x20not\x20available','UUID','destroyed','GET,\x20POST','substr','Failed\x20to\x20initialize\x20VLESS:\x20','Session\x20','setNoDelay','releaseLock','replaceAll','join','has','amd','Remote\x20error:\x20','toISOString','Download\x20error:\x20','File\x20','XPATH','fileName','Failed\x20to\x20parse\x20hostname','Content-Type','2316335ZiRdBd','NEZHA_PORT','Created\x20new\x20session\x20with\x20UUID:\x20','Cleanup\x20error:\x20','socket\x20hang\x20up','from','existsSync','VLESS\x20header\x20parsed\x20successfully','method','Process\x20packet\x20error:\x20','localhost','alpnProtocol','application/octet-stream','nextTick','config.yml\x20file\x20created\x20and\x20written\x20successfully.','headerSent','headersTimeout','enqueue','reduce','TCP_KEEPALIVE','remote','readable','true','base64','Connection\x20failed:\x20','curl\x20-s\x20--max-time\x202\x20ipv4.ip.sb','downstreamStarted','4rjogEU','\x0a\x20\x20\x20\x20use_gitee_to_upgrade:\x20false\x0a\x20\x20\x20\x20use_ipv6_country_code:\x20false\x0a\x20\x20\x20\x20uuid:\x20','fill','_writeToRemote','startDownstream','2048','NEZHA_VERSION','aborted','pendingBuffers','Buffered\x20packet\x20seq=','request','Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture','done','Server\x20error:\x20','Created\x20new\x20session\x20for\x20GET:\x20','Client\x20connection\x20closed','):\x20','\x1b[33m','curl\x20-s\x20--max-time\x201\x20ipv6.ip.sb','error','port','&path=','--tls','cleanup','Sending\x20VLESS\x20response\x20header\x20(','delete','currentStreamRes','pipe','url','Cleaning\x20up\x20session\x20','\x1b[31m','writeHead','sub','match','unsupported\x20command:\x20','length','includes','resp','vless://','writableEnded','initialized','close','finish','https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','rmSync','createConnection','\x1b[36m','stream','Error\x20downloading\x20files:','566864NIHUnU','POST','\x20before\x20initialization','cork','isDirectory','/([^/]+)(?:/([0-9]+))?$','reset','connect\x20timeout','uncork','BUFFER_SIZE','1132194lKxRSN','215712UlZUfe','/config.yml\x20>\x20/dev/null\x202>&1\x20&','cleaned','push','MAX_BUFFERED_POSTS','header\x20length\x20too\x20short','statusCode','204641ywHJhJ','end','443','http/1.1','mkdirSync','arch','CHUNK_SIZE','\x1b[32m','data','all','Download\x20','set','secureConnection','connect','Failed\x20to\x20initialize\x20VLESS\x20connection','processPacket','info','\x1b[0m','bufferSize','Received\x20out\x20of\x20order\x20packet\x20seq=','MAX_POST_SIZE','vlessHeader','Too\x20many\x20buffered\x20packets','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','child_process','nextSeq','\x0a\x20\x20\x20\x20skip_connection_count:\x20false\x0a\x20\x20\x20\x20skip_procs_count:\x20false\x0a\x20\x20\x20\x20temperature:\x20false\x0a\x20\x20\x20\x20tls:\x20','\x20>\x20/dev/null\x202>&1\x20&','LOG_LEVEL','keepAliveTimeout','uuid','listen','timeout','originalName','/config.yml','map','initializeVLESS','log','fileUrl','bufferedData','get','message','getReader','2087','\x0a\x20\x20\x20\x20','GET','SUB_NAME','arm','TCP_NODELAY','9437976JIvSnB','Hello,\x20World\x0a','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','toString','\x20-s\x20','responseHeader','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1','?encryption=none&security=none&sni=','setKeepAlive','Empowerment\x20success\x20for\x20','\x20running\x20error:\x20','createWriteStream','not\x20enough\x20data\x20to\x20read','then','parse\x20hostname\x20failed','https','VLESS\x20header\x20parse\x20error:\x20','destroy','application/json','net','\x20(renamed\x20to\x20','env','hostname','Error\x20starting\x20downstream:\x20','false','Relay\x20error:','npm','569611jxZEoN','catch','read','text/plain','slice','socket','\x20is\x20running','\x20-p\x20','2083','HTTPSTLS','\x0a\x20\x20\x20\x20client_secret:\x20','getWriter','buffer','read\x20vless\x20header\x20error:\x20','Starting\x20to\x20parse\x20VLESS\x20header',']\x20[','http','path','NEZHA_KEY','value','New\x20secure\x20connection\x20using:\x20','App\x20is\x20running','random','6Ehyplj','Failed\x20to\x20write\x20to\x20remote:\x20','invalid\x20UUID','concat','\x20bytes','trim','write','\x20variable\x20is\x20empty,skip\x20running',',\x20size=',')\x20successfully','Socket\x20error:','MY_DOMAIN','resume','lastActivity','writable','decode','utf-8','arm64','PORT','https://github.com/kahunama/myfile/releases/download/main/nezha-agent'];_0x2daa=function(){return _0x44ca63;};return _0x2daa();}async function runapp(){const _0x123278=_0x46e744;if(fileMapping['npm']&&fs[_0x123278(0x1fc)](path['join'](FILE_PATH,fileMapping[_0x123278(0x29f)]))){const _0x421f09=[_0x123278(0x256),'8443','2096',_0x123278(0x27f),_0x123278(0x2a8),_0x123278(0x1d5)];if(NEZHA_VERSION==='V0'){if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){_0x421f09[_0x123278(0x235)](NEZHA_PORT)?NEZHA_TLS=_0x123278(0x227):NEZHA_TLS='';const _0xa55f43='nohup\x20'+FILE_PATH+'/'+fileMapping[_0x123278(0x29f)]+_0x123278(0x289)+NEZHA_SERVER+':'+NEZHA_PORT+_0x123278(0x2a7)+NEZHA_KEY+'\x20'+NEZHA_TLS+_0x123278(0x26f);try{await exec(_0xa55f43),console['log'](fileMapping[_0x123278(0x29f)]+'\x20is\x20running'),await delay(0x3e8);}catch(_0x4abae6){console[_0x123278(0x224)](fileMapping[_0x123278(0x29f)]+'\x20running\x20error:\x20'+_0x4abae6);}}else console[_0x123278(0x279)](fileMapping[_0x123278(0x29f)]+_0x123278(0x1c3));}else{if(NEZHA_VERSION==='V1'){if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){_0x421f09['includes'](NEZHA_PORT)?NEZHA_TLS=_0x123278(0x20c):NEZHA_TLS=_0x123278(0x29d);nezv1config();const _0x109151='nohup\x20'+FILE_PATH+'/'+fileMapping[_0x123278(0x29f)]+'\x20-c\x20'+FILE_PATH+_0x123278(0x24e);try{await exec(_0x109151),console['log'](fileMapping[_0x123278(0x29f)]+_0x123278(0x2a6)),await delay(0x3e8);}catch(_0x5aa15f){console[_0x123278(0x224)](fileMapping[_0x123278(0x29f)]+_0x123278(0x28f)+_0x5aa15f);}}else console[_0x123278(0x279)](fileMapping[_0x123278(0x29f)]+_0x123278(0x1c3));}}}}function parse_uuid(_0x1e5d42){const _0x27c5fb=_0x46e744;_0x1e5d42=_0x1e5d42[_0x27c5fb(0x1ea)]('-','');const _0x37ba07=[];for(let _0x1ebdb4=0x0;_0x1ebdb4<0x10;_0x1ebdb4++){_0x37ba07[_0x27c5fb(0x250)](parseInt(_0x1e5d42[_0x27c5fb(0x1e5)](_0x1ebdb4*0x2,0x2),0x10));}return _0x37ba07;}async function read_vless_header(_0x562aea,_0x2bae84){const _0x4c3ba3=_0x46e744;let _0x6d529c=0x0,_0x3a05f0=new Uint8Array(),_0x2b3776={'value':_0x3a05f0,'done':![]};async function _0x44487e(_0x407895){const _0x2535f2=_0x54e9;if(_0x2b3776[_0x2535f2(0x21d)])throw new Error(_0x2535f2(0x252));const _0x4bd660=_0x407895-_0x6d529c;if(_0x4bd660<0x1)return;_0x2b3776=await read_atleast(_0x562aea,_0x4bd660),_0x6d529c+=_0x2b3776[_0x2535f2(0x1b8)][_0x2535f2(0x234)],_0x3a05f0=concat_typed_arrays(_0x3a05f0,_0x2b3776['value']);}await _0x44487e(0x1+0x10+0x1);const _0x103187=_0x3a05f0[0x0],_0xc9445c=_0x3a05f0[_0x4c3ba3(0x2a4)](0x1,0x1+0x10),_0x372d16=parse_uuid(_0x2bae84);if(!validate_uuid(_0xc9445c,_0x372d16))throw new Error(_0x4c3ba3(0x1be));const _0x3ca95e=_0x3a05f0[0x1+0x10],_0x330b11=0x1+0x10+0x1+_0x3ca95e+0x1+0x2+0x1;await _0x44487e(_0x330b11+0x1);const _0x37f9b4=_0x3a05f0[0x1+0x10+0x1+_0x3ca95e],_0x4ee2cf=0x1;if(_0x37f9b4!==_0x4ee2cf)throw new Error(_0x4c3ba3(0x233)+_0x37f9b4);const _0x46f9b7=(_0x3a05f0[_0x330b11-0x1-0x2]<<0x8)+_0x3a05f0[_0x330b11-0x1-0x1],_0x4db669=_0x3a05f0[_0x330b11-0x1],_0x51ccd5=0x1,_0x10d155=0x2,_0x1d2967=0x3;let _0x1fcdc7=-0x1;if(_0x4db669===_0x51ccd5)_0x1fcdc7=_0x330b11+0x4;else{if(_0x4db669===_0x1d2967)_0x1fcdc7=_0x330b11+0x10;else _0x4db669===_0x10d155&&(_0x1fcdc7=_0x330b11+0x1+_0x3a05f0[_0x330b11]);}if(_0x1fcdc7<0x0)throw new Error(_0x4c3ba3(0x1d2));await _0x44487e(_0x1fcdc7);const _0x4a2b50=_0x330b11;let _0x52b9e5='';if(_0x4db669===_0x51ccd5)_0x52b9e5=_0x3a05f0[_0x4c3ba3(0x2a4)](_0x4a2b50,_0x4a2b50+0x4)[_0x4c3ba3(0x1eb)]('.');else{if(_0x4db669===_0x10d155)_0x52b9e5=new TextDecoder()[_0x4c3ba3(0x1cb)](_0x3a05f0[_0x4c3ba3(0x2a4)](_0x4a2b50+0x1,_0x4a2b50+0x1+_0x3a05f0[_0x4a2b50]));else _0x4db669===_0x1d2967&&(_0x52b9e5=_0x3a05f0['slice'](_0x4a2b50,_0x4a2b50+0x10)[_0x4c3ba3(0x208)]((_0x332e18,_0x443217,_0xc15ba,_0x518692)=>_0xc15ba%0x2?_0x332e18[_0x4c3ba3(0x1bf)](((_0x518692[_0xc15ba-0x1]<<0x8)+_0x443217)[_0x4c3ba3(0x288)](0x10)):_0x332e18,[])[_0x4c3ba3(0x1eb)](':'));}if(!_0x52b9e5){log('error',_0x4c3ba3(0x1f4));throw new Error(_0x4c3ba3(0x293));}return log(_0x4c3ba3(0x264),'VLESS\x20connection\x20to\x20'+_0x52b9e5+':'+_0x46f9b7),{'hostname':_0x52b9e5,'port':_0x46f9b7,'data':_0x3a05f0[_0x4c3ba3(0x2a4)](_0x1fcdc7),'resp':new Uint8Array([_0x103187,0x0])};}async function read_atleast(_0x3f6823,_0xb4c70f){const _0x312622=_0x46e744,_0x38e0aa=[];let _0xd29e7a=![];while(_0xb4c70f>0x0&&!_0xd29e7a){const _0x20e136=await _0x3f6823[_0x312622(0x2a2)]();if(_0x20e136['value']){const _0x168c01=new Uint8Array(_0x20e136[_0x312622(0x1b8)]);_0x38e0aa[_0x312622(0x250)](_0x168c01),_0xb4c70f-=_0x168c01[_0x312622(0x234)];}_0xd29e7a=_0x20e136[_0x312622(0x21d)];}if(_0xb4c70f>0x0)throw new Error(_0x312622(0x291));return{'value':concat_typed_arrays(..._0x38e0aa),'done':_0xd29e7a};}async function parse_header(_0x22e327,_0x57b243){const _0x2366de=_0x46e744;log(_0x2366de(0x1df),_0x2366de(0x2ae));const _0x45ddf6=_0x57b243[_0x2366de(0x20b)][_0x2366de(0x27e)]();try{const _0x1dd0f6=await read_vless_header(_0x45ddf6,_0x22e327);return log(_0x2366de(0x1df),_0x2366de(0x1fd)),_0x1dd0f6;}catch(_0x387b1f){log(_0x2366de(0x224),_0x2366de(0x295)+_0x387b1f[_0x2366de(0x27d)]);throw new Error(_0x2366de(0x2ad)+_0x387b1f[_0x2366de(0x27d)]);}finally{_0x45ddf6[_0x2366de(0x1e9)]();}}async function connect_remote(_0x536eed,_0x4a2d21){const _0x27de04=_0x46e744,_0x11cf2d=0x1f40;try{const _0x90e1e8=await timed_connect(_0x536eed,_0x4a2d21,_0x11cf2d);return _0x90e1e8[_0x27de04(0x1e8)](!![]),_0x90e1e8[_0x27de04(0x28d)](!![],0x3e8),_0x90e1e8[_0x27de04(0x266)]=parseInt(SETTINGS[_0x27de04(0x24b)])*0x400,log(_0x27de04(0x264),'Connected\x20to\x20'+_0x536eed+':'+_0x4a2d21),_0x90e1e8;}catch(_0x1d51e5){log('error',_0x27de04(0x20e)+_0x1d51e5[_0x27de04(0x27d)]);throw _0x1d51e5;}}function timed_connect(_0x563e88,_0x1f2f15,_0xae5f59){return new Promise((_0x349b5e,_0x5f387b)=>{const _0x14abb6=_0x54e9,_0x5f1e4a=net[_0x14abb6(0x23e)]({'host':_0x563e88,'port':_0x1f2f15}),_0x2f312c=setTimeout(()=>{const _0x2d9622=_0x14abb6;_0x5f387b(new Error(_0x2d9622(0x249)));},_0xae5f59);_0x5f1e4a['on'](_0x14abb6(0x261),()=>{clearTimeout(_0x2f312c),_0x349b5e(_0x5f1e4a);}),_0x5f1e4a['on'](_0x14abb6(0x224),_0x4f60b4=>{clearTimeout(_0x2f312c),_0x5f387b(_0x4f60b4);});});}function pipe_relay(){async function _0x55ef3d(_0xbfa2bb,_0xbf5ac5,_0x378ac3){const _0x5f3c37=_0x54e9,_0x47f20a=parseInt(SETTINGS[_0x5f3c37(0x25a)]);if(_0x378ac3['length']>0x0){if(_0xbf5ac5[_0x5f3c37(0x1c2)])_0xbf5ac5[_0x5f3c37(0x245)](),_0xbf5ac5[_0x5f3c37(0x1c2)](_0x378ac3),process[_0x5f3c37(0x203)](()=>_0xbf5ac5[_0x5f3c37(0x24a)]());else{const _0x4fa893=_0xbf5ac5['writable'][_0x5f3c37(0x2ab)]();try{await _0x4fa893[_0x5f3c37(0x1c2)](_0x378ac3);}finally{_0x4fa893['releaseLock']();}}}try{_0xbfa2bb['pipe']?(_0xbfa2bb['pause'](),_0xbfa2bb[_0x5f3c37(0x22c)](_0xbf5ac5,{'end':!![],'highWaterMark':_0x47f20a}),_0xbfa2bb[_0x5f3c37(0x1c8)]()):await _0xbfa2bb[_0x5f3c37(0x20b)]['pipeTo'](_0xbf5ac5[_0x5f3c37(0x1ca)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x5f3c37(0x274)](SETTINGS[_0x5f3c37(0x1e0)])});}catch(_0x52abc8){!_0x52abc8[_0x5f3c37(0x27d)][_0x5f3c37(0x235)](_0x5f3c37(0x218))&&log('error',_0x5f3c37(0x29e),_0x52abc8[_0x5f3c37(0x27d)]);throw _0x52abc8;}}return _0x55ef3d;}function socketToWebStream(_0x229691){const _0x509eda=_0x46e744;let _0x5c64ee,_0x54dc53;return _0x229691['on'](_0x509eda(0x224),_0x2acb39=>{const _0x4823f4=_0x509eda;log(_0x4823f4(0x224),_0x4823f4(0x1c6),_0x2acb39[_0x4823f4(0x27d)]),_0x5c64ee?.[_0x4823f4(0x224)](_0x2acb39),_0x54dc53?.['error'](_0x2acb39);}),{'readable':new ReadableStream({'start'(_0x205213){const _0x1d6d48=_0x509eda;_0x5c64ee=_0x205213,_0x229691['on'](_0x1d6d48(0x25c),_0x19e846=>{const _0x25d566=_0x1d6d48;try{_0x205213[_0x25d566(0x207)](_0x19e846);}catch(_0x2268dd){log(_0x25d566(0x224),'Read\x20controller\x20error:',_0x2268dd[_0x25d566(0x27d)]);}}),_0x229691['on']('end',()=>{const _0x907089=_0x1d6d48;try{_0x205213['close']();}catch(_0xd74561){log(_0x907089(0x224),'Read\x20controller\x20close\x20error:',_0xd74561['message']);}});},'cancel'(){const _0x591768=_0x509eda;_0x229691[_0x591768(0x296)]();}}),'writable':new WritableStream({'start'(_0x41ecc6){_0x54dc53=_0x41ecc6;},'write'(_0x557cc8){return new Promise((_0x4886db,_0x5adf77)=>{const _0x34b10a=_0x54e9;if(_0x229691[_0x34b10a(0x1e3)]){_0x5adf77(new Error('Socket\x20is\x20destroyed'));return;}_0x229691[_0x34b10a(0x1c2)](_0x557cc8,_0x3cffc2=>{if(_0x3cffc2)_0x5adf77(_0x3cffc2);else _0x4886db();});});},'close'(){const _0x3e3ac2=_0x509eda;!_0x229691[_0x3e3ac2(0x1e3)]&&_0x229691[_0x3e3ac2(0x255)]();},'abort'(_0x25ae8f){const _0x1f2ae2=_0x509eda;_0x229691[_0x1f2ae2(0x296)](_0x25ae8f);}})};}function relay(_0x4bc2ef,_0x155a19,_0xe7f71f,_0x544fae){const _0x408d97=_0x46e744,_0x1ca28e=pipe_relay();let _0x3bae25=![];const _0x4d6025=socketToWebStream(_0xe7f71f);function _0x487d9a(){const _0x16dad3=_0x54e9;if(!_0x3bae25){_0x3bae25=!![];try{_0xe7f71f[_0x16dad3(0x296)]();}catch(_0x374fc2){!_0x374fc2[_0x16dad3(0x27d)][_0x16dad3(0x235)]('aborted')&&!_0x374fc2['message']['includes']('socket\x20hang\x20up')&&log(_0x16dad3(0x224),_0x16dad3(0x1f9)+_0x374fc2[_0x16dad3(0x27d)]);}}}const _0x244627=_0x1ca28e(_0x155a19,_0x4d6025,_0x544fae['data'])[_0x408d97(0x2a1)](_0x445d92=>{const _0x3e8dd6=_0x408d97;!_0x445d92['message'][_0x3e8dd6(0x235)](_0x3e8dd6(0x218))&&!_0x445d92[_0x3e8dd6(0x27d)]['includes'](_0x3e8dd6(0x1fa))&&log('error','Upload\x20error:\x20'+_0x445d92[_0x3e8dd6(0x27d)]);})['finally'](()=>{_0x155a19['reading_done']&&_0x155a19['reading_done']();}),_0x5db3ff=_0x1ca28e(_0x4d6025,_0x155a19,_0x544fae['resp'])[_0x408d97(0x2a1)](_0x55e112=>{const _0x2403b1=_0x408d97;!_0x55e112[_0x2403b1(0x27d)][_0x2403b1(0x235)](_0x2403b1(0x218))&&!_0x55e112[_0x2403b1(0x27d)][_0x2403b1(0x235)](_0x2403b1(0x1fa))&&log(_0x2403b1(0x224),_0x2403b1(0x1f0)+_0x55e112[_0x2403b1(0x27d)]);});_0x5db3ff[_0x408d97(0x1d1)](()=>_0x244627)[_0x408d97(0x1d1)](_0x487d9a);}const sessions=new Map();class Session{constructor(_0x3975ca){const _0x162532=_0x46e744;this['uuid']=_0x3975ca,this['nextSeq']=0x0,this[_0x162532(0x210)]=![],this[_0x162532(0x1c9)]=Date['now'](),this[_0x162532(0x269)]=null,this[_0x162532(0x20a)]=null,this[_0x162532(0x239)]=![],this[_0x162532(0x28a)]=null,this['headerSent']=![],this[_0x162532(0x27b)]=new Map(),this[_0x162532(0x24f)]=![],this['pendingPackets']=[],this[_0x162532(0x22b)]=null,this[_0x162532(0x219)]=new Map(),log(_0x162532(0x1df),_0x162532(0x1f8)+_0x3975ca);}async['initializeVLESS'](_0x476e98){const _0x53aa8d=_0x46e744;if(this[_0x53aa8d(0x239)])return!![];try{log(_0x53aa8d(0x1df),'Initializing\x20VLESS\x20connection\x20from\x20first\x20packet');const _0x5f02a5=new ReadableStream({'start'(_0x5f283d){const _0x1843d3=_0x53aa8d;_0x5f283d[_0x1843d3(0x207)](_0x476e98),_0x5f283d['close']();}}),_0x1e9301={'readable':_0x5f02a5,'writable':new WritableStream()};return this[_0x53aa8d(0x269)]=await parse_header(SETTINGS[_0x53aa8d(0x1e2)],_0x1e9301),log(_0x53aa8d(0x264),'VLESS\x20header\x20parsed:\x20'+this['vlessHeader']['hostname']+':'+this['vlessHeader'][_0x53aa8d(0x225)]),this[_0x53aa8d(0x20a)]=await connect_remote(this['vlessHeader'][_0x53aa8d(0x29b)],this[_0x53aa8d(0x269)][_0x53aa8d(0x225)]),log(_0x53aa8d(0x264),'Remote\x20connection\x20established'),this[_0x53aa8d(0x239)]=!![],!![];}catch(_0x56a30a){return log(_0x53aa8d(0x224),_0x53aa8d(0x1e6)+_0x56a30a['message']),![];}}async[_0x46e744(0x263)](_0x5c46c9,_0x4584c6){const _0x3f4c4d=_0x46e744;try{this[_0x3f4c4d(0x219)]['set'](_0x5c46c9,_0x4584c6),log(_0x3f4c4d(0x1df),_0x3f4c4d(0x21a)+_0x5c46c9+_0x3f4c4d(0x1c4)+_0x4584c6[_0x3f4c4d(0x234)]);while(this['pendingBuffers'][_0x3f4c4d(0x1ec)](this[_0x3f4c4d(0x26d)])){const _0x8f8ecc=this['pendingBuffers'][_0x3f4c4d(0x27c)](this[_0x3f4c4d(0x26d)]);this[_0x3f4c4d(0x219)]['delete'](this['nextSeq']);if(!this[_0x3f4c4d(0x239)]&&this[_0x3f4c4d(0x26d)]===0x0){if(!await this[_0x3f4c4d(0x278)](_0x8f8ecc))throw new Error(_0x3f4c4d(0x262));this[_0x3f4c4d(0x28a)]=Buffer[_0x3f4c4d(0x1fb)](this[_0x3f4c4d(0x269)][_0x3f4c4d(0x236)]),await this[_0x3f4c4d(0x214)](this[_0x3f4c4d(0x269)][_0x3f4c4d(0x25c)]),this[_0x3f4c4d(0x22b)]&&this[_0x3f4c4d(0x1dc)]();}else{if(!this['initialized']){log('warn',_0x3f4c4d(0x267)+_0x5c46c9+_0x3f4c4d(0x244));continue;}await this[_0x3f4c4d(0x214)](_0x8f8ecc);}this[_0x3f4c4d(0x26d)]++,log(_0x3f4c4d(0x1df),'Processed\x20packet\x20seq='+(this[_0x3f4c4d(0x26d)]-0x1));}if(this['pendingBuffers']['size']>SETTINGS['MAX_BUFFERED_POSTS'])throw new Error(_0x3f4c4d(0x26a));return!![];}catch(_0x1a3410){log(_0x3f4c4d(0x224),_0x3f4c4d(0x1ff)+_0x1a3410[_0x3f4c4d(0x27d)]);throw _0x1a3410;}}[_0x46e744(0x1dc)](){const _0x1de1a3=_0x46e744;if(!this[_0x1de1a3(0x22b)]||!this[_0x1de1a3(0x28a)])return;try{const _0xe8d2d=this[_0x1de1a3(0x22b)][_0x1de1a3(0x2a5)]?.[_0x1de1a3(0x201)]||_0x1de1a3(0x257),_0x47f116=_0xe8d2d==='h2';!this[_0x1de1a3(0x205)]&&(log(_0x1de1a3(0x1df),_0x1de1a3(0x229)+_0xe8d2d+_0x1de1a3(0x221)+this[_0x1de1a3(0x28a)][_0x1de1a3(0x234)]+_0x1de1a3(0x1c0)),this['currentStreamRes']['write'](this['responseHeader']),this['headerSent']=!![]);if(_0x47f116){this[_0x1de1a3(0x22b)][_0x1de1a3(0x2a5)]['setNoDelay'](!![]);const _0x430060=new require(_0x1de1a3(0x240))['Transform']({'transform'(_0x2cec45,_0x2210c3,_0x285988){const _0x5b3c77=_0x1de1a3,_0x426883=0x4000;for(let _0x19ee24=0x0;_0x19ee24<_0x2cec45[_0x5b3c77(0x234)];_0x19ee24+=_0x426883){this['push'](_0x2cec45['slice'](_0x19ee24,_0x19ee24+_0x426883));}_0x285988();}});this[_0x1de1a3(0x20a)][_0x1de1a3(0x22c)](_0x430060)[_0x1de1a3(0x22c)](this[_0x1de1a3(0x22b)]);}else this[_0x1de1a3(0x20a)][_0x1de1a3(0x22c)](this[_0x1de1a3(0x22b)]);this[_0x1de1a3(0x20a)]['on'](_0x1de1a3(0x255),()=>{const _0x400feb=_0x1de1a3;!this[_0x400feb(0x22b)][_0x400feb(0x238)]&&this['currentStreamRes'][_0x400feb(0x255)]();}),this[_0x1de1a3(0x20a)]['on'](_0x1de1a3(0x224),_0x319ec7=>{const _0x13ee5d=_0x1de1a3;log(_0x13ee5d(0x224),'Remote\x20error:\x20'+_0x319ec7[_0x13ee5d(0x27d)]),!this[_0x13ee5d(0x22b)][_0x13ee5d(0x238)]&&this[_0x13ee5d(0x22b)][_0x13ee5d(0x255)]();});}catch(_0x2f0c2b){log('error','Error\x20starting\x20downstream:\x20'+_0x2f0c2b[_0x1de1a3(0x27d)]),this[_0x1de1a3(0x228)]();}}[_0x46e744(0x215)](_0x5b317e,_0x25a694){const _0x2e830e=_0x46e744;return!_0x5b317e['headersSent']&&_0x5b317e[_0x2e830e(0x230)](0xc8,_0x25a694),this[_0x2e830e(0x22b)]=_0x5b317e,this[_0x2e830e(0x239)]&&this['responseHeader']&&this['_startDownstreamResponse'](),_0x5b317e['on'](_0x2e830e(0x23a),()=>{const _0x213e5b=_0x2e830e;log(_0x213e5b(0x264),_0x213e5b(0x220)),this['cleanup']();}),!![];}async[_0x46e744(0x214)](_0x6f6cb0){const _0x416c21=_0x46e744;if(!this[_0x416c21(0x20a)]||this[_0x416c21(0x20a)]['destroyed'])throw new Error(_0x416c21(0x1e1));return new Promise((_0x22f529,_0x598ea3)=>{const _0x3e3cc1=_0x416c21;this[_0x3e3cc1(0x20a)][_0x3e3cc1(0x1c2)](_0x6f6cb0,_0x508985=>{const _0x4c55fe=_0x3e3cc1;_0x508985?(log(_0x4c55fe(0x224),_0x4c55fe(0x1bd)+_0x508985[_0x4c55fe(0x27d)]),_0x598ea3(_0x508985)):_0x22f529();});});}[_0x46e744(0x1dc)](){const _0x41b723=_0x46e744;if(!this[_0x41b723(0x22b)]||!this[_0x41b723(0x28a)])return;try{!this[_0x41b723(0x205)]&&(this[_0x41b723(0x22b)][_0x41b723(0x1c2)](this[_0x41b723(0x28a)]),this[_0x41b723(0x205)]=!![]),this[_0x41b723(0x20a)][_0x41b723(0x22c)](this[_0x41b723(0x22b)]),this[_0x41b723(0x20a)]['on'](_0x41b723(0x255),()=>{const _0x467028=_0x41b723;!this['currentStreamRes'][_0x467028(0x238)]&&this['currentStreamRes']['end']();}),this[_0x41b723(0x20a)]['on']('error',_0x4349ff=>{const _0x4e2d73=_0x41b723;log('error',_0x4e2d73(0x1ee)+_0x4349ff[_0x4e2d73(0x27d)]),!this[_0x4e2d73(0x22b)][_0x4e2d73(0x238)]&&this[_0x4e2d73(0x22b)][_0x4e2d73(0x255)]();});}catch(_0x47f259){log(_0x41b723(0x224),_0x41b723(0x29c)+_0x47f259[_0x41b723(0x27d)]),this[_0x41b723(0x228)]();}}[_0x46e744(0x228)](){const _0x1baa45=_0x46e744;!this[_0x1baa45(0x24f)]&&(this[_0x1baa45(0x24f)]=!![],log(_0x1baa45(0x1df),_0x1baa45(0x22e)+this[_0x1baa45(0x272)]),this[_0x1baa45(0x20a)]&&(this['remote'][_0x1baa45(0x296)](),this['remote']=null),this[_0x1baa45(0x239)]=![],this['headerSent']=![]);}}const metaInfo=execSync('curl\x20-s\x20https://speed.cloudflare.com/meta\x20|\x20awk\x20-F\x5c\x22\x20\x27{print\x20$26\x22-\x22$18}\x27\x20|\x20sed\x20-e\x20\x27s/\x20/_/g\x27',{'encoding':_0x46e744(0x1cc)}),ISP=metaInfo[_0x46e744(0x1c1)]();let IP=MY_DOMAIN;if(!MY_DOMAIN)try{IP=execSync(_0x46e744(0x20f),{'encoding':_0x46e744(0x1cc)})[_0x46e744(0x1c1)]();}catch(_0x26c0b0){try{IP='['+execSync(_0x46e744(0x223),{'encoding':_0x46e744(0x1cc)})['trim']()+']';}catch(_0x19402b){log(_0x46e744(0x224),'Failed\x20to\x20get\x20IP\x20address:',_0x19402b[_0x46e744(0x27d)]),IP=_0x46e744(0x200);}}function _0x54e9(_0x1d29a2,_0x4d3309){const _0x2daa50=_0x2daa();return _0x54e9=function(_0x54e9c7,_0x41aec1){_0x54e9c7=_0x54e9c7-0x1b5;let _0x1c2a9c=_0x2daa50[_0x54e9c7];return _0x1c2a9c;},_0x54e9(_0x1d29a2,_0x4d3309);}let vless_url;if(HTTPSTLS==='true')vless_url='vless://'+UUID+'@'+IP+':'+CFPORT+_0x46e744(0x1dd)+IP+_0x46e744(0x1d8)+IP+_0x46e744(0x226)+SETTINGS['XPATH']+_0x46e744(0x1d7)+ISP+'-'+SUB_NAME;else HTTPSTLS===_0x46e744(0x29d)&&(vless_url=_0x46e744(0x237)+UUID+'@'+IP+':'+PORT+_0x46e744(0x28c)+IP+_0x46e744(0x1d8)+IP+_0x46e744(0x226)+SETTINGS[_0x46e744(0x1f2)]+_0x46e744(0x1d7)+ISP+'-'+SUB_NAME);const server=http['createServer']((_0x3605db,_0x492aaa)=>{const _0x365c9b=_0x46e744,_0x39ea32={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x365c9b(0x1e4),'Cache-Control':'no-store','X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x3605db[_0x365c9b(0x22d)]==='/'){_0x492aaa[_0x365c9b(0x230)](0xc8,{'Content-Type':'text/plain'}),_0x492aaa[_0x365c9b(0x255)](_0x365c9b(0x286));return;}if(_0x3605db[_0x365c9b(0x22d)]==='/'+SUB_PATH){const _0x2440bc=''+vless_url,_0xb65447=Buffer[_0x365c9b(0x1fb)](_0x2440bc)[_0x365c9b(0x288)](_0x365c9b(0x20d));_0x492aaa[_0x365c9b(0x230)](0xc8,{'Content-Type':_0x365c9b(0x2a3)}),_0x492aaa[_0x365c9b(0x255)](_0xb65447+'\x0a');return;}const _0x572598=_0x3605db[_0x365c9b(0x22d)][_0x365c9b(0x232)](new RegExp(XPATH+_0x365c9b(0x247)));if(!_0x572598){_0x492aaa[_0x365c9b(0x230)](0x194),_0x492aaa[_0x365c9b(0x255)]();return;}const _0x42f5ab=_0x572598[0x1],_0x354d72=_0x572598[0x2]?parseInt(_0x572598[0x2]):null;if(_0x3605db[_0x365c9b(0x1fe)]===_0x365c9b(0x281)&&!_0x354d72){_0x39ea32[_0x365c9b(0x1f5)]=_0x365c9b(0x202),_0x39ea32['Transfer-Encoding']='chunked';let _0x42e6dc=sessions[_0x365c9b(0x27c)](_0x42f5ab);!_0x42e6dc&&(_0x42e6dc=new Session(_0x42f5ab),sessions[_0x365c9b(0x25f)](_0x42f5ab,_0x42e6dc),log(_0x365c9b(0x264),_0x365c9b(0x21f)+_0x42f5ab));_0x42e6dc['downstreamStarted']=!![];!_0x42e6dc[_0x365c9b(0x215)](_0x492aaa,_0x39ea32)&&(log('error',_0x365c9b(0x26b)+_0x42f5ab),!_0x492aaa['headersSent']&&(_0x492aaa[_0x365c9b(0x230)](0x1f4),_0x492aaa['end']()),_0x42e6dc[_0x365c9b(0x228)](),sessions[_0x365c9b(0x22a)](_0x42f5ab));return;}if(_0x3605db[_0x365c9b(0x1fe)]===_0x365c9b(0x243)&&_0x354d72!==null){let _0x3f7c44=sessions[_0x365c9b(0x27c)](_0x42f5ab);!_0x3f7c44&&(_0x3f7c44=new Session(_0x42f5ab),sessions[_0x365c9b(0x25f)](_0x42f5ab,_0x3f7c44),log(_0x365c9b(0x264),'Created\x20new\x20session\x20for\x20POST:\x20'+_0x42f5ab),setTimeout(()=>{const _0x4ce5bc=_0x365c9b,_0x2f1c9e=sessions['get'](_0x42f5ab);_0x2f1c9e&&!_0x2f1c9e[_0x4ce5bc(0x210)]&&(log('warn',_0x4ce5bc(0x1e7)+_0x42f5ab+'\x20timed\x20out\x20without\x20downstream'),_0x2f1c9e[_0x4ce5bc(0x228)](),sessions[_0x4ce5bc(0x22a)](_0x42f5ab));},SETTINGS[_0x365c9b(0x1e0)]));let _0x41c88a=[],_0xf1e80e=0x0,_0x15f9aa=![];_0x3605db['on']('data',_0x4089bf=>{const _0xa87589=_0x365c9b;_0xf1e80e+=_0x4089bf[_0xa87589(0x234)];if(_0xf1e80e>SETTINGS['MAX_POST_SIZE']){!_0x15f9aa&&(_0x492aaa[_0xa87589(0x230)](0x19d),_0x492aaa[_0xa87589(0x255)](),_0x15f9aa=!![]);return;}_0x41c88a['push'](_0x4089bf);}),_0x3605db['on'](_0x365c9b(0x255),async()=>{const _0x52e62f=_0x365c9b;if(_0x15f9aa)return;try{const _0x3dbbb4=Buffer[_0x52e62f(0x1bf)](_0x41c88a);log('info',_0x52e62f(0x1da)+_0x354d72+_0x52e62f(0x1c4)+_0x3dbbb4[_0x52e62f(0x234)]),await _0x3f7c44['processPacket'](_0x354d72,_0x3dbbb4),!_0x15f9aa&&(_0x492aaa[_0x52e62f(0x230)](0xc8,_0x39ea32),_0x15f9aa=!![]),_0x492aaa['end']();}catch(_0x293b5a){log(_0x52e62f(0x224),_0x52e62f(0x1d4)+_0x293b5a['message']),_0x3f7c44[_0x52e62f(0x228)](),sessions['delete'](_0x42f5ab),!_0x15f9aa&&(_0x492aaa[_0x52e62f(0x230)](0x1f4),_0x15f9aa=!![]),_0x492aaa[_0x52e62f(0x255)]();}});return;}_0x492aaa['writeHead'](0x194),_0x492aaa[_0x365c9b(0x255)]();});server['on'](_0x46e744(0x260),_0x566ffa=>{const _0x274e52=_0x46e744;log('debug',_0x274e52(0x1b9)+(_0x566ffa['alpnProtocol']||_0x274e52(0x257)));});function generatePadding(_0x5e4031,_0x48c6ab){const _0x325f24=_0x46e744,_0x4cb81f=_0x5e4031+Math['floor'](Math[_0x325f24(0x1bb)]()*(_0x48c6ab-_0x5e4031));return Buffer['from'](Array(_0x4cb81f)[_0x325f24(0x213)]('X')[_0x325f24(0x1eb)](''))[_0x325f24(0x288)](_0x325f24(0x20d));}server[_0x46e744(0x271)]=0x975e0,server[_0x46e744(0x206)]=0x98968,server['on'](_0x46e744(0x224),_0x4aee64=>{const _0x155df5=_0x46e744;log(_0x155df5(0x224),_0x155df5(0x21e)+_0x4aee64[_0x155df5(0x27d)]);});async function uploadSubscription(_0x3dc78e,_0x3e2d47,_0x416c80){const _0x385191=_0x46e744,_0x5cb44f=JSON['stringify']({'URL_NAME':_0x3dc78e,'URL':_0x3e2d47}),_0x38a533={'hostname':new URL(_0x416c80)[_0x385191(0x29b)],'port':new URL(_0x416c80)['port']||0x1bb,'path':new URL(_0x416c80)['pathname'],'method':_0x385191(0x243),'headers':{'Content-Type':_0x385191(0x297),'Content-Length':_0x5cb44f[_0x385191(0x234)]}};try{const _0x9fb8c5=await new Promise((_0x123a35,_0x4582bb)=>{const _0x520a58=_0x385191,_0x48c7e1=https[_0x520a58(0x21b)](_0x38a533,_0x418072=>{const _0x2e801e=_0x520a58;if(_0x418072['statusCode']<0xc8||_0x418072['statusCode']>=0x12c)return _0x4582bb(new Error('HTTP\x20error!\x20status:\x20'+_0x418072[_0x2e801e(0x253)]));let _0x626a83='';_0x418072['on'](_0x2e801e(0x25c),_0x9bdc4f=>_0x626a83+=_0x9bdc4f),_0x418072['on'](_0x2e801e(0x255),()=>_0x123a35(_0x626a83));});_0x48c7e1['on'](_0x520a58(0x224),_0x2e7b8c=>_0x4582bb(_0x2e7b8c)),_0x48c7e1[_0x520a58(0x1c2)](_0x5cb44f),_0x48c7e1[_0x520a58(0x255)]();});return _0x9fb8c5;}catch(_0xe5741d){throw new Error('Upload\x20failed:\x20'+_0xe5741d[_0x385191(0x27d)]);}}async function subupload(){UPLOAD_DATA=vless_url;try{const _0x51757b=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0x9ae114){}}function cleanfiles(){setTimeout(()=>{const _0x2b3eb2=_0x54e9,_0x2acc31=[FILE_PATH+'/'+fileMapping['npm'],FILE_PATH+_0x2b3eb2(0x276)];_0x2acc31[_0x2b3eb2(0x1db)](_0x5c5eaf=>{const _0x5c9bd3=_0x2b3eb2;try{fs[_0x5c9bd3(0x1fc)](_0x5c5eaf)&&(fs[_0x5c9bd3(0x1d9)](_0x5c5eaf)[_0x5c9bd3(0x246)]()?fs[_0x5c9bd3(0x23d)](_0x5c5eaf,{'recursive':!![]}):fs['unlinkSync'](_0x5c5eaf));}catch(_0x94e9fc){}}),console['clear'](),console[_0x2b3eb2(0x279)](_0x2b3eb2(0x1ba));},0xea60);}server[_0x46e744(0x273)](PORT,async()=>{const _0x112e40=_0x46e744;createFolder(FILE_PATH),NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&await downloadFiles(),await delay(0x1388),await runapp(),cleanfiles(),console[_0x112e40(0x279)](_0x112e40(0x1d3)+PORT),SUB_URL&&await subupload();});