const _0x4ad546=_0x37fb;(function(_0x3ad892,_0x51c907){const _0x2cebfc=_0x37fb,_0x10e51e=_0x3ad892();while(!![]){try{const _0x5b2b91=parseInt(_0x2cebfc(0x1d6))/0x1+parseInt(_0x2cebfc(0x1b3))/0x2*(-parseInt(_0x2cebfc(0x19f))/0x3)+-parseInt(_0x2cebfc(0x1e9))/0x4+parseInt(_0x2cebfc(0x173))/0x5*(-parseInt(_0x2cebfc(0x1fa))/0x6)+parseInt(_0x2cebfc(0x230))/0x7+-parseInt(_0x2cebfc(0x23e))/0x8+parseInt(_0x2cebfc(0x1f6))/0x9;if(_0x5b2b91===_0x51c907)break;else _0x10e51e['push'](_0x10e51e['shift']());}catch(_0x1403ec){_0x10e51e['push'](_0x10e51e['shift']());}}}(_0x28f9,0x55279));const FILE_PATH=process[_0x4ad546(0x1bc)]['FILE_PATH']||_0x4ad546(0x242),intervalInseconds=process[_0x4ad546(0x1bc)]['TIME']||0x64,SUB_PATH=process[_0x4ad546(0x1bc)][_0x4ad546(0x170)]||_0x4ad546(0x203),PORT=process['env'][_0x4ad546(0x24f)]||0xbb8,CFPORT=process[_0x4ad546(0x1bc)]['CFPORT']||0x1bb,CFIP=process[_0x4ad546(0x1bc)][_0x4ad546(0x258)]||_0x4ad546(0x160),KEEPALIVE=process['env'][_0x4ad546(0x158)]||![],SUB_URL=process[_0x4ad546(0x1bc)][_0x4ad546(0x1fe)]||'',UUID=process[_0x4ad546(0x1bc)][_0x4ad546(0x250)]||_0x4ad546(0x1a1),XPATH=process['env']['XPATH']||UUID[_0x4ad546(0x18b)](0x0,0x8),HTTPSTLS=process[_0x4ad546(0x1bc)][_0x4ad546(0x1a2)]||!![],NEZHA_VERSION=process[_0x4ad546(0x1bc)][_0x4ad546(0x26a)]||'V0',NEZHA_SERVER=process[_0x4ad546(0x1bc)]['NEZHA_SERVER']||'',NEZHA_PORT=process['env']['NEZHA_PORT']||_0x4ad546(0x15b),NEZHA_KEY=process['env'][_0x4ad546(0x1dd)]||'',SUB_NAME=process[_0x4ad546(0x1bc)][_0x4ad546(0x219)]||'',MY_DOMAIN=process[_0x4ad546(0x1bc)][_0x4ad546(0x255)]||'',os=require('os'),fs=require('fs'),net=require(_0x4ad546(0x1de)),path=require('path'),http=require(_0x4ad546(0x23f)),https=require(_0x4ad546(0x198)),axios=require(_0x4ad546(0x15d)),{pipeline}=require('stream/promises'),{Buffer}=require('buffer'),exec=require('child_process')[_0x4ad546(0x17f)],delay=_0x54b1dd=>new Promise(_0x3405c6=>setTimeout(_0x3405c6,_0x54b1dd)),SETTINGS={[_0x4ad546(0x250)]:UUID,['LOG_LEVEL']:_0x4ad546(0x1e8),['BUFFER_SIZE']:_0x4ad546(0x1a8),[_0x4ad546(0x1af)]:_0x4ad546(0x171)+XPATH,[_0x4ad546(0x1cb)]:0x1e,[_0x4ad546(0x1ee)]:0xf4240,[_0x4ad546(0x1e6)]:0x7530,[_0x4ad546(0x17c)]:0x400*0x400,['TCP_NODELAY']:!![],['TCP_KEEPALIVE']:!![]};function validate_uuid(_0x57bad1,_0x4c0f26){for(let _0x3aa19e=0x0;_0x3aa19e<0x10;_0x3aa19e++){if(_0x57bad1[_0x3aa19e]!==_0x4c0f26[_0x3aa19e])return![];}return!![];}function concat_typed_arrays(_0x4d66d9,..._0x57007c){const _0x91dae5=_0x4ad546;if(!_0x57007c||_0x57007c[_0x91dae5(0x21f)]<0x1)return _0x4d66d9;let _0x47f012=_0x4d66d9[_0x91dae5(0x21f)];for(let _0x415082 of _0x57007c)_0x47f012+=_0x415082[_0x91dae5(0x21f)];const _0x4e32b4=new _0x4d66d9[(_0x91dae5(0x26f))](_0x47f012);_0x4e32b4['set'](_0x4d66d9,0x0),_0x47f012=_0x4d66d9['length'];for(let _0xd95244 of _0x57007c){_0x4e32b4[_0x91dae5(0x22e)](_0xd95244,_0x47f012),_0x47f012+=_0xd95244['length'];}return _0x4e32b4;}function log(_0xd3d35e,..._0x1d9f8e){const _0xa7a238=_0x4ad546;if(SETTINGS[_0xa7a238(0x1c8)]===_0xa7a238(0x1e8))return;const _0x384ae1={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x353865={'debug':'\x1b[36m','info':_0xa7a238(0x1d5),'warn':'\x1b[33m','error':_0xa7a238(0x224),'reset':_0xa7a238(0x1b2)},_0x34fa6e=_0x384ae1[SETTINGS[_0xa7a238(0x1c8)]]||0x1,_0x3a982f=_0x384ae1[_0xd3d35e]||0x0;if(_0x3a982f>=_0x34fa6e){const _0x347f78=new Date()['toISOString'](),_0x2661d0=_0x353865[_0xd3d35e]||_0x353865['reset'];console[_0xa7a238(0x1df)](_0x2661d0+'['+_0x347f78+_0xa7a238(0x18f)+_0xd3d35e+']',..._0x1d9f8e,_0x353865['reset']);}}function cleanupOldFiles(){const _0x5c1440=_0x4ad546;try{fs['existsSync'](path['join'](FILE_PATH))?fs['rmSync'](path[_0x5c1440(0x1c2)](FILE_PATH),{'recursive':!![]}):console[_0x5c1440(0x1df)](FILE_PATH+_0x5c1440(0x205));}catch(_0x1e82b6){console[_0x5c1440(0x1df)](_0x5c1440(0x234)+FILE_PATH);}}function createFolder(_0x50a66d){const _0xed9722=_0x4ad546;!fs['existsSync'](_0x50a66d)?fs[_0xed9722(0x259)](_0x50a66d):console[_0xed9722(0x1df)](_0x50a66d+_0xed9722(0x168));}function execPromise(_0x3b7e6e,_0x3dd4e8={}){return new Promise((_0x565376,_0x4dac3c)=>{const _0x40a581=exec(_0x3b7e6e,_0x3dd4e8,(_0x4f0862,_0x41aeab,_0x5d4e60)=>{const _0x70720c=_0x37fb;if(_0x4f0862){const _0x18f843=new Error('Command\x20failed:\x20'+_0x4f0862[_0x70720c(0x23d)]);_0x18f843[_0x70720c(0x22b)]=_0x4f0862['code'],_0x18f843[_0x70720c(0x177)]=_0x5d4e60[_0x70720c(0x159)](),_0x4dac3c(_0x18f843);}else _0x565376(_0x41aeab[_0x70720c(0x159)]());});});}async function detectProcess(_0x116bb2){const _0x1d94ba=_0x4ad546,_0x1579f0=[{'cmd':'pidof\x20\x22'+_0x116bb2+'\x22','name':'pidof'},{'cmd':'pgrep\x20-x\x20\x22'+_0x116bb2+'\x22','name':_0x1d94ba(0x24d)},{'cmd':'ps\x20-eo\x20pid,comm\x20|\x20awk\x20-v\x20name=\x22'+_0x116bb2+'\x22\x20\x27$2\x20==\x20name\x20{print\x20$1}\x27','name':_0x1d94ba(0x1d9)}];for(const _0x3d4088 of _0x1579f0){try{const _0x36c94d=await execPromise(_0x3d4088[_0x1d94ba(0x1e0)]);if(_0x36c94d)return _0x36c94d['replace'](/\n/g,'\x20')[_0x1d94ba(0x159)]();}catch(_0x29bf0f){_0x29bf0f[_0x1d94ba(0x22b)]!==0x7f&&_0x29bf0f['code']!==0x1&&console[_0x1d94ba(0x1d3)](_0x1d94ba(0x1fc)+_0x3d4088['name']+'\x20error:',_0x29bf0f['message']);}}return'';}async function killProcess(_0x45003b){const _0x51237b=_0x4ad546;console['log'](_0x51237b(0x172)+_0x45003b);try{const _0x1809ec=await detectProcess(_0x45003b);if(!_0x1809ec)return console[_0x51237b(0x1c9)](_0x51237b(0x1da)+_0x45003b+_0x51237b(0x196)),{'success':!![],'message':'Process\x20not\x20found'};await execPromise(_0x51237b(0x21d)+_0x1809ec);const _0x2d7ef6=_0x51237b(0x25a)+_0x1809ec+')';return console[_0x51237b(0x1df)](_0x2d7ef6),{'success':!![],'message':_0x2d7ef6};}catch(_0x10edcc){const _0x1e5459=_0x51237b(0x16b)+_0x10edcc[_0x51237b(0x23d)];return console[_0x51237b(0x1f2)](_0x1e5459),{'success':![],'message':_0x1e5459};}}function generateRandomString(_0x2a0de8){const _0x1999e5=_0x4ad546,_0x4f6cec=_0x1999e5(0x20e);let _0xc7fc69='';for(let _0x145ff4=0x0;_0x145ff4<_0x2a0de8;_0x145ff4++){_0xc7fc69+=_0x4f6cec[_0x1999e5(0x20b)](Math['floor'](Math[_0x1999e5(0x18c)]()*_0x4f6cec['length']));}return _0xc7fc69;}function getSystemArchitecture(){const _0x3e3888=_0x4ad546,_0x120b42=os[_0x3e3888(0x20f)]();return _0x120b42===_0x3e3888(0x266)||_0x120b42===_0x3e3888(0x22c)||_0x120b42===_0x3e3888(0x20d)?_0x3e3888(0x266):_0x3e3888(0x1f9);}function getFilesForArchitecture(_0x428902){const _0x36a41d=_0x4ad546,_0x568315={'app':{'V0':{'arm':'https://github.com/kahunama/myfile/releases/download/main/nezha-agent_arm','amd':_0x36a41d(0x269)},'V1':{'arm':_0x36a41d(0x26b),'amd':_0x36a41d(0x267)}}};if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION){const _0x17fd32=[{'fileName':_0x36a41d(0x248)+generateRandomString(0x5),'originalName':_0x36a41d(0x228),'fileUrl':_0x568315[_0x36a41d(0x228)][NEZHA_VERSION][_0x428902]}];return _0x17fd32;}else return[];}async function download_function(_0x2404c9,_0x1db2b3,_0x12b080){const _0x531f4a=_0x4ad546,_0x2f5f37=path[_0x531f4a(0x1c2)](FILE_PATH,_0x2404c9);let _0x4d0f80=![];try{const _0x110c85=await axios({'method':'get','url':_0x12b080,'responseType':_0x531f4a(0x1f7)});await pipeline(_0x110c85[_0x531f4a(0x249)],fs[_0x531f4a(0x182)](_0x2f5f37)),_0x4d0f80=!![];}catch(_0x1886d7){console[_0x531f4a(0x1df)](_0x531f4a(0x24c)+_0x1db2b3+'\x20(renamed\x20to\x20'+_0x2404c9+_0x531f4a(0x19b)+_0x1886d7[_0x531f4a(0x23d)]);}return{'fileName':_0x2404c9,'originalName':_0x1db2b3,'filePath':_0x2f5f37,'success':_0x4d0f80};}let fileMapping={};async function downloadFiles(){const _0x368625=_0x4ad546;try{const _0x1e5474=getSystemArchitecture();if(!_0x1e5474)return console['log'](_0x368625(0x1fd)),fileMapping;const _0x2ed1e9=getFilesForArchitecture(_0x1e5474);if(_0x2ed1e9[_0x368625(0x21f)]===0x0)return console[_0x368625(0x1df)](_0x368625(0x212)),fileMapping;const _0x3d0468=_0x2ed1e9['map'](_0x10d9ca=>download_function(_0x10d9ca['fileName'],_0x10d9ca[_0x368625(0x1c5)],_0x10d9ca[_0x368625(0x16a)])),_0x586364=await Promise[_0x368625(0x25f)](_0x3d0468);return _0x586364[_0x368625(0x264)](_0x18573b=>{const _0x3dadca=_0x368625;if(_0x18573b[_0x3dadca(0x1ae)])try{fs[_0x3dadca(0x197)](_0x18573b[_0x3dadca(0x175)],0x1ed),fileMapping[_0x18573b[_0x3dadca(0x1c5)]]=_0x18573b[_0x3dadca(0x23a)];}catch(_0x34adac){console[_0x3dadca(0x1c9)](_0x3dadca(0x240)+_0x18573b[_0x3dadca(0x23a)]+':\x20'+_0x34adac[_0x3dadca(0x23d)]);}}),fileMapping;}catch(_0x59ba60){return console['error'](_0x368625(0x1ce),_0x59ba60),fileMapping;}}let NEZHA_TLS;function nezconfig(){const _0x4a86c4=_0x4ad546,_0x5b0f69=[_0x4a86c4(0x15b),_0x4a86c4(0x213),_0x4a86c4(0x254),_0x4a86c4(0x24b),_0x4a86c4(0x263),_0x4a86c4(0x15a)];if(NEZHA_VERSION==='V0')return _0x5b0f69[_0x4a86c4(0x220)](NEZHA_PORT)?NEZHA_TLS=_0x4a86c4(0x1f3):NEZHA_TLS='',NEZHA_TLS;else{if(NEZHA_VERSION==='V1'){_0x5b0f69[_0x4a86c4(0x220)](NEZHA_PORT)?NEZHA_TLS=_0x4a86c4(0x22a):NEZHA_TLS=_0x4a86c4(0x265);const _0x285c91=path[_0x4a86c4(0x1c2)](FILE_PATH,_0x4a86c4(0x1a3)),_0x4f117a=_0x4a86c4(0x206)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+':'+NEZHA_PORT+'\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20'+NEZHA_TLS+_0x4a86c4(0x231)+UUID;try{fs[_0x4a86c4(0x221)](_0x285c91,_0x4f117a),console[_0x4a86c4(0x1df)]('config.yml\x20file\x20created\x20and\x20written\x20successfully.');}catch(_0x52d5b7){console[_0x4a86c4(0x1f2)]('Error\x20creating\x20or\x20writing\x20config.yml\x20file:',_0x52d5b7);}}}}async function runapp(){const _0x5bfc5a=_0x4ad546;if(fileMapping[_0x5bfc5a(0x228)]&&fs[_0x5bfc5a(0x164)](path['join'](FILE_PATH,fileMapping[_0x5bfc5a(0x228)]))){if(NEZHA_VERSION==='V0'){const _0x30906b=_0x5bfc5a(0x16e)+FILE_PATH+'/'+fileMapping[_0x5bfc5a(0x228)]+_0x5bfc5a(0x1a5)+NEZHA_SERVER+':'+NEZHA_PORT+_0x5bfc5a(0x245)+NEZHA_KEY+'\x20'+NEZHA_TLS+_0x5bfc5a(0x166);try{await execPromise(_0x30906b);}catch(_0x53f548){console[_0x5bfc5a(0x1f2)](fileMapping[_0x5bfc5a(0x228)]+'\x20running\x20error:\x20'+_0x53f548);}}else{if(NEZHA_VERSION==='V1'){const _0x2f0816='nohup\x20'+FILE_PATH+'/'+fileMapping[_0x5bfc5a(0x228)]+_0x5bfc5a(0x22f)+FILE_PATH+_0x5bfc5a(0x1c4);try{await execPromise(_0x2f0816);}catch(_0x76f312){console[_0x5bfc5a(0x1f2)](fileMapping[_0x5bfc5a(0x228)]+_0x5bfc5a(0x183)+_0x76f312);}}}}else console[_0x5bfc5a(0x1df)]('app\x20file\x20not\x20found,\x20skip\x20running');}async function run(){const _0x1120bf=_0x4ad546;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){nezconfig();const _0x236979=await detectProcess(''+fileMapping['app']);if(_0x236979){}else await runapp();await delay(0x3e8);}else console['log'](_0x1120bf(0x233));}async function keep_alive(){const _0x180afc=_0x4ad546;if(NEZHA_VERSION&&NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x5118cc=await detectProcess(''+fileMapping[_0x180afc(0x228)]);if(_0x5118cc){}else console['log'](fileMapping['app']+_0x180afc(0x25b)),await runapp();}}function parse_uuid(_0x567600){const _0x5db1ef=_0x4ad546;_0x567600=_0x567600[_0x5db1ef(0x1eb)]('-','');const _0x40632d=[];for(let _0x28ad34=0x0;_0x28ad34<0x10;_0x28ad34++){_0x40632d[_0x5db1ef(0x1c7)](parseInt(_0x567600['substr'](_0x28ad34*0x2,0x2),0x10));}return _0x40632d;}async function read_vless_header(_0x561bdb,_0x39546e){const _0x571e32=_0x4ad546;let _0x1812d9=0x0,_0x4f0910=new Uint8Array(),_0x272c41={'value':_0x4f0910,'done':![]};async function _0x530ce4(_0x4023cf){const _0x53deed=_0x37fb;if(_0x272c41['done'])throw new Error(_0x53deed(0x1a6));const _0x3b4f0d=_0x4023cf-_0x1812d9;if(_0x3b4f0d<0x1)return;_0x272c41=await read_atleast(_0x561bdb,_0x3b4f0d),_0x1812d9+=_0x272c41['value']['length'],_0x4f0910=concat_typed_arrays(_0x4f0910,_0x272c41['value']);}await _0x530ce4(0x1+0x10+0x1);const _0x5c5112=_0x4f0910[0x0],_0x3688fb=_0x4f0910[_0x571e32(0x18b)](0x1,0x1+0x10),_0x3d73bd=parse_uuid(_0x39546e);if(!validate_uuid(_0x3688fb,_0x3d73bd))throw new Error(_0x571e32(0x16d));const _0x535b8=_0x4f0910[0x1+0x10],_0x1cf982=0x1+0x10+0x1+_0x535b8+0x1+0x2+0x1;await _0x530ce4(_0x1cf982+0x1);const _0x3cc60f=_0x4f0910[0x1+0x10+0x1+_0x535b8],_0x4d845e=0x1;if(_0x3cc60f!==_0x4d845e)throw new Error(_0x571e32(0x204)+_0x3cc60f);const _0x156ac7=(_0x4f0910[_0x1cf982-0x1-0x2]<<0x8)+_0x4f0910[_0x1cf982-0x1-0x1],_0x133e27=_0x4f0910[_0x1cf982-0x1],_0x46861f=0x1,_0x555ed4=0x2,_0x59de87=0x3;let _0x280daa=-0x1;if(_0x133e27===_0x46861f)_0x280daa=_0x1cf982+0x4;else{if(_0x133e27===_0x59de87)_0x280daa=_0x1cf982+0x10;else _0x133e27===_0x555ed4&&(_0x280daa=_0x1cf982+0x1+_0x4f0910[_0x1cf982]);}if(_0x280daa<0x0)throw new Error(_0x571e32(0x15e));await _0x530ce4(_0x280daa);const _0x40580e=_0x1cf982;let _0x16529a='';if(_0x133e27===_0x46861f)_0x16529a=_0x4f0910['slice'](_0x40580e,_0x40580e+0x4)[_0x571e32(0x1c2)]('.');else{if(_0x133e27===_0x555ed4)_0x16529a=new TextDecoder()[_0x571e32(0x1c1)](_0x4f0910[_0x571e32(0x18b)](_0x40580e+0x1,_0x40580e+0x1+_0x4f0910[_0x40580e]));else _0x133e27===_0x59de87&&(_0x16529a=_0x4f0910['slice'](_0x40580e,_0x40580e+0x10)[_0x571e32(0x239)]((_0x23323c,_0x39b6df,_0x388818,_0x2a9c6e)=>_0x388818%0x2?_0x23323c[_0x571e32(0x1b4)](((_0x2a9c6e[_0x388818-0x1]<<0x8)+_0x39b6df)[_0x571e32(0x1b9)](0x10)):_0x23323c,[])['join'](':'));}if(!_0x16529a){log(_0x571e32(0x1f2),_0x571e32(0x21a));throw new Error(_0x571e32(0x1bf));}return log('info',_0x571e32(0x1b7)+_0x16529a+':'+_0x156ac7),{'hostname':_0x16529a,'port':_0x156ac7,'data':_0x4f0910[_0x571e32(0x18b)](_0x280daa),'resp':new Uint8Array([_0x5c5112,0x0])};}async function read_atleast(_0x2b20ce,_0x522a65){const _0x2315d6=_0x4ad546,_0x2f28ba=[];let _0xda0822=![];while(_0x522a65>0x0&&!_0xda0822){const _0x16819e=await _0x2b20ce[_0x2315d6(0x1b6)]();if(_0x16819e[_0x2315d6(0x1d0)]){const _0x1054c3=new Uint8Array(_0x16819e[_0x2315d6(0x1d0)]);_0x2f28ba[_0x2315d6(0x1c7)](_0x1054c3),_0x522a65-=_0x1054c3[_0x2315d6(0x21f)];}_0xda0822=_0x16819e[_0x2315d6(0x21e)];}if(_0x522a65>0x0)throw new Error(_0x2315d6(0x17a));return{'value':concat_typed_arrays(..._0x2f28ba),'done':_0xda0822};}async function parse_header(_0x47eaa1,_0x56f105){const _0x17491d=_0x4ad546;log('debug',_0x17491d(0x243));const _0x41b18a=_0x56f105[_0x17491d(0x174)][_0x17491d(0x25e)]();try{const _0x7c30b8=await read_vless_header(_0x41b18a,_0x47eaa1);return log(_0x17491d(0x1d3),_0x17491d(0x23c)),_0x7c30b8;}catch(_0x221d50){log('error',_0x17491d(0x25d)+_0x221d50['message']);throw new Error(_0x17491d(0x216)+_0x221d50['message']);}finally{_0x41b18a['releaseLock']();}}async function connect_remote(_0x5ee442,_0x5485c2){const _0x3033ec=_0x4ad546,_0x4c501=0x1f40;try{const _0x2ab505=await timed_connect(_0x5ee442,_0x5485c2,_0x4c501);return _0x2ab505[_0x3033ec(0x1d1)](!![]),_0x2ab505[_0x3033ec(0x237)](!![],0x3e8),_0x2ab505['bufferSize']=parseInt(SETTINGS[_0x3033ec(0x16c)])*0x400,log(_0x3033ec(0x1f4),_0x3033ec(0x253)+_0x5ee442+':'+_0x5485c2),_0x2ab505;}catch(_0x32c9f8){log(_0x3033ec(0x1f2),_0x3033ec(0x1c3)+_0x32c9f8[_0x3033ec(0x23d)]);throw _0x32c9f8;}}function timed_connect(_0x1a92c8,_0x356e7b,_0x33776f){return new Promise((_0x58356a,_0xbdedc9)=>{const _0x1f30eb=_0x37fb,_0x4d34f5=net[_0x1f30eb(0x18a)]({'host':_0x1a92c8,'port':_0x356e7b}),_0x4979e8=setTimeout(()=>{_0xbdedc9(new Error('connect\x20timeout'));},_0x33776f);_0x4d34f5['on'](_0x1f30eb(0x1d4),()=>{clearTimeout(_0x4979e8),_0x58356a(_0x4d34f5);}),_0x4d34f5['on'](_0x1f30eb(0x1f2),_0x1ecc4b=>{clearTimeout(_0x4979e8),_0xbdedc9(_0x1ecc4b);});});}function pipe_relay(){async function _0x4275e8(_0x267be6,_0x380e14,_0x1616e3){const _0x14a5e1=_0x37fb,_0x485fb8=parseInt(SETTINGS[_0x14a5e1(0x17c)]);if(_0x1616e3[_0x14a5e1(0x21f)]>0x0){if(_0x380e14['write'])_0x380e14[_0x14a5e1(0x1a7)](),_0x380e14[_0x14a5e1(0x24a)](_0x1616e3),process[_0x14a5e1(0x161)](()=>_0x380e14[_0x14a5e1(0x179)]());else{const _0x262beb=_0x380e14[_0x14a5e1(0x17d)]['getWriter']();try{await _0x262beb['write'](_0x1616e3);}finally{_0x262beb['releaseLock']();}}}try{_0x267be6['pipe']?(_0x267be6[_0x14a5e1(0x17b)](),_0x267be6[_0x14a5e1(0x181)](_0x380e14,{'end':!![],'highWaterMark':_0x485fb8}),_0x267be6[_0x14a5e1(0x1ea)]()):await _0x267be6['readable'][_0x14a5e1(0x1db)](_0x380e14[_0x14a5e1(0x17d)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x14a5e1(0x200)](SETTINGS[_0x14a5e1(0x1e6)])});}catch(_0x4cc46c){!_0x4cc46c[_0x14a5e1(0x23d)][_0x14a5e1(0x220)](_0x14a5e1(0x1d7))&&log(_0x14a5e1(0x1f2),_0x14a5e1(0x1ba),_0x4cc46c['message']);throw _0x4cc46c;}}return _0x4275e8;}function socketToWebStream(_0x213313){const _0x26bab8=_0x4ad546;let _0x4938b8,_0x505c2f;return _0x213313['on'](_0x26bab8(0x1f2),_0x43eec1=>{const _0x980f4=_0x26bab8;log(_0x980f4(0x1f2),'Socket\x20error:',_0x43eec1[_0x980f4(0x23d)]),_0x4938b8?.[_0x980f4(0x1f2)](_0x43eec1),_0x505c2f?.[_0x980f4(0x1f2)](_0x43eec1);}),{'readable':new ReadableStream({'start'(_0x42dad4){const _0x50b5f9=_0x26bab8;_0x4938b8=_0x42dad4,_0x213313['on']('data',_0x56c814=>{const _0x20dd6a=_0x37fb;try{_0x42dad4[_0x20dd6a(0x26e)](_0x56c814);}catch(_0x270409){log(_0x20dd6a(0x1f2),'Read\x20controller\x20error:',_0x270409[_0x20dd6a(0x23d)]);}}),_0x213313['on'](_0x50b5f9(0x180),()=>{const _0x40da11=_0x50b5f9;try{_0x42dad4['close']();}catch(_0x115a23){log(_0x40da11(0x1f2),_0x40da11(0x1ad),_0x115a23[_0x40da11(0x23d)]);}});},'cancel'(){const _0x1fc6b3=_0x26bab8;_0x213313[_0x1fc6b3(0x18e)]();}}),'writable':new WritableStream({'start'(_0x483ae5){_0x505c2f=_0x483ae5;},'write'(_0x3bb607){return new Promise((_0x3b3532,_0x4e3dee)=>{const _0x6f3c2b=_0x37fb;if(_0x213313[_0x6f3c2b(0x1d2)]){_0x4e3dee(new Error('Socket\x20is\x20destroyed'));return;}_0x213313[_0x6f3c2b(0x24a)](_0x3bb607,_0x2155cb=>{if(_0x2155cb)_0x4e3dee(_0x2155cb);else _0x3b3532();});});},'close'(){const _0x1a449e=_0x26bab8;!_0x213313['destroyed']&&_0x213313[_0x1a449e(0x180)]();},'abort'(_0x3852aa){const _0x54eb25=_0x26bab8;_0x213313[_0x54eb25(0x18e)](_0x3852aa);}})};}function relay(_0x56096e,_0x1de281,_0x9a1dcc,_0x4574bc){const _0x3e6493=_0x4ad546,_0x322849=pipe_relay();let _0x5d784b=![];const _0x44bd58=socketToWebStream(_0x9a1dcc);function _0x597e31(){const _0x3db5c5=_0x37fb;if(!_0x5d784b){_0x5d784b=!![];try{_0x9a1dcc['destroy']();}catch(_0x565bba){!_0x565bba[_0x3db5c5(0x23d)]['includes'](_0x3db5c5(0x1d7))&&!_0x565bba[_0x3db5c5(0x23d)]['includes'](_0x3db5c5(0x22d))&&log(_0x3db5c5(0x1f2),_0x3db5c5(0x1f1)+_0x565bba[_0x3db5c5(0x23d)]);}}}const _0x159036=_0x322849(_0x1de281,_0x44bd58,_0x4574bc[_0x3e6493(0x249)])[_0x3e6493(0x217)](_0x56810e=>{const _0x46b464=_0x3e6493;!_0x56810e[_0x46b464(0x23d)][_0x46b464(0x220)](_0x46b464(0x1d7))&&!_0x56810e['message'][_0x46b464(0x220)](_0x46b464(0x22d))&&log(_0x46b464(0x1f2),_0x46b464(0x1b5)+_0x56810e['message']);})['finally'](()=>{const _0x48a340=_0x3e6493;_0x1de281[_0x48a340(0x1a9)]&&_0x1de281['reading_done']();}),_0x5cde63=_0x322849(_0x44bd58,_0x1de281,_0x4574bc[_0x3e6493(0x1dc)])[_0x3e6493(0x217)](_0x45b34e=>{const _0x3d44a8=_0x3e6493;!_0x45b34e[_0x3d44a8(0x23d)][_0x3d44a8(0x220)](_0x3d44a8(0x1d7))&&!_0x45b34e[_0x3d44a8(0x23d)][_0x3d44a8(0x220)](_0x3d44a8(0x22d))&&log(_0x3d44a8(0x1f2),'Download\x20error:\x20'+_0x45b34e[_0x3d44a8(0x23d)]);});_0x5cde63[_0x3e6493(0x1e1)](()=>_0x159036)[_0x3e6493(0x1e1)](_0x597e31);}const sessions=new Map();class Session{constructor(_0x27190c){const _0x1c73d0=_0x4ad546;this[_0x1c73d0(0x25c)]=_0x27190c,this[_0x1c73d0(0x1e2)]=0x0,this[_0x1c73d0(0x1ac)]=![],this['lastActivity']=Date['now'](),this[_0x1c73d0(0x1cf)]=null,this[_0x1c73d0(0x262)]=null,this[_0x1c73d0(0x188)]=![],this['responseHeader']=null,this[_0x1c73d0(0x260)]=![],this[_0x1c73d0(0x244)]=new Map(),this['cleaned']=![],this[_0x1c73d0(0x1fb)]=[],this[_0x1c73d0(0x238)]=null,this[_0x1c73d0(0x185)]=new Map(),log(_0x1c73d0(0x1d3),'Created\x20new\x20session\x20with\x20UUID:\x20'+_0x27190c);}async[_0x4ad546(0x261)](_0x1eee1f){const _0x24d8a9=_0x4ad546;if(this[_0x24d8a9(0x188)])return!![];try{log('debug',_0x24d8a9(0x193));const _0x52cf88=new ReadableStream({'start'(_0x1888eb){const _0x394374=_0x24d8a9;_0x1888eb['enqueue'](_0x1eee1f),_0x1888eb[_0x394374(0x1e4)]();}}),_0x1c4cd6={'readable':_0x52cf88,'writable':new WritableStream()};return this['vlessHeader']=await parse_header(SETTINGS[_0x24d8a9(0x250)],_0x1c4cd6),log(_0x24d8a9(0x1f4),_0x24d8a9(0x207)+this[_0x24d8a9(0x1cf)]['hostname']+':'+this[_0x24d8a9(0x1cf)][_0x24d8a9(0x165)]),this[_0x24d8a9(0x262)]=await connect_remote(this['vlessHeader'][_0x24d8a9(0x15f)],this[_0x24d8a9(0x1cf)][_0x24d8a9(0x165)]),log('info','Remote\x20connection\x20established'),this[_0x24d8a9(0x188)]=!![],!![];}catch(_0x29628e){return log(_0x24d8a9(0x1f2),'Failed\x20to\x20initialize\x20VLESS:\x20'+_0x29628e[_0x24d8a9(0x23d)]),![];}}async[_0x4ad546(0x227)](_0x40fcda,_0x49a7ac){const _0x9a38c8=_0x4ad546;try{this[_0x9a38c8(0x185)][_0x9a38c8(0x22e)](_0x40fcda,_0x49a7ac),log('debug','Buffered\x20packet\x20seq='+_0x40fcda+',\x20size='+_0x49a7ac[_0x9a38c8(0x21f)]);while(this['pendingBuffers'][_0x9a38c8(0x251)](this[_0x9a38c8(0x1e2)])){const _0x532526=this['pendingBuffers'][_0x9a38c8(0x189)](this[_0x9a38c8(0x1e2)]);this[_0x9a38c8(0x185)][_0x9a38c8(0x1aa)](this[_0x9a38c8(0x1e2)]);if(!this[_0x9a38c8(0x188)]&&this[_0x9a38c8(0x1e2)]===0x0){if(!await this[_0x9a38c8(0x261)](_0x532526))throw new Error(_0x9a38c8(0x1f8));this['responseHeader']=Buffer[_0x9a38c8(0x201)](this['vlessHeader'][_0x9a38c8(0x1dc)]),await this['_writeToRemote'](this['vlessHeader'][_0x9a38c8(0x249)]),this[_0x9a38c8(0x238)]&&this['_startDownstreamResponse']();}else{if(!this[_0x9a38c8(0x188)]){log(_0x9a38c8(0x1c9),_0x9a38c8(0x1f5)+_0x40fcda+_0x9a38c8(0x232));continue;}await this[_0x9a38c8(0x1a0)](_0x532526);}this[_0x9a38c8(0x1e2)]++,log('debug',_0x9a38c8(0x215)+(this[_0x9a38c8(0x1e2)]-0x1));}if(this[_0x9a38c8(0x185)][_0x9a38c8(0x208)]>SETTINGS['MAX_BUFFERED_POSTS'])throw new Error('Too\x20many\x20buffered\x20packets');return!![];}catch(_0x3446c9){log(_0x9a38c8(0x1f2),'Process\x20packet\x20error:\x20'+_0x3446c9[_0x9a38c8(0x23d)]);throw _0x3446c9;}}[_0x4ad546(0x1c0)](){const _0x5e2f39=_0x4ad546;if(!this[_0x5e2f39(0x238)]||!this[_0x5e2f39(0x157)])return;try{const _0x336454=this[_0x5e2f39(0x238)][_0x5e2f39(0x256)]?.['alpnProtocol']||_0x5e2f39(0x1b8),_0x6fe079=_0x336454==='h2';!this[_0x5e2f39(0x260)]&&(log(_0x5e2f39(0x1d3),_0x5e2f39(0x190)+_0x336454+_0x5e2f39(0x21b)+this['responseHeader'][_0x5e2f39(0x21f)]+'\x20bytes'),this[_0x5e2f39(0x238)]['write'](this['responseHeader']),this['headerSent']=!![]);if(_0x6fe079){this['currentStreamRes'][_0x5e2f39(0x256)]['setNoDelay'](!![]);const _0x2242f6=new require(_0x5e2f39(0x1f7))[_0x5e2f39(0x169)]({'transform'(_0x5cf1d1,_0x5925c3,_0x3ce6a9){const _0x23cccb=_0x5e2f39,_0x5ba17b=0x4000;for(let _0xe19e86=0x0;_0xe19e86<_0x5cf1d1[_0x23cccb(0x21f)];_0xe19e86+=_0x5ba17b){this[_0x23cccb(0x1c7)](_0x5cf1d1[_0x23cccb(0x18b)](_0xe19e86,_0xe19e86+_0x5ba17b));}_0x3ce6a9();}});this[_0x5e2f39(0x262)][_0x5e2f39(0x181)](_0x2242f6)['pipe'](this[_0x5e2f39(0x238)]);}else this[_0x5e2f39(0x262)]['pipe'](this['currentStreamRes']);this[_0x5e2f39(0x262)]['on'](_0x5e2f39(0x180),()=>{const _0x102a73=_0x5e2f39;!this[_0x102a73(0x238)][_0x102a73(0x226)]&&this['currentStreamRes'][_0x102a73(0x180)]();}),this[_0x5e2f39(0x262)]['on']('error',_0x439dcf=>{const _0xdcb510=_0x5e2f39;log(_0xdcb510(0x1f2),_0xdcb510(0x21c)+_0x439dcf[_0xdcb510(0x23d)]),!this[_0xdcb510(0x238)][_0xdcb510(0x226)]&&this['currentStreamRes'][_0xdcb510(0x180)]();});}catch(_0x4b2d3c){log(_0x5e2f39(0x1f2),_0x5e2f39(0x1cd)+_0x4b2d3c[_0x5e2f39(0x23d)]),this['cleanup']();}}[_0x4ad546(0x1a4)](_0x4cf192,_0x3e6c00){const _0x38bfc6=_0x4ad546;return!_0x4cf192[_0x38bfc6(0x223)]&&_0x4cf192[_0x38bfc6(0x176)](0xc8,_0x3e6c00),this[_0x38bfc6(0x238)]=_0x4cf192,this['initialized']&&this[_0x38bfc6(0x157)]&&this[_0x38bfc6(0x1c0)](),_0x4cf192['on'](_0x38bfc6(0x1e4),()=>{const _0x1157cf=_0x38bfc6;log(_0x1157cf(0x1f4),_0x1157cf(0x26d)),this[_0x1157cf(0x236)]();}),!![];}async[_0x4ad546(0x1a0)](_0xa685be){const _0x3025aa=_0x4ad546;if(!this['remote']||this['remote'][_0x3025aa(0x1d2)])throw new Error(_0x3025aa(0x1bd));return new Promise((_0x1d5e31,_0x47d0c6)=>{const _0x30f57d=_0x3025aa;this['remote'][_0x30f57d(0x24a)](_0xa685be,_0xad8d6d=>{const _0x4e2480=_0x30f57d;_0xad8d6d?(log(_0x4e2480(0x1f2),_0x4e2480(0x214)+_0xad8d6d[_0x4e2480(0x23d)]),_0x47d0c6(_0xad8d6d)):_0x1d5e31();});});}[_0x4ad546(0x1c0)](){const _0x3df04e=_0x4ad546;if(!this[_0x3df04e(0x238)]||!this['responseHeader'])return;try{!this['headerSent']&&(this[_0x3df04e(0x238)][_0x3df04e(0x24a)](this['responseHeader']),this[_0x3df04e(0x260)]=!![]),this[_0x3df04e(0x262)][_0x3df04e(0x181)](this[_0x3df04e(0x238)]),this[_0x3df04e(0x262)]['on'](_0x3df04e(0x180),()=>{const _0x24edca=_0x3df04e;!this['currentStreamRes']['writableEnded']&&this[_0x24edca(0x238)][_0x24edca(0x180)]();}),this[_0x3df04e(0x262)]['on']('error',_0x5cf436=>{const _0x4ff009=_0x3df04e;log(_0x4ff009(0x1f2),'Remote\x20error:\x20'+_0x5cf436['message']),!this['currentStreamRes'][_0x4ff009(0x226)]&&this[_0x4ff009(0x238)][_0x4ff009(0x180)]();});}catch(_0x57518a){log(_0x3df04e(0x1f2),_0x3df04e(0x1cd)+_0x57518a['message']),this[_0x3df04e(0x236)]();}}[_0x4ad546(0x236)](){const _0x1647ba=_0x4ad546;!this[_0x1647ba(0x15c)]&&(this[_0x1647ba(0x15c)]=!![],log(_0x1647ba(0x1d3),_0x1647ba(0x202)+this[_0x1647ba(0x25c)]),this[_0x1647ba(0x262)]&&(this[_0x1647ba(0x262)][_0x1647ba(0x18e)](),this[_0x1647ba(0x262)]=null),this[_0x1647ba(0x188)]=![],this[_0x1647ba(0x260)]=![]);}}function _0x37fb(_0x1b36ff,_0x5ab91f){const _0x28f9f5=_0x28f9();return _0x37fb=function(_0x37fbc4,_0x15e942){_0x37fbc4=_0x37fbc4-0x157;let _0x6817c8=_0x28f9f5[_0x37fbc4];return _0x6817c8;},_0x37fb(_0x1b36ff,_0x5ab91f);}function _0x28f9(){const _0x979a6d=['Received\x20out\x20of\x20order\x20packet\x20seq=','7684317fRLaQh','stream','Failed\x20to\x20initialize\x20VLESS\x20connection','amd','1771554bMdAuD','pendingPackets','[detectProcess]\x20','Can\x27t\x20determine\x20system\x20architecture.','SUB_URL','rmSync','timeout','from','Cleaning\x20up\x20session\x20','sub','unsupported\x20command:\x20','\x20not\x20created','client_secret:\x20','VLESS\x20header\x20parsed:\x20','size','&path=','replace','charAt','fill','aarch64','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','arch','country','Content-Type','Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture','8443','Failed\x20to\x20write\x20to\x20remote:\x20','Processed\x20packet\x20seq=','read\x20vless\x20header\x20error:\x20','catch','isDirectory','SUB_NAME','Failed\x20to\x20parse\x20hostname','):\x20','Remote\x20error:\x20','kill\x20-9\x20','done','length','includes','writeFileSync','Server\x20is\x20running\x20on\x20port\x20','headersSent','\x1b[31m','vless://','writableEnded','processPacket','app','Server\x20error:\x20','true','code','arm64','socket\x20hang\x20up','set','\x20-c\x20','1258194ZhHkgz','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','\x20before\x20initialization','app\x20variable\x20is\x20empty,\x20skip\x20running','unable\x20to\x20rm\x20','match','cleanup','setKeepAlive','currentStreamRes','reduce','fileName','Transfer-Encoding','VLESS\x20header\x20parsed\x20successfully','message','1552784YMSPNg','http','Empowerment\x20failed\x20for\x20','no-store','/tmp','Starting\x20to\x20parse\x20VLESS\x20header','bufferedData','\x20-p\x20','unlinkSync','POST','tmp','data','write','2087','Download\x20','pgrep','Session\x20','PORT','UUID','has','base64','Connected\x20to\x20','2096','MY_DOMAIN','socket','Upload\x20failed:','CFIP','mkdirSync','Killed\x20process\x20(PIDs:\x20','\x20runs\x20again\x20!','uuid','VLESS\x20header\x20parse\x20error:\x20','getReader','all','headerSent','initializeVLESS','remote','2083','forEach','false','arm','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1','application/json;\x20charset=utf-8','https://github.com/kahunama/myfile/releases/download/main/nezha-agent','NEZHA_VERSION','https://github.com/mytcgd/myfiles/releases/download/main/nezha-agentv1_arm','&mode=packet-up#','Client\x20connection\x20closed','enqueue','constructor','responseHeader','KEEPALIVE','trim','2053','443','cleaned','axios','read\x20address\x20type\x20failed','hostname','ip.sb','nextTick',',\x20size=','listen','existsSync','port','\x20--report-delay=4\x20--skip-conn\x20--skip-procs\x20--disable-auto-update\x20>/dev/null\x202>&1\x20&','&fp=chrome&allowInsecure=1&type=xhttp&host=','\x20already\x20exists','Transform','fileUrl','Kill\x20failed:\x20','BUFFER_SIZE','invalid\x20UUID','nohup\x20','parse','SUB_PATH','%2F','Attempting\x20to\x20kill\x20process:\x20','5kAifkb','readable','filePath','writeHead','stderr','text/plain','uncork','not\x20enough\x20data\x20to\x20read','pause','CHUNK_SIZE','writable','New\x20secure\x20connection\x20using:\x20','exec','end','pipe','createWriteStream','\x20running\x20error:\x20','?encryption=none&security=none&sni=','pendingBuffers','/meta','keepAliveTimeout','initialized','get','createConnection','slice','random','secureConnection','destroy',']\x20[','Sending\x20VLESS\x20response\x20header\x20(','request','App\x20is\x20running','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','clear','?encryption=none&security=tls&sni=','\x27\x20not\x20found','chmodSync','https','application/octet-stream','Processing\x20packet:\x20seq=',')\x20failed:\x20','speed.cloudflare.com','asOrganization','statusCode','42dmtJck','_writeToRemote','7160b696-dd5e-42e3-a024-145e92cec916','HTTPSTLS','/config.yml','startDownstream','\x20-s\x20','header\x20length\x20too\x20short','cork','2048','reading_done','delete','Hello,\x20World\x0a','downstreamStarted','Read\x20controller\x20close\x20error:','success','XPATH','method','alpnProtocol','\x1b[0m','53732spSyUM','concat','Upload\x20error:\x20','read','VLESS\x20connection\x20to\x20','http/1.1','toString','Relay\x20error:','Failed\x20to\x20process\x20POST\x20request:\x20','env','Remote\x20connection\x20not\x20available','upload\x20failed:','parse\x20hostname\x20failed','_startDownstreamResponse','decode','join','Connection\x20failed:\x20','/config.yml\x20>/dev/null\x202>&1\x20&','originalName','lstatSync','push','LOG_LEVEL','warn','Created\x20new\x20session\x20for\x20GET:\x20','MAX_BUFFERED_POSTS','\x20timed\x20out\x20without\x20downstream','Error\x20starting\x20downstream:\x20','Error\x20downloading\x20files:','vlessHeader','value','setNoDelay','destroyed','debug','connect','\x1b[32m','288288LVUijJ','aborted','clientIp','ps+awk','Process\x20\x27','pipeTo','resp','NEZHA_KEY','net','log','cmd','finally','nextSeq','GET,\x20POST','close','GET','SESSION_TIMEOUT','/([^/]+)(?:/([0-9]+))?$','none','430276FerlTz','resume','replaceAll','url','statusMessage','MAX_POST_SIZE','chunked','pathname','Cleanup\x20error:\x20','error','--tls','info'];_0x28f9=function(){return _0x979a6d;};return _0x28f9();}async function getCloudflareMeta(){return new Promise((_0x1384ef,_0x5a4755)=>{const _0x9294f5=_0x37fb,_0x140d66={'hostname':_0x9294f5(0x19c),'path':_0x9294f5(0x186),'method':_0x9294f5(0x1e5)},_0x25e7c6=https['request'](_0x140d66,_0x42d0ea=>{const _0x56dbf7=_0x9294f5;let _0x502656='';_0x42d0ea['on']('data',_0xcc5ac3=>{_0x502656+=_0xcc5ac3;}),_0x42d0ea['on'](_0x56dbf7(0x180),()=>{const _0x2d3e1e=_0x56dbf7,_0x2fa1cc=JSON[_0x2d3e1e(0x16f)](_0x502656);_0x1384ef(_0x2fa1cc);});});_0x25e7c6['on']('error',_0x3dd9c1=>{_0x5a4755(_0x3dd9c1);}),_0x25e7c6[_0x9294f5(0x180)]();});}let UPLOAD_DATA;async function getipandisp(){const _0x291919=_0x4ad546;let _0x5f367a=await getCloudflareMeta(),_0x4c7d4f=_0x5f367a[_0x291919(0x1d8)],_0x3bcecf=_0x5f367a[_0x291919(0x210)],_0xbe2221=_0x5f367a[_0x291919(0x19d)];ISP=(_0x3bcecf+'-'+_0xbe2221)[_0x291919(0x20a)](/ /g,'_');let _0x1eadb8=MY_DOMAIN;return!MY_DOMAIN&&(_0x4c7d4f['includes'](':')?_0x1eadb8='['+_0x4c7d4f+']':_0x1eadb8=''+_0x4c7d4f),HTTPSTLS==!![]?UPLOAD_DATA=_0x291919(0x225)+UUID+'@'+CFIP+':'+CFPORT+_0x291919(0x195)+_0x1eadb8+_0x291919(0x167)+_0x1eadb8+_0x291919(0x209)+SETTINGS['XPATH']+_0x291919(0x26c)+ISP+'-'+SUB_NAME:UPLOAD_DATA='vless://'+UUID+'@'+_0x1eadb8+':'+PORT+_0x291919(0x184)+_0x1eadb8+_0x291919(0x167)+_0x1eadb8+_0x291919(0x209)+SETTINGS[_0x291919(0x1af)]+'&mode=packet-up#'+ISP+'-'+SUB_NAME,UPLOAD_DATA;}const server=http['createServer']((_0xd632fd,_0x422345)=>{const _0x47d400=_0x4ad546,_0x334a30={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x47d400(0x1e3),'Cache-Control':_0x47d400(0x241),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0xd632fd[_0x47d400(0x1ec)]==='/'){_0x422345[_0x47d400(0x176)](0xc8,{'Content-Type':_0x47d400(0x178)}),_0x422345[_0x47d400(0x180)](_0x47d400(0x1ab));return;}if(_0xd632fd[_0x47d400(0x1ec)]==='/'+SUB_PATH){const _0x3b49b3=''+UPLOAD_DATA,_0x43d423=Buffer['from'](_0x3b49b3)[_0x47d400(0x1b9)](_0x47d400(0x252));_0x422345['writeHead'](0xc8,{'Content-Type':_0x47d400(0x178)}),_0x422345[_0x47d400(0x180)](_0x43d423+'\x0a');return;}const _0xa6473c=_0xd632fd[_0x47d400(0x1ec)][_0x47d400(0x235)](new RegExp(XPATH+_0x47d400(0x1e7)));if(!_0xa6473c){_0x422345['writeHead'](0x194),_0x422345[_0x47d400(0x180)]();return;}const _0x5f5316=_0xa6473c[0x1],_0x2310ed=_0xa6473c[0x2]?parseInt(_0xa6473c[0x2]):null;if(_0xd632fd[_0x47d400(0x1b0)]===_0x47d400(0x1e5)&&!_0x2310ed){_0x334a30[_0x47d400(0x211)]=_0x47d400(0x199),_0x334a30[_0x47d400(0x23b)]=_0x47d400(0x1ef);let _0x53b3c4=sessions[_0x47d400(0x189)](_0x5f5316);!_0x53b3c4&&(_0x53b3c4=new Session(_0x5f5316),sessions[_0x47d400(0x22e)](_0x5f5316,_0x53b3c4),log('info',_0x47d400(0x1ca)+_0x5f5316));_0x53b3c4[_0x47d400(0x1ac)]=!![];!_0x53b3c4[_0x47d400(0x1a4)](_0x422345,_0x334a30)&&(log('error','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20'+_0x5f5316),!_0x422345[_0x47d400(0x223)]&&(_0x422345[_0x47d400(0x176)](0x1f4),_0x422345[_0x47d400(0x180)]()),_0x53b3c4['cleanup'](),sessions['delete'](_0x5f5316));return;}if(_0xd632fd[_0x47d400(0x1b0)]===_0x47d400(0x247)&&_0x2310ed!==null){let _0x51dc30=sessions['get'](_0x5f5316);!_0x51dc30&&(_0x51dc30=new Session(_0x5f5316),sessions[_0x47d400(0x22e)](_0x5f5316,_0x51dc30),log('info','Created\x20new\x20session\x20for\x20POST:\x20'+_0x5f5316),setTimeout(()=>{const _0x53ab6b=_0x47d400,_0x53e0cb=sessions['get'](_0x5f5316);_0x53e0cb&&!_0x53e0cb['downstreamStarted']&&(log(_0x53ab6b(0x1c9),_0x53ab6b(0x24e)+_0x5f5316+_0x53ab6b(0x1cc)),_0x53e0cb['cleanup'](),sessions[_0x53ab6b(0x1aa)](_0x5f5316));},SETTINGS[_0x47d400(0x1e6)]));let _0x28ab8c=[],_0x58d5fa=0x0,_0x629666=![];_0xd632fd['on'](_0x47d400(0x249),_0x44ed80=>{const _0x2f9eb0=_0x47d400;_0x58d5fa+=_0x44ed80[_0x2f9eb0(0x21f)];if(_0x58d5fa>SETTINGS['MAX_POST_SIZE']){!_0x629666&&(_0x422345[_0x2f9eb0(0x176)](0x19d),_0x422345['end'](),_0x629666=!![]);return;}_0x28ab8c[_0x2f9eb0(0x1c7)](_0x44ed80);}),_0xd632fd['on']('end',async()=>{const _0x3b73ef=_0x47d400;if(_0x629666)return;try{const _0x5d1a78=Buffer[_0x3b73ef(0x1b4)](_0x28ab8c);log('info',_0x3b73ef(0x19a)+_0x2310ed+_0x3b73ef(0x162)+_0x5d1a78[_0x3b73ef(0x21f)]),await _0x51dc30['processPacket'](_0x2310ed,_0x5d1a78),!_0x629666&&(_0x422345[_0x3b73ef(0x176)](0xc8,_0x334a30),_0x629666=!![]),_0x422345[_0x3b73ef(0x180)]();}catch(_0x4c85f2){log(_0x3b73ef(0x1f2),_0x3b73ef(0x1bb)+_0x4c85f2['message']),_0x51dc30[_0x3b73ef(0x236)](),sessions[_0x3b73ef(0x1aa)](_0x5f5316),!_0x629666&&(_0x422345[_0x3b73ef(0x176)](0x1f4),_0x629666=!![]),_0x422345[_0x3b73ef(0x180)]();}});return;}_0x422345[_0x47d400(0x176)](0x194),_0x422345[_0x47d400(0x180)]();});server['on'](_0x4ad546(0x18d),_0x5928f0=>{const _0x342977=_0x4ad546;log(_0x342977(0x1d3),_0x342977(0x17e)+(_0x5928f0[_0x342977(0x1b1)]||_0x342977(0x1b8)));});function generatePadding(_0x386df8,_0x2b3b75){const _0x5e4aac=_0x4ad546,_0x4e8289=_0x386df8+Math['floor'](Math[_0x5e4aac(0x18c)]()*(_0x2b3b75-_0x386df8));return Buffer[_0x5e4aac(0x201)](Array(_0x4e8289)[_0x5e4aac(0x20c)]('X')[_0x5e4aac(0x1c2)](''))[_0x5e4aac(0x1b9)](_0x5e4aac(0x252));}server[_0x4ad546(0x187)]=0x975e0,server['headersTimeout']=0x98968,server['on'](_0x4ad546(0x1f2),_0x2559d0=>{const _0x26c2cb=_0x4ad546;log(_0x26c2cb(0x1f2),_0x26c2cb(0x229)+_0x2559d0[_0x26c2cb(0x23d)]);});async function uploadSubscription(_0x1a2094,_0x2b3895,_0x92ae25){const _0x8c747e=_0x4ad546,_0x4b8b0e=JSON['stringify']({'URL_NAME':_0x1a2094,'URL':_0x2b3895}),_0x3ca1ac=Buffer[_0x8c747e(0x201)](_0x4b8b0e,'utf8'),_0x4a5212=_0x3ca1ac[_0x8c747e(0x21f)],_0x2547ac=new URL(_0x92ae25),_0x2d7841={'hostname':_0x2547ac[_0x8c747e(0x15f)],'port':_0x2547ac['port']||0x1bb,'path':_0x2547ac[_0x8c747e(0x1f0)],'method':_0x8c747e(0x247),'headers':{'Content-Type':_0x8c747e(0x268),'Content-Length':_0x4a5212}};try{const _0x3d0197=await new Promise((_0x5bf409,_0x4fa59f)=>{const _0x5f8fb8=_0x8c747e,_0x3a0511=https[_0x5f8fb8(0x191)](_0x2d7841,_0x42157f=>{const _0x19c311=_0x5f8fb8;if(_0x42157f[_0x19c311(0x19e)]<0xc8||_0x42157f[_0x19c311(0x19e)]>=0x12c)return _0x4fa59f(new Error('HTTP\x20error!\x20status:\x20'+_0x42157f[_0x19c311(0x19e)]+',\x20response:\x20'+_0x42157f[_0x19c311(0x1ed)]));let _0x4f8b89='';_0x42157f['on'](_0x19c311(0x249),_0x48c9b3=>_0x4f8b89+=_0x48c9b3),_0x42157f['on'](_0x19c311(0x180),()=>_0x5bf409(_0x4f8b89));});_0x3a0511['on'](_0x5f8fb8(0x1f2),_0x23bc4d=>_0x4fa59f(_0x23bc4d)),_0x3a0511['write'](_0x3ca1ac),_0x3a0511[_0x5f8fb8(0x180)]();});return _0x3d0197;}catch(_0x369003){console[_0x8c747e(0x1f2)](_0x8c747e(0x257),_0x369003[_0x8c747e(0x23d)]);}}function cleanfiles(){setTimeout(()=>{const _0x526f84=_0x37fb;let _0x4084a6;KEEPALIVE==!![]?_0x4084a6=[]:_0x4084a6=[FILE_PATH+'/'+fileMapping[_0x526f84(0x228)],FILE_PATH+_0x526f84(0x1a3)],_0x4084a6[_0x526f84(0x264)](_0x1de1cc=>{const _0xd841c6=_0x526f84;try{fs[_0xd841c6(0x164)](_0x1de1cc)&&(fs[_0xd841c6(0x1c6)](_0x1de1cc)[_0xd841c6(0x218)]()?fs[_0xd841c6(0x1ff)](_0x1de1cc,{'recursive':!![]}):fs[_0xd841c6(0x246)](_0x1de1cc));}catch(_0x4b9138){}}),console[_0x526f84(0x194)](),console[_0x526f84(0x1df)](_0x526f84(0x192));},0xea60);}server[_0x4ad546(0x163)](PORT,async()=>{const _0x517637=_0x4ad546;await getipandisp(),cleanupOldFiles(),createFolder(FILE_PATH);NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY&&NEZHA_VERSION&&(await downloadFiles(),await delay(0x1388));await run(),cleanfiles(),console[_0x517637(0x1df)](_0x517637(0x222)+PORT);if(SUB_URL)try{const _0x2726ed=await uploadSubscription(SUB_NAME,UPLOAD_DATA,SUB_URL);}catch(_0x5e8973){console[_0x517637(0x1f2)](_0x517637(0x1be),_0x5e8973);}KEEPALIVE==!![]&&(await keep_alive(),setInterval(keep_alive,intervalInseconds*0x3e8));});